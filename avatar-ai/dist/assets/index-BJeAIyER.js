var R_=n=>{throw TypeError(n)};var Eb=(n,e,t)=>e.has(n)||R_("Cannot "+t);var N=(n,e,t)=>(Eb(n,e,"read from private field"),t?t.call(n):e.get(n)),ve=(n,e,t)=>e.has(n)?R_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),fe=(n,e,t,i)=>(Eb(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),Re=(n,e,t)=>(Eb(n,e,"access private method"),t);var fm=(n,e,t,i)=>({set _(s){fe(n,e,s,t)},get _(){return N(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function AD(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ED={exports:{}},Zy={},_D={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qf=Symbol.for("react.element"),E6=Symbol.for("react.portal"),_6=Symbol.for("react.fragment"),M6=Symbol.for("react.strict_mode"),R6=Symbol.for("react.profiler"),P6=Symbol.for("react.provider"),I6=Symbol.for("react.context"),B6=Symbol.for("react.forward_ref"),D6=Symbol.for("react.suspense"),N6=Symbol.for("react.memo"),F6=Symbol.for("react.lazy"),P_=Symbol.iterator;function O6(n){return n===null||typeof n!="object"?null:(n=P_&&n[P_]||n["@@iterator"],typeof n=="function"?n:null)}var MD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RD=Object.assign,PD={};function cd(n,e,t){this.props=n,this.context=e,this.refs=PD,this.updater=t||MD}cd.prototype.isReactComponent={};cd.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};cd.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ID(){}ID.prototype=cd.prototype;function $k(n,e,t){this.props=n,this.context=e,this.refs=PD,this.updater=t||MD}var Xk=$k.prototype=new ID;Xk.constructor=$k;RD(Xk,cd.prototype);Xk.isPureReactComponent=!0;var I_=Array.isArray,BD=Object.prototype.hasOwnProperty,Yk={current:null},DD={key:!0,ref:!0,__self:!0,__source:!0};function ND(n,e,t){var i,s={},r=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)BD.call(e,i)&&!DD.hasOwnProperty(i)&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return{$$typeof:qf,type:n,key:r,ref:o,props:s,_owner:Yk.current}}function L6(n,e){return{$$typeof:qf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Zk(n){return typeof n=="object"&&n!==null&&n.$$typeof===qf}function j6(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var B_=/\/+/g;function _b(n,e){return typeof n=="object"&&n!==null&&n.key!=null?j6(""+n.key):e.toString(36)}function yg(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case qf:case E6:o=!0}}if(o)return o=n,s=s(o),n=i===""?"."+_b(o,0):i,I_(s)?(t="",n!=null&&(t=n.replace(B_,"$&/")+"/"),yg(s,e,t,"",function(d){return d})):s!=null&&(Zk(s)&&(s=L6(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(B_,"$&/")+"/")+n)),e.push(s)),1;if(o=0,i=i===""?".":i+":",I_(n))for(var a=0;a<n.length;a++){r=n[a];var c=i+_b(r,a);o+=yg(r,e,t,c,s)}else if(c=O6(n),typeof c=="function")for(n=c.call(n),a=0;!(r=n.next()).done;)r=r.value,c=i+_b(r,a++),o+=yg(r,e,t,c,s);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function pm(n,e,t){if(n==null)return n;var i=[],s=0;return yg(n,i,"","",function(r){return e.call(t,r,s++)}),i}function U6(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Xn={current:null},vg={transition:null},z6={ReactCurrentDispatcher:Xn,ReactCurrentBatchConfig:vg,ReactCurrentOwner:Yk};function FD(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:pm,forEach:function(n,e,t){pm(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return pm(n,function(){e++}),e},toArray:function(n){return pm(n,function(e){return e})||[]},only:function(n){if(!Zk(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};je.Component=cd;je.Fragment=_6;je.Profiler=R6;je.PureComponent=$k;je.StrictMode=M6;je.Suspense=D6;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z6;je.act=FD;je.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=RD({},n.props),s=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=Yk.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)BD.call(e,c)&&!DD.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=t;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];i.children=a}return{$$typeof:qf,type:n.type,key:s,ref:r,props:i,_owner:o}};je.createContext=function(n){return n={$$typeof:I6,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:P6,_context:n},n.Consumer=n};je.createElement=ND;je.createFactory=function(n){var e=ND.bind(null,n);return e.type=n,e};je.createRef=function(){return{current:null}};je.forwardRef=function(n){return{$$typeof:B6,render:n}};je.isValidElement=Zk;je.lazy=function(n){return{$$typeof:F6,_payload:{_status:-1,_result:n},_init:U6}};je.memo=function(n,e){return{$$typeof:N6,type:n,compare:e===void 0?null:e}};je.startTransition=function(n){var e=vg.transition;vg.transition={};try{n()}finally{vg.transition=e}};je.unstable_act=FD;je.useCallback=function(n,e){return Xn.current.useCallback(n,e)};je.useContext=function(n){return Xn.current.useContext(n)};je.useDebugValue=function(){};je.useDeferredValue=function(n){return Xn.current.useDeferredValue(n)};je.useEffect=function(n,e){return Xn.current.useEffect(n,e)};je.useId=function(){return Xn.current.useId()};je.useImperativeHandle=function(n,e,t){return Xn.current.useImperativeHandle(n,e,t)};je.useInsertionEffect=function(n,e){return Xn.current.useInsertionEffect(n,e)};je.useLayoutEffect=function(n,e){return Xn.current.useLayoutEffect(n,e)};je.useMemo=function(n,e){return Xn.current.useMemo(n,e)};je.useReducer=function(n,e,t){return Xn.current.useReducer(n,e,t)};je.useRef=function(n){return Xn.current.useRef(n)};je.useState=function(n){return Xn.current.useState(n)};je.useSyncExternalStore=function(n,e,t){return Xn.current.useSyncExternalStore(n,e,t)};je.useTransition=function(){return Xn.current.useTransition()};je.version="18.3.1";_D.exports=je;var P=_D.exports;const OD=AD(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V6=P,H6=Symbol.for("react.element"),G6=Symbol.for("react.fragment"),W6=Object.prototype.hasOwnProperty,J6=V6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K6={key:!0,ref:!0,__self:!0,__source:!0};function LD(n,e,t){var i,s={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)W6.call(e,i)&&!K6.hasOwnProperty(i)&&(s[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:H6,type:n,key:r,ref:o,props:s,_owner:J6.current}}Zy.Fragment=G6;Zy.jsx=LD;Zy.jsxs=LD;ED.exports=Zy;var S=ED.exports,AS={},jD={exports:{}},Ni={},UD={exports:{}},zD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(z,X){var te=z.length;z.push(X);e:for(;0<te;){var ye=te-1>>>1,_e=z[ye];if(0<s(_e,X))z[ye]=X,z[te]=_e,te=ye;else break e}}function t(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var X=z[0],te=z.pop();if(te!==X){z[0]=te;e:for(var ye=0,_e=z.length,Dt=_e>>>1;ye<Dt;){var Ye=2*(ye+1)-1,Xt=z[Ye],an=Ye+1,yo=z[an];if(0>s(Xt,te))an<_e&&0>s(yo,Xt)?(z[ye]=yo,z[an]=te,ye=an):(z[ye]=Xt,z[Ye]=te,ye=Ye);else if(an<_e&&0>s(yo,te))z[ye]=yo,z[an]=te,ye=an;else break e}}return X}function s(z,X){var te=z.sortIndex-X.sortIndex;return te!==0?te:z.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,f=null,m=3,y=!1,v=!1,x=!1,k=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(z){for(var X=t(d);X!==null;){if(X.callback===null)i(d);else if(X.startTime<=z)i(d),X.sortIndex=X.expirationTime,e(c,X);else break;X=t(d)}}function E(z){if(x=!1,T(z),!v)if(t(c)!==null)v=!0,K(_);else{var X=t(d);X!==null&&ee(E,X.startTime-z)}}function _(z,X){v=!1,x&&(x=!1,C(I),I=-1),y=!0;var te=m;try{for(T(X),f=t(c);f!==null&&(!(f.expirationTime>X)||z&&!W());){var ye=f.callback;if(typeof ye=="function"){f.callback=null,m=f.priorityLevel;var _e=ye(f.expirationTime<=X);X=n.unstable_now(),typeof _e=="function"?f.callback=_e:f===t(c)&&i(c),T(X)}else i(c);f=t(c)}if(f!==null)var Dt=!0;else{var Ye=t(d);Ye!==null&&ee(E,Ye.startTime-X),Dt=!1}return Dt}finally{f=null,m=te,y=!1}}var R=!1,B=null,I=-1,L=5,O=-1;function W(){return!(n.unstable_now()-O<L)}function ie(){if(B!==null){var z=n.unstable_now();O=z;var X=!0;try{X=B(!0,z)}finally{X?he():(R=!1,B=null)}}else R=!1}var he;if(typeof A=="function")he=function(){A(ie)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,le=ae.port2;ae.port1.onmessage=ie,he=function(){le.postMessage(null)}}else he=function(){k(ie,0)};function K(z){B=z,R||(R=!0,he())}function ee(z,X){I=k(function(){z(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,K(_))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(z){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var te=m;m=X;try{return z()}finally{m=te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,X){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var te=m;m=z;try{return X()}finally{m=te}},n.unstable_scheduleCallback=function(z,X,te){var ye=n.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?ye+te:ye):te=ye,z){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=te+_e,z={id:h++,callback:X,priorityLevel:z,startTime:te,expirationTime:_e,sortIndex:-1},te>ye?(z.sortIndex=te,e(d,z),t(c)===null&&z===t(d)&&(x?(C(I),I=-1):x=!0,ee(E,te-ye))):(z.sortIndex=_e,e(c,z),v||y||(v=!0,K(_))),z},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(z){var X=m;return function(){var te=m;m=X;try{return z.apply(this,arguments)}finally{m=te}}}})(zD);UD.exports=zD;var q6=UD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q6=P,Di=q6;function ne(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VD=new Set,af={};function Zl(n,e){Ju(n,e),Ju(n+"Capture",e)}function Ju(n,e){for(af[n]=e,n=0;n<e.length;n++)VD.add(e[n])}var so=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ES=Object.prototype.hasOwnProperty,$6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D_={},N_={};function X6(n){return ES.call(N_,n)?!0:ES.call(D_,n)?!1:$6.test(n)?N_[n]=!0:(D_[n]=!0,!1)}function Y6(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Z6(n,e,t,i){if(e===null||typeof e>"u"||Y6(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yn(n,e,t,i,s,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){An[n]=new Yn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];An[e]=new Yn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){An[n]=new Yn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){An[n]=new Yn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){An[n]=new Yn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){An[n]=new Yn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){An[n]=new Yn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){An[n]=new Yn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){An[n]=new Yn(n,5,!1,n.toLowerCase(),null,!1,!1)});var ew=/[\-:]([a-z])/g;function tw(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ew,tw);An[e]=new Yn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ew,tw);An[e]=new Yn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ew,tw);An[e]=new Yn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){An[n]=new Yn(n,1,!1,n.toLowerCase(),null,!1,!1)});An.xlinkHref=new Yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){An[n]=new Yn(n,1,!1,n.toLowerCase(),null,!0,!0)});function nw(n,e,t,i){var s=An.hasOwnProperty(e)?An[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Z6(e,t,s,i)&&(t=null),i||s===null?X6(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,i=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var ho=Q6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mm=Symbol.for("react.element"),Qc=Symbol.for("react.portal"),$c=Symbol.for("react.fragment"),iw=Symbol.for("react.strict_mode"),_S=Symbol.for("react.profiler"),HD=Symbol.for("react.provider"),GD=Symbol.for("react.context"),sw=Symbol.for("react.forward_ref"),MS=Symbol.for("react.suspense"),RS=Symbol.for("react.suspense_list"),rw=Symbol.for("react.memo"),Yo=Symbol.for("react.lazy"),WD=Symbol.for("react.offscreen"),F_=Symbol.iterator;function Zd(n){return n===null||typeof n!="object"?null:(n=F_&&n[F_]||n["@@iterator"],typeof n=="function"?n:null)}var Tt=Object.assign,Mb;function Ah(n){if(Mb===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Mb=e&&e[1]||""}return`
`+Mb+n}var Rb=!1;function Pb(n,e){if(!n||Rb)return"";Rb=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var i=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){i=d}n.call(e.prototype)}else{try{throw Error()}catch(d){i=d}n()}}catch(d){if(d&&i&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),r=i.stack.split(`
`),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==r[a]){var c=`
`+s[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{Rb=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Ah(n):""}function e5(n){switch(n.tag){case 5:return Ah(n.type);case 16:return Ah("Lazy");case 13:return Ah("Suspense");case 19:return Ah("SuspenseList");case 0:case 2:case 15:return n=Pb(n.type,!1),n;case 11:return n=Pb(n.type.render,!1),n;case 1:return n=Pb(n.type,!0),n;default:return""}}function PS(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case $c:return"Fragment";case Qc:return"Portal";case _S:return"Profiler";case iw:return"StrictMode";case MS:return"Suspense";case RS:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case GD:return(n.displayName||"Context")+".Consumer";case HD:return(n._context.displayName||"Context")+".Provider";case sw:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case rw:return e=n.displayName||null,e!==null?e:PS(n.type)||"Memo";case Yo:e=n._payload,n=n._init;try{return PS(n(e))}catch{}}return null}function t5(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return PS(e);case 8:return e===iw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _a(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function JD(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function n5(n){var e=JD(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function gm(n){n._valueTracker||(n._valueTracker=n5(n))}function KD(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=JD(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function ey(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function IS(n,e){var t=e.checked;return Tt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function O_(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=_a(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qD(n,e){e=e.checked,e!=null&&nw(n,"checked",e,!1)}function BS(n,e){qD(n,e);var t=_a(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?DS(n,e.type,t):e.hasOwnProperty("defaultValue")&&DS(n,e.type,_a(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function L_(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function DS(n,e,t){(e!=="number"||ey(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Eh=Array.isArray;function gu(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+_a(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function NS(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Tt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function j_(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ne(92));if(Eh(t)){if(1<t.length)throw Error(ne(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:_a(t)}}function QD(n,e){var t=_a(e.value),i=_a(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function U_(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function $D(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function FS(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?$D(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ym,XD=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(ym=ym||document.createElement("div"),ym.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ym.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function lf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Fh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i5=["Webkit","ms","Moz","O"];Object.keys(Fh).forEach(function(n){i5.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Fh[e]=Fh[n]})});function YD(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Fh.hasOwnProperty(n)&&Fh[n]?(""+e).trim():e+"px"}function ZD(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,s=YD(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,s):n[t]=s}}var s5=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function OS(n,e){if(e){if(s5[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function LS(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jS=null;function ow(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var US=null,yu=null,vu=null;function z_(n){if(n=Xf(n)){if(typeof US!="function")throw Error(ne(280));var e=n.stateNode;e&&(e=sv(e),US(n.stateNode,n.type,e))}}function eN(n){yu?vu?vu.push(n):vu=[n]:yu=n}function tN(){if(yu){var n=yu,e=vu;if(vu=yu=null,z_(n),e)for(n=0;n<e.length;n++)z_(e[n])}}function nN(n,e){return n(e)}function iN(){}var Ib=!1;function sN(n,e,t){if(Ib)return n(e,t);Ib=!0;try{return nN(n,e,t)}finally{Ib=!1,(yu!==null||vu!==null)&&(iN(),tN())}}function cf(n,e){var t=n.stateNode;if(t===null)return null;var i=sv(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ne(231,e,typeof t));return t}var zS=!1;if(so)try{var eh={};Object.defineProperty(eh,"passive",{get:function(){zS=!0}}),window.addEventListener("test",eh,eh),window.removeEventListener("test",eh,eh)}catch{zS=!1}function r5(n,e,t,i,s,r,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(h){this.onError(h)}}var Oh=!1,ty=null,ny=!1,VS=null,o5={onError:function(n){Oh=!0,ty=n}};function a5(n,e,t,i,s,r,o,a,c){Oh=!1,ty=null,r5.apply(o5,arguments)}function l5(n,e,t,i,s,r,o,a,c){if(a5.apply(this,arguments),Oh){if(Oh){var d=ty;Oh=!1,ty=null}else throw Error(ne(198));ny||(ny=!0,VS=d)}}function ec(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function rN(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function V_(n){if(ec(n)!==n)throw Error(ne(188))}function c5(n){var e=n.alternate;if(!e){if(e=ec(n),e===null)throw Error(ne(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return V_(s),n;if(r===i)return V_(s),e;r=r.sibling}throw Error(ne(188))}if(t.return!==i.return)t=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(t.alternate!==i)throw Error(ne(190))}if(t.tag!==3)throw Error(ne(188));return t.stateNode.current===t?n:e}function oN(n){return n=c5(n),n!==null?aN(n):null}function aN(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=aN(n);if(e!==null)return e;n=n.sibling}return null}var lN=Di.unstable_scheduleCallback,H_=Di.unstable_cancelCallback,u5=Di.unstable_shouldYield,d5=Di.unstable_requestPaint,Lt=Di.unstable_now,h5=Di.unstable_getCurrentPriorityLevel,aw=Di.unstable_ImmediatePriority,cN=Di.unstable_UserBlockingPriority,iy=Di.unstable_NormalPriority,f5=Di.unstable_LowPriority,uN=Di.unstable_IdlePriority,ev=null,nr=null;function p5(n){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(ev,n,void 0,(n.current.flags&128)===128)}catch{}}var Ps=Math.clz32?Math.clz32:y5,m5=Math.log,g5=Math.LN2;function y5(n){return n>>>=0,n===0?32:31-(m5(n)/g5|0)|0}var vm=64,bm=4194304;function _h(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function sy(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,s=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?i=_h(a):(r&=o,r!==0&&(i=_h(r)))}else o=t&~s,o!==0?i=_h(o):r!==0&&(i=_h(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,r=e&-e,s>=r||s===16&&(r&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Ps(e),s=1<<t,i|=n[t],e&=~s;return i}function v5(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b5(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-Ps(r),a=1<<o,c=s[o];c===-1?(!(a&t)||a&i)&&(s[o]=v5(a,e)):c<=e&&(n.expiredLanes|=a),r&=~a}}function HS(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function dN(){var n=vm;return vm<<=1,!(vm&4194240)&&(vm=64),n}function Bb(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Qf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ps(e),n[e]=t}function x5(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Ps(t),r=1<<s;e[s]=0,i[s]=-1,n[s]=-1,t&=~r}}function lw(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Ps(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}var nt=0;function hN(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var fN,cw,pN,mN,gN,GS=!1,xm=[],ga=null,ya=null,va=null,uf=new Map,df=new Map,ea=[],S5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G_(n,e){switch(n){case"focusin":case"focusout":ga=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":va=null;break;case"pointerover":case"pointerout":uf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":df.delete(e.pointerId)}}function th(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=Xf(e),e!==null&&cw(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function C5(n,e,t,i,s){switch(e){case"focusin":return ga=th(ga,n,e,t,i,s),!0;case"dragenter":return ya=th(ya,n,e,t,i,s),!0;case"mouseover":return va=th(va,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return uf.set(r,th(uf.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,df.set(r,th(df.get(r)||null,n,e,t,i,s)),!0}return!1}function yN(n){var e=yl(n.target);if(e!==null){var t=ec(e);if(t!==null){if(e=t.tag,e===13){if(e=rN(t),e!==null){n.blockedOn=e,gN(n.priority,function(){pN(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function bg(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=WS(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);jS=i,t.target.dispatchEvent(i),jS=null}else return e=Xf(t),e!==null&&cw(e),n.blockedOn=t,!1;e.shift()}return!0}function W_(n,e,t){bg(n)&&t.delete(e)}function k5(){GS=!1,ga!==null&&bg(ga)&&(ga=null),ya!==null&&bg(ya)&&(ya=null),va!==null&&bg(va)&&(va=null),uf.forEach(W_),df.forEach(W_)}function nh(n,e){n.blockedOn===e&&(n.blockedOn=null,GS||(GS=!0,Di.unstable_scheduleCallback(Di.unstable_NormalPriority,k5)))}function hf(n){function e(s){return nh(s,n)}if(0<xm.length){nh(xm[0],n);for(var t=1;t<xm.length;t++){var i=xm[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ga!==null&&nh(ga,n),ya!==null&&nh(ya,n),va!==null&&nh(va,n),uf.forEach(e),df.forEach(e),t=0;t<ea.length;t++)i=ea[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<ea.length&&(t=ea[0],t.blockedOn===null);)yN(t),t.blockedOn===null&&ea.shift()}var bu=ho.ReactCurrentBatchConfig,ry=!0;function w5(n,e,t,i){var s=nt,r=bu.transition;bu.transition=null;try{nt=1,uw(n,e,t,i)}finally{nt=s,bu.transition=r}}function T5(n,e,t,i){var s=nt,r=bu.transition;bu.transition=null;try{nt=4,uw(n,e,t,i)}finally{nt=s,bu.transition=r}}function uw(n,e,t,i){if(ry){var s=WS(n,e,t,i);if(s===null)Hb(n,e,i,oy,t),G_(n,i);else if(C5(s,n,e,t,i))i.stopPropagation();else if(G_(n,i),e&4&&-1<S5.indexOf(n)){for(;s!==null;){var r=Xf(s);if(r!==null&&fN(r),r=WS(n,e,t,i),r===null&&Hb(n,e,i,oy,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else Hb(n,e,i,null,t)}}var oy=null;function WS(n,e,t,i){if(oy=null,n=ow(i),n=yl(n),n!==null)if(e=ec(n),e===null)n=null;else if(t=e.tag,t===13){if(n=rN(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return oy=n,null}function vN(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h5()){case aw:return 1;case cN:return 4;case iy:case f5:return 16;case uN:return 536870912;default:return 16}default:return 16}}var ha=null,dw=null,xg=null;function bN(){if(xg)return xg;var n,e=dw,t=e.length,i,s="value"in ha?ha.value:ha.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===s[r-i];i++);return xg=s.slice(n,1<i?1-i:void 0)}function Sg(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Sm(){return!0}function J_(){return!1}function Fi(n){function e(t,i,s,r,o){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Sm:J_,this.isPropagationStopped=J_,this}return Tt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Sm)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Sm)},persist:function(){},isPersistent:Sm}),e}var ud={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hw=Fi(ud),$f=Tt({},ud,{view:0,detail:0}),A5=Fi($f),Db,Nb,ih,tv=Tt({},$f,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ih&&(ih&&n.type==="mousemove"?(Db=n.screenX-ih.screenX,Nb=n.screenY-ih.screenY):Nb=Db=0,ih=n),Db)},movementY:function(n){return"movementY"in n?n.movementY:Nb}}),K_=Fi(tv),E5=Tt({},tv,{dataTransfer:0}),_5=Fi(E5),M5=Tt({},$f,{relatedTarget:0}),Fb=Fi(M5),R5=Tt({},ud,{animationName:0,elapsedTime:0,pseudoElement:0}),P5=Fi(R5),I5=Tt({},ud,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),B5=Fi(I5),D5=Tt({},ud,{data:0}),q_=Fi(D5),N5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L5(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=O5[n])?!!e[n]:!1}function fw(){return L5}var j5=Tt({},$f,{key:function(n){if(n.key){var e=N5[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Sg(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?F5[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fw,charCode:function(n){return n.type==="keypress"?Sg(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Sg(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),U5=Fi(j5),z5=Tt({},tv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Q_=Fi(z5),V5=Tt({},$f,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fw}),H5=Fi(V5),G5=Tt({},ud,{propertyName:0,elapsedTime:0,pseudoElement:0}),W5=Fi(G5),J5=Tt({},tv,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),K5=Fi(J5),q5=[9,13,27,32],pw=so&&"CompositionEvent"in window,Lh=null;so&&"documentMode"in document&&(Lh=document.documentMode);var Q5=so&&"TextEvent"in window&&!Lh,xN=so&&(!pw||Lh&&8<Lh&&11>=Lh),$_=" ",X_=!1;function SN(n,e){switch(n){case"keyup":return q5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CN(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xc=!1;function $5(n,e){switch(n){case"compositionend":return CN(e);case"keypress":return e.which!==32?null:(X_=!0,$_);case"textInput":return n=e.data,n===$_&&X_?null:n;default:return null}}function X5(n,e){if(Xc)return n==="compositionend"||!pw&&SN(n,e)?(n=bN(),xg=dw=ha=null,Xc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xN&&e.locale!=="ko"?null:e.data;default:return null}}var Y5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Y_(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Y5[n.type]:e==="textarea"}function kN(n,e,t,i){eN(i),e=ay(e,"onChange"),0<e.length&&(t=new hw("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var jh=null,ff=null;function Z5(n){DN(n,0)}function nv(n){var e=eu(n);if(KD(e))return n}function ez(n,e){if(n==="change")return e}var wN=!1;if(so){var Ob;if(so){var Lb="oninput"in document;if(!Lb){var Z_=document.createElement("div");Z_.setAttribute("oninput","return;"),Lb=typeof Z_.oninput=="function"}Ob=Lb}else Ob=!1;wN=Ob&&(!document.documentMode||9<document.documentMode)}function eM(){jh&&(jh.detachEvent("onpropertychange",TN),ff=jh=null)}function TN(n){if(n.propertyName==="value"&&nv(ff)){var e=[];kN(e,ff,n,ow(n)),sN(Z5,e)}}function tz(n,e,t){n==="focusin"?(eM(),jh=e,ff=t,jh.attachEvent("onpropertychange",TN)):n==="focusout"&&eM()}function nz(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nv(ff)}function iz(n,e){if(n==="click")return nv(e)}function sz(n,e){if(n==="input"||n==="change")return nv(e)}function rz(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ns=typeof Object.is=="function"?Object.is:rz;function pf(n,e){if(Ns(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!ES.call(e,s)||!Ns(n[s],e[s]))return!1}return!0}function tM(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function nM(n,e){var t=tM(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=tM(t)}}function AN(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?AN(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function EN(){for(var n=window,e=ey();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ey(n.document)}return e}function mw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function oz(n){var e=EN(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&AN(t.ownerDocument.documentElement,t)){if(i!==null&&mw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=nM(t,r);var o=nM(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var az=so&&"documentMode"in document&&11>=document.documentMode,Yc=null,JS=null,Uh=null,KS=!1;function iM(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;KS||Yc==null||Yc!==ey(i)||(i=Yc,"selectionStart"in i&&mw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Uh&&pf(Uh,i)||(Uh=i,i=ay(JS,"onSelect"),0<i.length&&(e=new hw("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Yc)))}function Cm(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Zc={animationend:Cm("Animation","AnimationEnd"),animationiteration:Cm("Animation","AnimationIteration"),animationstart:Cm("Animation","AnimationStart"),transitionend:Cm("Transition","TransitionEnd")},jb={},_N={};so&&(_N=document.createElement("div").style,"AnimationEvent"in window||(delete Zc.animationend.animation,delete Zc.animationiteration.animation,delete Zc.animationstart.animation),"TransitionEvent"in window||delete Zc.transitionend.transition);function iv(n){if(jb[n])return jb[n];if(!Zc[n])return n;var e=Zc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in _N)return jb[n]=e[t];return n}var MN=iv("animationend"),RN=iv("animationiteration"),PN=iv("animationstart"),IN=iv("transitionend"),BN=new Map,sM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Da(n,e){BN.set(n,e),Zl(e,[n])}for(var Ub=0;Ub<sM.length;Ub++){var zb=sM[Ub],lz=zb.toLowerCase(),cz=zb[0].toUpperCase()+zb.slice(1);Da(lz,"on"+cz)}Da(MN,"onAnimationEnd");Da(RN,"onAnimationIteration");Da(PN,"onAnimationStart");Da("dblclick","onDoubleClick");Da("focusin","onFocus");Da("focusout","onBlur");Da(IN,"onTransitionEnd");Ju("onMouseEnter",["mouseout","mouseover"]);Ju("onMouseLeave",["mouseout","mouseover"]);Ju("onPointerEnter",["pointerout","pointerover"]);Ju("onPointerLeave",["pointerout","pointerover"]);Zl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mh));function rM(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,l5(i,e,void 0,n),n.currentTarget=null}function DN(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==r&&s.isPropagationStopped())break e;rM(s,a,d),r=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==r&&s.isPropagationStopped())break e;rM(s,a,d),r=c}}}if(ny)throw n=VS,ny=!1,VS=null,n}function ft(n,e){var t=e[YS];t===void 0&&(t=e[YS]=new Set);var i=n+"__bubble";t.has(i)||(NN(e,n,2,!1),t.add(i))}function Vb(n,e,t){var i=0;e&&(i|=4),NN(t,n,i,e)}var km="_reactListening"+Math.random().toString(36).slice(2);function mf(n){if(!n[km]){n[km]=!0,VD.forEach(function(t){t!=="selectionchange"&&(uz.has(t)||Vb(t,!1,n),Vb(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[km]||(e[km]=!0,Vb("selectionchange",!1,e))}}function NN(n,e,t,i){switch(vN(e)){case 1:var s=w5;break;case 4:s=T5;break;default:s=uw}t=s.bind(null,e,t,n),s=void 0,!zS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Hb(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=yl(a),o===null)return;if(c=o.tag,c===5||c===6){i=r=o;continue e}a=a.parentNode}}i=i.return}sN(function(){var d=r,h=ow(t),f=[];e:{var m=BN.get(n);if(m!==void 0){var y=hw,v=n;switch(n){case"keypress":if(Sg(t)===0)break e;case"keydown":case"keyup":y=U5;break;case"focusin":v="focus",y=Fb;break;case"focusout":v="blur",y=Fb;break;case"beforeblur":case"afterblur":y=Fb;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=K_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=_5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=H5;break;case MN:case RN:case PN:y=P5;break;case IN:y=W5;break;case"scroll":y=A5;break;case"wheel":y=K5;break;case"copy":case"cut":case"paste":y=B5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Q_}var x=(e&4)!==0,k=!x&&n==="scroll",C=x?m!==null?m+"Capture":null:m;x=[];for(var A=d,T;A!==null;){T=A;var E=T.stateNode;if(T.tag===5&&E!==null&&(T=E,C!==null&&(E=cf(A,C),E!=null&&x.push(gf(A,E,T)))),k)break;A=A.return}0<x.length&&(m=new y(m,v,null,t,h),f.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",y=n==="mouseout"||n==="pointerout",m&&t!==jS&&(v=t.relatedTarget||t.fromElement)&&(yl(v)||v[ro]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(v=t.relatedTarget||t.toElement,y=d,v=v?yl(v):null,v!==null&&(k=ec(v),v!==k||v.tag!==5&&v.tag!==6)&&(v=null)):(y=null,v=d),y!==v)){if(x=K_,E="onMouseLeave",C="onMouseEnter",A="mouse",(n==="pointerout"||n==="pointerover")&&(x=Q_,E="onPointerLeave",C="onPointerEnter",A="pointer"),k=y==null?m:eu(y),T=v==null?m:eu(v),m=new x(E,A+"leave",y,t,h),m.target=k,m.relatedTarget=T,E=null,yl(h)===d&&(x=new x(C,A+"enter",v,t,h),x.target=T,x.relatedTarget=k,E=x),k=E,y&&v)t:{for(x=y,C=v,A=0,T=x;T;T=Ic(T))A++;for(T=0,E=C;E;E=Ic(E))T++;for(;0<A-T;)x=Ic(x),A--;for(;0<T-A;)C=Ic(C),T--;for(;A--;){if(x===C||C!==null&&x===C.alternate)break t;x=Ic(x),C=Ic(C)}x=null}else x=null;y!==null&&oM(f,m,y,x,!1),v!==null&&k!==null&&oM(f,k,v,x,!0)}}e:{if(m=d?eu(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var _=ez;else if(Y_(m))if(wN)_=sz;else{_=nz;var R=tz}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(_=iz);if(_&&(_=_(n,d))){kN(f,_,t,h);break e}R&&R(n,m,d),n==="focusout"&&(R=m._wrapperState)&&R.controlled&&m.type==="number"&&DS(m,"number",m.value)}switch(R=d?eu(d):window,n){case"focusin":(Y_(R)||R.contentEditable==="true")&&(Yc=R,JS=d,Uh=null);break;case"focusout":Uh=JS=Yc=null;break;case"mousedown":KS=!0;break;case"contextmenu":case"mouseup":case"dragend":KS=!1,iM(f,t,h);break;case"selectionchange":if(az)break;case"keydown":case"keyup":iM(f,t,h)}var B;if(pw)e:{switch(n){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Xc?SN(n,t)&&(I="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(I="onCompositionStart");I&&(xN&&t.locale!=="ko"&&(Xc||I!=="onCompositionStart"?I==="onCompositionEnd"&&Xc&&(B=bN()):(ha=h,dw="value"in ha?ha.value:ha.textContent,Xc=!0)),R=ay(d,I),0<R.length&&(I=new q_(I,n,null,t,h),f.push({event:I,listeners:R}),B?I.data=B:(B=CN(t),B!==null&&(I.data=B)))),(B=Q5?$5(n,t):X5(n,t))&&(d=ay(d,"onBeforeInput"),0<d.length&&(h=new q_("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:d}),h.data=B))}DN(f,e)})}function gf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ay(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;s.tag===5&&r!==null&&(s=r,r=cf(n,t),r!=null&&i.unshift(gf(n,r,s)),r=cf(n,e),r!=null&&i.push(gf(n,r,s))),n=n.return}return i}function Ic(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function oM(n,e,t,i,s){for(var r=e._reactName,o=[];t!==null&&t!==i;){var a=t,c=a.alternate,d=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&d!==null&&(a=d,s?(c=cf(t,r),c!=null&&o.unshift(gf(t,c,a))):s||(c=cf(t,r),c!=null&&o.push(gf(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var dz=/\r\n?/g,hz=/\u0000|\uFFFD/g;function aM(n){return(typeof n=="string"?n:""+n).replace(dz,`
`).replace(hz,"")}function wm(n,e,t){if(e=aM(e),aM(n)!==e&&t)throw Error(ne(425))}function ly(){}var qS=null,QS=null;function $S(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var XS=typeof setTimeout=="function"?setTimeout:void 0,fz=typeof clearTimeout=="function"?clearTimeout:void 0,lM=typeof Promise=="function"?Promise:void 0,pz=typeof queueMicrotask=="function"?queueMicrotask:typeof lM<"u"?function(n){return lM.resolve(null).then(n).catch(mz)}:XS;function mz(n){setTimeout(function(){throw n})}function Gb(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(i===0){n.removeChild(s),hf(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=s}while(t);hf(e)}function ba(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function cM(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var dd=Math.random().toString(36).slice(2),tr="__reactFiber$"+dd,yf="__reactProps$"+dd,ro="__reactContainer$"+dd,YS="__reactEvents$"+dd,gz="__reactListeners$"+dd,yz="__reactHandles$"+dd;function yl(n){var e=n[tr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ro]||t[tr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=cM(n);n!==null;){if(t=n[tr])return t;n=cM(n)}return e}n=t,t=n.parentNode}return null}function Xf(n){return n=n[tr]||n[ro],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function eu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ne(33))}function sv(n){return n[yf]||null}var ZS=[],tu=-1;function Na(n){return{current:n}}function pt(n){0>tu||(n.current=ZS[tu],ZS[tu]=null,tu--)}function ct(n,e){tu++,ZS[tu]=n.current,n.current=e}var Ma={},On=Na(Ma),di=Na(!1),Vl=Ma;function Ku(n,e){var t=n.type.contextTypes;if(!t)return Ma;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},r;for(r in t)s[r]=e[r];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function hi(n){return n=n.childContextTypes,n!=null}function cy(){pt(di),pt(On)}function uM(n,e,t){if(On.current!==Ma)throw Error(ne(168));ct(On,e),ct(di,t)}function FN(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(ne(108,t5(n)||"Unknown",s));return Tt({},t,i)}function uy(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ma,Vl=On.current,ct(On,n),ct(di,di.current),!0}function dM(n,e,t){var i=n.stateNode;if(!i)throw Error(ne(169));t?(n=FN(n,e,Vl),i.__reactInternalMemoizedMergedChildContext=n,pt(di),pt(On),ct(On,n)):pt(di),ct(di,t)}var Or=null,rv=!1,Wb=!1;function ON(n){Or===null?Or=[n]:Or.push(n)}function vz(n){rv=!0,ON(n)}function Fa(){if(!Wb&&Or!==null){Wb=!0;var n=0,e=nt;try{var t=Or;for(nt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Or=null,rv=!1}catch(s){throw Or!==null&&(Or=Or.slice(n+1)),lN(aw,Fa),s}finally{nt=e,Wb=!1}}return null}var nu=[],iu=0,dy=null,hy=0,qi=[],Qi=0,Hl=null,qr=1,Qr="";function hl(n,e){nu[iu++]=hy,nu[iu++]=dy,dy=n,hy=e}function LN(n,e,t){qi[Qi++]=qr,qi[Qi++]=Qr,qi[Qi++]=Hl,Hl=n;var i=qr;n=Qr;var s=32-Ps(i)-1;i&=~(1<<s),t+=1;var r=32-Ps(e)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,qr=1<<32-Ps(e)+s|t<<s|i,Qr=r+n}else qr=1<<r|t<<s|i,Qr=n}function gw(n){n.return!==null&&(hl(n,1),LN(n,1,0))}function yw(n){for(;n===dy;)dy=nu[--iu],nu[iu]=null,hy=nu[--iu],nu[iu]=null;for(;n===Hl;)Hl=qi[--Qi],qi[Qi]=null,Qr=qi[--Qi],qi[Qi]=null,qr=qi[--Qi],qi[Qi]=null}var Ii=null,Ri=null,mt=!1,ks=null;function jN(n,e){var t=$i(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function hM(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ii=n,Ri=ba(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ii=n,Ri=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Hl!==null?{id:qr,overflow:Qr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=$i(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ii=n,Ri=null,!0):!1;default:return!1}}function eC(n){return(n.mode&1)!==0&&(n.flags&128)===0}function tC(n){if(mt){var e=Ri;if(e){var t=e;if(!hM(n,e)){if(eC(n))throw Error(ne(418));e=ba(t.nextSibling);var i=Ii;e&&hM(n,e)?jN(i,t):(n.flags=n.flags&-4097|2,mt=!1,Ii=n)}}else{if(eC(n))throw Error(ne(418));n.flags=n.flags&-4097|2,mt=!1,Ii=n}}}function fM(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ii=n}function Tm(n){if(n!==Ii)return!1;if(!mt)return fM(n),mt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!$S(n.type,n.memoizedProps)),e&&(e=Ri)){if(eC(n))throw UN(),Error(ne(418));for(;e;)jN(n,e),e=ba(e.nextSibling)}if(fM(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ne(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ri=ba(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ri=null}}else Ri=Ii?ba(n.stateNode.nextSibling):null;return!0}function UN(){for(var n=Ri;n;)n=ba(n.nextSibling)}function qu(){Ri=Ii=null,mt=!1}function vw(n){ks===null?ks=[n]:ks.push(n)}var bz=ho.ReactCurrentBatchConfig;function sh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ne(309));var i=t.stateNode}if(!i)throw Error(ne(147,n));var s=i,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=s.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(ne(284));if(!t._owner)throw Error(ne(290,n))}return n}function Am(n,e){throw n=Object.prototype.toString.call(e),Error(ne(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function pM(n){var e=n._init;return e(n._payload)}function zN(n){function e(C,A){if(n){var T=C.deletions;T===null?(C.deletions=[A],C.flags|=16):T.push(A)}}function t(C,A){if(!n)return null;for(;A!==null;)e(C,A),A=A.sibling;return null}function i(C,A){for(C=new Map;A!==null;)A.key!==null?C.set(A.key,A):C.set(A.index,A),A=A.sibling;return C}function s(C,A){return C=ka(C,A),C.index=0,C.sibling=null,C}function r(C,A,T){return C.index=T,n?(T=C.alternate,T!==null?(T=T.index,T<A?(C.flags|=2,A):T):(C.flags|=2,A)):(C.flags|=1048576,A)}function o(C){return n&&C.alternate===null&&(C.flags|=2),C}function a(C,A,T,E){return A===null||A.tag!==6?(A=Yb(T,C.mode,E),A.return=C,A):(A=s(A,T),A.return=C,A)}function c(C,A,T,E){var _=T.type;return _===$c?h(C,A,T.props.children,E,T.key):A!==null&&(A.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Yo&&pM(_)===A.type)?(E=s(A,T.props),E.ref=sh(C,A,T),E.return=C,E):(E=_g(T.type,T.key,T.props,null,C.mode,E),E.ref=sh(C,A,T),E.return=C,E)}function d(C,A,T,E){return A===null||A.tag!==4||A.stateNode.containerInfo!==T.containerInfo||A.stateNode.implementation!==T.implementation?(A=Zb(T,C.mode,E),A.return=C,A):(A=s(A,T.children||[]),A.return=C,A)}function h(C,A,T,E,_){return A===null||A.tag!==7?(A=Ol(T,C.mode,E,_),A.return=C,A):(A=s(A,T),A.return=C,A)}function f(C,A,T){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Yb(""+A,C.mode,T),A.return=C,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case mm:return T=_g(A.type,A.key,A.props,null,C.mode,T),T.ref=sh(C,null,A),T.return=C,T;case Qc:return A=Zb(A,C.mode,T),A.return=C,A;case Yo:var E=A._init;return f(C,E(A._payload),T)}if(Eh(A)||Zd(A))return A=Ol(A,C.mode,T,null),A.return=C,A;Am(C,A)}return null}function m(C,A,T,E){var _=A!==null?A.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return _!==null?null:a(C,A,""+T,E);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case mm:return T.key===_?c(C,A,T,E):null;case Qc:return T.key===_?d(C,A,T,E):null;case Yo:return _=T._init,m(C,A,_(T._payload),E)}if(Eh(T)||Zd(T))return _!==null?null:h(C,A,T,E,null);Am(C,T)}return null}function y(C,A,T,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return C=C.get(T)||null,a(A,C,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case mm:return C=C.get(E.key===null?T:E.key)||null,c(A,C,E,_);case Qc:return C=C.get(E.key===null?T:E.key)||null,d(A,C,E,_);case Yo:var R=E._init;return y(C,A,T,R(E._payload),_)}if(Eh(E)||Zd(E))return C=C.get(T)||null,h(A,C,E,_,null);Am(A,E)}return null}function v(C,A,T,E){for(var _=null,R=null,B=A,I=A=0,L=null;B!==null&&I<T.length;I++){B.index>I?(L=B,B=null):L=B.sibling;var O=m(C,B,T[I],E);if(O===null){B===null&&(B=L);break}n&&B&&O.alternate===null&&e(C,B),A=r(O,A,I),R===null?_=O:R.sibling=O,R=O,B=L}if(I===T.length)return t(C,B),mt&&hl(C,I),_;if(B===null){for(;I<T.length;I++)B=f(C,T[I],E),B!==null&&(A=r(B,A,I),R===null?_=B:R.sibling=B,R=B);return mt&&hl(C,I),_}for(B=i(C,B);I<T.length;I++)L=y(B,C,I,T[I],E),L!==null&&(n&&L.alternate!==null&&B.delete(L.key===null?I:L.key),A=r(L,A,I),R===null?_=L:R.sibling=L,R=L);return n&&B.forEach(function(W){return e(C,W)}),mt&&hl(C,I),_}function x(C,A,T,E){var _=Zd(T);if(typeof _!="function")throw Error(ne(150));if(T=_.call(T),T==null)throw Error(ne(151));for(var R=_=null,B=A,I=A=0,L=null,O=T.next();B!==null&&!O.done;I++,O=T.next()){B.index>I?(L=B,B=null):L=B.sibling;var W=m(C,B,O.value,E);if(W===null){B===null&&(B=L);break}n&&B&&W.alternate===null&&e(C,B),A=r(W,A,I),R===null?_=W:R.sibling=W,R=W,B=L}if(O.done)return t(C,B),mt&&hl(C,I),_;if(B===null){for(;!O.done;I++,O=T.next())O=f(C,O.value,E),O!==null&&(A=r(O,A,I),R===null?_=O:R.sibling=O,R=O);return mt&&hl(C,I),_}for(B=i(C,B);!O.done;I++,O=T.next())O=y(B,C,I,O.value,E),O!==null&&(n&&O.alternate!==null&&B.delete(O.key===null?I:O.key),A=r(O,A,I),R===null?_=O:R.sibling=O,R=O);return n&&B.forEach(function(ie){return e(C,ie)}),mt&&hl(C,I),_}function k(C,A,T,E){if(typeof T=="object"&&T!==null&&T.type===$c&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case mm:e:{for(var _=T.key,R=A;R!==null;){if(R.key===_){if(_=T.type,_===$c){if(R.tag===7){t(C,R.sibling),A=s(R,T.props.children),A.return=C,C=A;break e}}else if(R.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Yo&&pM(_)===R.type){t(C,R.sibling),A=s(R,T.props),A.ref=sh(C,R,T),A.return=C,C=A;break e}t(C,R);break}else e(C,R);R=R.sibling}T.type===$c?(A=Ol(T.props.children,C.mode,E,T.key),A.return=C,C=A):(E=_g(T.type,T.key,T.props,null,C.mode,E),E.ref=sh(C,A,T),E.return=C,C=E)}return o(C);case Qc:e:{for(R=T.key;A!==null;){if(A.key===R)if(A.tag===4&&A.stateNode.containerInfo===T.containerInfo&&A.stateNode.implementation===T.implementation){t(C,A.sibling),A=s(A,T.children||[]),A.return=C,C=A;break e}else{t(C,A);break}else e(C,A);A=A.sibling}A=Zb(T,C.mode,E),A.return=C,C=A}return o(C);case Yo:return R=T._init,k(C,A,R(T._payload),E)}if(Eh(T))return v(C,A,T,E);if(Zd(T))return x(C,A,T,E);Am(C,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,A!==null&&A.tag===6?(t(C,A.sibling),A=s(A,T),A.return=C,C=A):(t(C,A),A=Yb(T,C.mode,E),A.return=C,C=A),o(C)):t(C,A)}return k}var Qu=zN(!0),VN=zN(!1),fy=Na(null),py=null,su=null,bw=null;function xw(){bw=su=py=null}function Sw(n){var e=fy.current;pt(fy),n._currentValue=e}function nC(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function xu(n,e){py=n,bw=su=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(li=!0),n.firstContext=null)}function es(n){var e=n._currentValue;if(bw!==n)if(n={context:n,memoizedValue:e,next:null},su===null){if(py===null)throw Error(ne(308));su=n,py.dependencies={lanes:0,firstContext:n}}else su=su.next=n;return e}var vl=null;function Cw(n){vl===null?vl=[n]:vl.push(n)}function HN(n,e,t,i){var s=e.interleaved;return s===null?(t.next=t,Cw(e)):(t.next=s.next,s.next=t),e.interleaved=t,oo(n,i)}function oo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Zo=!1;function kw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GN(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Yr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function xa(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,We&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,oo(n,t)}return s=i.interleaved,s===null?(e.next=e,Cw(i)):(e.next=s.next,s.next=e),i.interleaved=e,oo(n,t)}function Cg(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,lw(n,t)}}function mM(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?s=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function my(n,e,t,i){var s=n.updateQueue;Zo=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?r=d:o.next=d,o=c;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(r!==null){var f=s.baseState;o=0,h=d=c=null,a=r;do{var m=a.lane,y=a.eventTime;if((i&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=n,x=a;switch(m=e,y=t,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(y,f,m);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,m=typeof v=="function"?v.call(y,f,m):v,m==null)break e;f=Tt({},f,m);break e;case 2:Zo=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else y={eventTime:y,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=y,c=f):h=h.next=y,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else r===null&&(s.shared.lanes=0);Wl|=o,n.lanes=o,n.memoizedState=f}}function gM(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],s=i.callback;if(s!==null){if(i.callback=null,i=t,typeof s!="function")throw Error(ne(191,s));s.call(i)}}}var Yf={},ir=Na(Yf),vf=Na(Yf),bf=Na(Yf);function bl(n){if(n===Yf)throw Error(ne(174));return n}function ww(n,e){switch(ct(bf,e),ct(vf,n),ct(ir,Yf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:FS(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=FS(e,n)}pt(ir),ct(ir,e)}function $u(){pt(ir),pt(vf),pt(bf)}function WN(n){bl(bf.current);var e=bl(ir.current),t=FS(e,n.type);e!==t&&(ct(vf,n),ct(ir,t))}function Tw(n){vf.current===n&&(pt(ir),pt(vf))}var St=Na(0);function gy(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jb=[];function Aw(){for(var n=0;n<Jb.length;n++)Jb[n]._workInProgressVersionPrimary=null;Jb.length=0}var kg=ho.ReactCurrentDispatcher,Kb=ho.ReactCurrentBatchConfig,Gl=0,kt=null,tn=null,pn=null,yy=!1,zh=!1,xf=0,xz=0;function Rn(){throw Error(ne(321))}function Ew(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ns(n[t],e[t]))return!1;return!0}function _w(n,e,t,i,s,r){if(Gl=r,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kg.current=n===null||n.memoizedState===null?wz:Tz,n=t(i,s),zh){r=0;do{if(zh=!1,xf=0,25<=r)throw Error(ne(301));r+=1,pn=tn=null,e.updateQueue=null,kg.current=Az,n=t(i,s)}while(zh)}if(kg.current=vy,e=tn!==null&&tn.next!==null,Gl=0,pn=tn=kt=null,yy=!1,e)throw Error(ne(300));return n}function Mw(){var n=xf!==0;return xf=0,n}function $s(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?kt.memoizedState=pn=n:pn=pn.next=n,pn}function ts(){if(tn===null){var n=kt.alternate;n=n!==null?n.memoizedState:null}else n=tn.next;var e=pn===null?kt.memoizedState:pn.next;if(e!==null)pn=e,tn=n;else{if(n===null)throw Error(ne(310));tn=n,n={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},pn===null?kt.memoizedState=pn=n:pn=pn.next=n}return pn}function Sf(n,e){return typeof e=="function"?e(n):e}function qb(n){var e=ts(),t=e.queue;if(t===null)throw Error(ne(311));t.lastRenderedReducer=n;var i=tn,s=i.baseQueue,r=t.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}i.baseQueue=s=r,t.pending=null}if(s!==null){r=s.next,i=i.baseState;var a=o=null,c=null,d=r;do{var h=d.lane;if((Gl&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:n(i,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=f,o=i):c=c.next=f,kt.lanes|=h,Wl|=h}d=d.next}while(d!==null&&d!==r);c===null?o=i:c.next=a,Ns(i,e.memoizedState)||(li=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,t.lastRenderedState=i}if(n=t.interleaved,n!==null){s=n;do r=s.lane,kt.lanes|=r,Wl|=r,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Qb(n){var e=ts(),t=e.queue;if(t===null)throw Error(ne(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do r=n(r,o.action),o=o.next;while(o!==s);Ns(r,e.memoizedState)||(li=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function JN(){}function KN(n,e){var t=kt,i=ts(),s=e(),r=!Ns(i.memoizedState,s);if(r&&(i.memoizedState=s,li=!0),i=i.queue,Rw($N.bind(null,t,i,n),[n]),i.getSnapshot!==e||r||pn!==null&&pn.memoizedState.tag&1){if(t.flags|=2048,Cf(9,QN.bind(null,t,i,s,e),void 0,null),yn===null)throw Error(ne(349));Gl&30||qN(t,e,s)}return s}function qN(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function QN(n,e,t,i){e.value=t,e.getSnapshot=i,XN(e)&&YN(n)}function $N(n,e,t){return t(function(){XN(e)&&YN(n)})}function XN(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ns(n,t)}catch{return!0}}function YN(n){var e=oo(n,1);e!==null&&Is(e,n,1,-1)}function yM(n){var e=$s();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sf,lastRenderedState:n},e.queue=n,n=n.dispatch=kz.bind(null,kt,n),[e.memoizedState,n]}function Cf(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function ZN(){return ts().memoizedState}function wg(n,e,t,i){var s=$s();kt.flags|=n,s.memoizedState=Cf(1|e,t,void 0,i===void 0?null:i)}function ov(n,e,t,i){var s=ts();i=i===void 0?null:i;var r=void 0;if(tn!==null){var o=tn.memoizedState;if(r=o.destroy,i!==null&&Ew(i,o.deps)){s.memoizedState=Cf(e,t,r,i);return}}kt.flags|=n,s.memoizedState=Cf(1|e,t,r,i)}function vM(n,e){return wg(8390656,8,n,e)}function Rw(n,e){return ov(2048,8,n,e)}function eF(n,e){return ov(4,2,n,e)}function tF(n,e){return ov(4,4,n,e)}function nF(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function iF(n,e,t){return t=t!=null?t.concat([n]):null,ov(4,4,nF.bind(null,e,n),t)}function Pw(){}function sF(n,e){var t=ts();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Ew(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function rF(n,e){var t=ts();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Ew(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function oF(n,e,t){return Gl&21?(Ns(t,e)||(t=dN(),kt.lanes|=t,Wl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,li=!0),n.memoizedState=t)}function Sz(n,e){var t=nt;nt=t!==0&&4>t?t:4,n(!0);var i=Kb.transition;Kb.transition={};try{n(!1),e()}finally{nt=t,Kb.transition=i}}function aF(){return ts().memoizedState}function Cz(n,e,t){var i=Ca(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},lF(n))cF(e,t);else if(t=HN(n,e,t,i),t!==null){var s=Qn();Is(t,n,i,s),uF(t,e,i)}}function kz(n,e,t){var i=Ca(n),s={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(lF(n))cF(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(s.hasEagerState=!0,s.eagerState=a,Ns(a,o)){var c=e.interleaved;c===null?(s.next=s,Cw(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}t=HN(n,e,s,i),t!==null&&(s=Qn(),Is(t,n,i,s),uF(t,e,i))}}function lF(n){var e=n.alternate;return n===kt||e!==null&&e===kt}function cF(n,e){zh=yy=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function uF(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,lw(n,t)}}var vy={readContext:es,useCallback:Rn,useContext:Rn,useEffect:Rn,useImperativeHandle:Rn,useInsertionEffect:Rn,useLayoutEffect:Rn,useMemo:Rn,useReducer:Rn,useRef:Rn,useState:Rn,useDebugValue:Rn,useDeferredValue:Rn,useTransition:Rn,useMutableSource:Rn,useSyncExternalStore:Rn,useId:Rn,unstable_isNewReconciler:!1},wz={readContext:es,useCallback:function(n,e){return $s().memoizedState=[n,e===void 0?null:e],n},useContext:es,useEffect:vM,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,wg(4194308,4,nF.bind(null,e,n),t)},useLayoutEffect:function(n,e){return wg(4194308,4,n,e)},useInsertionEffect:function(n,e){return wg(4,2,n,e)},useMemo:function(n,e){var t=$s();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=$s();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=Cz.bind(null,kt,n),[i.memoizedState,n]},useRef:function(n){var e=$s();return n={current:n},e.memoizedState=n},useState:yM,useDebugValue:Pw,useDeferredValue:function(n){return $s().memoizedState=n},useTransition:function(){var n=yM(!1),e=n[0];return n=Sz.bind(null,n[1]),$s().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=kt,s=$s();if(mt){if(t===void 0)throw Error(ne(407));t=t()}else{if(t=e(),yn===null)throw Error(ne(349));Gl&30||qN(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,vM($N.bind(null,i,r,n),[n]),i.flags|=2048,Cf(9,QN.bind(null,i,r,t,e),void 0,null),t},useId:function(){var n=$s(),e=yn.identifierPrefix;if(mt){var t=Qr,i=qr;t=(i&~(1<<32-Ps(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=xf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=xz++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Tz={readContext:es,useCallback:sF,useContext:es,useEffect:Rw,useImperativeHandle:iF,useInsertionEffect:eF,useLayoutEffect:tF,useMemo:rF,useReducer:qb,useRef:ZN,useState:function(){return qb(Sf)},useDebugValue:Pw,useDeferredValue:function(n){var e=ts();return oF(e,tn.memoizedState,n)},useTransition:function(){var n=qb(Sf)[0],e=ts().memoizedState;return[n,e]},useMutableSource:JN,useSyncExternalStore:KN,useId:aF,unstable_isNewReconciler:!1},Az={readContext:es,useCallback:sF,useContext:es,useEffect:Rw,useImperativeHandle:iF,useInsertionEffect:eF,useLayoutEffect:tF,useMemo:rF,useReducer:Qb,useRef:ZN,useState:function(){return Qb(Sf)},useDebugValue:Pw,useDeferredValue:function(n){var e=ts();return tn===null?e.memoizedState=n:oF(e,tn.memoizedState,n)},useTransition:function(){var n=Qb(Sf)[0],e=ts().memoizedState;return[n,e]},useMutableSource:JN,useSyncExternalStore:KN,useId:aF,unstable_isNewReconciler:!1};function ys(n,e){if(n&&n.defaultProps){e=Tt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function iC(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Tt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var av={isMounted:function(n){return(n=n._reactInternals)?ec(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Qn(),s=Ca(n),r=Yr(i,s);r.payload=e,t!=null&&(r.callback=t),e=xa(n,r,s),e!==null&&(Is(e,n,s,i),Cg(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Qn(),s=Ca(n),r=Yr(i,s);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=xa(n,r,s),e!==null&&(Is(e,n,s,i),Cg(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Qn(),i=Ca(n),s=Yr(t,i);s.tag=2,e!=null&&(s.callback=e),e=xa(n,s,i),e!==null&&(Is(e,n,i,t),Cg(e,n,i))}};function bM(n,e,t,i,s,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,o):e.prototype&&e.prototype.isPureReactComponent?!pf(t,i)||!pf(s,r):!0}function dF(n,e,t){var i=!1,s=Ma,r=e.contextType;return typeof r=="object"&&r!==null?r=es(r):(s=hi(e)?Vl:On.current,i=e.contextTypes,r=(i=i!=null)?Ku(n,s):Ma),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=av,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=r),e}function xM(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&av.enqueueReplaceState(e,e.state,null)}function sC(n,e,t,i){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},kw(n);var r=e.contextType;typeof r=="object"&&r!==null?s.context=es(r):(r=hi(e)?Vl:On.current,s.context=Ku(n,r)),s.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(iC(n,e,r,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&av.enqueueReplaceState(s,s.state,null),my(n,t,s,i),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Xu(n,e){try{var t="",i=e;do t+=e5(i),i=i.return;while(i);var s=t}catch(r){s=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:s,digest:null}}function $b(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function rC(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Ez=typeof WeakMap=="function"?WeakMap:Map;function hF(n,e,t){t=Yr(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){xy||(xy=!0,mC=i),rC(n,e)},t}function fF(n,e,t){t=Yr(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;t.payload=function(){return i(s)},t.callback=function(){rC(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){rC(n,e),typeof i!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function SM(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new Ez;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(s.add(t),n=zz.bind(null,n,e,t),e.then(n,n))}function CM(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function kM(n,e,t,i,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Yr(-1,1),e.tag=2,xa(t,e,1))),t.lanes|=1),n)}var _z=ho.ReactCurrentOwner,li=!1;function Hn(n,e,t,i){e.child=n===null?VN(e,null,t,i):Qu(e,n.child,t,i)}function wM(n,e,t,i,s){t=t.render;var r=e.ref;return xu(e,s),i=_w(n,e,t,i,r,s),t=Mw(),n!==null&&!li?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ao(n,e,s)):(mt&&t&&gw(e),e.flags|=1,Hn(n,e,i,s),e.child)}function TM(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!jw(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,pF(n,e,r,i,s)):(n=_g(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&s)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:pf,t(o,i)&&n.ref===e.ref)return ao(n,e,s)}return e.flags|=1,n=ka(r,i),n.ref=e.ref,n.return=e,e.child=n}function pF(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(pf(r,i)&&n.ref===e.ref)if(li=!1,e.pendingProps=i=r,(n.lanes&s)!==0)n.flags&131072&&(li=!0);else return e.lanes=n.lanes,ao(n,e,s)}return oC(n,e,t,i,s)}function mF(n,e,t){var i=e.pendingProps,s=i.children,r=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(ou,Mi),Mi|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ct(ou,Mi),Mi|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:t,ct(ou,Mi),Mi|=i}else r!==null?(i=r.baseLanes|t,e.memoizedState=null):i=t,ct(ou,Mi),Mi|=i;return Hn(n,e,s,t),e.child}function gF(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function oC(n,e,t,i,s){var r=hi(t)?Vl:On.current;return r=Ku(e,r),xu(e,s),t=_w(n,e,t,i,r,s),i=Mw(),n!==null&&!li?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ao(n,e,s)):(mt&&i&&gw(e),e.flags|=1,Hn(n,e,t,s),e.child)}function AM(n,e,t,i,s){if(hi(t)){var r=!0;uy(e)}else r=!1;if(xu(e,s),e.stateNode===null)Tg(n,e),dF(e,t,i),sC(e,t,i,s),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=es(d):(d=hi(t)?Vl:On.current,d=Ku(e,d));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==d)&&xM(e,o,i,d),Zo=!1;var m=e.memoizedState;o.state=m,my(e,i,o,s),c=e.memoizedState,a!==i||m!==c||di.current||Zo?(typeof h=="function"&&(iC(e,t,h,i),c=e.memoizedState),(a=Zo||bM(e,t,a,i,m,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=d,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,GN(n,e),a=e.memoizedProps,d=e.type===e.elementType?a:ys(e.type,a),o.props=d,f=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=es(c):(c=hi(t)?Vl:On.current,c=Ku(e,c));var y=t.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||m!==c)&&xM(e,o,i,c),Zo=!1,m=e.memoizedState,o.state=m,my(e,i,o,s);var v=e.memoizedState;a!==f||m!==v||di.current||Zo?(typeof y=="function"&&(iC(e,t,y,i),v=e.memoizedState),(d=Zo||bM(e,t,d,i,m,v,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=v),o.props=i,o.state=v,o.context=c,i=d):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),i=!1)}return aC(n,e,t,i,r,s)}function aC(n,e,t,i,s,r){gF(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&dM(e,t,!1),ao(n,e,r);i=e.stateNode,_z.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Qu(e,n.child,null,r),e.child=Qu(e,null,a,r)):Hn(n,e,a,r),e.memoizedState=i.state,s&&dM(e,t,!0),e.child}function yF(n){var e=n.stateNode;e.pendingContext?uM(n,e.pendingContext,e.pendingContext!==e.context):e.context&&uM(n,e.context,!1),ww(n,e.containerInfo)}function EM(n,e,t,i,s){return qu(),vw(s),e.flags|=256,Hn(n,e,t,i),e.child}var lC={dehydrated:null,treeContext:null,retryLane:0};function cC(n){return{baseLanes:n,cachePool:null,transitions:null}}function vF(n,e,t){var i=e.pendingProps,s=St.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),ct(St,s&1),n===null)return tC(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,r?(i=e.mode,r=e.child,o={mode:"hidden",children:o},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=uv(o,i,0,null),n=Ol(n,i,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=cC(t),e.memoizedState=lC,n):Iw(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Mz(n,e,o,i,a,s,t);if(r){r=i.fallback,o=e.mode,s=n.child,a=s.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=ka(s,c),i.subtreeFlags=s.subtreeFlags&14680064),a!==null?r=ka(a,r):(r=Ol(r,o,t,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=n.child.memoizedState,o=o===null?cC(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=lC,i}return r=n.child,n=r.sibling,i=ka(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Iw(n,e){return e=uv({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Em(n,e,t,i){return i!==null&&vw(i),Qu(e,n.child,null,t),n=Iw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Mz(n,e,t,i,s,r,o){if(t)return e.flags&256?(e.flags&=-257,i=$b(Error(ne(422))),Em(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=i.fallback,s=e.mode,i=uv({mode:"visible",children:i.children},s,0,null),r=Ol(r,s,o,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&Qu(e,n.child,null,o),e.child.memoizedState=cC(o),e.memoizedState=lC,r);if(!(e.mode&1))return Em(n,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var a=i.dgst;return i=a,r=Error(ne(419)),i=$b(r,i,void 0),Em(n,e,o,i)}if(a=(o&n.childLanes)!==0,li||a){if(i=yn,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==r.retryLane&&(r.retryLane=s,oo(n,s),Is(i,n,s,-1))}return Lw(),i=$b(Error(ne(421))),Em(n,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=Vz.bind(null,n),s._reactRetry=e,null):(n=r.treeContext,Ri=ba(s.nextSibling),Ii=e,mt=!0,ks=null,n!==null&&(qi[Qi++]=qr,qi[Qi++]=Qr,qi[Qi++]=Hl,qr=n.id,Qr=n.overflow,Hl=e),e=Iw(e,i.children),e.flags|=4096,e)}function _M(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),nC(n.return,e,t)}function Xb(n,e,t,i,s){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=t,r.tailMode=s)}function bF(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if(Hn(n,e,i.children,t),i=St.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_M(n,t,e);else if(n.tag===19)_M(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(ct(St,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&gy(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Xb(e,!1,s,t,r);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&gy(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Xb(e,!0,t,null,r);break;case"together":Xb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ao(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Wl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ne(153));if(e.child!==null){for(n=e.child,t=ka(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ka(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Rz(n,e,t){switch(e.tag){case 3:yF(e),qu();break;case 5:WN(e);break;case 1:hi(e.type)&&uy(e);break;case 4:ww(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;ct(fy,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ct(St,St.current&1),e.flags|=128,null):t&e.child.childLanes?vF(n,e,t):(ct(St,St.current&1),n=ao(n,e,t),n!==null?n.sibling:null);ct(St,St.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return bF(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ct(St,St.current),i)break;return null;case 22:case 23:return e.lanes=0,mF(n,e,t)}return ao(n,e,t)}var xF,uC,SF,CF;xF=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};uC=function(){};SF=function(n,e,t,i){var s=n.memoizedProps;if(s!==i){n=e.stateNode,bl(ir.current);var r=null;switch(t){case"input":s=IS(n,s),i=IS(n,i),r=[];break;case"select":s=Tt({},s,{value:void 0}),i=Tt({},i,{value:void 0}),r=[];break;case"textarea":s=NS(n,s),i=NS(n,i),r=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=ly)}OS(t,i);var o;t=null;for(d in s)if(!i.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(af.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in i){var c=i[d];if(a=s!=null?s[d]:void 0,i.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(r||(r=[]),r.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(r=r||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(af.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ft("scroll",n),r||a===c||(r=[])):(r=r||[]).push(d,c))}t&&(r=r||[]).push("style",t);var d=r;(e.updateQueue=d)&&(e.flags|=4)}};CF=function(n,e,t,i){t!==i&&(e.flags|=4)};function rh(n,e){if(!mt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Pn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function Pz(n,e,t){var i=e.pendingProps;switch(yw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(e),null;case 1:return hi(e.type)&&cy(),Pn(e),null;case 3:return i=e.stateNode,$u(),pt(di),pt(On),Aw(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Tm(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ks!==null&&(vC(ks),ks=null))),uC(n,e),Pn(e),null;case 5:Tw(e);var s=bl(bf.current);if(t=e.type,n!==null&&e.stateNode!=null)SF(n,e,t,i,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ne(166));return Pn(e),null}if(n=bl(ir.current),Tm(e)){i=e.stateNode,t=e.type;var r=e.memoizedProps;switch(i[tr]=e,i[yf]=r,n=(e.mode&1)!==0,t){case"dialog":ft("cancel",i),ft("close",i);break;case"iframe":case"object":case"embed":ft("load",i);break;case"video":case"audio":for(s=0;s<Mh.length;s++)ft(Mh[s],i);break;case"source":ft("error",i);break;case"img":case"image":case"link":ft("error",i),ft("load",i);break;case"details":ft("toggle",i);break;case"input":O_(i,r),ft("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},ft("invalid",i);break;case"textarea":j_(i,r),ft("invalid",i)}OS(t,r),s=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?i.textContent!==a&&(r.suppressHydrationWarning!==!0&&wm(i.textContent,a,n),s=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&wm(i.textContent,a,n),s=["children",""+a]):af.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ft("scroll",i)}switch(t){case"input":gm(i),L_(i,r,!0);break;case"textarea":gm(i),U_(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=ly)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=$D(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[tr]=e,n[yf]=i,xF(n,e,!1,!1),e.stateNode=n;e:{switch(o=LS(t,i),t){case"dialog":ft("cancel",n),ft("close",n),s=i;break;case"iframe":case"object":case"embed":ft("load",n),s=i;break;case"video":case"audio":for(s=0;s<Mh.length;s++)ft(Mh[s],n);s=i;break;case"source":ft("error",n),s=i;break;case"img":case"image":case"link":ft("error",n),ft("load",n),s=i;break;case"details":ft("toggle",n),s=i;break;case"input":O_(n,i),s=IS(n,i),ft("invalid",n);break;case"option":s=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},s=Tt({},i,{value:void 0}),ft("invalid",n);break;case"textarea":j_(n,i),s=NS(n,i),ft("invalid",n);break;default:s=i}OS(t,s),a=s;for(r in a)if(a.hasOwnProperty(r)){var c=a[r];r==="style"?ZD(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&XD(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&lf(n,c):typeof c=="number"&&lf(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(af.hasOwnProperty(r)?c!=null&&r==="onScroll"&&ft("scroll",n):c!=null&&nw(n,r,c,o))}switch(t){case"input":gm(n),L_(n,i,!1);break;case"textarea":gm(n),U_(n);break;case"option":i.value!=null&&n.setAttribute("value",""+_a(i.value));break;case"select":n.multiple=!!i.multiple,r=i.value,r!=null?gu(n,!!i.multiple,r,!1):i.defaultValue!=null&&gu(n,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=ly)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pn(e),null;case 6:if(n&&e.stateNode!=null)CF(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ne(166));if(t=bl(bf.current),bl(ir.current),Tm(e)){if(i=e.stateNode,t=e.memoizedProps,i[tr]=e,(r=i.nodeValue!==t)&&(n=Ii,n!==null))switch(n.tag){case 3:wm(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&wm(i.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[tr]=e,e.stateNode=i}return Pn(e),null;case 13:if(pt(St),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(mt&&Ri!==null&&e.mode&1&&!(e.flags&128))UN(),qu(),e.flags|=98560,r=!1;else if(r=Tm(e),i!==null&&i.dehydrated!==null){if(n===null){if(!r)throw Error(ne(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(ne(317));r[tr]=e}else qu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pn(e),r=!1}else ks!==null&&(vC(ks),ks=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||St.current&1?rn===0&&(rn=3):Lw())),e.updateQueue!==null&&(e.flags|=4),Pn(e),null);case 4:return $u(),uC(n,e),n===null&&mf(e.stateNode.containerInfo),Pn(e),null;case 10:return Sw(e.type._context),Pn(e),null;case 17:return hi(e.type)&&cy(),Pn(e),null;case 19:if(pt(St),r=e.memoizedState,r===null)return Pn(e),null;if(i=(e.flags&128)!==0,o=r.rendering,o===null)if(i)rh(r,!1);else{if(rn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=gy(n),o!==null){for(e.flags|=128,rh(r,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)r=t,n=i,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ct(St,St.current&1|2),e.child}n=n.sibling}r.tail!==null&&Lt()>Yu&&(e.flags|=128,i=!0,rh(r,!1),e.lanes=4194304)}else{if(!i)if(n=gy(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),rh(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!mt)return Pn(e),null}else 2*Lt()-r.renderingStartTime>Yu&&t!==1073741824&&(e.flags|=128,i=!0,rh(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Lt(),e.sibling=null,t=St.current,ct(St,i?t&1|2:t&1),e):(Pn(e),null);case 22:case 23:return Ow(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Mi&1073741824&&(Pn(e),e.subtreeFlags&6&&(e.flags|=8192)):Pn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function Iz(n,e){switch(yw(e),e.tag){case 1:return hi(e.type)&&cy(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return $u(),pt(di),pt(On),Aw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Tw(e),null;case 13:if(pt(St),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));qu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return pt(St),null;case 4:return $u(),null;case 10:return Sw(e.type._context),null;case 22:case 23:return Ow(),null;case 24:return null;default:return null}}var _m=!1,Dn=!1,Bz=typeof WeakSet=="function"?WeakSet:Set,ge=null;function ru(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Pt(n,e,i)}else t.current=null}function dC(n,e,t){try{t()}catch(i){Pt(n,e,i)}}var MM=!1;function Dz(n,e){if(qS=ry,n=EN(),mw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,d=0,h=0,f=n,m=null;t:for(;;){for(var y;f!==t||s!==0&&f.nodeType!==3||(a=o+s),f!==r||i!==0&&f.nodeType!==3||(c=o+i),f.nodeType===3&&(o+=f.nodeValue.length),(y=f.firstChild)!==null;)m=f,f=y;for(;;){if(f===n)break t;if(m===t&&++d===s&&(a=o),m===r&&++h===i&&(c=o),(y=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=y}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(QS={focusedElem:n,selectionRange:t},ry=!1,ge=e;ge!==null;)if(e=ge,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ge=n;else for(;ge!==null;){e=ge;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,k=v.memoizedState,C=e.stateNode,A=C.getSnapshotBeforeUpdate(e.elementType===e.type?x:ys(e.type,x),k);C.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(E){Pt(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}return v=MM,MM=!1,v}function Vh(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&n)===n){var r=s.destroy;s.destroy=void 0,r!==void 0&&dC(e,t,r)}s=s.next}while(s!==i)}}function lv(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function hC(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function kF(n){var e=n.alternate;e!==null&&(n.alternate=null,kF(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[tr],delete e[yf],delete e[YS],delete e[gz],delete e[yz])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function wF(n){return n.tag===5||n.tag===3||n.tag===4}function RM(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||wF(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function fC(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ly));else if(i!==4&&(n=n.child,n!==null))for(fC(n,e,t),n=n.sibling;n!==null;)fC(n,e,t),n=n.sibling}function pC(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(pC(n,e,t),n=n.sibling;n!==null;)pC(n,e,t),n=n.sibling}var Cn=null,xs=!1;function Fo(n,e,t){for(t=t.child;t!==null;)TF(n,e,t),t=t.sibling}function TF(n,e,t){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(ev,t)}catch{}switch(t.tag){case 5:Dn||ru(t,e);case 6:var i=Cn,s=xs;Cn=null,Fo(n,e,t),Cn=i,xs=s,Cn!==null&&(xs?(n=Cn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Cn.removeChild(t.stateNode));break;case 18:Cn!==null&&(xs?(n=Cn,t=t.stateNode,n.nodeType===8?Gb(n.parentNode,t):n.nodeType===1&&Gb(n,t),hf(n)):Gb(Cn,t.stateNode));break;case 4:i=Cn,s=xs,Cn=t.stateNode.containerInfo,xs=!0,Fo(n,e,t),Cn=i,xs=s;break;case 0:case 11:case 14:case 15:if(!Dn&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var r=s,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&dC(t,e,o),s=s.next}while(s!==i)}Fo(n,e,t);break;case 1:if(!Dn&&(ru(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Pt(t,e,a)}Fo(n,e,t);break;case 21:Fo(n,e,t);break;case 22:t.mode&1?(Dn=(i=Dn)||t.memoizedState!==null,Fo(n,e,t),Dn=i):Fo(n,e,t);break;default:Fo(n,e,t)}}function PM(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Bz),e.forEach(function(i){var s=Hz.bind(null,n,i);t.has(i)||(t.add(i),i.then(s,s))})}}function cs(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Cn=a.stateNode,xs=!1;break e;case 3:Cn=a.stateNode.containerInfo,xs=!0;break e;case 4:Cn=a.stateNode.containerInfo,xs=!0;break e}a=a.return}if(Cn===null)throw Error(ne(160));TF(r,o,s),Cn=null,xs=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Pt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AF(e,n),e=e.sibling}function AF(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(cs(e,n),Ks(n),i&4){try{Vh(3,n,n.return),lv(3,n)}catch(x){Pt(n,n.return,x)}try{Vh(5,n,n.return)}catch(x){Pt(n,n.return,x)}}break;case 1:cs(e,n),Ks(n),i&512&&t!==null&&ru(t,t.return);break;case 5:if(cs(e,n),Ks(n),i&512&&t!==null&&ru(t,t.return),n.flags&32){var s=n.stateNode;try{lf(s,"")}catch(x){Pt(n,n.return,x)}}if(i&4&&(s=n.stateNode,s!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&qD(s,r),LS(a,o);var d=LS(a,r);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?ZD(s,f):h==="dangerouslySetInnerHTML"?XD(s,f):h==="children"?lf(s,f):nw(s,h,f,d)}switch(a){case"input":BS(s,r);break;case"textarea":QD(s,r);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var y=r.value;y!=null?gu(s,!!r.multiple,y,!1):m!==!!r.multiple&&(r.defaultValue!=null?gu(s,!!r.multiple,r.defaultValue,!0):gu(s,!!r.multiple,r.multiple?[]:"",!1))}s[yf]=r}catch(x){Pt(n,n.return,x)}}break;case 6:if(cs(e,n),Ks(n),i&4){if(n.stateNode===null)throw Error(ne(162));s=n.stateNode,r=n.memoizedProps;try{s.nodeValue=r}catch(x){Pt(n,n.return,x)}}break;case 3:if(cs(e,n),Ks(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{hf(e.containerInfo)}catch(x){Pt(n,n.return,x)}break;case 4:cs(e,n),Ks(n);break;case 13:cs(e,n),Ks(n),s=n.child,s.flags&8192&&(r=s.memoizedState!==null,s.stateNode.isHidden=r,!r||s.alternate!==null&&s.alternate.memoizedState!==null||(Nw=Lt())),i&4&&PM(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Dn=(d=Dn)||h,cs(e,n),Dn=d):cs(e,n),Ks(n),i&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!h&&n.mode&1)for(ge=n,h=n.child;h!==null;){for(f=ge=h;ge!==null;){switch(m=ge,y=m.child,m.tag){case 0:case 11:case 14:case 15:Vh(4,m,m.return);break;case 1:ru(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){i=m,t=m.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){Pt(i,t,x)}}break;case 5:ru(m,m.return);break;case 22:if(m.memoizedState!==null){BM(f);continue}}y!==null?(y.return=m,ge=y):BM(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=YD("display",o))}catch(x){Pt(n,n.return,x)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){Pt(n,n.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:cs(e,n),Ks(n),i&4&&PM(n);break;case 21:break;default:cs(e,n),Ks(n)}}function Ks(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(wF(t)){var i=t;break e}t=t.return}throw Error(ne(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(lf(s,""),i.flags&=-33);var r=RM(n);pC(n,r,s);break;case 3:case 4:var o=i.stateNode.containerInfo,a=RM(n);fC(n,a,o);break;default:throw Error(ne(161))}}catch(c){Pt(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Nz(n,e,t){ge=n,EF(n)}function EF(n,e,t){for(var i=(n.mode&1)!==0;ge!==null;){var s=ge,r=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||_m;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Dn;a=_m;var d=Dn;if(_m=o,(Dn=c)&&!d)for(ge=s;ge!==null;)o=ge,c=o.child,o.tag===22&&o.memoizedState!==null?DM(s):c!==null?(c.return=o,ge=c):DM(s);for(;r!==null;)ge=r,EF(r),r=r.sibling;ge=s,_m=a,Dn=d}IM(n)}else s.subtreeFlags&8772&&r!==null?(r.return=s,ge=r):IM(n)}}function IM(n){for(;ge!==null;){var e=ge;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Dn||lv(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Dn)if(t===null)i.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:ys(e.type,t.memoizedProps);i.componentDidUpdate(s,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&gM(e,r,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}gM(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&hf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Dn||e.flags&512&&hC(e)}catch(m){Pt(e,e.return,m)}}if(e===n){ge=null;break}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}}function BM(n){for(;ge!==null;){var e=ge;if(e===n){ge=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ge=t;break}ge=e.return}}function DM(n){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lv(4,e)}catch(c){Pt(e,t,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(c){Pt(e,s,c)}}var r=e.return;try{hC(e)}catch(c){Pt(e,r,c)}break;case 5:var o=e.return;try{hC(e)}catch(c){Pt(e,o,c)}}}catch(c){Pt(e,e.return,c)}if(e===n){ge=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ge=a;break}ge=e.return}}var Fz=Math.ceil,by=ho.ReactCurrentDispatcher,Bw=ho.ReactCurrentOwner,Zi=ho.ReactCurrentBatchConfig,We=0,yn=null,Qt=null,Tn=0,Mi=0,ou=Na(0),rn=0,kf=null,Wl=0,cv=0,Dw=0,Hh=null,oi=null,Nw=0,Yu=1/0,Nr=null,xy=!1,mC=null,Sa=null,Mm=!1,fa=null,Sy=0,Gh=0,gC=null,Ag=-1,Eg=0;function Qn(){return We&6?Lt():Ag!==-1?Ag:Ag=Lt()}function Ca(n){return n.mode&1?We&2&&Tn!==0?Tn&-Tn:bz.transition!==null?(Eg===0&&(Eg=dN()),Eg):(n=nt,n!==0||(n=window.event,n=n===void 0?16:vN(n.type)),n):1}function Is(n,e,t,i){if(50<Gh)throw Gh=0,gC=null,Error(ne(185));Qf(n,t,i),(!(We&2)||n!==yn)&&(n===yn&&(!(We&2)&&(cv|=t),rn===4&&ta(n,Tn)),fi(n,i),t===1&&We===0&&!(e.mode&1)&&(Yu=Lt()+500,rv&&Fa()))}function fi(n,e){var t=n.callbackNode;b5(n,e);var i=sy(n,n===yn?Tn:0);if(i===0)t!==null&&H_(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&H_(t),e===1)n.tag===0?vz(NM.bind(null,n)):ON(NM.bind(null,n)),pz(function(){!(We&6)&&Fa()}),t=null;else{switch(hN(i)){case 1:t=aw;break;case 4:t=cN;break;case 16:t=iy;break;case 536870912:t=uN;break;default:t=iy}t=NF(t,_F.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function _F(n,e){if(Ag=-1,Eg=0,We&6)throw Error(ne(327));var t=n.callbackNode;if(Su()&&n.callbackNode!==t)return null;var i=sy(n,n===yn?Tn:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Cy(n,i);else{e=i;var s=We;We|=2;var r=RF();(yn!==n||Tn!==e)&&(Nr=null,Yu=Lt()+500,Fl(n,e));do try{jz();break}catch(a){MF(n,a)}while(!0);xw(),by.current=r,We=s,Qt!==null?e=0:(yn=null,Tn=0,e=rn)}if(e!==0){if(e===2&&(s=HS(n),s!==0&&(i=s,e=yC(n,s))),e===1)throw t=kf,Fl(n,0),ta(n,i),fi(n,Lt()),t;if(e===6)ta(n,i);else{if(s=n.current.alternate,!(i&30)&&!Oz(s)&&(e=Cy(n,i),e===2&&(r=HS(n),r!==0&&(i=r,e=yC(n,r))),e===1))throw t=kf,Fl(n,0),ta(n,i),fi(n,Lt()),t;switch(n.finishedWork=s,n.finishedLanes=i,e){case 0:case 1:throw Error(ne(345));case 2:fl(n,oi,Nr);break;case 3:if(ta(n,i),(i&130023424)===i&&(e=Nw+500-Lt(),10<e)){if(sy(n,0)!==0)break;if(s=n.suspendedLanes,(s&i)!==i){Qn(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=XS(fl.bind(null,n,oi,Nr),e);break}fl(n,oi,Nr);break;case 4:if(ta(n,i),(i&4194240)===i)break;for(e=n.eventTimes,s=-1;0<i;){var o=31-Ps(i);r=1<<o,o=e[o],o>s&&(s=o),i&=~r}if(i=s,i=Lt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Fz(i/1960))-i,10<i){n.timeoutHandle=XS(fl.bind(null,n,oi,Nr),i);break}fl(n,oi,Nr);break;case 5:fl(n,oi,Nr);break;default:throw Error(ne(329))}}}return fi(n,Lt()),n.callbackNode===t?_F.bind(null,n):null}function yC(n,e){var t=Hh;return n.current.memoizedState.isDehydrated&&(Fl(n,e).flags|=256),n=Cy(n,e),n!==2&&(e=oi,oi=t,e!==null&&vC(e)),n}function vC(n){oi===null?oi=n:oi.push.apply(oi,n)}function Oz(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!Ns(r(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ta(n,e){for(e&=~Dw,e&=~cv,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ps(e),i=1<<t;n[t]=-1,e&=~i}}function NM(n){if(We&6)throw Error(ne(327));Su();var e=sy(n,0);if(!(e&1))return fi(n,Lt()),null;var t=Cy(n,e);if(n.tag!==0&&t===2){var i=HS(n);i!==0&&(e=i,t=yC(n,i))}if(t===1)throw t=kf,Fl(n,0),ta(n,e),fi(n,Lt()),t;if(t===6)throw Error(ne(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,fl(n,oi,Nr),fi(n,Lt()),null}function Fw(n,e){var t=We;We|=1;try{return n(e)}finally{We=t,We===0&&(Yu=Lt()+500,rv&&Fa())}}function Jl(n){fa!==null&&fa.tag===0&&!(We&6)&&Su();var e=We;We|=1;var t=Zi.transition,i=nt;try{if(Zi.transition=null,nt=1,n)return n()}finally{nt=i,Zi.transition=t,We=e,!(We&6)&&Fa()}}function Ow(){Mi=ou.current,pt(ou)}function Fl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,fz(t)),Qt!==null)for(t=Qt.return;t!==null;){var i=t;switch(yw(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&cy();break;case 3:$u(),pt(di),pt(On),Aw();break;case 5:Tw(i);break;case 4:$u();break;case 13:pt(St);break;case 19:pt(St);break;case 10:Sw(i.type._context);break;case 22:case 23:Ow()}t=t.return}if(yn=n,Qt=n=ka(n.current,null),Tn=Mi=e,rn=0,kf=null,Dw=cv=Wl=0,oi=Hh=null,vl!==null){for(e=0;e<vl.length;e++)if(t=vl[e],i=t.interleaved,i!==null){t.interleaved=null;var s=i.next,r=t.pending;if(r!==null){var o=r.next;r.next=s,i.next=o}t.pending=i}vl=null}return n}function MF(n,e){do{var t=Qt;try{if(xw(),kg.current=vy,yy){for(var i=kt.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}yy=!1}if(Gl=0,pn=tn=kt=null,zh=!1,xf=0,Bw.current=null,t===null||t.return===null){rn=1,kf=e,Qt=null;break}e:{var r=n,o=t.return,a=t,c=e;if(e=Tn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=CM(o);if(y!==null){y.flags&=-257,kM(y,o,a,r,e),y.mode&1&&SM(r,d,e),e=y,c=d;var v=e.updateQueue;if(v===null){var x=new Set;x.add(c),e.updateQueue=x}else v.add(c);break e}else{if(!(e&1)){SM(r,d,e),Lw();break e}c=Error(ne(426))}}else if(mt&&a.mode&1){var k=CM(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),kM(k,o,a,r,e),vw(Xu(c,a));break e}}r=c=Xu(c,a),rn!==4&&(rn=2),Hh===null?Hh=[r]:Hh.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var C=hF(r,c,e);mM(r,C);break e;case 1:a=c;var A=r.type,T=r.stateNode;if(!(r.flags&128)&&(typeof A.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Sa===null||!Sa.has(T)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=fF(r,a,e);mM(r,E);break e}}r=r.return}while(r!==null)}IF(t)}catch(_){e=_,Qt===t&&t!==null&&(Qt=t=t.return);continue}break}while(!0)}function RF(){var n=by.current;return by.current=vy,n===null?vy:n}function Lw(){(rn===0||rn===3||rn===2)&&(rn=4),yn===null||!(Wl&268435455)&&!(cv&268435455)||ta(yn,Tn)}function Cy(n,e){var t=We;We|=2;var i=RF();(yn!==n||Tn!==e)&&(Nr=null,Fl(n,e));do try{Lz();break}catch(s){MF(n,s)}while(!0);if(xw(),We=t,by.current=i,Qt!==null)throw Error(ne(261));return yn=null,Tn=0,rn}function Lz(){for(;Qt!==null;)PF(Qt)}function jz(){for(;Qt!==null&&!u5();)PF(Qt)}function PF(n){var e=DF(n.alternate,n,Mi);n.memoizedProps=n.pendingProps,e===null?IF(n):Qt=e,Bw.current=null}function IF(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Iz(t,e),t!==null){t.flags&=32767,Qt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{rn=6,Qt=null;return}}else if(t=Pz(t,e,Mi),t!==null){Qt=t;return}if(e=e.sibling,e!==null){Qt=e;return}Qt=e=n}while(e!==null);rn===0&&(rn=5)}function fl(n,e,t){var i=nt,s=Zi.transition;try{Zi.transition=null,nt=1,Uz(n,e,t,i)}finally{Zi.transition=s,nt=i}return null}function Uz(n,e,t,i){do Su();while(fa!==null);if(We&6)throw Error(ne(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ne(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(x5(n,r),n===yn&&(Qt=yn=null,Tn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Mm||(Mm=!0,NF(iy,function(){return Su(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Zi.transition,Zi.transition=null;var o=nt;nt=1;var a=We;We|=4,Bw.current=null,Dz(n,t),AF(t,n),oz(QS),ry=!!qS,QS=qS=null,n.current=t,Nz(t),d5(),We=a,nt=o,Zi.transition=r}else n.current=t;if(Mm&&(Mm=!1,fa=n,Sy=s),r=n.pendingLanes,r===0&&(Sa=null),p5(t.stateNode),fi(n,Lt()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],i(s.value,{componentStack:s.stack,digest:s.digest});if(xy)throw xy=!1,n=mC,mC=null,n;return Sy&1&&n.tag!==0&&Su(),r=n.pendingLanes,r&1?n===gC?Gh++:(Gh=0,gC=n):Gh=0,Fa(),null}function Su(){if(fa!==null){var n=hN(Sy),e=Zi.transition,t=nt;try{if(Zi.transition=null,nt=16>n?16:n,fa===null)var i=!1;else{if(n=fa,fa=null,Sy=0,We&6)throw Error(ne(331));var s=We;for(We|=4,ge=n.current;ge!==null;){var r=ge,o=r.child;if(ge.flags&16){var a=r.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(ge=d;ge!==null;){var h=ge;switch(h.tag){case 0:case 11:case 15:Vh(8,h,r)}var f=h.child;if(f!==null)f.return=h,ge=f;else for(;ge!==null;){h=ge;var m=h.sibling,y=h.return;if(kF(h),h===d){ge=null;break}if(m!==null){m.return=y,ge=m;break}ge=y}}}var v=r.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var k=x.sibling;x.sibling=null,x=k}while(x!==null)}}ge=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,ge=o;else e:for(;ge!==null;){if(r=ge,r.flags&2048)switch(r.tag){case 0:case 11:case 15:Vh(9,r,r.return)}var C=r.sibling;if(C!==null){C.return=r.return,ge=C;break e}ge=r.return}}var A=n.current;for(ge=A;ge!==null;){o=ge;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ge=T;else e:for(o=A;ge!==null;){if(a=ge,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lv(9,a)}}catch(_){Pt(a,a.return,_)}if(a===o){ge=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,ge=E;break e}ge=a.return}}if(We=s,Fa(),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(ev,n)}catch{}i=!0}return i}finally{nt=t,Zi.transition=e}}return!1}function FM(n,e,t){e=Xu(t,e),e=hF(n,e,1),n=xa(n,e,1),e=Qn(),n!==null&&(Qf(n,1,e),fi(n,e))}function Pt(n,e,t){if(n.tag===3)FM(n,n,t);else for(;e!==null;){if(e.tag===3){FM(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Sa===null||!Sa.has(i))){n=Xu(t,n),n=fF(e,n,1),e=xa(e,n,1),n=Qn(),e!==null&&(Qf(e,1,n),fi(e,n));break}}e=e.return}}function zz(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Qn(),n.pingedLanes|=n.suspendedLanes&t,yn===n&&(Tn&t)===t&&(rn===4||rn===3&&(Tn&130023424)===Tn&&500>Lt()-Nw?Fl(n,0):Dw|=t),fi(n,e)}function BF(n,e){e===0&&(n.mode&1?(e=bm,bm<<=1,!(bm&130023424)&&(bm=4194304)):e=1);var t=Qn();n=oo(n,e),n!==null&&(Qf(n,e,t),fi(n,t))}function Vz(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),BF(n,t)}function Hz(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(ne(314))}i!==null&&i.delete(e),BF(n,t)}var DF;DF=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||di.current)li=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return li=!1,Rz(n,e,t);li=!!(n.flags&131072)}else li=!1,mt&&e.flags&1048576&&LN(e,hy,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Tg(n,e),n=e.pendingProps;var s=Ku(e,On.current);xu(e,t),s=_w(null,e,i,n,s,t);var r=Mw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hi(i)?(r=!0,uy(e)):r=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,kw(e),s.updater=av,e.stateNode=s,s._reactInternals=e,sC(e,i,n,t),e=aC(null,e,i,!0,r,t)):(e.tag=0,mt&&r&&gw(e),Hn(null,e,s,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Tg(n,e),n=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=Wz(i),n=ys(i,n),s){case 0:e=oC(null,e,i,n,t);break e;case 1:e=AM(null,e,i,n,t);break e;case 11:e=wM(null,e,i,n,t);break e;case 14:e=TM(null,e,i,ys(i.type,n),t);break e}throw Error(ne(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ys(i,s),oC(n,e,i,s,t);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ys(i,s),AM(n,e,i,s,t);case 3:e:{if(yF(e),n===null)throw Error(ne(387));i=e.pendingProps,r=e.memoizedState,s=r.element,GN(n,e),my(e,i,null,t);var o=e.memoizedState;if(i=o.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){s=Xu(Error(ne(423)),e),e=EM(n,e,i,t,s);break e}else if(i!==s){s=Xu(Error(ne(424)),e),e=EM(n,e,i,t,s);break e}else for(Ri=ba(e.stateNode.containerInfo.firstChild),Ii=e,mt=!0,ks=null,t=VN(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(qu(),i===s){e=ao(n,e,t);break e}Hn(n,e,i,t)}e=e.child}return e;case 5:return WN(e),n===null&&tC(e),i=e.type,s=e.pendingProps,r=n!==null?n.memoizedProps:null,o=s.children,$S(i,s)?o=null:r!==null&&$S(i,r)&&(e.flags|=32),gF(n,e),Hn(n,e,o,t),e.child;case 6:return n===null&&tC(e),null;case 13:return vF(n,e,t);case 4:return ww(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Qu(e,null,i,t):Hn(n,e,i,t),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ys(i,s),wM(n,e,i,s,t);case 7:return Hn(n,e,e.pendingProps,t),e.child;case 8:return Hn(n,e,e.pendingProps.children,t),e.child;case 12:return Hn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,r=e.memoizedProps,o=s.value,ct(fy,i._currentValue),i._currentValue=o,r!==null)if(Ns(r.value,o)){if(r.children===s.children&&!di.current){e=ao(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(r.tag===1){c=Yr(-1,t&-t),c.tag=2;var d=r.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),nC(r.return,t,e),a.lanes|=t;break}c=c.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(ne(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),nC(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}Hn(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,xu(e,t),s=es(s),i=i(s),e.flags|=1,Hn(n,e,i,t),e.child;case 14:return i=e.type,s=ys(i,e.pendingProps),s=ys(i.type,s),TM(n,e,i,s,t);case 15:return pF(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ys(i,s),Tg(n,e),e.tag=1,hi(i)?(n=!0,uy(e)):n=!1,xu(e,t),dF(e,i,s),sC(e,i,s,t),aC(null,e,i,!0,n,t);case 19:return bF(n,e,t);case 22:return mF(n,e,t)}throw Error(ne(156,e.tag))};function NF(n,e){return lN(n,e)}function Gz(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(n,e,t,i){return new Gz(n,e,t,i)}function jw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Wz(n){if(typeof n=="function")return jw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===sw)return 11;if(n===rw)return 14}return 2}function ka(n,e){var t=n.alternate;return t===null?(t=$i(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function _g(n,e,t,i,s,r){var o=2;if(i=n,typeof n=="function")jw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case $c:return Ol(t.children,s,r,e);case iw:o=8,s|=8;break;case _S:return n=$i(12,t,e,s|2),n.elementType=_S,n.lanes=r,n;case MS:return n=$i(13,t,e,s),n.elementType=MS,n.lanes=r,n;case RS:return n=$i(19,t,e,s),n.elementType=RS,n.lanes=r,n;case WD:return uv(t,s,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case HD:o=10;break e;case GD:o=9;break e;case sw:o=11;break e;case rw:o=14;break e;case Yo:o=16,i=null;break e}throw Error(ne(130,n==null?n:typeof n,""))}return e=$i(o,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function Ol(n,e,t,i){return n=$i(7,n,i,e),n.lanes=t,n}function uv(n,e,t,i){return n=$i(22,n,i,e),n.elementType=WD,n.lanes=t,n.stateNode={isHidden:!1},n}function Yb(n,e,t){return n=$i(6,n,null,e),n.lanes=t,n}function Zb(n,e,t){return e=$i(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Jz(n,e,t,i,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bb(0),this.expirationTimes=Bb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bb(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Uw(n,e,t,i,s,r,o,a,c){return n=new Jz(n,e,t,a,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=$i(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},kw(r),n}function Kz(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qc,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function FF(n){if(!n)return Ma;n=n._reactInternals;e:{if(ec(n)!==n||n.tag!==1)throw Error(ne(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(n.tag===1){var t=n.type;if(hi(t))return FN(n,t,e)}return e}function OF(n,e,t,i,s,r,o,a,c){return n=Uw(t,i,!0,n,s,r,o,a,c),n.context=FF(null),t=n.current,i=Qn(),s=Ca(t),r=Yr(i,s),r.callback=e??null,xa(t,r,s),n.current.lanes=s,Qf(n,s,i),fi(n,i),n}function dv(n,e,t,i){var s=e.current,r=Qn(),o=Ca(s);return t=FF(t),e.context===null?e.context=t:e.pendingContext=t,e=Yr(r,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=xa(s,e,o),n!==null&&(Is(n,s,o,r),Cg(n,s,o)),o}function ky(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function OM(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function zw(n,e){OM(n,e),(n=n.alternate)&&OM(n,e)}function qz(){return null}var LF=typeof reportError=="function"?reportError:function(n){console.error(n)};function Vw(n){this._internalRoot=n}hv.prototype.render=Vw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ne(409));dv(n,e,null,null)};hv.prototype.unmount=Vw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Jl(function(){dv(null,n,null,null)}),e[ro]=null}};function hv(n){this._internalRoot=n}hv.prototype.unstable_scheduleHydration=function(n){if(n){var e=mN();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ea.length&&e!==0&&e<ea[t].priority;t++);ea.splice(t,0,n),t===0&&yN(n)}};function Hw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function LM(){}function Qz(n,e,t,i,s){if(s){if(typeof i=="function"){var r=i;i=function(){var d=ky(o);r.call(d)}}var o=OF(e,i,n,0,null,!1,!1,"",LM);return n._reactRootContainer=o,n[ro]=o.current,mf(n.nodeType===8?n.parentNode:n),Jl(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof i=="function"){var a=i;i=function(){var d=ky(c);a.call(d)}}var c=Uw(n,0,!1,null,null,!1,!1,"",LM);return n._reactRootContainer=c,n[ro]=c.current,mf(n.nodeType===8?n.parentNode:n),Jl(function(){dv(e,c,t,i)}),c}function pv(n,e,t,i,s){var r=t._reactRootContainer;if(r){var o=r;if(typeof s=="function"){var a=s;s=function(){var c=ky(o);a.call(c)}}dv(e,o,n,s)}else o=Qz(t,e,n,s,i);return ky(o)}fN=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=_h(e.pendingLanes);t!==0&&(lw(e,t|1),fi(e,Lt()),!(We&6)&&(Yu=Lt()+500,Fa()))}break;case 13:Jl(function(){var i=oo(n,1);if(i!==null){var s=Qn();Is(i,n,1,s)}}),zw(n,1)}};cw=function(n){if(n.tag===13){var e=oo(n,134217728);if(e!==null){var t=Qn();Is(e,n,134217728,t)}zw(n,134217728)}};pN=function(n){if(n.tag===13){var e=Ca(n),t=oo(n,e);if(t!==null){var i=Qn();Is(t,n,e,i)}zw(n,e)}};mN=function(){return nt};gN=function(n,e){var t=nt;try{return nt=n,e()}finally{nt=t}};US=function(n,e,t){switch(e){case"input":if(BS(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=sv(i);if(!s)throw Error(ne(90));KD(i),BS(i,s)}}}break;case"textarea":QD(n,t);break;case"select":e=t.value,e!=null&&gu(n,!!t.multiple,e,!1)}};nN=Fw;iN=Jl;var $z={usingClientEntryPoint:!1,Events:[Xf,eu,sv,eN,tN,Fw]},oh={findFiberByHostInstance:yl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xz={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=oN(n),n===null?null:n.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||qz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rm.isDisabled&&Rm.supportsFiber)try{ev=Rm.inject(Xz),nr=Rm}catch{}}Ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$z;Ni.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hw(e))throw Error(ne(200));return Kz(n,e,null,t)};Ni.createRoot=function(n,e){if(!Hw(n))throw Error(ne(299));var t=!1,i="",s=LF;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Uw(n,1,!1,null,null,t,!1,i,s),n[ro]=e.current,mf(n.nodeType===8?n.parentNode:n),new Vw(e)};Ni.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ne(188)):(n=Object.keys(n).join(","),Error(ne(268,n)));return n=oN(e),n=n===null?null:n.stateNode,n};Ni.flushSync=function(n){return Jl(n)};Ni.hydrate=function(n,e,t){if(!fv(e))throw Error(ne(200));return pv(null,n,e,!0,t)};Ni.hydrateRoot=function(n,e,t){if(!Hw(n))throw Error(ne(405));var i=t!=null&&t.hydratedSources||null,s=!1,r="",o=LF;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=OF(e,null,n,1,t??null,s,!1,r,o),n[ro]=e.current,mf(n),i)for(n=0;n<i.length;n++)t=i[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new hv(e)};Ni.render=function(n,e,t){if(!fv(e))throw Error(ne(200));return pv(null,n,e,!1,t)};Ni.unmountComponentAtNode=function(n){if(!fv(n))throw Error(ne(40));return n._reactRootContainer?(Jl(function(){pv(null,null,n,!1,function(){n._reactRootContainer=null,n[ro]=null})}),!0):!1};Ni.unstable_batchedUpdates=Fw;Ni.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!fv(t))throw Error(ne(200));if(n==null||n._reactInternals===void 0)throw Error(ne(38));return pv(n,e,t,!1,i)};Ni.version="18.3.1-next-f1338f8080-20240426";function jF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jF)}catch(n){console.error(n)}}jF(),jD.exports=Ni;var Yz=jD.exports,jM=Yz;AS.createRoot=jM.createRoot,AS.hydrateRoot=jM.hydrateRoot;var hd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Zz={setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n),setInterval:(n,e)=>setInterval(n,e),clearInterval:n=>clearInterval(n)},ia,Qk,mD,e8=(mD=class{constructor(){ve(this,ia,Zz);ve(this,Qk,!1)}setTimeoutProvider(n){fe(this,ia,n)}setTimeout(n,e){return N(this,ia).setTimeout(n,e)}clearTimeout(n){N(this,ia).clearTimeout(n)}setInterval(n,e){return N(this,ia).setInterval(n,e)}clearInterval(n){N(this,ia).clearInterval(n)}},ia=new WeakMap,Qk=new WeakMap,mD),xl=new e8;function t8(n){setTimeout(n,0)}var Kl=typeof window>"u"||"Deno"in globalThis;function Wn(){}function n8(n,e){return typeof n=="function"?n(e):n}function bC(n){return typeof n=="number"&&n>=0&&n!==1/0}function UF(n,e){return Math.max(n+(e||0)-Date.now(),0)}function wa(n,e){return typeof n=="function"?n(e):n}function Ki(n,e){return typeof n=="function"?n(e):n}function UM(n,e){const{type:t="all",exact:i,fetchStatus:s,predicate:r,queryKey:o,stale:a}=n;if(o){if(i){if(e.queryHash!==Gw(o,e.options))return!1}else if(!wf(e.queryKey,o))return!1}if(t!=="all"){const c=e.isActive();if(t==="active"&&!c||t==="inactive"&&c)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||r&&!r(e))}function zM(n,e){const{exact:t,status:i,predicate:s,mutationKey:r}=n;if(r){if(!e.options.mutationKey)return!1;if(t){if(ql(e.options.mutationKey)!==ql(r))return!1}else if(!wf(e.options.mutationKey,r))return!1}return!(i&&e.state.status!==i||s&&!s(e))}function Gw(n,e){return((e==null?void 0:e.queryKeyHashFn)||ql)(n)}function ql(n){return JSON.stringify(n,(e,t)=>xC(t)?Object.keys(t).sort().reduce((i,s)=>(i[s]=t[s],i),{}):t)}function wf(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>wf(n[t],e[t])):!1}var i8=Object.prototype.hasOwnProperty;function zF(n,e,t=0){if(n===e)return n;if(t>500)return e;const i=VM(n)&&VM(e);if(!i&&!(xC(n)&&xC(e)))return e;const r=(i?n:Object.keys(n)).length,o=i?e:Object.keys(e),a=o.length,c=i?new Array(a):{};let d=0;for(let h=0;h<a;h++){const f=i?h:o[h],m=n[f],y=e[f];if(m===y){c[f]=m,(i?h<r:i8.call(n,f))&&d++;continue}if(m===null||y===null||typeof m!="object"||typeof y!="object"){c[f]=y;continue}const v=zF(m,y,t+1);c[f]=v,v===m&&d++}return r===a&&d===r?n:c}function wy(n,e){if(!e||Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}function VM(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function xC(n){if(!HM(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!HM(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function HM(n){return Object.prototype.toString.call(n)==="[object Object]"}function s8(n){return new Promise(e=>{xl.setTimeout(e,n)})}function SC(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?zF(n,e):e}function r8(n,e,t=0){const i=[...n,e];return t&&i.length>t?i.slice(1):i}function o8(n,e,t=0){const i=[e,...n];return t&&i.length>t?i.slice(0,-1):i}var Ww=Symbol();function VF(n,e){return!n.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!n.queryFn||n.queryFn===Ww?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function Jw(n,e){return typeof n=="function"?n(...e):!!n}function a8(n,e,t){let i=!1,s;return Object.defineProperty(n,"signal",{enumerable:!0,get:()=>(s??(s=e()),i||(i=!0,s.aborted?t():s.addEventListener("abort",t,{once:!0})),s)}),n}var El,sa,Du,gD,l8=(gD=class extends hd{constructor(){super();ve(this,El);ve(this,sa);ve(this,Du);fe(this,Du,e=>{if(!Kl&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){N(this,sa)||this.setEventListener(N(this,Du))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,sa))==null||e.call(this),fe(this,sa,void 0))}setEventListener(e){var t;fe(this,Du,e),(t=N(this,sa))==null||t.call(this),fe(this,sa,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){N(this,El)!==e&&(fe(this,El,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof N(this,El)=="boolean"?N(this,El):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},El=new WeakMap,sa=new WeakMap,Du=new WeakMap,gD),Kw=new l8;function CC(){let n,e;const t=new Promise((s,r)=>{n=s,e=r});t.status="pending",t.catch(()=>{});function i(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{i({status:"fulfilled",value:s}),n(s)},t.reject=s=>{i({status:"rejected",reason:s}),e(s)},t}var c8=t8;function u8(){let n=[],e=0,t=a=>{a()},i=a=>{a()},s=c8;const r=a=>{e?n.push(a):s(()=>{t(a)})},o=()=>{const a=n;n=[],a.length&&s(()=>{i(()=>{a.forEach(c=>{t(c)})})})};return{batch:a=>{let c;e++;try{c=a()}finally{e--,e||o()}return c},batchCalls:a=>(...c)=>{r(()=>{a(...c)})},schedule:r,setNotifyFunction:a=>{t=a},setBatchNotifyFunction:a=>{i=a},setScheduler:a=>{s=a}}}var nn=u8(),Nu,ra,Fu,yD,d8=(yD=class extends hd{constructor(){super();ve(this,Nu,!0);ve(this,ra);ve(this,Fu);fe(this,Fu,e=>{if(!Kl&&window.addEventListener){const t=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",i)}}})}onSubscribe(){N(this,ra)||this.setEventListener(N(this,Fu))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,ra))==null||e.call(this),fe(this,ra,void 0))}setEventListener(e){var t;fe(this,Fu,e),(t=N(this,ra))==null||t.call(this),fe(this,ra,e(this.setOnline.bind(this)))}setOnline(e){N(this,Nu)!==e&&(fe(this,Nu,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return N(this,Nu)}},Nu=new WeakMap,ra=new WeakMap,Fu=new WeakMap,yD),Ty=new d8;function h8(n){return Math.min(1e3*2**n,3e4)}function HF(n){return(n??"online")==="online"?Ty.isOnline():!0}var kC=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function GF(n){let e=!1,t=0,i;const s=CC(),r=()=>s.status!=="pending",o=x=>{var k;if(!r()){const C=new kC(x);m(C),(k=n.onCancel)==null||k.call(n,C)}},a=()=>{e=!0},c=()=>{e=!1},d=()=>Kw.isFocused()&&(n.networkMode==="always"||Ty.isOnline())&&n.canRun(),h=()=>HF(n.networkMode)&&n.canRun(),f=x=>{r()||(i==null||i(),s.resolve(x))},m=x=>{r()||(i==null||i(),s.reject(x))},y=()=>new Promise(x=>{var k;i=C=>{(r()||d())&&x(C)},(k=n.onPause)==null||k.call(n)}).then(()=>{var x;i=void 0,r()||(x=n.onContinue)==null||x.call(n)}),v=()=>{if(r())return;let x;const k=t===0?n.initialPromise:void 0;try{x=k??n.fn()}catch(C){x=Promise.reject(C)}Promise.resolve(x).then(f).catch(C=>{var R;if(r())return;const A=n.retry??(Kl?0:3),T=n.retryDelay??h8,E=typeof T=="function"?T(t,C):T,_=A===!0||typeof A=="number"&&t<A||typeof A=="function"&&A(t,C);if(e||!_){m(C);return}t++,(R=n.onFail)==null||R.call(n,t,C),s8(E).then(()=>d()?void 0:y()).then(()=>{e?m(C):v()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(i==null||i(),s),cancelRetry:a,continueRetry:c,canStart:h,start:()=>(h()?v():y().then(v),s)}}var _l,vD,WF=(vD=class{constructor(){ve(this,_l)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),bC(this.gcTime)&&fe(this,_l,xl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(Kl?1/0:5*60*1e3))}clearGcTimeout(){N(this,_l)&&(xl.clearTimeout(N(this,_l)),fe(this,_l,void 0))}},_l=new WeakMap,vD),Ml,Ou,Ji,Rl,hn,Hf,Pl,vs,Ir,bD,f8=(bD=class extends WF{constructor(e){super();ve(this,vs);ve(this,Ml);ve(this,Ou);ve(this,Ji);ve(this,Rl);ve(this,hn);ve(this,Hf);ve(this,Pl);fe(this,Pl,!1),fe(this,Hf,e.defaultOptions),this.setOptions(e.options),this.observers=[],fe(this,Rl,e.client),fe(this,Ji,N(this,Rl).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,fe(this,Ml,WM(this.options)),this.state=e.state??N(this,Ml),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=N(this,hn))==null?void 0:e.promise}setOptions(e){if(this.options={...N(this,Hf),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=WM(this.options);t.data!==void 0&&(this.setState(GM(t.data,t.dataUpdatedAt)),fe(this,Ml,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&N(this,Ji).remove(this)}setData(e,t){const i=SC(this.state.data,e,this.options);return Re(this,vs,Ir).call(this,{data:i,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),i}setState(e,t){Re(this,vs,Ir).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var i,s;const t=(i=N(this,hn))==null?void 0:i.promise;return(s=N(this,hn))==null||s.cancel(e),t?t.then(Wn).catch(Wn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(N(this,Ml))}isActive(){return this.observers.some(e=>Ki(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ww||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>wa(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!UF(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=N(this,hn))==null||t.continue()}onOnline(){var t;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=N(this,hn))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),N(this,Ji).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(N(this,hn)&&(N(this,Pl)?N(this,hn).cancel({revert:!0}):N(this,hn).cancelRetry()),this.scheduleGc()),N(this,Ji).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Re(this,vs,Ir).call(this,{type:"invalidate"})}async fetch(e,t){var c,d,h,f,m,y,v,x,k,C,A,T;if(this.state.fetchStatus!=="idle"&&((c=N(this,hn))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(N(this,hn))return N(this,hn).continueRetry(),N(this,hn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const E=this.observers.find(_=>_.options.queryFn);E&&this.setOptions(E.options)}const i=new AbortController,s=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(fe(this,Pl,!0),i.signal)})},r=()=>{const E=VF(this.options,t),R=(()=>{const B={client:N(this,Rl),queryKey:this.queryKey,meta:this.meta};return s(B),B})();return fe(this,Pl,!1),this.options.persister?this.options.persister(E,R,this):E(R)},a=(()=>{const E={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:N(this,Rl),state:this.state,fetchFn:r};return s(E),E})();(d=this.options.behavior)==null||d.onFetch(a,this),fe(this,Ou,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=a.fetchOptions)==null?void 0:h.meta))&&Re(this,vs,Ir).call(this,{type:"fetch",meta:(f=a.fetchOptions)==null?void 0:f.meta}),fe(this,hn,GF({initialPromise:t==null?void 0:t.initialPromise,fn:a.fetchFn,onCancel:E=>{E instanceof kC&&E.revert&&this.setState({...N(this,Ou),fetchStatus:"idle"}),i.abort()},onFail:(E,_)=>{Re(this,vs,Ir).call(this,{type:"failed",failureCount:E,error:_})},onPause:()=>{Re(this,vs,Ir).call(this,{type:"pause"})},onContinue:()=>{Re(this,vs,Ir).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const E=await N(this,hn).start();if(E===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(E),(y=(m=N(this,Ji).config).onSuccess)==null||y.call(m,E,this),(x=(v=N(this,Ji).config).onSettled)==null||x.call(v,E,this.state.error,this),E}catch(E){if(E instanceof kC){if(E.silent)return N(this,hn).promise;if(E.revert){if(this.state.data===void 0)throw E;return this.state.data}}throw Re(this,vs,Ir).call(this,{type:"error",error:E}),(C=(k=N(this,Ji).config).onError)==null||C.call(k,E,this),(T=(A=N(this,Ji).config).onSettled)==null||T.call(A,this.state.data,E,this),E}finally{this.scheduleGc()}}},Ml=new WeakMap,Ou=new WeakMap,Ji=new WeakMap,Rl=new WeakMap,hn=new WeakMap,Hf=new WeakMap,Pl=new WeakMap,vs=new WeakSet,Ir=function(e){const t=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...JF(i.data,this.options),fetchMeta:e.meta??null};case"success":const s={...i,...GM(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return fe(this,Ou,e.manual?s:void 0),s;case"error":const r=e.error;return{...i,error:r,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=t(this.state),nn.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),N(this,Ji).notify({query:this,type:"updated",action:e})})},bD);function JF(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:HF(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function GM(n,e){return{data:n,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function WM(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,i=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var si,Ve,Gf,zn,Il,Lu,Ur,oa,Wf,ju,Uu,Bl,Dl,aa,zu,Xe,Rh,wC,TC,AC,EC,_C,MC,RC,KF,xD,p8=(xD=class extends hd{constructor(e,t){super();ve(this,Xe);ve(this,si);ve(this,Ve);ve(this,Gf);ve(this,zn);ve(this,Il);ve(this,Lu);ve(this,Ur);ve(this,oa);ve(this,Wf);ve(this,ju);ve(this,Uu);ve(this,Bl);ve(this,Dl);ve(this,aa);ve(this,zu,new Set);this.options=t,fe(this,si,e),fe(this,oa,null),fe(this,Ur,CC()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(N(this,Ve).addObserver(this),JM(N(this,Ve),this.options)?Re(this,Xe,Rh).call(this):this.updateResult(),Re(this,Xe,EC).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return PC(N(this,Ve),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return PC(N(this,Ve),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Re(this,Xe,_C).call(this),Re(this,Xe,MC).call(this),N(this,Ve).removeObserver(this)}setOptions(e){const t=this.options,i=N(this,Ve);if(this.options=N(this,si).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ki(this.options.enabled,N(this,Ve))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Re(this,Xe,RC).call(this),N(this,Ve).setOptions(this.options),t._defaulted&&!wy(this.options,t)&&N(this,si).getQueryCache().notify({type:"observerOptionsUpdated",query:N(this,Ve),observer:this});const s=this.hasListeners();s&&KM(N(this,Ve),i,this.options,t)&&Re(this,Xe,Rh).call(this),this.updateResult(),s&&(N(this,Ve)!==i||Ki(this.options.enabled,N(this,Ve))!==Ki(t.enabled,N(this,Ve))||wa(this.options.staleTime,N(this,Ve))!==wa(t.staleTime,N(this,Ve)))&&Re(this,Xe,wC).call(this);const r=Re(this,Xe,TC).call(this);s&&(N(this,Ve)!==i||Ki(this.options.enabled,N(this,Ve))!==Ki(t.enabled,N(this,Ve))||r!==N(this,aa))&&Re(this,Xe,AC).call(this,r)}getOptimisticResult(e){const t=N(this,si).getQueryCache().build(N(this,si),e),i=this.createResult(t,e);return g8(this,i)&&(fe(this,zn,i),fe(this,Lu,this.options),fe(this,Il,N(this,Ve).state)),i}getCurrentResult(){return N(this,zn)}trackResult(e,t){return new Proxy(e,{get:(i,s)=>(this.trackProp(s),t==null||t(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&N(this,Ur).status==="pending"&&N(this,Ur).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(i,s))})}trackProp(e){N(this,zu).add(e)}getCurrentQuery(){return N(this,Ve)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=N(this,si).defaultQueryOptions(e),i=N(this,si).getQueryCache().build(N(this,si),t);return i.fetch().then(()=>this.createResult(i,t))}fetch(e){return Re(this,Xe,Rh).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),N(this,zn)))}createResult(e,t){var L;const i=N(this,Ve),s=this.options,r=N(this,zn),o=N(this,Il),a=N(this,Lu),d=e!==i?e.state:N(this,Gf),{state:h}=e;let f={...h},m=!1,y;if(t._optimisticResults){const O=this.hasListeners(),W=!O&&JM(e,t),ie=O&&KM(e,i,t,s);(W||ie)&&(f={...f,...JF(h.data,e.options)}),t._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:v,errorUpdatedAt:x,status:k}=f;y=f.data;let C=!1;if(t.placeholderData!==void 0&&y===void 0&&k==="pending"){let O;r!=null&&r.isPlaceholderData&&t.placeholderData===(a==null?void 0:a.placeholderData)?(O=r.data,C=!0):O=typeof t.placeholderData=="function"?t.placeholderData((L=N(this,Uu))==null?void 0:L.state.data,N(this,Uu)):t.placeholderData,O!==void 0&&(k="success",y=SC(r==null?void 0:r.data,O,t),m=!0)}if(t.select&&y!==void 0&&!C)if(r&&y===(o==null?void 0:o.data)&&t.select===N(this,Wf))y=N(this,ju);else try{fe(this,Wf,t.select),y=t.select(y),y=SC(r==null?void 0:r.data,y,t),fe(this,ju,y),fe(this,oa,null)}catch(O){fe(this,oa,O)}N(this,oa)&&(v=N(this,oa),y=N(this,ju),x=Date.now(),k="error");const A=f.fetchStatus==="fetching",T=k==="pending",E=k==="error",_=T&&A,R=y!==void 0,I={status:k,fetchStatus:f.fetchStatus,isPending:T,isSuccess:k==="success",isError:E,isInitialLoading:_,isLoading:_,data:y,dataUpdatedAt:f.dataUpdatedAt,error:v,errorUpdatedAt:x,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>d.dataUpdateCount||f.errorUpdateCount>d.errorUpdateCount,isFetching:A,isRefetching:A&&!T,isLoadingError:E&&!R,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:E&&R,isStale:qw(e,t),refetch:this.refetch,promise:N(this,Ur),isEnabled:Ki(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const O=I.data!==void 0,W=I.status==="error"&&!O,ie=le=>{W?le.reject(I.error):O&&le.resolve(I.data)},he=()=>{const le=fe(this,Ur,I.promise=CC());ie(le)},ae=N(this,Ur);switch(ae.status){case"pending":e.queryHash===i.queryHash&&ie(ae);break;case"fulfilled":(W||I.data!==ae.value)&&he();break;case"rejected":(!W||I.error!==ae.reason)&&he();break}}return I}updateResult(){const e=N(this,zn),t=this.createResult(N(this,Ve),this.options);if(fe(this,Il,N(this,Ve).state),fe(this,Lu,this.options),N(this,Il).data!==void 0&&fe(this,Uu,N(this,Ve)),wy(t,e))return;fe(this,zn,t);const i=()=>{if(!e)return!0;const{notifyOnChangeProps:s}=this.options,r=typeof s=="function"?s():s;if(r==="all"||!r&&!N(this,zu).size)return!0;const o=new Set(r??N(this,zu));return this.options.throwOnError&&o.add("error"),Object.keys(N(this,zn)).some(a=>{const c=a;return N(this,zn)[c]!==e[c]&&o.has(c)})};Re(this,Xe,KF).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Re(this,Xe,EC).call(this)}},si=new WeakMap,Ve=new WeakMap,Gf=new WeakMap,zn=new WeakMap,Il=new WeakMap,Lu=new WeakMap,Ur=new WeakMap,oa=new WeakMap,Wf=new WeakMap,ju=new WeakMap,Uu=new WeakMap,Bl=new WeakMap,Dl=new WeakMap,aa=new WeakMap,zu=new WeakMap,Xe=new WeakSet,Rh=function(e){Re(this,Xe,RC).call(this);let t=N(this,Ve).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(Wn)),t},wC=function(){Re(this,Xe,_C).call(this);const e=wa(this.options.staleTime,N(this,Ve));if(Kl||N(this,zn).isStale||!bC(e))return;const i=UF(N(this,zn).dataUpdatedAt,e)+1;fe(this,Bl,xl.setTimeout(()=>{N(this,zn).isStale||this.updateResult()},i))},TC=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(N(this,Ve)):this.options.refetchInterval)??!1},AC=function(e){Re(this,Xe,MC).call(this),fe(this,aa,e),!(Kl||Ki(this.options.enabled,N(this,Ve))===!1||!bC(N(this,aa))||N(this,aa)===0)&&fe(this,Dl,xl.setInterval(()=>{(this.options.refetchIntervalInBackground||Kw.isFocused())&&Re(this,Xe,Rh).call(this)},N(this,aa)))},EC=function(){Re(this,Xe,wC).call(this),Re(this,Xe,AC).call(this,Re(this,Xe,TC).call(this))},_C=function(){N(this,Bl)&&(xl.clearTimeout(N(this,Bl)),fe(this,Bl,void 0))},MC=function(){N(this,Dl)&&(xl.clearInterval(N(this,Dl)),fe(this,Dl,void 0))},RC=function(){const e=N(this,si).getQueryCache().build(N(this,si),this.options);if(e===N(this,Ve))return;const t=N(this,Ve);fe(this,Ve,e),fe(this,Gf,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},KF=function(e){nn.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(N(this,zn))}),N(this,si).getQueryCache().notify({query:N(this,Ve),type:"observerResultsUpdated"})})},xD);function m8(n,e){return Ki(e.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&e.retryOnMount===!1)}function JM(n,e){return m8(n,e)||n.state.data!==void 0&&PC(n,e,e.refetchOnMount)}function PC(n,e,t){if(Ki(e.enabled,n)!==!1&&wa(e.staleTime,n)!=="static"){const i=typeof t=="function"?t(n):t;return i==="always"||i!==!1&&qw(n,e)}return!1}function KM(n,e,t,i){return(n!==e||Ki(i.enabled,n)===!1)&&(!t.suspense||n.state.status!=="error")&&qw(n,t)}function qw(n,e){return Ki(e.enabled,n)!==!1&&n.isStaleByTime(wa(e.staleTime,n))}function g8(n,e){return!wy(n.getCurrentResult(),e)}function qM(n){return{onFetch:(e,t)=>{var h,f,m,y,v;const i=e.options,s=(m=(f=(h=e.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:m.direction,r=((y=e.state.data)==null?void 0:y.pages)||[],o=((v=e.state.data)==null?void 0:v.pageParams)||[];let a={pages:[],pageParams:[]},c=0;const d=async()=>{let x=!1;const k=T=>{a8(T,()=>e.signal,()=>x=!0)},C=VF(e.options,e.fetchOptions),A=async(T,E,_)=>{if(x)return Promise.reject();if(E==null&&T.pages.length)return Promise.resolve(T);const B=(()=>{const W={client:e.client,queryKey:e.queryKey,pageParam:E,direction:_?"backward":"forward",meta:e.options.meta};return k(W),W})(),I=await C(B),{maxPages:L}=e.options,O=_?o8:r8;return{pages:O(T.pages,I,L),pageParams:O(T.pageParams,E,L)}};if(s&&r.length){const T=s==="backward",E=T?y8:QM,_={pages:r,pageParams:o},R=E(i,_);a=await A(_,R,T)}else{const T=n??r.length;do{const E=c===0?o[0]??i.initialPageParam:QM(i,a);if(c>0&&E==null)break;a=await A(a,E),c++}while(c<T)}return a};e.options.persister?e.fetchFn=()=>{var x,k;return(k=(x=e.options).persister)==null?void 0:k.call(x,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function QM(n,{pages:e,pageParams:t}){const i=e.length-1;return e.length>0?n.getNextPageParam(e[i],e,t[i],t):void 0}function y8(n,{pages:e,pageParams:t}){var i;return e.length>0?(i=n.getPreviousPageParam)==null?void 0:i.call(n,e[0],e,t[0],t):void 0}var Jf,Ys,Vn,Nl,Zs,Ko,SD,v8=(SD=class extends WF{constructor(e){super();ve(this,Zs);ve(this,Jf);ve(this,Ys);ve(this,Vn);ve(this,Nl);fe(this,Jf,e.client),this.mutationId=e.mutationId,fe(this,Vn,e.mutationCache),fe(this,Ys,[]),this.state=e.state||qF(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){N(this,Ys).includes(e)||(N(this,Ys).push(e),this.clearGcTimeout(),N(this,Vn).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){fe(this,Ys,N(this,Ys).filter(t=>t!==e)),this.scheduleGc(),N(this,Vn).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){N(this,Ys).length||(this.state.status==="pending"?this.scheduleGc():N(this,Vn).remove(this))}continue(){var e;return((e=N(this,Nl))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,a,c,d,h,f,m,y,v,x,k,C,A,T,E,_,R,B,I,L;const t=()=>{Re(this,Zs,Ko).call(this,{type:"continue"})},i={client:N(this,Jf),meta:this.options.meta,mutationKey:this.options.mutationKey};fe(this,Nl,GF({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(O,W)=>{Re(this,Zs,Ko).call(this,{type:"failed",failureCount:O,error:W})},onPause:()=>{Re(this,Zs,Ko).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>N(this,Vn).canRun(this)}));const s=this.state.status==="pending",r=!N(this,Nl).canStart();try{if(s)t();else{Re(this,Zs,Ko).call(this,{type:"pending",variables:e,isPaused:r}),await((a=(o=N(this,Vn).config).onMutate)==null?void 0:a.call(o,e,this,i));const W=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,e,i));W!==this.state.context&&Re(this,Zs,Ko).call(this,{type:"pending",context:W,variables:e,isPaused:r})}const O=await N(this,Nl).start();return await((f=(h=N(this,Vn).config).onSuccess)==null?void 0:f.call(h,O,e,this.state.context,this,i)),await((y=(m=this.options).onSuccess)==null?void 0:y.call(m,O,e,this.state.context,i)),await((x=(v=N(this,Vn).config).onSettled)==null?void 0:x.call(v,O,null,this.state.variables,this.state.context,this,i)),await((C=(k=this.options).onSettled)==null?void 0:C.call(k,O,null,e,this.state.context,i)),Re(this,Zs,Ko).call(this,{type:"success",data:O}),O}catch(O){try{await((T=(A=N(this,Vn).config).onError)==null?void 0:T.call(A,O,e,this.state.context,this,i))}catch(W){Promise.reject(W)}try{await((_=(E=this.options).onError)==null?void 0:_.call(E,O,e,this.state.context,i))}catch(W){Promise.reject(W)}try{await((B=(R=N(this,Vn).config).onSettled)==null?void 0:B.call(R,void 0,O,this.state.variables,this.state.context,this,i))}catch(W){Promise.reject(W)}try{await((L=(I=this.options).onSettled)==null?void 0:L.call(I,void 0,O,e,this.state.context,i))}catch(W){Promise.reject(W)}throw Re(this,Zs,Ko).call(this,{type:"error",error:O}),O}finally{N(this,Vn).runNext(this)}}},Jf=new WeakMap,Ys=new WeakMap,Vn=new WeakMap,Nl=new WeakMap,Zs=new WeakSet,Ko=function(e){const t=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),nn.batch(()=>{N(this,Ys).forEach(i=>{i.onMutationUpdate(e)}),N(this,Vn).notify({mutation:this,type:"updated",action:e})})},SD);function qF(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zr,bs,Kf,CD,b8=(CD=class extends hd{constructor(e={}){super();ve(this,zr);ve(this,bs);ve(this,Kf);this.config=e,fe(this,zr,new Set),fe(this,bs,new Map),fe(this,Kf,0)}build(e,t,i){const s=new v8({client:e,mutationCache:this,mutationId:++fm(this,Kf)._,options:e.defaultMutationOptions(t),state:i});return this.add(s),s}add(e){N(this,zr).add(e);const t=Pm(e);if(typeof t=="string"){const i=N(this,bs).get(t);i?i.push(e):N(this,bs).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(N(this,zr).delete(e)){const t=Pm(e);if(typeof t=="string"){const i=N(this,bs).get(t);if(i)if(i.length>1){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}else i[0]===e&&N(this,bs).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Pm(e);if(typeof t=="string"){const i=N(this,bs).get(t),s=i==null?void 0:i.find(r=>r.state.status==="pending");return!s||s===e}else return!0}runNext(e){var i;const t=Pm(e);if(typeof t=="string"){const s=(i=N(this,bs).get(t))==null?void 0:i.find(r=>r!==e&&r.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){nn.batch(()=>{N(this,zr).forEach(e=>{this.notify({type:"removed",mutation:e})}),N(this,zr).clear(),N(this,bs).clear()})}getAll(){return Array.from(N(this,zr))}find(e){const t={exact:!0,...e};return this.getAll().find(i=>zM(t,i))}findAll(e={}){return this.getAll().filter(t=>zM(e,t))}notify(e){nn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return nn.batch(()=>Promise.all(e.map(t=>t.continue().catch(Wn))))}},zr=new WeakMap,bs=new WeakMap,Kf=new WeakMap,CD);function Pm(n){var e;return(e=n.options.scope)==null?void 0:e.id}var Vr,la,ri,Hr,io,Mg,IC,kD,x8=(kD=class extends hd{constructor(t,i){super();ve(this,io);ve(this,Vr);ve(this,la);ve(this,ri);ve(this,Hr);fe(this,Vr,t),this.setOptions(i),this.bindMethods(),Re(this,io,Mg).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const i=this.options;this.options=N(this,Vr).defaultMutationOptions(t),wy(this.options,i)||N(this,Vr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:N(this,ri),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&ql(i.mutationKey)!==ql(this.options.mutationKey)?this.reset():((s=N(this,ri))==null?void 0:s.state.status)==="pending"&&N(this,ri).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=N(this,ri))==null||t.removeObserver(this)}onMutationUpdate(t){Re(this,io,Mg).call(this),Re(this,io,IC).call(this,t)}getCurrentResult(){return N(this,la)}reset(){var t;(t=N(this,ri))==null||t.removeObserver(this),fe(this,ri,void 0),Re(this,io,Mg).call(this),Re(this,io,IC).call(this)}mutate(t,i){var s;return fe(this,Hr,i),(s=N(this,ri))==null||s.removeObserver(this),fe(this,ri,N(this,Vr).getMutationCache().build(N(this,Vr),this.options)),N(this,ri).addObserver(this),N(this,ri).execute(t)}},Vr=new WeakMap,la=new WeakMap,ri=new WeakMap,Hr=new WeakMap,io=new WeakSet,Mg=function(){var i;const t=((i=N(this,ri))==null?void 0:i.state)??qF();fe(this,la,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},IC=function(t){nn.batch(()=>{var i,s,r,o,a,c,d,h;if(N(this,Hr)&&this.hasListeners()){const f=N(this,la).variables,m=N(this,la).context,y={client:N(this,Vr),meta:this.options.meta,mutationKey:this.options.mutationKey};if((t==null?void 0:t.type)==="success"){try{(s=(i=N(this,Hr)).onSuccess)==null||s.call(i,t.data,f,m,y)}catch(v){Promise.reject(v)}try{(o=(r=N(this,Hr)).onSettled)==null||o.call(r,t.data,null,f,m,y)}catch(v){Promise.reject(v)}}else if((t==null?void 0:t.type)==="error"){try{(c=(a=N(this,Hr)).onError)==null||c.call(a,t.error,f,m,y)}catch(v){Promise.reject(v)}try{(h=(d=N(this,Hr)).onSettled)==null||h.call(d,void 0,t.error,f,m,y)}catch(v){Promise.reject(v)}}}this.listeners.forEach(f=>{f(N(this,la))})})},kD),er,wD,S8=(wD=class extends hd{constructor(e={}){super();ve(this,er);this.config=e,fe(this,er,new Map)}build(e,t,i){const s=t.queryKey,r=t.queryHash??Gw(s,t);let o=this.get(r);return o||(o=new f8({client:e,queryKey:s,queryHash:r,options:e.defaultQueryOptions(t),state:i,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){N(this,er).has(e.queryHash)||(N(this,er).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=N(this,er).get(e.queryHash);t&&(e.destroy(),t===e&&N(this,er).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){nn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return N(this,er).get(e)}getAll(){return[...N(this,er).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(i=>UM(t,i))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(i=>UM(e,i)):t}notify(e){nn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){nn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){nn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},er=new WeakMap,wD),_t,ca,ua,Vu,Hu,da,Gu,Wu,TD,C8=(TD=class{constructor(n={}){ve(this,_t);ve(this,ca);ve(this,ua);ve(this,Vu);ve(this,Hu);ve(this,da);ve(this,Gu);ve(this,Wu);fe(this,_t,n.queryCache||new S8),fe(this,ca,n.mutationCache||new b8),fe(this,ua,n.defaultOptions||{}),fe(this,Vu,new Map),fe(this,Hu,new Map),fe(this,da,0)}mount(){fm(this,da)._++,N(this,da)===1&&(fe(this,Gu,Kw.subscribe(async n=>{n&&(await this.resumePausedMutations(),N(this,_t).onFocus())})),fe(this,Wu,Ty.subscribe(async n=>{n&&(await this.resumePausedMutations(),N(this,_t).onOnline())})))}unmount(){var n,e;fm(this,da)._--,N(this,da)===0&&((n=N(this,Gu))==null||n.call(this),fe(this,Gu,void 0),(e=N(this,Wu))==null||e.call(this),fe(this,Wu,void 0))}isFetching(n){return N(this,_t).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return N(this,ca).findAll({...n,status:"pending"}).length}getQueryData(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=N(this,_t).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=N(this,_t).build(this,e),i=t.state.data;return i===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(wa(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(n){return N(this,_t).findAll(n).map(({queryKey:e,state:t})=>{const i=t.data;return[e,i]})}setQueryData(n,e,t){const i=this.defaultQueryOptions({queryKey:n}),s=N(this,_t).get(i.queryHash),r=s==null?void 0:s.state.data,o=n8(e,r);if(o!==void 0)return N(this,_t).build(this,i).setData(o,{...t,manual:!0})}setQueriesData(n,e,t){return nn.batch(()=>N(this,_t).findAll(n).map(({queryKey:i})=>[i,this.setQueryData(i,e,t)]))}getQueryState(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=N(this,_t).get(e.queryHash))==null?void 0:t.state}removeQueries(n){const e=N(this,_t);nn.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=N(this,_t);return nn.batch(()=>(t.findAll(n).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},i=nn.batch(()=>N(this,_t).findAll(n).map(s=>s.cancel(t)));return Promise.all(i).then(Wn).catch(Wn)}invalidateQueries(n,e={}){return nn.batch(()=>(N(this,_t).findAll(n).forEach(t=>{t.invalidate()}),(n==null?void 0:n.refetchType)==="none"?Promise.resolve():this.refetchQueries({...n,type:(n==null?void 0:n.refetchType)??(n==null?void 0:n.type)??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},i=nn.batch(()=>N(this,_t).findAll(n).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let r=s.fetch(void 0,t);return t.throwOnError||(r=r.catch(Wn)),s.state.fetchStatus==="paused"?Promise.resolve():r}));return Promise.all(i).then(Wn)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=N(this,_t).build(this,e);return t.isStaleByTime(wa(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(Wn).catch(Wn)}fetchInfiniteQuery(n){return n.behavior=qM(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(Wn).catch(Wn)}ensureInfiniteQueryData(n){return n.behavior=qM(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Ty.isOnline()?N(this,ca).resumePausedMutations():Promise.resolve()}getQueryCache(){return N(this,_t)}getMutationCache(){return N(this,ca)}getDefaultOptions(){return N(this,ua)}setDefaultOptions(n){fe(this,ua,n)}setQueryDefaults(n,e){N(this,Vu).set(ql(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...N(this,Vu).values()],t={};return e.forEach(i=>{wf(n,i.queryKey)&&Object.assign(t,i.defaultOptions)}),t}setMutationDefaults(n,e){N(this,Hu).set(ql(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...N(this,Hu).values()],t={};return e.forEach(i=>{wf(n,i.mutationKey)&&Object.assign(t,i.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...N(this,ua).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=Gw(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ww&&(e.enabled=!1),e}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...N(this,ua).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){N(this,_t).clear(),N(this,ca).clear()}},_t=new WeakMap,ca=new WeakMap,ua=new WeakMap,Vu=new WeakMap,Hu=new WeakMap,da=new WeakMap,Gu=new WeakMap,Wu=new WeakMap,TD),QF=P.createContext(void 0),Qw=n=>{const e=P.useContext(QF);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},k8=({client:n,children:e})=>(P.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),S.jsx(QF.Provider,{value:n,children:e})),$F=P.createContext(!1),w8=()=>P.useContext($F);$F.Provider;function T8(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var A8=P.createContext(T8()),E8=()=>P.useContext(A8),_8=(n,e,t)=>{const i=t!=null&&t.state.error&&typeof n.throwOnError=="function"?Jw(n.throwOnError,[t.state.error,t]):n.throwOnError;(n.suspense||n.experimental_prefetchInRender||i)&&(e.isReset()||(n.retryOnMount=!1))},M8=n=>{P.useEffect(()=>{n.clearReset()},[n])},R8=({result:n,errorResetBoundary:e,throwOnError:t,query:i,suspense:s})=>n.isError&&!e.isReset()&&!n.isFetching&&i&&(s&&n.data===void 0||Jw(t,[n.error,i])),P8=n=>{if(n.suspense){const t=s=>s==="static"?s:Math.max(s??1e3,1e3),i=n.staleTime;n.staleTime=typeof i=="function"?(...s)=>t(i(...s)):t(i),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},I8=(n,e)=>n.isLoading&&n.isFetching&&!e,B8=(n,e)=>(n==null?void 0:n.suspense)&&e.isPending,$M=(n,e,t)=>e.fetchOptimistic(n).catch(()=>{t.clearReset()});function D8(n,e,t){var m,y,v,x;const i=w8(),s=E8(),r=Qw(),o=r.defaultQueryOptions(n);(y=(m=r.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||y.call(m,o);const a=r.getQueryCache().get(o.queryHash);o._optimisticResults=i?"isRestoring":"optimistic",P8(o),_8(o,s,a),M8(s);const c=!r.getQueryCache().get(o.queryHash),[d]=P.useState(()=>new e(r,o)),h=d.getOptimisticResult(o),f=!i&&n.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(k=>{const C=f?d.subscribe(nn.batchCalls(k)):Wn;return d.updateResult(),C},[d,f]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),P.useEffect(()=>{d.setOptions(o)},[o,d]),B8(o,h))throw $M(o,d,s);if(R8({result:h,errorResetBoundary:s,throwOnError:o.throwOnError,query:a,suspense:o.suspense}))throw h.error;if((x=(v=r.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||x.call(v,o,h),o.experimental_prefetchInRender&&!Kl&&I8(h,i)){const k=c?$M(o,d,s):a==null?void 0:a.promise;k==null||k.catch(Wn).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?h:d.trackResult(h)}function XF(n,e){return D8(n,p8)}function Im(n,e){const t=Qw(),[i]=P.useState(()=>new x8(t,n));P.useEffect(()=>{i.setOptions(n)},[i,n]);const s=P.useSyncExternalStore(P.useCallback(o=>i.subscribe(nn.batchCalls(o)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),r=P.useCallback((o,a)=>{i.mutate(o,a).catch(Wn)},[i]);if(s.error&&Jw(i.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:r,mutateAsync:s.mutate}}/**
 * react-router v7.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var XM="popstate";function N8(n={}){function e(i,s){let{pathname:r,search:o,hash:a}=i.location;return BC("",{pathname:r,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){return typeof s=="string"?s:Tf(s)}return O8(e,t,null,n)}function wt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Fs(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function F8(){return Math.random().toString(36).substring(2,10)}function YM(n,e){return{usr:n.state,key:n.key,idx:e}}function BC(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?fd(e):e,state:t,key:e&&e.key||i||F8()}}function Tf({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function fd(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function O8(n,e,t,i={}){let{window:s=document.defaultView,v5Compat:r=!1}=i,o=s.history,a="POP",c=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let k=h(),C=k==null?null:k-d;d=k,c&&c({action:a,location:x.location,delta:C})}function m(k,C){a="PUSH";let A=BC(x.location,k,C);d=h()+1;let T=YM(A,d),E=x.createHref(A);try{o.pushState(T,"",E)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(E)}r&&c&&c({action:a,location:x.location,delta:1})}function y(k,C){a="REPLACE";let A=BC(x.location,k,C);d=h();let T=YM(A,d),E=x.createHref(A);o.replaceState(T,"",E),r&&c&&c({action:a,location:x.location,delta:0})}function v(k){return L8(k)}let x={get action(){return a},get location(){return n(s,o)},listen(k){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(XM,f),c=k,()=>{s.removeEventListener(XM,f),c=null}},createHref(k){return e(s,k)},createURL:v,encodeLocation(k){let C=v(k);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:m,replace:y,go(k){return o.go(k)}};return x}function L8(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),wt(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Tf(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function YF(n,e,t="/"){return j8(n,e,t,!1)}function j8(n,e,t,i){let s=typeof e=="string"?fd(e):e,r=lo(s.pathname||"/",t);if(r==null)return null;let o=ZF(n);U8(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=X8(r);a=Q8(o[c],d,i)}return a}function ZF(n,e=[],t=[],i="",s=!1){let r=(o,a,c=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(i)&&c)return;wt(h.relativePath.startsWith(i),`Absolute route path "${h.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(i.length)}let f=Zr([i,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(wt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),ZF(o.children,e,m,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:K8(f,o.index),routesMeta:m})};return n.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))r(o,a);else for(let d of eO(o.path))r(o,a,!0,d)}),e}function eO(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(i.length===0)return s?[r,""]:[r];let o=eO(i.join("/")),a=[];return a.push(...o.map(c=>c===""?r:[r,c].join("/"))),s&&a.push(...o),a.map(c=>n.startsWith("/")&&c===""?"/":c)}function U8(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:q8(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var z8=/^:[\w-]+$/,V8=3,H8=2,G8=1,W8=10,J8=-2,ZM=n=>n==="*";function K8(n,e){let t=n.split("/"),i=t.length;return t.some(ZM)&&(i+=J8),e&&(i+=H8),t.filter(s=>!ZM(s)).reduce((s,r)=>s+(z8.test(r)?V8:r===""?G8:W8),i)}function q8(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function Q8(n,e,t=!1){let{routesMeta:i}=n,s={},r="/",o=[];for(let a=0;a<i.length;++a){let c=i[a],d=a===i.length-1,h=r==="/"?e:e.slice(r.length)||"/",f=Ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),m=c.route;if(!f&&d&&t&&!i[i.length-1].route.index&&(f=Ay({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Zr([r,f.pathname]),pathnameBase:tV(Zr([r,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(r=Zr([r,f.pathnameBase]))}return o}function Ay(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=$8(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let r=s[0],o=r.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:i.reduce((d,{paramName:h,isOptional:f},m)=>{if(h==="*"){let v=a[m]||"";o=r.slice(0,r.length-v.length).replace(/(.)\/+$/,"$1")}const y=a[m];return f&&!y?d[h]=void 0:d[h]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:r,pathnameBase:o,pattern:n}}function $8(n,e=!1,t=!0){Fs(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(i.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function X8(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fs(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function lo(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var tO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Y8=n=>tO.test(n);function Z8(n,e="/"){let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?fd(n):n,r;if(t)if(Y8(t))r=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Fs(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?r=eR(t.substring(1),"/"):r=eR(t,e)}else r=e;return{pathname:r,search:nV(i),hash:iV(s)}}function eR(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function ex(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function eV(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function nO(n){let e=eV(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function iO(n,e,t,i=!1){let s;typeof n=="string"?s=fd(n):(s={...n},wt(!s.pathname||!s.pathname.includes("?"),ex("?","pathname","search",s)),wt(!s.pathname||!s.pathname.includes("#"),ex("#","pathname","hash",s)),wt(!s.search||!s.search.includes("#"),ex("#","search","hash",s)));let r=n===""||s.pathname==="",o=r?"/":s.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!i&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}a=f>=0?e[f]:"/"}let c=Z8(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}var Zr=n=>n.join("/").replace(/\/\/+/g,"/"),tV=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),nV=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,iV=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,sV=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function rV(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function oV(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var sO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function rO(n,e){let t=n;if(typeof t!="string"||!tO.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,s=!1;if(sO)try{let r=new URL(window.location.href),o=t.startsWith("//")?new URL(r.protocol+t):new URL(t),a=lo(o.pathname,e);o.origin===r.origin&&a!=null?t=a+o.search+o.hash:s=!0}catch{Fs(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var oO=["POST","PUT","PATCH","DELETE"];new Set(oO);var aV=["GET",...oO];new Set(aV);var pd=P.createContext(null);pd.displayName="DataRouter";var mv=P.createContext(null);mv.displayName="DataRouterState";var lV=P.createContext(!1),aO=P.createContext({isTransitioning:!1});aO.displayName="ViewTransition";var cV=P.createContext(new Map);cV.displayName="Fetchers";var uV=P.createContext(null);uV.displayName="Await";var ns=P.createContext(null);ns.displayName="Navigation";var Zf=P.createContext(null);Zf.displayName="Location";var fo=P.createContext({outlet:null,matches:[],isDataRoute:!1});fo.displayName="Route";var $w=P.createContext(null);$w.displayName="RouteError";var lO="REACT_ROUTER_ERROR",dV="REDIRECT",hV="ROUTE_ERROR_RESPONSE";function fV(n){if(n.startsWith(`${lO}:${dV}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function pV(n){if(n.startsWith(`${lO}:${hV}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new sV(e.status,e.statusText,e.data)}catch{}}function mV(n,{relative:e}={}){wt(ep(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=P.useContext(ns),{hash:s,pathname:r,search:o}=np(n,{relative:e}),a=r;return t!=="/"&&(a=r==="/"?t:Zr([t,r])),i.createHref({pathname:a,search:o,hash:s})}function ep(){return P.useContext(Zf)!=null}function Oa(){return wt(ep(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(Zf).location}var cO="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uO(n){P.useContext(ns).static||P.useLayoutEffect(n)}function tp(){let{isDataRoute:n}=P.useContext(fo);return n?_V():gV()}function gV(){wt(ep(),"useNavigate() may be used only in the context of a <Router> component.");let n=P.useContext(pd),{basename:e,navigator:t}=P.useContext(ns),{matches:i}=P.useContext(fo),{pathname:s}=Oa(),r=JSON.stringify(nO(i)),o=P.useRef(!1);return uO(()=>{o.current=!0}),P.useCallback((c,d={})=>{if(Fs(o.current,cO),!o.current)return;if(typeof c=="number"){t.go(c);return}let h=iO(c,JSON.parse(r),s,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Zr([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,r,s,n])}P.createContext(null);function np(n,{relative:e}={}){let{matches:t}=P.useContext(fo),{pathname:i}=Oa(),s=JSON.stringify(nO(t));return P.useMemo(()=>iO(n,JSON.parse(s),i,e==="path"),[n,s,i,e])}function yV(n,e){return dO(n,e)}function dO(n,e,t,i,s){var A;wt(ep(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=P.useContext(ns),{matches:o}=P.useContext(fo),a=o[o.length-1],c=a?a.params:{},d=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let T=f&&f.path||"";fO(d,!f||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=Oa(),y;if(e){let T=typeof e=="string"?fd(e):e;wt(h==="/"||((A=T.pathname)==null?void 0:A.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),y=T}else y=m;let v=y.pathname||"/",x=v;if(h!=="/"){let T=h.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(T.length).join("/")}let k=YF(n,{pathname:x});Fs(f||k!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Fs(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=CV(k&&k.map(T=>Object.assign({},T,{params:Object.assign({},c,T.params),pathname:Zr([h,r.encodeLocation?r.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:Zr([h,r.encodeLocation?r.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,t,i,s);return e&&C?P.createElement(Zf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},C):C}function vV(){let n=EV(),e=rV(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},r={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:r},"ErrorBoundary")," or"," ",P.createElement("code",{style:r},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:s},t):null,o)}var bV=P.createElement(vV,null),hO=class extends P.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=pV(n.digest);t&&(n=t)}let e=n!==void 0?P.createElement(fo.Provider,{value:this.props.routeContext},P.createElement($w.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?P.createElement(xV,{error:n},e):e}};hO.contextType=lV;var tx=new WeakMap;function xV({children:n,error:e}){let{basename:t}=P.useContext(ns);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=fV(e.digest);if(i){let s=tx.get(e);if(s)throw s;let r=rO(i.location,t);if(sO&&!tx.get(e))if(r.isExternal||i.reloadDocument)window.location.href=r.absoluteURL||r.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(r.to,{replace:i.replace}));throw tx.set(e,o),o}return P.createElement("meta",{httpEquiv:"refresh",content:`0;url=${r.absoluteURL||r.to}`})}}return n}function SV({routeContext:n,match:e,children:t}){let i=P.useContext(pd);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(fo.Provider,{value:n},t)}function CV(n,e=[],t=null,i=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,o=t==null?void 0:t.errors;if(o!=null){let h=r.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);wt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,h+1))}let a=!1,c=-1;if(t)for(let h=0;h<r.length;h++){let f=r[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:m,errors:y}=t,v=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!y||y[f.route.id]===void 0);if(f.route.lazy||v){a=!0,c>=0?r=r.slice(0,c+1):r=[r[0]];break}}}let d=t&&i?(h,f)=>{var m,y;i(h,{location:t.location,params:((y=(m=t.matches)==null?void 0:m[0])==null?void 0:y.params)??{},unstable_pattern:oV(t.matches),errorInfo:f})}:void 0;return r.reduceRight((h,f,m)=>{let y,v=!1,x=null,k=null;t&&(y=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||bV,a&&(c<0&&m===0?(fO("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,k=null):c===m&&(v=!0,k=f.route.hydrateFallbackElement||null)));let C=e.concat(r.slice(0,m+1)),A=()=>{let T;return y?T=x:v?T=k:f.route.Component?T=P.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=h,P.createElement(SV,{match:f,routeContext:{outlet:h,matches:C,isDataRoute:t!=null},children:T})};return t&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?P.createElement(hO,{location:t.location,revalidation:t.revalidation,component:x,error:y,children:A(),routeContext:{outlet:null,matches:C,isDataRoute:!0},onError:d}):A()},null)}function Xw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kV(n){let e=P.useContext(pd);return wt(e,Xw(n)),e}function wV(n){let e=P.useContext(mv);return wt(e,Xw(n)),e}function TV(n){let e=P.useContext(fo);return wt(e,Xw(n)),e}function Yw(n){let e=TV(n),t=e.matches[e.matches.length-1];return wt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function AV(){return Yw("useRouteId")}function EV(){var i;let n=P.useContext($w),e=wV("useRouteError"),t=Yw("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function _V(){let{router:n}=kV("useNavigate"),e=Yw("useNavigate"),t=P.useRef(!1);return uO(()=>{t.current=!0}),P.useCallback(async(s,r={})=>{Fs(t.current,cO),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...r}))},[n,e])}var tR={};function fO(n,e,t){!e&&!tR[n]&&(tR[n]=!0,Fs(!1,t))}P.memo(MV);function MV({routes:n,future:e,state:t,onError:i}){return dO(n,void 0,t,i,e)}function qo(n){wt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function RV({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:s,static:r=!1,unstable_useTransitions:o}){wt(!ep(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),c=P.useMemo(()=>({basename:a,navigator:s,static:r,unstable_useTransitions:o,future:{}}),[a,s,r,o]);typeof t=="string"&&(t=fd(t));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:y="default"}=t,v=P.useMemo(()=>{let x=lo(d,a);return x==null?null:{location:{pathname:x,search:h,hash:f,state:m,key:y},navigationType:i}},[a,d,h,f,m,y,i]);return Fs(v!=null,`<Router basename="${a}"> is not able to match the URL "${d}${h}${f}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:P.createElement(ns.Provider,{value:c},P.createElement(Zf.Provider,{children:e,value:v}))}function PV({children:n,location:e}){return yV(DC(n),e)}function DC(n,e=[]){let t=[];return P.Children.forEach(n,(i,s)=>{if(!P.isValidElement(i))return;let r=[...e,s];if(i.type===P.Fragment){t.push.apply(t,DC(i.props.children,r));return}wt(i.type===qo,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),wt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||r.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=DC(i.props.children,r)),t.push(o)}),t}var Rg="get",Pg="application/x-www-form-urlencoded";function gv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function IV(n){return gv(n)&&n.tagName.toLowerCase()==="button"}function BV(n){return gv(n)&&n.tagName.toLowerCase()==="form"}function DV(n){return gv(n)&&n.tagName.toLowerCase()==="input"}function NV(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function FV(n,e){return n.button===0&&(!e||e==="_self")&&!NV(n)}var Bm=null;function OV(){if(Bm===null)try{new FormData(document.createElement("form"),0),Bm=!1}catch{Bm=!0}return Bm}var LV=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nx(n){return n!=null&&!LV.has(n)?(Fs(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Pg}"`),null):n}function jV(n,e){let t,i,s,r,o;if(BV(n)){let a=n.getAttribute("action");i=a?lo(a,e):null,t=n.getAttribute("method")||Rg,s=nx(n.getAttribute("enctype"))||Pg,r=new FormData(n)}else if(IV(n)||DV(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||a.getAttribute("action");if(i=c?lo(c,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||Rg,s=nx(n.getAttribute("formenctype"))||nx(a.getAttribute("enctype"))||Pg,r=new FormData(a,n),!OV()){let{name:d,type:h,value:f}=n;if(h==="image"){let m=d?`${d}.`:"";r.append(`${m}x`,"0"),r.append(`${m}y`,"0")}else d&&r.append(d,f)}}else{if(gv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Rg,i=null,s=Pg,o=n}return r&&s==="text/plain"&&(o=r,r=void 0),{action:i,method:t.toLowerCase(),encType:s,formData:r,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Zw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function UV(n,e,t,i){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${i}`:s.pathname=`${s.pathname}.${i}`:s.pathname==="/"?s.pathname=`_root.${i}`:e&&lo(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${i}`,s}async function zV(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VV(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function HV(n,e,t){let i=await Promise.all(n.map(async s=>{let r=e.routes[s.route.id];if(r){let o=await zV(r,t);return o.links?o.links():[]}return[]}));return KV(i.flat(1).filter(VV).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function nR(n,e,t,i,s,r){let o=(c,d)=>t[d]?c.route.id!==t[d].route.id:!0,a=(c,d)=>{var h;return t[d].pathname!==c.pathname||((h=t[d].route.path)==null?void 0:h.endsWith("*"))&&t[d].params["*"]!==c.params["*"]};return r==="assets"?e.filter((c,d)=>o(c,d)||a(c,d)):r==="data"?e.filter((c,d)=>{var f;let h=i.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,d)||a(c,d))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function GV(n,e,{includeHydrateFallback:t}={}){return WV(n.map(i=>{let s=e.routes[i.route.id];if(!s)return[];let r=[s.module];return s.clientActionModule&&(r=r.concat(s.clientActionModule)),s.clientLoaderModule&&(r=r.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(r=r.concat(s.hydrateFallbackModule)),s.imports&&(r=r.concat(s.imports)),r}).flat(1))}function WV(n){return[...new Set(n)]}function JV(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function KV(n,e){let t=new Set;return new Set(e),n.reduce((i,s)=>{let r=JSON.stringify(JV(s));return t.has(r)||(t.add(r),i.push({key:r,link:s})),i},[])}function pO(){let n=P.useContext(pd);return Zw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function qV(){let n=P.useContext(mv);return Zw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var eT=P.createContext(void 0);eT.displayName="FrameworkContext";function mO(){let n=P.useContext(eT);return Zw(n,"You must render this element inside a <HydratedRouter> element"),n}function QV(n,e){let t=P.useContext(eT),[i,s]=P.useState(!1),[r,o]=P.useState(!1),{onFocus:a,onBlur:c,onMouseEnter:d,onMouseLeave:h,onTouchStart:f}=e,m=P.useRef(null);P.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let x=C=>{C.forEach(A=>{o(A.isIntersecting)})},k=new IntersectionObserver(x,{threshold:.5});return m.current&&k.observe(m.current),()=>{k.disconnect()}}},[n]),P.useEffect(()=>{if(i){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[i]);let y=()=>{s(!0)},v=()=>{s(!1),o(!1)};return t?n!=="intent"?[r,m,{}]:[r,m,{onFocus:ah(a,y),onBlur:ah(c,v),onMouseEnter:ah(d,y),onMouseLeave:ah(h,v),onTouchStart:ah(f,y)}]:[!1,m,{}]}function ah(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function $V({page:n,...e}){let{router:t}=pO(),i=P.useMemo(()=>YF(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?P.createElement(YV,{page:n,matches:i,...e}):null}function XV(n){let{manifest:e,routeModules:t}=mO(),[i,s]=P.useState([]);return P.useEffect(()=>{let r=!1;return HV(n,e,t).then(o=>{r||s(o)}),()=>{r=!0}},[n,e,t]),i}function YV({page:n,matches:e,...t}){let i=Oa(),{future:s,manifest:r,routeModules:o}=mO(),{basename:a}=pO(),{loaderData:c,matches:d}=qV(),h=P.useMemo(()=>nR(n,e,d,r,i,"data"),[n,e,d,r,i]),f=P.useMemo(()=>nR(n,e,d,r,i,"assets"),[n,e,d,r,i]),m=P.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let x=new Set,k=!1;if(e.forEach(A=>{var E;let T=r.routes[A.route.id];!T||!T.hasLoader||(!h.some(_=>_.route.id===A.route.id)&&A.route.id in c&&((E=o[A.route.id])!=null&&E.shouldRevalidate)||T.hasClientLoader?k=!0:x.add(A.route.id))}),x.size===0)return[];let C=UV(n,a,s.unstable_trailingSlashAwareDataRequests,"data");return k&&x.size>0&&C.searchParams.set("_routes",e.filter(A=>x.has(A.route.id)).map(A=>A.route.id).join(",")),[C.pathname+C.search]},[a,s.unstable_trailingSlashAwareDataRequests,c,i,r,h,e,n,o]),y=P.useMemo(()=>GV(f,r),[f,r]),v=XV(f);return P.createElement(P.Fragment,null,m.map(x=>P.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),y.map(x=>P.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),v.map(({key:x,link:k})=>P.createElement("link",{key:x,nonce:t.nonce,...k})))}function ZV(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var eH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eH&&(window.__reactRouterVersion="7.12.0")}catch{}function tH({basename:n,children:e,unstable_useTransitions:t,window:i}){let s=P.useRef();s.current==null&&(s.current=N8({window:i,v5Compat:!0}));let r=s.current,[o,a]=P.useState({action:r.action,location:r.location}),c=P.useCallback(d=>{t===!1?a(d):P.startTransition(()=>a(d))},[t]);return P.useLayoutEffect(()=>r.listen(c),[r,c]),P.createElement(RV,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:r,unstable_useTransitions:t})}var gO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wh=P.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:s,reloadDocument:r,replace:o,state:a,target:c,to:d,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m,...y},v){let{basename:x,unstable_useTransitions:k}=P.useContext(ns),C=typeof d=="string"&&gO.test(d),A=rO(d,x);d=A.to;let T=mV(d,{relative:s}),[E,_,R]=QV(i,y),B=rH(d,{replace:o,state:a,target:c,preventScrollReset:h,relative:s,viewTransition:f,unstable_defaultShouldRevalidate:m,unstable_useTransitions:k});function I(O){e&&e(O),O.defaultPrevented||B(O)}let L=P.createElement("a",{...y,...R,href:A.absoluteURL||T,onClick:A.isExternal||r?e:I,ref:ZV(v,_),target:c,"data-discover":!C&&t==="render"?"true":void 0});return E&&!C?P.createElement(P.Fragment,null,L,P.createElement($V,{page:T})):L});Wh.displayName="Link";var nH=P.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:s=!1,style:r,to:o,viewTransition:a,children:c,...d},h){let f=np(o,{relative:d.relative}),m=Oa(),y=P.useContext(mv),{navigator:v,basename:x}=P.useContext(ns),k=y!=null&&uH(f)&&a===!0,C=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,A=m.pathname,T=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(A=A.toLowerCase(),T=T?T.toLowerCase():null,C=C.toLowerCase()),T&&x&&(T=lo(T,x)||T);const E=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let _=A===C||!s&&A.startsWith(C)&&A.charAt(E)==="/",R=T!=null&&(T===C||!s&&T.startsWith(C)&&T.charAt(C.length)==="/"),B={isActive:_,isPending:R,isTransitioning:k},I=_?e:void 0,L;typeof i=="function"?L=i(B):L=[i,_?"active":null,R?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let O=typeof r=="function"?r(B):r;return P.createElement(Wh,{...d,"aria-current":I,className:L,ref:h,style:O,to:o,viewTransition:a},typeof c=="function"?c(B):c)});nH.displayName="NavLink";var iH=P.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:s,state:r,method:o=Rg,action:a,onSubmit:c,relative:d,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m,...y},v)=>{let{unstable_useTransitions:x}=P.useContext(ns),k=lH(),C=cH(a,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",T=typeof a=="string"&&gO.test(a),E=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let R=_.nativeEvent.submitter,B=(R==null?void 0:R.getAttribute("formmethod"))||o,I=()=>k(R||_.currentTarget,{fetcherKey:e,method:B,navigate:t,replace:s,state:r,relative:d,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:m});x&&t!==!1?P.startTransition(()=>I()):I()};return P.createElement("form",{ref:v,method:A,action:C,onSubmit:i?c:E,...y,"data-discover":!T&&n==="render"?"true":void 0})});iH.displayName="Form";function sH(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yO(n){let e=P.useContext(pd);return wt(e,sH(n)),e}function rH(n,{target:e,replace:t,state:i,preventScrollReset:s,relative:r,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:c}={}){let d=tp(),h=Oa(),f=np(n,{relative:r});return P.useCallback(m=>{if(FV(m,e)){m.preventDefault();let y=t!==void 0?t:Tf(h)===Tf(f),v=()=>d(n,{replace:y,state:i,preventScrollReset:s,relative:r,viewTransition:o,unstable_defaultShouldRevalidate:a});c?P.startTransition(()=>v()):v()}},[h,d,f,t,i,e,n,s,r,o,a,c])}var oH=0,aH=()=>`__${String(++oH)}__`;function lH(){let{router:n}=yO("useSubmit"),{basename:e}=P.useContext(ns),t=AV(),i=n.fetch,s=n.navigate;return P.useCallback(async(r,o={})=>{let{action:a,method:c,encType:d,formData:h,body:f}=jV(r,e);if(o.navigate===!1){let m=o.fetcherKey||aH();await i(m,t,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||d,flushSync:o.flushSync})}else await s(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,s,e,t])}function cH(n,{relative:e}={}){let{basename:t}=P.useContext(ns),i=P.useContext(fo);wt(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),r={...np(n||".",{relative:e})},o=Oa();if(n==null){r.search=o.search;let a=new URLSearchParams(r.search),c=a.getAll("index");if(c.some(h=>h==="")){a.delete("index"),c.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();r.search=h?`?${h}`:""}}return(!n||n===".")&&s.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:Zr([t,r.pathname])),Tf(r)}function uH(n,{relative:e}={}){let t=P.useContext(aO);wt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=yO("useViewTransitionState"),s=np(n,{relative:e});if(!t.isTransitioning)return!1;let r=lo(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=lo(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ay(s.pathname,o)!=null||Ay(s.pathname,r)!=null}const tT=P.createContext({});function Ra(n){const e=P.useRef(null);return e.current===null&&(e.current=n()),e.current}const vO=typeof window<"u",yv=vO?P.useLayoutEffect:P.useEffect,vv=P.createContext(null);function nT(n,e){n.indexOf(e)===-1&&n.push(e)}function iT(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Os=(n,e,t)=>t>e?e:t<n?n:t;let Af=()=>{};const co={},bO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function xO(n){return typeof n=="object"&&n!==null}const SO=n=>/^0[^.\s]+$/u.test(n);function sT(n){let e;return()=>(e===void 0&&(e=n()),e)}const pi=n=>n,dH=(n,e)=>t=>e(n(t)),ip=(...n)=>n.reduce(dH),Zu=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i};class rT{constructor(){this.subscriptions=[]}add(e){return nT(this.subscriptions,e),()=>iT(this.subscriptions,e)}notify(e,t,i){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,i);else for(let r=0;r<s;r++){const o=this.subscriptions[r];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const eo=n=>n*1e3,Xi=n=>n/1e3;function oT(n,e){return e?n*(1e3/e):0}const CO=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,hH=1e-7,fH=12;function pH(n,e,t,i,s){let r,o,a=0;do o=e+(t-e)/2,r=CO(o,i,s)-n,r>0?t=o:e=o;while(Math.abs(r)>hH&&++a<fH);return o}function sp(n,e,t,i){if(n===e&&t===i)return pi;const s=r=>pH(r,0,1,n,t);return r=>r===0||r===1?r:CO(s(r),e,i)}const kO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,wO=n=>e=>1-n(1-e),TO=sp(.33,1.53,.69,.99),aT=wO(TO),AO=kO(aT),EO=n=>(n*=2)<1?.5*aT(n):.5*(2-Math.pow(2,-10*(n-1))),lT=n=>1-Math.sin(Math.acos(n)),_O=wO(lT),MO=kO(lT),mH=sp(.42,0,1,1),gH=sp(0,0,.58,1),RO=sp(.42,0,.58,1),yH=n=>Array.isArray(n)&&typeof n[0]!="number",PO=n=>Array.isArray(n)&&typeof n[0]=="number",vH={linear:pi,easeIn:mH,easeInOut:RO,easeOut:gH,circIn:lT,circInOut:MO,circOut:_O,backIn:aT,backInOut:AO,backOut:TO,anticipate:EO},bH=n=>typeof n=="string",iR=n=>{if(PO(n)){Af(n.length===4);const[e,t,i,s]=n;return sp(e,t,i,s)}else if(bH(n))return vH[n];return n},Dm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function xH(n,e){let t=new Set,i=new Set,s=!1,r=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(h){o.has(h)&&(d.schedule(h),n()),h(a)}const d={schedule:(h,f=!1,m=!1)=>{const v=m&&s?t:i;return f&&o.add(h),v.has(h)||v.add(h),h},cancel:h=>{i.delete(h),o.delete(h)},process:h=>{if(a=h,s){r=!0;return}s=!0,[t,i]=[i,t],t.forEach(c),t.clear(),s=!1,r&&(r=!1,d.process(h))}};return d}const SH=40;function IO(n,e){let t=!1,i=!0;const s={delta:0,timestamp:0,isProcessing:!1},r=()=>t=!0,o=Dm.reduce((T,E)=>(T[E]=xH(r),T),{}),{setup:a,read:c,resolveKeyframes:d,preUpdate:h,update:f,preRender:m,render:y,postRender:v}=o,x=()=>{const T=co.useManualTiming?s.timestamp:performance.now();t=!1,co.useManualTiming||(s.delta=i?1e3/60:Math.max(Math.min(T-s.timestamp,SH),1)),s.timestamp=T,s.isProcessing=!0,a.process(s),c.process(s),d.process(s),h.process(s),f.process(s),m.process(s),y.process(s),v.process(s),s.isProcessing=!1,t&&e&&(i=!1,n(x))},k=()=>{t=!0,i=!0,s.isProcessing||n(x)};return{schedule:Dm.reduce((T,E)=>{const _=o[E];return T[E]=(R,B=!1,I=!1)=>(t||k(),_.schedule(R,B,I)),T},{}),cancel:T=>{for(let E=0;E<Dm.length;E++)o[Dm[E]].cancel(T)},state:s,steps:o}}const{schedule:$e,cancel:Ls,state:fn,steps:ix}=IO(typeof requestAnimationFrame<"u"?requestAnimationFrame:pi,!0);let Ig;function CH(){Ig=void 0}const Kn={now:()=>(Ig===void 0&&Kn.set(fn.isProcessing||co.useManualTiming?fn.timestamp:performance.now()),Ig),set:n=>{Ig=n,queueMicrotask(CH)}},BO=n=>e=>typeof e=="string"&&e.startsWith(n),DO=BO("--"),kH=BO("var(--"),cT=n=>kH(n)?wH.test(n.split("/*")[0].trim()):!1,wH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function sR(n){return typeof n!="string"?!1:n.split("/*")[0].includes("var(--")}const md={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Ef={...md,transform:n=>Os(0,1,n)},Nm={...md,default:1},Jh=n=>Math.round(n*1e5)/1e5,uT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function TH(n){return n==null}const AH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,dT=(n,e)=>t=>!!(typeof t=="string"&&AH.test(t)&&t.startsWith(n)||e&&!TH(t)&&Object.prototype.hasOwnProperty.call(t,e)),NO=(n,e,t)=>i=>{if(typeof i!="string")return i;const[s,r,o,a]=i.match(uT);return{[n]:parseFloat(s),[e]:parseFloat(r),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},EH=n=>Os(0,255,n),sx={...md,transform:n=>Math.round(EH(n))},Sl={test:dT("rgb","red"),parse:NO("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+sx.transform(n)+", "+sx.transform(e)+", "+sx.transform(t)+", "+Jh(Ef.transform(i))+")"};function _H(n){let e="",t="",i="",s="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),s=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),s=n.substring(4,5),e+=e,t+=t,i+=i,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:s?parseInt(s,16)/255:1}}const NC={test:dT("#"),parse:_H,transform:Sl.transform},rp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Qo=rp("deg"),sr=rp("%"),me=rp("px"),MH=rp("vh"),RH=rp("vw"),rR={...sr,parse:n=>sr.parse(n)/100,transform:n=>sr.transform(n*100)},au={test:dT("hsl","hue"),parse:NO("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+sr.transform(Jh(e))+", "+sr.transform(Jh(t))+", "+Jh(Ef.transform(i))+")"},Kt={test:n=>Sl.test(n)||NC.test(n)||au.test(n),parse:n=>Sl.test(n)?Sl.parse(n):au.test(n)?au.parse(n):NC.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Sl.transform(n):au.transform(n),getAnimatableNone:n=>{const e=Kt.parse(n);return e.alpha=0,Kt.transform(e)}},PH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function IH(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(uT))==null?void 0:e.length)||0)+(((t=n.match(PH))==null?void 0:t.length)||0)>0}const FO="number",OO="color",BH="var",DH="var(",oR="${}",NH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _f(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},s=[];let r=0;const a=e.replace(NH,c=>(Kt.test(c)?(i.color.push(r),s.push(OO),t.push(Kt.parse(c))):c.startsWith(DH)?(i.var.push(r),s.push(BH),t.push(c)):(i.number.push(r),s.push(FO),t.push(parseFloat(c))),++r,oR)).split(oR);return{values:t,split:a,indexes:i,types:s}}function LO(n){return _f(n).values}function jO(n){const{split:e,types:t}=_f(n),i=e.length;return s=>{let r="";for(let o=0;o<i;o++)if(r+=e[o],s[o]!==void 0){const a=t[o];a===FO?r+=Jh(s[o]):a===OO?r+=Kt.transform(s[o]):r+=s[o]}return r}}const FH=n=>typeof n=="number"?0:Kt.test(n)?Kt.getAnimatableNone(n):n;function OH(n){const e=LO(n);return jO(n)(e.map(FH))}const Pa={test:IH,parse:LO,createTransformer:jO,getAnimatableNone:OH};function rx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function LH({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let s=0,r=0,o=0;if(!e)s=r=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;s=rx(c,a,n+1/3),r=rx(c,a,n),o=rx(c,a,n-1/3)}return{red:Math.round(s*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:i}}function Ey(n,e){return t=>t>0?e:n}const Ct=(n,e,t)=>n+(e-n)*t,ox=(n,e,t)=>{const i=n*n,s=t*(e*e-i)+i;return s<0?0:Math.sqrt(s)},jH=[NC,Sl,au],UH=n=>jH.find(e=>e.test(n));function aR(n){const e=UH(n);if(!e)return!1;let t=e.parse(n);return e===au&&(t=LH(t)),t}const lR=(n,e)=>{const t=aR(n),i=aR(e);if(!t||!i)return Ey(n,e);const s={...t};return r=>(s.red=ox(t.red,i.red,r),s.green=ox(t.green,i.green,r),s.blue=ox(t.blue,i.blue,r),s.alpha=Ct(t.alpha,i.alpha,r),Sl.transform(s))},FC=new Set(["none","hidden"]);function zH(n,e){return FC.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function VH(n,e){return t=>Ct(n,e,t)}function hT(n){return typeof n=="number"?VH:typeof n=="string"?cT(n)?Ey:Kt.test(n)?lR:WH:Array.isArray(n)?UO:typeof n=="object"?Kt.test(n)?lR:HH:Ey}function UO(n,e){const t=[...n],i=t.length,s=n.map((r,o)=>hT(r)(r,e[o]));return r=>{for(let o=0;o<i;o++)t[o]=s[o](r);return t}}function HH(n,e){const t={...n,...e},i={};for(const s in t)n[s]!==void 0&&e[s]!==void 0&&(i[s]=hT(n[s])(n[s],e[s]));return s=>{for(const r in i)t[r]=i[r](s);return t}}function GH(n,e){const t=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const r=e.types[s],o=n.indexes[r][i[r]],a=n.values[o]??0;t[s]=a,i[r]++}return t}const WH=(n,e)=>{const t=Pa.createTransformer(e),i=_f(n),s=_f(e);return i.indexes.var.length===s.indexes.var.length&&i.indexes.color.length===s.indexes.color.length&&i.indexes.number.length>=s.indexes.number.length?FC.has(n)&&!s.values.length||FC.has(e)&&!i.values.length?zH(n,e):ip(UO(GH(i,s),s.values),t):Ey(n,e)};function zO(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Ct(n,e,t):hT(n)(n,e)}const JH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>$e.update(e,t),stop:()=>Ls(e),now:()=>fn.isProcessing?fn.timestamp:Kn.now()}},VO=(n,e,t=10)=>{let i="";const s=Math.max(Math.round(e/t),2);for(let r=0;r<s;r++)i+=Math.round(n(r/(s-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},_y=2e4;function fT(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<_y;)e+=t,i=n.next(e);return e>=_y?1/0:e}function KH(n,e=100,t){const i=t({...n,keyframes:[0,e]}),s=Math.min(fT(i),_y);return{type:"keyframes",ease:r=>i.next(s*r).value/e,duration:Xi(s)}}const qH=5;function HO(n,e,t){const i=Math.max(e-qH,0);return oT(t-n(i),e-i)}const Mt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ax=.001;function QH({duration:n=Mt.duration,bounce:e=Mt.bounce,velocity:t=Mt.velocity,mass:i=Mt.mass}){let s,r,o=1-e;o=Os(Mt.minDamping,Mt.maxDamping,o),n=Os(Mt.minDuration,Mt.maxDuration,Xi(n)),o<1?(s=d=>{const h=d*o,f=h*n,m=h-t,y=OC(d,o),v=Math.exp(-f);return ax-m/y*v},r=d=>{const f=d*o*n,m=f*t+t,y=Math.pow(o,2)*Math.pow(d,2)*n,v=Math.exp(-f),x=OC(Math.pow(d,2),o);return(-s(d)+ax>0?-1:1)*((m-y)*v)/x}):(s=d=>{const h=Math.exp(-d*n),f=(d-t)*n+1;return-ax+h*f},r=d=>{const h=Math.exp(-d*n),f=(t-d)*(n*n);return h*f});const a=5/n,c=XH(s,r,a);if(n=eo(n),isNaN(c))return{stiffness:Mt.stiffness,damping:Mt.damping,duration:n};{const d=Math.pow(c,2)*i;return{stiffness:d,damping:o*2*Math.sqrt(i*d),duration:n}}}const $H=12;function XH(n,e,t){let i=t;for(let s=1;s<$H;s++)i=i-n(i)/e(i);return i}function OC(n,e){return n*Math.sqrt(1-e*e)}const YH=["duration","bounce"],ZH=["stiffness","damping","mass"];function cR(n,e){return e.some(t=>n[t]!==void 0)}function eG(n){let e={velocity:Mt.velocity,stiffness:Mt.stiffness,damping:Mt.damping,mass:Mt.mass,isResolvedFromDuration:!1,...n};if(!cR(n,ZH)&&cR(n,YH))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),s=i*i,r=2*Os(.05,1,1-(n.bounce||0))*Math.sqrt(s);e={...e,mass:Mt.mass,stiffness:s,damping:r}}else{const t=QH(n);e={...e,...t,mass:Mt.mass},e.isResolvedFromDuration=!0}return e}function My(n=Mt.visualDuration,e=Mt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:s}=t;const r=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:r},{stiffness:c,damping:d,mass:h,duration:f,velocity:m,isResolvedFromDuration:y}=eG({...t,velocity:-Xi(t.velocity||0)}),v=m||0,x=d/(2*Math.sqrt(c*h)),k=o-r,C=Xi(Math.sqrt(c/h)),A=Math.abs(k)<5;i||(i=A?Mt.restSpeed.granular:Mt.restSpeed.default),s||(s=A?Mt.restDelta.granular:Mt.restDelta.default);let T;if(x<1){const _=OC(C,x);T=R=>{const B=Math.exp(-x*C*R);return o-B*((v+x*C*k)/_*Math.sin(_*R)+k*Math.cos(_*R))}}else if(x===1)T=_=>o-Math.exp(-C*_)*(k+(v+C*k)*_);else{const _=C*Math.sqrt(x*x-1);T=R=>{const B=Math.exp(-x*C*R),I=Math.min(_*R,300);return o-B*((v+x*C*k)*Math.sinh(I)+_*k*Math.cosh(I))/_}}const E={calculatedDuration:y&&f||null,next:_=>{const R=T(_);if(y)a.done=_>=f;else{let B=_===0?v:0;x<1&&(B=_===0?eo(v):HO(T,_,R));const I=Math.abs(B)<=i,L=Math.abs(o-R)<=s;a.done=I&&L}return a.value=a.done?o:R,a},toString:()=>{const _=Math.min(fT(E),_y),R=VO(B=>E.next(_*B).value,_,30);return _+"ms "+R},toTransition:()=>{}};return E}My.applyToOptions=n=>{const e=KH(n,100,My);return n.ease=e.ease,n.duration=eo(e.duration),n.type="keyframes",n};function LC({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:s=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:c,restDelta:d=.5,restSpeed:h}){const f=n[0],m={done:!1,value:f},y=I=>a!==void 0&&I<a||c!==void 0&&I>c,v=I=>a===void 0?c:c===void 0||Math.abs(a-I)<Math.abs(c-I)?a:c;let x=t*e;const k=f+x,C=o===void 0?k:o(k);C!==k&&(x=C-f);const A=I=>-x*Math.exp(-I/i),T=I=>C+A(I),E=I=>{const L=A(I),O=T(I);m.done=Math.abs(L)<=d,m.value=m.done?C:O};let _,R;const B=I=>{y(m.value)&&(_=I,R=My({keyframes:[m.value,v(m.value)],velocity:HO(T,I,m.value),damping:s,stiffness:r,restDelta:d,restSpeed:h}))};return B(0),{calculatedDuration:null,next:I=>{let L=!1;return!R&&_===void 0&&(L=!0,E(I),B(I)),_!==void 0&&I>=_?R.next(I-_):(!L&&E(I),m)}}}function tG(n,e,t){const i=[],s=t||co.mix||zO,r=n.length-1;for(let o=0;o<r;o++){let a=s(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||pi:e;a=ip(c,a)}i.push(a)}return i}function pT(n,e,{clamp:t=!0,ease:i,mixer:s}={}){const r=n.length;if(Af(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[r-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=tG(e,i,s),c=a.length,d=h=>{if(o&&h<n[0])return e[0];let f=0;if(c>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const m=Zu(n[f],n[f+1],h);return a[f](m)};return t?h=>d(Os(n[0],n[r-1],h)):d}function nG(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const s=Zu(0,e,i);n.push(Ct(t,1,s))}}function GO(n){const e=[0];return nG(e,n.length-1),e}function iG(n,e){return n.map(t=>t*e)}function sG(n,e){return n.map(()=>e||RO).splice(0,n.length-1)}function Kh({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const s=yH(i)?i.map(iR):iR(i),r={done:!1,value:e[0]},o=iG(t&&t.length===e.length?t:GO(e),n),a=pT(o,e,{ease:Array.isArray(s)?s:sG(e,s)});return{calculatedDuration:n,next:c=>(r.value=a(c),r.done=c>=n,r)}}const rG=n=>n!==null;function mT(n,{repeat:e,repeatType:t="loop"},i,s=1){const r=n.filter(rG),a=s<0||e&&t!=="loop"&&e%2===1?0:r.length-1;return!a||i===void 0?r[a]:i}const oG={decay:LC,inertia:LC,tween:Kh,keyframes:Kh,spring:My};function WO(n){typeof n.type=="string"&&(n.type=oG[n.type])}class gT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const aG=n=>n/100;class yT extends gT{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,s;const{motionValue:t}=this.options;t&&t.updatedAt!==Kn.now()&&this.tick(Kn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(i=this.options).onStop)==null||s.call(i))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;WO(e);const{type:t=Kh,repeat:i=0,repeatDelay:s=0,repeatType:r,velocity:o=0}=e;let{keyframes:a}=e;const c=t||Kh;c!==Kh&&typeof a[0]!="number"&&(this.mixKeyframes=ip(aG,zO(a[0],a[1])),a=[0,100]);const d=c({...e,keyframes:a});r==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...a].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=fT(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+s,this.totalDuration=this.resolvedDuration*(i+1)-s,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:i,totalDuration:s,mixKeyframes:r,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:d=0,keyframes:h,repeat:f,repeatType:m,repeatDelay:y,type:v,onUpdate:x,finalKeyframe:k}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const C=this.currentTime-d*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let T=this.currentTime,E=i;if(f){const I=Math.min(this.currentTime,s)/a;let L=Math.floor(I),O=I%1;!O&&I>=1&&(O=1),O===1&&L--,L=Math.min(L,f+1),!!(L%2)&&(m==="reverse"?(O=1-O,y&&(O-=y/a)):m==="mirror"&&(E=o)),T=Os(0,1,O)*a}const _=A?{done:!1,value:h[0]}:E.next(T);r&&(_.value=r(_.value));let{done:R}=_;!A&&c!==null&&(R=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const B=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return B&&v!==LC&&(_.value=mT(h,this.options,k,this.speed)),x&&x(_.value),B&&this.finish(),_}then(e,t){return this.finished.then(e,t)}get duration(){return Xi(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Xi(e)}get time(){return Xi(this.currentTime)}set time(e){var t;e=eo(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Kn.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Xi(this.currentTime))}play(){var s,r;if(this.isStopped)return;const{driver:e=JH,startTime:t}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(r=(s=this.options).onPlay)==null||r.call(s);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=t??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Kn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function lG(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Cl=n=>n*180/Math.PI,jC=n=>{const e=Cl(Math.atan2(n[1],n[0]));return UC(e)},cG={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:jC,rotateZ:jC,skewX:n=>Cl(Math.atan(n[1])),skewY:n=>Cl(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},UC=n=>(n=n%360,n<0&&(n+=360),n),uR=jC,dR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),hR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),uG={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:dR,scaleY:hR,scale:n=>(dR(n)+hR(n))/2,rotateX:n=>UC(Cl(Math.atan2(n[6],n[5]))),rotateY:n=>UC(Cl(Math.atan2(-n[2],n[0]))),rotateZ:uR,rotate:uR,skewX:n=>Cl(Math.atan(n[4])),skewY:n=>Cl(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function zC(n){return n.includes("scale")?1:0}function VC(n,e){if(!n||n==="none")return zC(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,s;if(t)i=uG,s=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=cG,s=a}if(!s)return zC(e);const r=i[e],o=s[1].split(",").map(hG);return typeof r=="function"?r(o):o[r]}const dG=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return VC(t,e)};function hG(n){return parseFloat(n.trim())}const gd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yd=new Set(gd),fR=n=>n===md||n===me,fG=new Set(["x","y","z"]),pG=gd.filter(n=>!fG.has(n));function mG(n){const e=[];return pG.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const pa={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>VC(e,"x"),y:(n,{transform:e})=>VC(e,"y")};pa.translateX=pa.x;pa.translateY=pa.y;const Ll=new Set;let HC=!1,GC=!1,WC=!1;function JO(){if(GC){const n=Array.from(Ll).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const s=mG(i);s.length&&(t.set(i,s),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const s=t.get(i);s&&s.forEach(([r,o])=>{var a;(a=i.getValue(r))==null||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}GC=!1,HC=!1,Ll.forEach(n=>n.complete(WC)),Ll.clear()}function KO(){Ll.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(GC=!0)})}function gG(){WC=!0,KO(),JO(),WC=!1}class vT{constructor(e,t,i,s,r,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=s,this.element=r,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Ll.add(this),HC||(HC=!0,$e.read(KO),$e.resolveKeyframes(JO))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:s}=this;if(e[0]===null){const r=s==null?void 0:s.get(),o=e[e.length-1];if(r!==void 0)e[0]=r;else if(i&&t){const a=i.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),s&&r===void 0&&s.set(e[0])}lG(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Ll.delete(this)}cancel(){this.state==="scheduled"&&(Ll.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const yG=n=>n.startsWith("--");function vG(n,e,t){yG(e)?n.style.setProperty(e,t):n.style[e]=t}const qO=sT(()=>window.ScrollTimeline!==void 0),bG={};function xG(n,e){const t=sT(n);return()=>bG[e]??t()}const QO=xG(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ph=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,pR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ph([0,.65,.55,1]),circOut:Ph([.55,0,1,.45]),backIn:Ph([.31,.01,.66,-.59]),backOut:Ph([.33,1.53,.69,.99])};function $O(n,e){if(n)return typeof n=="function"?QO()?VO(n,e):"ease-out":PO(n)?Ph(n):Array.isArray(n)?n.map(t=>$O(t,e)||pR.easeOut):pR[n]}function SG(n,e,t,{delay:i=0,duration:s=300,repeat:r=0,repeatType:o="loop",ease:a="easeOut",times:c}={},d=void 0){const h={[e]:t};c&&(h.offset=c);const f=$O(a,s);Array.isArray(f)&&(h.easing=f);const m={delay:i,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function XO(n){return typeof n=="function"&&"applyToOptions"in n}function CG({type:n,...e}){return XO(n)&&QO()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class kG extends gT{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:t,name:i,keyframes:s,pseudoElement:r,allowFlatten:o=!1,finalKeyframe:a,onComplete:c}=e;this.isPseudoElement=!!r,this.allowFlatten=o,this.options=e,Af(typeof e.type!="string");const d=CG(e);this.animation=SG(t,i,s,d,r),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const h=mT(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(h):vG(t,i,h),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,i;const e=((i=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:i.call(t).duration)||0;return Xi(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Xi(e)}get time(){return Xi(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=eo(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&qO()?(this.animation.timeline=e,pi):t(this)}}const YO={anticipate:EO,backInOut:AO,circInOut:MO};function wG(n){return n in YO}function TG(n){typeof n.ease=="string"&&wG(n.ease)&&(n.ease=YO[n.ease])}const lx=10;class AG extends kG{constructor(e){TG(e),WO(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:i,onComplete:s,element:r,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new yT({...o,autoplay:!1}),c=Math.max(lx,Kn.now()-this.startTime),d=Os(0,lx,c-lx);t.setWithVelocity(a.sample(Math.max(0,c-d)).value,a.sample(c).value,d),a.stop()}}const mR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Pa.test(n)||n==="0")&&!n.startsWith("url("));function EG(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function _G(n,e,t,i){const s=n[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const r=n[n.length-1],o=mR(s,e),a=mR(r,e);return!o||!a?!1:EG(n)||(t==="spring"||XO(t))&&i}function JC(n){n.duration=0,n.type="keyframes"}const MG=new Set(["opacity","clipPath","filter","transform"]),RG=sT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function PG(n){var h;const{motionValue:e,name:t,repeatDelay:i,repeatType:s,damping:r,type:o}=n;if(!(((h=e==null?void 0:e.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=e.owner.getProps();return RG()&&t&&MG.has(t)&&(t!=="transform"||!d)&&!c&&!i&&s!=="mirror"&&r!==0&&o!=="inertia"}const IG=40;class BG extends gT{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:o="loop",keyframes:a,name:c,motionValue:d,element:h,...f}){var v;super(),this.stop=()=>{var x,k;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(k=this.keyframeResolver)==null||k.cancel()},this.createdAt=Kn.now();const m={autoplay:e,delay:t,type:i,repeat:s,repeatDelay:r,repeatType:o,name:c,motionValue:d,element:h,...f},y=(h==null?void 0:h.KeyframeResolver)||vT;this.keyframeResolver=new y(a,(x,k,C)=>this.onKeyframesResolved(x,k,m,!C),c,d,h),(v=this.keyframeResolver)==null||v.scheduleResolve()}onKeyframesResolved(e,t,i,s){this.keyframeResolver=void 0;const{name:r,type:o,velocity:a,delay:c,isHandoff:d,onUpdate:h}=i;this.resolvedAt=Kn.now(),_G(e,r,o,a)||((co.instantAnimations||!c)&&(h==null||h(mT(e,i,t))),e[0]=e[e.length-1],JC(i),i.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>IG?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...i,keyframes:e},y=!d&&PG(m)?new AG({...m,element:m.motionValue.owner.current}):new yT(m);y.finished.then(()=>this.notifyFinished()).catch(pi),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),gG()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const DG=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function NG(n){const e=DG.exec(n);if(!e)return[,];const[,t,i,s]=e;return[`--${t??i}`,s]}function ZO(n,e,t=1){const[i,s]=NG(n);if(!i)return;const r=window.getComputedStyle(e).getPropertyValue(i);if(r){const o=r.trim();return bO(o)?parseFloat(o):o}return cT(s)?ZO(s,e,t+1):s}function bT(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const FG={type:"spring",stiffness:500,damping:25,restSpeed:10},OG=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),LG={type:"keyframes",duration:.8},jG={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},UG=(n,{keyframes:e})=>e.length>2?LG:yd.has(n)?n.startsWith("scale")?OG(e[1]):FG:jG;function zG({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:s,repeat:r,repeatType:o,repeatDelay:a,from:c,elapsed:d,...h}){return!!Object.keys(h).length}const VG=n=>n!==null;function HG(n,{repeat:e,repeatType:t="loop"},i){const s=n.filter(VG),r=e&&t!=="loop"&&e%2===1?0:s.length-1;return s[r]}function eL(n,e,t,i=0,s=1){const r=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,a=(o-1)*i;return typeof t=="function"?t(r,o):s===1?r*i:a-r*i}const xT=(n,e,t,i={},s,r)=>o=>{const a=bT(i,n)||{},c=a.delay||i.delay||0;let{elapsed:d=0}=i;d=d-eo(c);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-d,onUpdate:m=>{e.set(m),a.onUpdate&&a.onUpdate(m)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:r?void 0:s};zG(a)||Object.assign(h,UG(n,h)),h.duration&&(h.duration=eo(h.duration)),h.repeatDelay&&(h.repeatDelay=eo(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(JC(h),h.delay===0&&(f=!0)),(co.instantAnimations||co.skipAnimations)&&(f=!0,JC(h),h.delay=0),h.allowFlatten=!a.type&&!a.ease,f&&!r&&e.get()!==void 0){const m=HG(h.keyframes,a);if(m!==void 0){$e.update(()=>{h.onUpdate(m),h.onComplete()});return}}return a.isSync?new yT(h):new BG(h)},tL=new Set(["width","height","top","left","right","bottom",...gd]),gR=30,GG=n=>!isNaN(parseFloat(n)),qh={current:void 0};class WG{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var r;const s=Kn.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((r=this.events.change)==null||r.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Kn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=GG(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new rT);const i=this.events[e].add(t);return e==="change"?()=>{i(),$e.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return qh.current&&qh.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Kn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>gR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,gR);return oT(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ms(n,e){return new WG(n,e)}function yR(n){const e=[{},{}];return n==null||n.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function ST(n,e,t,i){if(typeof e=="function"){const[s,r]=yR(i);e=e(t!==void 0?t:n.custom,s,r)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[s,r]=yR(i);e=e(t!==void 0?t:n.custom,s,r)}return e}function Cu(n,e,t){const i=n.getProps();return ST(i,e,t!==void 0?t:i.custom,n)}const KC=n=>Array.isArray(n);function JG(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Ms(t))}function KG(n){return KC(n)?n[n.length-1]||0:n}function qG(n,e){const t=Cu(n,e);let{transitionEnd:i={},transition:s={},...r}=t||{};r={...r,...i};for(const o in r){const a=KG(r[o]);JG(n,o,a)}}const Fn=n=>!!(n&&n.getVelocity);function QG(n){return!!(Fn(n)&&n.add)}function qC(n,e){const t=n.getValue("willChange");if(QG(t))return t.add(e);if(!t&&co.WillChange){const i=new co.WillChange("auto");n.addValue("willChange",i),i.add(e)}}function CT(n){return n.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const $G="framerAppearId",nL="data-"+CT($G);function iL(n){return n.props[nL]}function XG({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function sL(n,e,{delay:t=0,transitionOverride:i,type:s}={}){let{transition:r=n.getDefaultTransition(),transitionEnd:o,...a}=e;i&&(r=i);const c=[],d=s&&n.animationState&&n.animationState.getState()[s];for(const h in a){const f=n.getValue(h,n.latestValues[h]??null),m=a[h];if(m===void 0||d&&XG(d,h))continue;const y={delay:t,...bT(r||{},h)},v=f.get();if(v!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===v&&!y.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const C=iL(n);if(C){const A=window.MotionHandoffAnimation(C,h,$e);A!==null&&(y.startTime=A,x=!0)}}qC(n,h),f.start(xT(h,f,m,n.shouldReduceMotion&&tL.has(h)?{type:!1}:y,n,x));const k=f.animation;k&&c.push(k)}return o&&Promise.all(c).then(()=>{$e.update(()=>{o&&qG(n,o)})}),c}function QC(n,e,t={}){var c;const i=Cu(n,e,t.type==="exit"?(c=n.presenceContext)==null?void 0:c.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const r=i?()=>Promise.all(sL(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(d=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=s;return YG(n,e,d,h,f,m,t)}:()=>Promise.resolve(),{when:a}=s;if(a){const[d,h]=a==="beforeChildren"?[r,o]:[o,r];return d().then(()=>h())}else return Promise.all([r(),o(t.delay)])}function YG(n,e,t=0,i=0,s=0,r=1,o){const a=[];for(const c of n.variantChildren)c.notify("AnimationStart",e),a.push(QC(c,e,{...o,delay:t+(typeof i=="function"?0:i)+eL(n.variantChildren,c,i,s,r)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(a)}function ZG(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const s=e.map(r=>QC(n,r,t));i=Promise.all(s)}else if(typeof e=="string")i=QC(n,e,t);else{const s=typeof e=="function"?Cu(n,e,t.custom):e;i=Promise.all(sL(n,s,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}const e7={test:n=>n==="auto",parse:n=>n},rL=n=>e=>e.test(n),oL=[md,me,sr,Qo,RH,MH,e7],vR=n=>oL.find(rL(n));function t7(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||SO(n):!0}const n7=new Set(["brightness","contrast","saturate","opacity"]);function i7(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(uT)||[];if(!i)return n;const s=t.replace(i,"");let r=n7.has(e)?1:0;return i!==t&&(r*=100),e+"("+r+s+")"}const s7=/\b([a-z-]*)\(.*?\)/gu,$C={...Pa,getAnimatableNone:n=>{const e=n.match(s7);return e?e.map(i7).join(" "):n}},bR={...md,transform:Math.round},r7={rotate:Qo,rotateX:Qo,rotateY:Qo,rotateZ:Qo,scale:Nm,scaleX:Nm,scaleY:Nm,scaleZ:Nm,skew:Qo,skewX:Qo,skewY:Qo,distance:me,translateX:me,translateY:me,translateZ:me,x:me,y:me,z:me,perspective:me,transformPerspective:me,opacity:Ef,originX:rR,originY:rR,originZ:me},kT={borderWidth:me,borderTopWidth:me,borderRightWidth:me,borderBottomWidth:me,borderLeftWidth:me,borderRadius:me,radius:me,borderTopLeftRadius:me,borderTopRightRadius:me,borderBottomRightRadius:me,borderBottomLeftRadius:me,width:me,maxWidth:me,height:me,maxHeight:me,top:me,right:me,bottom:me,left:me,inset:me,insetBlock:me,insetBlockStart:me,insetBlockEnd:me,insetInline:me,insetInlineStart:me,insetInlineEnd:me,padding:me,paddingTop:me,paddingRight:me,paddingBottom:me,paddingLeft:me,paddingBlock:me,paddingBlockStart:me,paddingBlockEnd:me,paddingInline:me,paddingInlineStart:me,paddingInlineEnd:me,margin:me,marginTop:me,marginRight:me,marginBottom:me,marginLeft:me,marginBlock:me,marginBlockStart:me,marginBlockEnd:me,marginInline:me,marginInlineStart:me,marginInlineEnd:me,backgroundPositionX:me,backgroundPositionY:me,...r7,zIndex:bR,fillOpacity:Ef,strokeOpacity:Ef,numOctaves:bR},o7={...kT,color:Kt,backgroundColor:Kt,outlineColor:Kt,fill:Kt,stroke:Kt,borderColor:Kt,borderTopColor:Kt,borderRightColor:Kt,borderBottomColor:Kt,borderLeftColor:Kt,filter:$C,WebkitFilter:$C},aL=n=>o7[n];function lL(n,e){let t=aL(n);return t!==$C&&(t=Pa),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const a7=new Set(["auto","none","0"]);function l7(n,e,t){let i=0,s;for(;i<n.length&&!s;){const r=n[i];typeof r=="string"&&!a7.has(r)&&_f(r).values.length&&(s=n[i]),i++}if(s&&t)for(const r of e)n[r]=lL(t,s)}class c7 extends vT{constructor(e,t,i,s,r){super(e,t,i,s,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let f=e[h];if(typeof f=="string"&&(f=f.trim(),cT(f))){const m=ZO(f,t.current);m!==void 0&&(e[h]=m),h===e.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!tL.has(i)||e.length!==2)return;const[s,r]=e,o=vR(s),a=vR(r),c=sR(s),d=sR(r);if(c!==d&&pa[i]){this.needsMeasurement=!0;return}if(o!==a)if(fR(o)&&fR(a))for(let h=0;h<e.length;h++){const f=e[h];typeof f=="string"&&(e[h]=parseFloat(f))}else pa[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let s=0;s<e.length;s++)(e[s]===null||t7(e[s]))&&i.push(s);i.length&&l7(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=pa[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const s=t[t.length-1];s!==void 0&&e.getValue(i,s).jump(s,!1)}measureEndState(){var a;const{element:e,name:t,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const s=e.getValue(t);s&&s.jump(this.measuredOrigin,!1);const r=i.length-1,o=i[r];i[r]=pa[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([c,d])=>{e.getValue(c).set(d)}),this.resolveNoneKeyframes()}}function wT(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){const s=document.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}const cL=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function TT(n){return xO(n)&&"offsetHeight"in n}const{schedule:AT}=IO(queueMicrotask,!1),gs={x:!1,y:!1};function uL(){return gs.x||gs.y}function u7(n){return n==="x"||n==="y"?gs[n]?null:(gs[n]=!0,()=>{gs[n]=!1}):gs.x||gs.y?null:(gs.x=gs.y=!0,()=>{gs.x=gs.y=!1})}function dL(n,e){const t=wT(n),i=new AbortController,s={passive:!0,...e,signal:i.signal};return[t,s,()=>i.abort()]}function xR(n){return!(n.pointerType==="touch"||uL())}function d7(n,e,t={}){const[i,s,r]=dL(n,t),o=a=>{if(!xR(a))return;const{target:c}=a,d=e(c,a);if(typeof d!="function"||!c)return;const h=f=>{xR(f)&&(d(f),c.removeEventListener("pointerleave",h))};c.addEventListener("pointerleave",h,s)};return i.forEach(a=>{a.addEventListener("pointerenter",o,s)}),r}const hL=(n,e)=>e?n===e?!0:hL(n,e.parentElement):!1,ET=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,h7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function fL(n){return h7.has(n.tagName)||n.isContentEditable===!0}const Bg=new WeakSet;function SR(n){return e=>{e.key==="Enter"&&n(e)}}function cx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const f7=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=SR(()=>{if(Bg.has(t))return;cx(t,"down");const s=SR(()=>{cx(t,"up")}),r=()=>cx(t,"cancel");t.addEventListener("keyup",s,e),t.addEventListener("blur",r,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function CR(n){return ET(n)&&!uL()}function p7(n,e,t={}){const[i,s,r]=dL(n,t),o=a=>{const c=a.currentTarget;if(!CR(a))return;Bg.add(c);const d=e(c,a),h=(y,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),Bg.has(c)&&Bg.delete(c),CR(y)&&typeof d=="function"&&d(y,{success:v})},f=y=>{h(y,c===window||c===document||t.useGlobalTarget||hL(c,y.target))},m=y=>{h(y,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",m,s)};return i.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),TT(a)&&(a.addEventListener("focus",d=>f7(d,s)),!fL(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),r}function _T(n){return xO(n)&&"ownerSVGElement"in n}const Dg=new WeakMap;let $o;const pL=(n,e,t)=>(i,s)=>s&&s[0]?s[0][n+"Size"]:_T(i)&&"getBBox"in i?i.getBBox()[e]:i[t],m7=pL("inline","width","offsetWidth"),g7=pL("block","height","offsetHeight");function y7({target:n,borderBoxSize:e}){var t;(t=Dg.get(n))==null||t.forEach(i=>{i(n,{get width(){return m7(n,e)},get height(){return g7(n,e)}})})}function v7(n){n.forEach(y7)}function b7(){typeof ResizeObserver>"u"||($o=new ResizeObserver(v7))}function x7(n,e){$o||b7();const t=wT(n);return t.forEach(i=>{let s=Dg.get(i);s||(s=new Set,Dg.set(i,s)),s.add(e),$o==null||$o.observe(i)}),()=>{t.forEach(i=>{const s=Dg.get(i);s==null||s.delete(e),s!=null&&s.size||$o==null||$o.unobserve(i)})}}const Ng=new Set;let lu;function S7(){lu=()=>{const n={get width(){return window.innerWidth},get height(){return window.innerHeight}};Ng.forEach(e=>e(n))},window.addEventListener("resize",lu)}function C7(n){return Ng.add(n),lu||S7(),()=>{Ng.delete(n),!Ng.size&&typeof lu=="function"&&(window.removeEventListener("resize",lu),lu=void 0)}}function k7(n,e){return typeof n=="function"?C7(n):x7(n,e)}function mL(n,e){let t;const i=()=>{const{currentTime:s}=e,o=(s===null?0:s.value)/100;t!==o&&n(o),t=o};return $e.preUpdate(i,!0),()=>Ls(i)}function w7(n){return _T(n)&&n.tagName==="svg"}function T7(...n){const e=!Array.isArray(n[0]),t=e?0:-1,i=n[0+t],s=n[1+t],r=n[2+t],o=n[3+t],a=pT(s,r,o);return e?a(i):a}const A7=[...oL,Kt,Pa],E7=n=>A7.find(rL(n)),kR=()=>({translate:0,scale:1,origin:0,originPoint:0}),cu=()=>({x:kR(),y:kR()}),wR=()=>({min:0,max:0}),en=()=>({x:wR(),y:wR()}),XC={current:null},gL={current:!1},_7=typeof window<"u";function M7(){if(gL.current=!0,!!_7)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>XC.current=n.matches;n.addEventListener("change",e),e()}else XC.current=!1}const R7=new WeakMap;function bv(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Mf(n){return typeof n=="string"||Array.isArray(n)}const MT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],RT=["initial",...MT];function xv(n){return bv(n.animate)||RT.some(e=>Mf(n[e]))}function yL(n){return!!(xv(n)||n.variants)}function P7(n,e,t){for(const i in e){const s=e[i],r=t[i];if(Fn(s))n.addValue(i,s);else if(Fn(r))n.addValue(i,Ms(s,{owner:n}));else if(r!==s)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=n.getStaticValue(i);n.addValue(i,Ms(o!==void 0?o:s,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const TR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Ry={};function vL(n){Ry=n}function I7(){return Ry}class B7{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:s,blockInitialAnimation:r,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=vT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Kn.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,$e.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!r,this.isControllingVariants=xv(t),this.isVariantNode=yL(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in f){const y=f[m];c[m]!==void 0&&Fn(y)&&y.set(c[m])}}mount(e){var t;this.current=e,R7.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,s)=>this.bindToMotionValue(s,i)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(gL.current||M7(),this.shouldReduceMotion=XC.current),(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Ls(this.notifyUpdate),Ls(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=yd.has(e);i&&this.onBindTransform&&this.onBindTransform();const s=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&$e.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let r;typeof window<"u"&&window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ry){const t=Ry[e];if(!t)continue;const{isEnabled:i,Feature:s}=t;if(!this.features[e]&&s&&i(this.props)&&(this.features[e]=new s(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):en()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<TR.length;i++){const s=TR[i];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const r="on"+s,o=e[r];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=P7(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=Ms(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(bO(i)||SO(i))?i=parseFloat(i):!E7(i)&&Pa.test(t)&&(i=lL(e,t)),this.setBaseTarget(e,Fn(i)?i.get():i)),Fn(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var r;const{initial:t}=this.props;let i;if(typeof t=="string"||typeof t=="object"){const o=ST(this.props,t,(r=this.presenceContext)==null?void 0:r.custom);o&&(i=o[e])}if(t&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Fn(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new rT),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){AT.render(this.render)}}class La{constructor(e){this.isMounted=!1,this.node=e}update(){}}class bL extends B7{constructor(){super(...arguments),this.KeyframeResolver=c7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){const i=e.style;return i?i[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Fn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function xL({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function D7({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function N7(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function ux(n){return n===void 0||n===1}function YC({scale:n,scaleX:e,scaleY:t}){return!ux(n)||!ux(e)||!ux(t)}function pl(n){return YC(n)||SL(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function SL(n){return AR(n.x)||AR(n.y)}function AR(n){return n&&n!=="0%"}function Py(n,e,t){const i=n-t,s=e*i;return t+s}function ER(n,e,t,i,s){return s!==void 0&&(n=Py(n,s,i)),Py(n,t,i)+e}function ZC(n,e=0,t=1,i,s){n.min=ER(n.min,e,t,i,s),n.max=ER(n.max,e,t,i,s)}function CL(n,{x:e,y:t}){ZC(n.x,e.translate,e.scale,e.originPoint),ZC(n.y,t.translate,t.scale,t.originPoint)}const _R=.999999999999,MR=1.0000000000001;function F7(n,e,t,i=!1){const s=t.length;if(!s)return;e.x=e.y=1;let r,o;for(let a=0;a<s;a++){r=t[a],o=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&r.options.layoutScroll&&r.scroll&&r!==r.root&&du(n,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,CL(n,o)),i&&pl(r.latestValues)&&du(n,r.latestValues))}e.x<MR&&e.x>_R&&(e.x=1),e.y<MR&&e.y>_R&&(e.y=1)}function uu(n,e){n.min=n.min+e,n.max=n.max+e}function RR(n,e,t,i,s=.5){const r=Ct(n.min,n.max,s);ZC(n,e,t,r,i)}function du(n,e){RR(n.x,e.x,e.scaleX,e.scale,e.originX),RR(n.y,e.y,e.scaleY,e.scale,e.originY)}function kL(n,e){return xL(N7(n.getBoundingClientRect(),e))}function O7(n,e,t){const i=kL(n,t),{scroll:s}=e;return s&&(uu(i.x,s.offset.x),uu(i.y,s.offset.y)),i}const L7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},j7=gd.length;function U7(n,e,t){let i="",s=!0;for(let r=0;r<j7;r++){const o=gd[r],a=n[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const d=cL(a,kT[o]);if(!c){s=!1;const h=L7[o]||o;i+=`${h}(${d}) `}t&&(e[o]=d)}}return i=i.trim(),t?i=t(e,s?"":i):s&&(i="none"),i}function PT(n,e,t){const{style:i,vars:s,transformOrigin:r}=n;let o=!1,a=!1;for(const c in e){const d=e[c];if(yd.has(c)){o=!0;continue}else if(DO(c)){s[c]=d;continue}else{const h=cL(d,kT[c]);c.startsWith("origin")?(a=!0,r[c]=h):i[c]=h}}if(e.transform||(o||t?i.transform=U7(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:d="50%",originZ:h=0}=r;i.transformOrigin=`${c} ${d} ${h}`}}function wL(n,{style:e,vars:t},i,s){const r=n.style;let o;for(o in e)r[o]=e[o];s==null||s.applyProjectionStyles(r,i);for(o in t)r.setProperty(o,t[o])}function PR(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const lh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(me.test(n))n=parseFloat(n);else return n;const t=PR(n,e.target.x),i=PR(n,e.target.y);return`${t}% ${i}%`}},z7={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,s=Pa.parse(n);if(s.length>5)return i;const r=Pa.createTransformer(n),o=typeof s[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;s[0+o]/=a,s[1+o]/=c;const d=Ct(a,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=d),typeof s[3+o]=="number"&&(s[3+o]/=d),r(s)}},ek={borderRadius:{...lh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:lh,borderTopRightRadius:lh,borderBottomLeftRadius:lh,borderBottomRightRadius:lh,boxShadow:z7};function TL(n,{layout:e,layoutId:t}){return yd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!ek[n]||n==="opacity")}function IT(n,e,t){var o;const i=n.style,s=e==null?void 0:e.style,r={};if(!i)return r;for(const a in i)(Fn(i[a])||s&&Fn(s[a])||TL(a,n)||((o=t==null?void 0:t.getValue(a))==null?void 0:o.liveStyle)!==void 0)&&(r[a]=i[a]);return r}function V7(n){return window.getComputedStyle(n)}class H7 extends bL{constructor(){super(...arguments),this.type="html",this.renderInstance=wL}readValueFromInstance(e,t){var i;if(yd.has(t))return(i=this.projection)!=null&&i.isProjecting?zC(t):dG(e,t);{const s=V7(e),r=(DO(t)?s.getPropertyValue(t):s[t])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return kL(e,t)}build(e,t,i){PT(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return IT(e,t,i)}}const G7={offset:"stroke-dashoffset",array:"stroke-dasharray"},W7={offset:"strokeDashoffset",array:"strokeDasharray"};function J7(n,e,t=1,i=0,s=!0){n.pathLength=1;const r=s?G7:W7;n[r.offset]=me.transform(-i);const o=me.transform(e),a=me.transform(t);n[r.array]=`${o} ${a}`}const K7=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function AL(n,{attrX:e,attrY:t,attrScale:i,pathLength:s,pathSpacing:r=1,pathOffset:o=0,...a},c,d,h){if(PT(n,a,d),c){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:f,style:m}=n;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete f.transformBox);for(const y of K7)f[y]!==void 0&&(m[y]=f[y],delete f[y]);e!==void 0&&(f.x=e),t!==void 0&&(f.y=t),i!==void 0&&(f.scale=i),s!==void 0&&J7(f,s,r,o,!1)}const EL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),_L=n=>typeof n=="string"&&n.toLowerCase()==="svg";function q7(n,e,t,i){wL(n,e,void 0,i);for(const s in e.attrs)n.setAttribute(EL.has(s)?s:CT(s),e.attrs[s])}function ML(n,e,t){const i=IT(n,e,t);for(const s in n)if(Fn(n[s])||Fn(e[s])){const r=gd.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;i[r]=n[s]}return i}class Q7 extends bL{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=en}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(yd.has(t)){const i=aL(t);return i&&i.default||0}return t=EL.has(t)?t:CT(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return ML(e,t,i)}build(e,t,i){AL(e,t,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,t,i,s){q7(e,t,i,s)}mount(e){this.isSVGTag=_L(e.tagName),super.mount(e)}}const $7=RT.length;function RL(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?RL(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<$7;t++){const i=RT[t],s=n.props[i];(Mf(s)||s===!1)&&(e[i]=s)}return e}function PL(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}const X7=[...MT].reverse(),Y7=MT.length;function Z7(n){return e=>Promise.all(e.map(({animation:t,options:i})=>ZG(n,t,i)))}function eW(n){let e=Z7(n),t=IR(),i=!0;const s=c=>(d,h)=>{var m;const f=Cu(n,h,c==="exit"?(m=n.presenceContext)==null?void 0:m.custom:void 0);if(f){const{transition:y,transitionEnd:v,...x}=f;d={...d,...x,...v}}return d};function r(c){e=c(n)}function o(c){const{props:d}=n,h=RL(n.parent)||{},f=[],m=new Set;let y={},v=1/0;for(let k=0;k<Y7;k++){const C=X7[k],A=t[C],T=d[C]!==void 0?d[C]:h[C],E=Mf(T),_=C===c?A.isActive:null;_===!1&&(v=k);let R=T===h[C]&&T!==d[C]&&E;if(R&&i&&n.manuallyAnimateOnMount&&(R=!1),A.protectedKeys={...y},!A.isActive&&_===null||!T&&!A.prevProp||bv(T)||typeof T=="boolean")continue;const B=tW(A.prevProp,T);let I=B||C===c&&A.isActive&&!R&&E||k>v&&E,L=!1;const O=Array.isArray(T)?T:[T];let W=O.reduce(s(C),{});_===!1&&(W={});const{prevResolvedValues:ie={}}=A,he={...ie,...W},ae=ee=>{I=!0,m.has(ee)&&(L=!0,m.delete(ee)),A.needsAnimating[ee]=!0;const z=n.getValue(ee);z&&(z.liveStyle=!1)};for(const ee in he){const z=W[ee],X=ie[ee];if(y.hasOwnProperty(ee))continue;let te=!1;KC(z)&&KC(X)?te=!PL(z,X):te=z!==X,te?z!=null?ae(ee):m.add(ee):z!==void 0&&m.has(ee)?ae(ee):A.protectedKeys[ee]=!0}A.prevProp=T,A.prevResolvedValues=W,A.isActive&&(y={...y,...W}),i&&n.blockInitialAnimation&&(I=!1);const le=R&&B;I&&(!le||L)&&f.push(...O.map(ee=>{const z={type:C};if(typeof ee=="string"&&i&&!le&&n.manuallyAnimateOnMount&&n.parent){const{parent:X}=n,te=Cu(X,ee);if(X.enteringChildren&&te){const{delayChildren:ye}=te.transition||{};z.delay=eL(X.enteringChildren,n,ye)}}return{animation:ee,options:z}}))}if(m.size){const k={};if(typeof d.initial!="boolean"){const C=Cu(n,Array.isArray(d.initial)?d.initial[0]:d.initial);C&&C.transition&&(k.transition=C.transition)}m.forEach(C=>{const A=n.getBaseTarget(C),T=n.getValue(C);T&&(T.liveStyle=!0),k[C]=A??null}),f.push({animation:k})}let x=!!f.length;return i&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(x=!1),i=!1,x?e(f):Promise.resolve()}function a(c,d){var f;if(t[c].isActive===d)return Promise.resolve();(f=n.variantChildren)==null||f.forEach(m=>{var y;return(y=m.animationState)==null?void 0:y.setActive(c,d)}),t[c].isActive=d;const h=o(c);for(const m in t)t[m].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:r,getState:()=>t,reset:()=>{t=IR()}}}function tW(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!PL(e,n):!1}function ol(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function IR(){return{animate:ol(!0),whileInView:ol(),whileHover:ol(),whileTap:ol(),whileDrag:ol(),whileFocus:ol(),exit:ol()}}const IL=1e-4,nW=1-IL,iW=1+IL,BL=.01,sW=0-BL,rW=0+BL;function qn(n){return n.max-n.min}function oW(n,e,t){return Math.abs(n-e)<=t}function BR(n,e,t,i=.5){n.origin=i,n.originPoint=Ct(e.min,e.max,n.origin),n.scale=qn(t)/qn(e),n.translate=Ct(t.min,t.max,n.origin)-n.originPoint,(n.scale>=nW&&n.scale<=iW||isNaN(n.scale))&&(n.scale=1),(n.translate>=sW&&n.translate<=rW||isNaN(n.translate))&&(n.translate=0)}function Qh(n,e,t,i){BR(n.x,e.x,t.x,i?i.originX:void 0),BR(n.y,e.y,t.y,i?i.originY:void 0)}function DR(n,e,t){n.min=t.min+e.min,n.max=n.min+qn(e)}function aW(n,e,t){DR(n.x,e.x,t.x),DR(n.y,e.y,t.y)}function NR(n,e,t){n.min=e.min-t.min,n.max=n.min+qn(e)}function Iy(n,e,t){NR(n.x,e.x,t.x),NR(n.y,e.y,t.y)}function FR(n,e,t,i,s){return n-=e,n=Py(n,1/t,i),s!==void 0&&(n=Py(n,1/s,i)),n}function lW(n,e=0,t=1,i=.5,s,r=n,o=n){if(sr.test(e)&&(e=parseFloat(e),e=Ct(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Ct(r.min,r.max,i);n===r&&(a-=e),n.min=FR(n.min,e,t,a,s),n.max=FR(n.max,e,t,a,s)}function OR(n,e,[t,i,s],r,o){lW(n,e[t],e[i],e[s],e.scale,r,o)}const cW=["x","scaleX","originX"],uW=["y","scaleY","originY"];function LR(n,e,t,i){OR(n.x,e,cW,t?t.x:void 0,i?i.x:void 0),OR(n.y,e,uW,t?t.y:void 0,i?i.y:void 0)}function jR(n,e){n.min=e.min,n.max=e.max}function us(n,e){jR(n.x,e.x),jR(n.y,e.y)}function UR(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function zR(n){return n.translate===0&&n.scale===1}function DL(n){return zR(n.x)&&zR(n.y)}function VR(n,e){return n.min===e.min&&n.max===e.max}function dW(n,e){return VR(n.x,e.x)&&VR(n.y,e.y)}function HR(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function NL(n,e){return HR(n.x,e.x)&&HR(n.y,e.y)}function GR(n){return qn(n.x)/qn(n.y)}function WR(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}function Vi(n){return[n("x"),n("y")]}function hW(n,e,t){let i="";const s=n.x.translate/e.x,r=n.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((s||r||o)&&(i=`translate3d(${s}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:f,rotateY:m,skewX:y,skewY:v}=t;d&&(i=`perspective(${d}px) ${i}`),h&&(i+=`rotate(${h}deg) `),f&&(i+=`rotateX(${f}deg) `),m&&(i+=`rotateY(${m}deg) `),y&&(i+=`skewX(${y}deg) `),v&&(i+=`skewY(${v}deg) `)}const a=n.x.scale*e.x,c=n.y.scale*e.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const FL=["TopLeft","TopRight","BottomLeft","BottomRight"],fW=FL.length,JR=n=>typeof n=="string"?parseFloat(n):n,KR=n=>typeof n=="number"||me.test(n);function pW(n,e,t,i,s,r){s?(n.opacity=Ct(0,t.opacity??1,mW(i)),n.opacityExit=Ct(e.opacity??1,0,gW(i))):r&&(n.opacity=Ct(e.opacity??1,t.opacity??1,i));for(let o=0;o<fW;o++){const a=`border${FL[o]}Radius`;let c=qR(e,a),d=qR(t,a);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||KR(c)===KR(d)?(n[a]=Math.max(Ct(JR(c),JR(d),i),0),(sr.test(d)||sr.test(c))&&(n[a]+="%")):n[a]=d}(e.rotate||t.rotate)&&(n.rotate=Ct(e.rotate||0,t.rotate||0,i))}function qR(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const mW=OL(0,.5,_O),gW=OL(.5,.95,pi);function OL(n,e,t){return i=>i<n?0:i>e?1:t(Zu(n,e,i))}function yW(n,e){const t=Kn.now(),i=({timestamp:s})=>{const r=s-t;r>=e&&(Ls(i),n(r-e))};return $e.setup(i,!0),()=>Ls(i)}function Rf(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Fg(n){return Fn(n)?n.get():n}function vW(n,e,t){const i=Fn(n)?n:Ms(n);return i.start(xT("",i,e,t)),i.animation}const bW=(n,e)=>n.depth-e.depth;class xW{constructor(){this.children=[],this.isDirty=!1}add(e){nT(this.children,e),this.isDirty=!0}remove(e){iT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(bW),this.isDirty=!1,this.children.forEach(e)}}class SW{constructor(){this.members=[]}add(e){nT(this.members,e),e.scheduleRender()}remove(e){if(iT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let i;for(let s=t;s>=0;s--){const r=this.members[s];if(r.isPresent!==!1){i=r;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Og={hasAnimatedSinceResize:!0,hasEverUpdated:!1},dx=["","X","Y","Z"],CW=1e3;let kW=0;function hx(n,e,t,i){const{latestValues:s}=e;s[n]&&(t[n]=s[n],e.setStaticValue(n,0),i&&(i[n]=0))}function LL(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=iL(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:s,layoutId:r}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",$e,!(s||r))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&LL(i)}function jL({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:s}){return class{constructor(o={},a=e==null?void 0:e()){this.id=kW++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(AW),this.nodes.forEach(RW),this.nodes.forEach(PW),this.nodes.forEach(EW)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new xW)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new rT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=_T(o)&&!w7(o),this.instance=o;const{layoutId:a,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||a)&&(this.isLayoutDirty=!0),n){let h,f=0;const m=()=>this.root.updateBlockedByResize=!1;$e.read(()=>{f=window.innerWidth}),n(o,()=>{const y=window.innerWidth;y!==f&&(f=y,this.root.updateBlockedByResize=!0,h&&h(),h=yW(m,250),Og.hasAnimatedSinceResize&&(Og.hasAnimatedSinceResize=!1,this.nodes.forEach(XR)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&d&&(a||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||d.getDefaultTransition()||FW,{onLayoutAnimationStart:x,onLayoutAnimationComplete:k}=d.getProps(),C=!this.targetLayout||!NL(this.targetLayout,y),A=!f&&m;if(this.options.layoutRoot||this.resumeFrom||A||f&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const T={...bT(v,"layout"),onPlay:x,onComplete:k};(d.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T),this.setAnimationOrigin(h,A)}else f||XR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ls(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(IW),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&LL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(QR);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach($R);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(MW),this.nodes.forEach(wW),this.nodes.forEach(TW)):this.nodes.forEach($R),this.clearAllSnapshots();const a=Kn.now();fn.delta=Os(0,1e3/60,a-fn.timestamp),fn.timestamp=a,fn.isProcessing=!0,ix.update.process(fn),ix.preRender.process(fn),ix.render.process(fn),fn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,AT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_W),this.sharedNodes.forEach(BW)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$e.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$e.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!qn(this.snapshot.measuredBox.x)&&!qn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=en(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!DL(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(a||pl(this.latestValues)||h)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),OW(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:o}=this.options;if(!o)return en();const a=o.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(LW))){const{scroll:h}=this.root;h&&(uu(a.x,h.offset.x),uu(a.y,h.offset.y))}return a}removeElementScroll(o){var c;const a=en();if(us(a,o),(c=this.scroll)!=null&&c.wasRoot)return a;for(let d=0;d<this.path.length;d++){const h=this.path[d],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&us(a,o),uu(a.x,f.offset.x),uu(a.y,f.offset.y))}return a}applyTransform(o,a=!1){const c=en();us(c,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&du(c,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),pl(h.latestValues)&&du(c,h.latestValues)}return pl(this.latestValues)&&du(c,this.latestValues),c}removeTransform(o){const a=en();us(a,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!pl(d.latestValues))continue;YC(d.latestValues)&&d.updateSnapshot();const h=en(),f=d.measurePageBox();us(h,f),LR(a,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return pl(this.latestValues)&&LR(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var y;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==a;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!this.layout||!(h||f))return;this.resolvedRelativeTargetAt=fn.timestamp;const m=this.getClosestProjectingParent();m&&this.linkedParentVersion!==m.layoutVersion&&!m.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(m&&m.layout?this.createRelativeTarget(m,this.layout.layoutBox,m.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=en(),this.targetWithTransforms=en()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aW(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):us(this.target,this.layout.layoutBox),CL(this.target,this.targetDelta)):us(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?this.createRelativeTarget(m,this.target,m.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||YC(this.parent.latestValues)||SL(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),Iy(this.relativeTargetOrigin,a,c),us(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var v;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty)&&(c=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===fn.timestamp&&(c=!1),c)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;us(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;F7(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=en());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(UR(this.prevProjectionDelta.x,this.projectionDelta.x),UR(this.prevProjectionDelta.y,this.projectionDelta.y)),Qh(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!WR(this.projectionDelta.x,this.prevProjectionDelta.x)||!WR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=cu(),this.projectionDelta=cu(),this.projectionDeltaWithTransform=cu()}setAnimationOrigin(o,a=!1){const c=this.snapshot,d=c?c.latestValues:{},h={...this.latestValues},f=cu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const m=en(),y=c?c.source:void 0,v=this.layout?this.layout.source:void 0,x=y!==v,k=this.getStack(),C=!k||k.members.length<=1,A=!!(x&&!C&&this.options.crossfade===!0&&!this.path.some(NW));this.animationProgress=0;let T;this.mixTargetDelta=E=>{const _=E/1e3;YR(f.x,o.x,_),YR(f.y,o.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Iy(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),DW(this.relativeTarget,this.relativeTargetOrigin,m,_),T&&dW(this.relativeTarget,T)&&(this.isProjectionDirty=!1),T||(T=en()),us(T,this.relativeTarget)),x&&(this.animationValues=h,pW(h,d,this.latestValues,_,A,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,c,d;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(d=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||d.stop(),this.pendingAnimation&&(Ls(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$e.update(()=>{Og.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ms(0)),this.currentAnimation=vW(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),o.onUpdate&&o.onUpdate(h)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(CW),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:d,latestValues:h}=o;if(!(!a||!c||!d)){if(this!==o&&this.layout&&d&&UL(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||en();const f=qn(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+f;const m=qn(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}us(a,c),du(a,h),Qh(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new SW),this.sharedNodes.get(o).add(a);const d=a.options.initialPromotionConfig;a.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const d={};c.z&&hx("z",o,d,this.animationValues);for(let h=0;h<dx.length;h++)hx(`rotate${dx[h]}`,o,d,this.animationValues),hx(`skew${dx[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Fg(a==null?void 0:a.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Fg(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!pl(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let f=hW(this.projectionDeltaWithTransform,this.treeScale,h);c&&(f=c(h,f)),o.transform=f;const{x:m,y}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${y.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const v in ek){if(h[v]===void 0)continue;const{correct:x,applyTo:k,isCSSVariable:C}=ek[v],A=f==="none"?h[v]:x(h[v],d);if(k){const T=k.length;for(let E=0;E<T;E++)o[k[E]]=A}else C?this.options.visualElement.renderState.vars[v]=A:o[v]=A}this.options.layoutId&&(o.pointerEvents=d===this?Fg(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(QR),this.root.sharedNodes.clear()}}}function wW(n){n.updateLayout()}function TW(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:s}=n.layout,{animationType:r}=n.options,o=e.source!==n.layout.source;r==="size"?Vi(f=>{const m=o?e.measuredBox[f]:e.layoutBox[f],y=qn(m);m.min=i[f].min,m.max=m.min+y}):UL(r,e.layoutBox,i)&&Vi(f=>{const m=o?e.measuredBox[f]:e.layoutBox[f],y=qn(i[f]);m.max=m.min+y,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+y)});const a=cu();Qh(a,i,e.layoutBox);const c=cu();o?Qh(c,n.applyTransform(s,!0),e.measuredBox):Qh(c,i,e.layoutBox);const d=!DL(a);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:y}=f;if(m&&y){const v=en();Iy(v,e.layoutBox,m.layoutBox);const x=en();Iy(x,i,y.layoutBox),NL(v,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=v,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:e,delta:c,layoutDelta:a,hasLayoutChanged:d,hasRelativeLayoutChanged:h})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function AW(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function EW(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function _W(n){n.clearSnapshot()}function QR(n){n.clearMeasurements()}function $R(n){n.isLayoutDirty=!1}function MW(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function XR(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function RW(n){n.resolveTargetDelta()}function PW(n){n.calcProjection()}function IW(n){n.resetSkewAndRotation()}function BW(n){n.removeLeadSnapshot()}function YR(n,e,t){n.translate=Ct(e.translate,0,t),n.scale=Ct(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function ZR(n,e,t,i){n.min=Ct(e.min,t.min,i),n.max=Ct(e.max,t.max,i)}function DW(n,e,t,i){ZR(n.x,e.x,t.x,i),ZR(n.y,e.y,t.y,i)}function NW(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const FW={duration:.45,ease:[.4,0,.1,1]},eP=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),tP=eP("applewebkit/")&&!eP("chrome/")?Math.round:pi;function nP(n){n.min=tP(n.min),n.max=tP(n.max)}function OW(n){nP(n.x),nP(n.y)}function UL(n,e,t){return n==="position"||n==="preserve-aspect"&&!oW(GR(e),GR(t),.2)}function LW(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const jW=jL({attachResizeListener:(n,e)=>Rf(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),fx={current:void 0},zL=jL({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!fx.current){const n=new jW({});n.mount(window),n.setOptions({layoutScroll:!0}),fx.current=n}return fx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Sv=P.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function iP(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function UW(...n){return e=>{let t=!1;const i=n.map(s=>{const r=iP(s,e);return!t&&typeof r=="function"&&(t=!0),r});if(t)return()=>{for(let s=0;s<i.length;s++){const r=i[s];typeof r=="function"?r():iP(n[s],null)}}}}function zW(...n){return P.useCallback(UW(...n),n)}class VW extends P.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=t.offsetParent,s=TT(i)&&i.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function HW({children:n,isPresent:e,anchorX:t,root:i}){var h;const s=P.useId(),r=P.useRef(null),o=P.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=P.useContext(Sv),c=((h=n.props)==null?void 0:h.ref)??(n==null?void 0:n.ref),d=zW(r,c);return P.useInsertionEffect(()=>{const{width:f,height:m,top:y,left:v,right:x}=o.current;if(e||!r.current||!f||!m)return;const k=t==="left"?`left: ${v}`:`right: ${x}`;r.current.dataset.motionPopId=s;const C=document.createElement("style");a&&(C.nonce=a);const A=i??document.head;return A.appendChild(C),C.sheet&&C.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${m}px !important;
            ${k}px !important;
            top: ${y}px !important;
          }
        `),()=>{A.contains(C)&&A.removeChild(C)}},[e]),S.jsx(VW,{isPresent:e,childRef:r,sizeRef:o,children:P.cloneElement(n,{ref:d})})}const GW=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:s,presenceAffectsLayout:r,mode:o,anchorX:a,root:c})=>{const d=Ra(WW),h=P.useId();let f=!0,m=P.useMemo(()=>(f=!1,{id:h,initial:e,isPresent:t,custom:s,onExitComplete:y=>{d.set(y,!0);for(const v of d.values())if(!v)return;i&&i()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[t,d,i]);return r&&f&&(m={...m}),P.useMemo(()=>{d.forEach((y,v)=>d.set(v,!1))},[t]),P.useEffect(()=>{!t&&!d.size&&i&&i()},[t]),o==="popLayout"&&(n=S.jsx(HW,{isPresent:t,anchorX:a,root:c,children:n})),S.jsx(vv.Provider,{value:m,children:n})};function WW(){return new Map}function VL(n=!0){const e=P.useContext(vv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:s}=e,r=P.useId();P.useEffect(()=>{if(n)return s(r)},[n]);const o=P.useCallback(()=>n&&i&&i(r),[r,i,n]);return!t&&i?[!1,o]:[!0]}const Fm=n=>n.key||"";function sP(n){const e=[];return P.Children.forEach(n,t=>{P.isValidElement(t)&&e.push(t)}),e}const BT=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:s=!0,mode:r="sync",propagate:o=!1,anchorX:a="left",root:c})=>{const[d,h]=VL(o),f=P.useMemo(()=>sP(n),[n]),m=o&&!d?[]:f.map(Fm),y=P.useRef(!0),v=P.useRef(f),x=Ra(()=>new Map),k=P.useRef(new Set),[C,A]=P.useState(f),[T,E]=P.useState(f);yv(()=>{y.current=!1,v.current=f;for(let B=0;B<T.length;B++){const I=Fm(T[B]);m.includes(I)?(x.delete(I),k.current.delete(I)):x.get(I)!==!0&&x.set(I,!1)}},[T,m.length,m.join("-")]);const _=[];if(f!==C){let B=[...f];for(let I=0;I<T.length;I++){const L=T[I],O=Fm(L);m.includes(O)||(B.splice(I,0,L),_.push(L))}return r==="wait"&&_.length&&(B=_),E(sP(B)),A(f),null}const{forceRender:R}=P.useContext(tT);return S.jsx(S.Fragment,{children:T.map(B=>{const I=Fm(B),L=o&&!d?!1:f===T||m.includes(I),O=()=>{if(k.current.has(I))return;if(k.current.add(I),x.has(I))x.set(I,!0);else return;let W=!0;x.forEach(ie=>{ie||(W=!1)}),W&&(R==null||R(),E(v.current),o&&(h==null||h()),i&&i())};return S.jsx(GW,{isPresent:L,initial:!y.current||t?void 0:!1,custom:e,presenceAffectsLayout:s,mode:r,root:c,onExitComplete:L?void 0:O,anchorX:a,children:B},I)})})},HL=P.createContext({strict:!1}),rP={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let oP=!1;function JW(){if(oP)return;const n={};for(const e in rP)n[e]={isEnabled:t=>rP[e].some(i=>!!t[i])};vL(n),oP=!0}function GL(){return JW(),I7()}function KW(n){const e=GL();for(const t in n)e[t]={...e[t],...n[t]};vL(e)}const qW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function By(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||qW.has(n)}let WL=n=>!By(n);function QW(n){typeof n=="function"&&(WL=e=>e.startsWith("on")?!By(e):n(e))}try{QW(require("@emotion/is-prop-valid").default)}catch{}function $W(n,e,t){const i={};for(const s in n)s==="values"&&typeof n.values=="object"||(WL(s)||t===!0&&By(s)||!e&&!By(s)||n.draggable&&s.startsWith("onDrag"))&&(i[s]=n[s]);return i}const Cv=P.createContext({});function XW(n,e){if(xv(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Mf(t)?t:void 0,animate:Mf(i)?i:void 0}}return n.inherit!==!1?e:{}}function YW(n){const{initial:e,animate:t}=XW(n,P.useContext(Cv));return P.useMemo(()=>({initial:e,animate:t}),[aP(e),aP(t)])}function aP(n){return Array.isArray(n)?n.join(" "):n}const DT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function JL(n,e,t){for(const i in e)!Fn(e[i])&&!TL(i,t)&&(n[i]=e[i])}function ZW({transformTemplate:n},e){return P.useMemo(()=>{const t=DT();return PT(t,e,n),Object.assign({},t.vars,t.style)},[e])}function eJ(n,e){const t=n.style||{},i={};return JL(i,t,n),Object.assign(i,ZW(n,e)),i}function tJ(n,e){const t={},i=eJ(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}const KL=()=>({...DT(),attrs:{}});function nJ(n,e,t,i){const s=P.useMemo(()=>{const r=KL();return AL(r,e,_L(i),n.transformTemplate,n.style),{...r.attrs,style:{...r.style}}},[e]);if(n.style){const r={};JL(r,n.style,n),s.style={...r,...s.style}}return s}const iJ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function NT(n){return typeof n!="string"||n.includes("-")?!1:!!(iJ.indexOf(n)>-1||/[A-Z]/u.test(n))}function sJ(n,e,t,{latestValues:i},s,r=!1,o){const c=(o??NT(n)?nJ:tJ)(e,i,s,n),d=$W(e,typeof n=="string",r),h=n!==P.Fragment?{...d,...c,ref:t}:{},{children:f}=e,m=P.useMemo(()=>Fn(f)?f.get():f,[f]);return P.createElement(n,{...h,children:m})}function rJ({scrapeMotionValuesFromProps:n,createRenderState:e},t,i,s){return{latestValues:oJ(t,i,s,n),renderState:e()}}function oJ(n,e,t,i){const s={},r=i(n,{});for(const m in r)s[m]=Fg(r[m]);let{initial:o,animate:a}=n;const c=xv(n),d=yL(n);e&&d&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const f=h?a:o;if(f&&typeof f!="boolean"&&!bv(f)){const m=Array.isArray(f)?f:[f];for(let y=0;y<m.length;y++){const v=ST(n,m[y]);if(v){const{transitionEnd:x,transition:k,...C}=v;for(const A in C){let T=C[A];if(Array.isArray(T)){const E=h?T.length-1:0;T=T[E]}T!==null&&(s[A]=T)}for(const A in x)s[A]=x[A]}}}return s}const qL=n=>(e,t)=>{const i=P.useContext(Cv),s=P.useContext(vv),r=()=>rJ(n,e,i,s);return t?r():Ra(r)},aJ=qL({scrapeMotionValuesFromProps:IT,createRenderState:DT}),lJ=qL({scrapeMotionValuesFromProps:ML,createRenderState:KL}),cJ=Symbol.for("motionComponentSymbol");function uJ(n,e,t){const i=P.useRef(t);P.useInsertionEffect(()=>{i.current=t});const s=P.useRef(null);return P.useCallback(r=>{var a;r&&((a=n.onMount)==null||a.call(n,r)),e&&(r?e.mount(r):e.unmount());const o=i.current;if(typeof o=="function")if(r){const c=o(r);typeof c=="function"&&(s.current=c)}else s.current?(s.current(),s.current=null):o(r);else o&&(o.current=r)},[e])}const QL=P.createContext({});function Ih(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function dJ(n,e,t,i,s,r){var k,C;const{visualElement:o}=P.useContext(Cv),a=P.useContext(HL),c=P.useContext(vv),d=P.useContext(Sv).reducedMotion,h=P.useRef(null);i=i||a.renderer,!h.current&&i&&(h.current=i(n,{visualState:e,parent:o,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d,isSVG:r}));const f=h.current,m=P.useContext(QL);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&hJ(h.current,t,s,m);const y=P.useRef(!1);P.useInsertionEffect(()=>{f&&y.current&&f.update(t,c)});const v=t[nL],x=P.useRef(!!v&&!((k=window.MotionHandoffIsComplete)!=null&&k.call(window,v))&&((C=window.MotionHasOptimisedAnimation)==null?void 0:C.call(window,v)));return yv(()=>{f&&(y.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),x.current&&f.animationState&&f.animationState.animateChanges())}),P.useEffect(()=>{f&&(!x.current&&f.animationState&&f.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var A;(A=window.MotionHandoffMarkAsComplete)==null||A.call(window,v)}),x.current=!1),f.enteringChildren=void 0)}),f}function hJ(n,e,t,i){const{layoutId:s,layout:r,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:$L(n.parent)),n.projection.setOptions({layoutId:s,layout:r,alwaysMeasureLayout:!!o||a&&Ih(a),visualElement:n,animationType:typeof r=="string"?r:"both",initialPromotionConfig:i,crossfade:h,layoutScroll:c,layoutRoot:d})}function $L(n){if(n)return n.options.allowProjection!==!1?n.projection:$L(n.parent)}function px(n,{forwardMotionProps:e=!1,type:t}={},i,s){i&&KW(i);const r=t?t==="svg":NT(n),o=r?lJ:aJ;function a(d,h){let f;const m={...P.useContext(Sv),...d,layoutId:fJ(d)},{isStatic:y}=m,v=YW(d),x=o(d,y);if(!y&&vO){pJ();const k=mJ(m);f=k.MeasureLayout,v.visualElement=dJ(n,x,m,s,k.ProjectionNode,r)}return S.jsxs(Cv.Provider,{value:v,children:[f&&v.visualElement?S.jsx(f,{visualElement:v.visualElement,...m}):null,sJ(n,d,uJ(x,v.visualElement,h),x,y,e,r)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const c=P.forwardRef(a);return c[cJ]=n,c}function fJ({layoutId:n}){const e=P.useContext(tT).id;return e&&n!==void 0?e+"-"+n:n}function pJ(n,e){P.useContext(HL).strict}function mJ(n){const e=GL(),{drag:t,layout:i}=e;if(!t&&!i)return{};const s={...t,...i};return{MeasureLayout:t!=null&&t.isEnabled(n)||i!=null&&i.isEnabled(n)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function gJ(n,e){if(typeof Proxy>"u")return px;const t=new Map,i=(r,o)=>px(r,o,n,e),s=(r,o)=>i(r,o);return new Proxy(s,{get:(r,o)=>o==="create"?i:(t.has(o)||t.set(o,px(o,void 0,n,e)),t.get(o))})}const yJ=(n,e)=>e.isSVG??NT(n)?new Q7(e):new H7(e,{allowProjection:n!==P.Fragment});class vJ extends La{constructor(e){super(e),e.animationState||(e.animationState=eW(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();bv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let bJ=0;class xJ extends La{constructor(){super(...arguments),this.id=bJ++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const s=this.node.animationState.setActive("exit",!e);t&&!e&&s.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const SJ={animation:{Feature:vJ},exit:{Feature:xJ}};function op(n){return{point:{x:n.pageX,y:n.pageY}}}const CJ=n=>e=>ET(e)&&n(e,op(e));function $h(n,e,t,i){return Rf(n,e,CJ(t),i)}const XL=({current:n})=>n?n.ownerDocument.defaultView:null,lP=(n,e)=>Math.abs(n-e);function kJ(n,e){const t=lP(n.x,e.x),i=lP(n.y,e.y);return Math.sqrt(t**2+i**2)}const cP=new Set(["auto","scroll"]);class YL{constructor(e,t,{transformPagePoint:i,contextWindow:s=window,dragSnapToOrigin:r=!1,distanceThreshold:o=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=y=>{this.handleScroll(y.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=gx(this.lastMoveEventInfo,this.history),v=this.startEvent!==null,x=kJ(y.offset,{x:0,y:0})>=this.distanceThreshold;if(!v&&!x)return;const{point:k}=y,{timestamp:C}=fn;this.history.push({...k,timestamp:C});const{onStart:A,onMove:T}=this.handlers;v||(A&&A(this.lastMoveEvent,y),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,y)},this.handlePointerMove=(y,v)=>{this.lastMoveEvent=y,this.lastMoveEventInfo=mx(v,this.transformPagePoint),$e.update(this.updatePoint,!0)},this.handlePointerUp=(y,v)=>{this.end();const{onEnd:x,onSessionEnd:k,resumeAnimation:C}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const A=gx(y.type==="pointercancel"?this.lastMoveEventInfo:mx(v,this.transformPagePoint),this.history);this.startEvent&&x&&x(y,A),k&&k(y,A)},!ET(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=s||window;const c=op(e),d=mx(c,this.transformPagePoint),{point:h}=d,{timestamp:f}=fn;this.history=[{...h,timestamp:f}];const{onSessionStart:m}=t;m&&m(e,gx(d,this.history)),this.removeListeners=ip($h(this.contextWindow,"pointermove",this.handlePointerMove),$h(this.contextWindow,"pointerup",this.handlePointerUp),$h(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(e){let t=e.parentElement;for(;t;){const i=getComputedStyle(t);(cP.has(i.overflowX)||cP.has(i.overflowY))&&this.scrollPositions.set(t,{x:t.scrollLeft,y:t.scrollTop}),t=t.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const t=this.scrollPositions.get(e);if(!t)return;const i=e===window,s=i?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},r={x:s.x-t.x,y:s.y-t.y};r.x===0&&r.y===0||(i?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=r.x,this.lastMoveEventInfo.point.y+=r.y):this.history.length>0&&(this.history[0].x-=r.x,this.history[0].y-=r.y),this.scrollPositions.set(e,s),$e.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ls(this.updatePoint)}}function mx(n,e){return e?{point:e(n.point)}:n}function uP(n,e){return{x:n.x-e.x,y:n.y-e.y}}function gx({point:n},e){return{point:n,delta:uP(n,ZL(e)),offset:uP(n,wJ(e)),velocity:TJ(e,.1)}}function wJ(n){return n[0]}function ZL(n){return n[n.length-1]}function TJ(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const s=ZL(n);for(;t>=0&&(i=n[t],!(s.timestamp-i.timestamp>eo(e)));)t--;if(!i)return{x:0,y:0};const r=Xi(s.timestamp-i.timestamp);if(r===0)return{x:0,y:0};const o={x:(s.x-i.x)/r,y:(s.y-i.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function AJ(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Ct(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Ct(t,n,i.max):Math.min(n,t)),n}function dP(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function EJ(n,{top:e,left:t,bottom:i,right:s}){return{x:dP(n.x,t,s),y:dP(n.y,e,i)}}function hP(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function _J(n,e){return{x:hP(n.x,e.x),y:hP(n.y,e.y)}}function MJ(n,e){let t=.5;const i=qn(n),s=qn(e);return s>i?t=Zu(e.min,e.max-i,n.min):i>s&&(t=Zu(n.min,n.max-s,e.min)),Os(0,1,t)}function RJ(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const tk=.35;function PJ(n=tk){return n===!1?n=0:n===!0&&(n=tk),{x:fP(n,"left","right"),y:fP(n,"top","bottom")}}function fP(n,e,t){return{min:pP(n,e),max:pP(n,t)}}function pP(n,e){return typeof n=="number"?n:n[e]||0}const IJ=new WeakMap;class BJ{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=en(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:i}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=f=>{t?(this.stopAnimation(),this.snapToCursor(op(f).point)):this.pauseAnimation()},o=(f,m)=>{this.stopAnimation();const{drag:y,dragPropagation:v,onDragStart:x}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=u7(y),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vi(C=>{let A=this.getAxisMotionValue(C).get()||0;if(sr.test(A)){const{projection:T}=this.visualElement;if(T&&T.layout){const E=T.layout.layoutBox[C];E&&(A=qn(E)*(parseFloat(A)/100))}}this.originPoint[C]=A}),x&&$e.postRender(()=>x(f,m)),qC(this.visualElement,"transform");const{animationState:k}=this.visualElement;k&&k.setActive("whileDrag",!0)},a=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m;const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:x,onDrag:k}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:C}=m;if(v&&this.currentDirection===null){this.currentDirection=DJ(C),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",m.point,C),this.updateAxis("y",m.point,C),this.visualElement.render(),k&&k(f,m)},c=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m,this.stop(f,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Vi(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)==null?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new YL(e,{onSessionStart:r,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:i,contextWindow:XL(this.visualElement),element:this.visualElement.current})}stop(e,t){const i=e||this.latestPointerEvent,s=t||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!s||!i)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&$e.postRender(()=>a(i,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:s}=this.getProps();if(!i||!Om(e,s,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=AJ(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){var r;const{dragConstraints:e,dragElastic:t}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)==null?void 0:r.layout,s=this.constraints;e&&Ih(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=EJ(i.layoutBox,e):this.constraints=!1,this.elastic=PJ(t),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Vi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=RJ(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Ih(e))return!1;const i=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const r=O7(i,s.root,this.visualElement.getTransformPagePoint());let o=_J(s.layout.layoutBox,r);if(t){const a=t(D7(o));this.hasMutatedConstraints=!!a,a&&(o=xL(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:s,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},d=Vi(h=>{if(!Om(h,t,this.currentDirection))return;let f=c&&c[h]||{};o&&(f={min:0,max:0});const m=s?200:1e6,y=s?40:1e7,v={type:"inertia",velocity:i?e[h]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(h,v)});return Promise.all(d).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return qC(this.visualElement,e),i.start(xT(e,i,0,t,this.visualElement,!1))}stopAnimation(){Vi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),s=i[t];return s||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Vi(t=>{const{drag:i}=this.getProps();if(!Om(t,i,this.currentDirection))return;const{projection:s}=this.visualElement,r=this.getAxisMotionValue(t);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[t],c=r.get()||0;r.set(e[t]-Ct(o,a,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Ih(t)||!i||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Vi(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();s[o]=MJ({min:c,max:c},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Vi(o=>{if(!Om(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];a.set(Ct(c,d,s[o]))})}addListeners(){if(!this.visualElement.current)return;IJ.set(this.visualElement,this);const e=this.visualElement.current,t=$h(e,"pointerdown",c=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&!fL(c.target)&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Ih(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,r=s.addEventListener("measure",i);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),$e.read(i);const o=Rf(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Vi(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=c[h].translate,f.set(f.get()+c[h].translate))}),this.visualElement.render())});return()=>{o(),t(),r(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:s=!1,dragConstraints:r=!1,dragElastic:o=tk,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:s,dragConstraints:r,dragElastic:o,dragMomentum:a}}}function Om(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function DJ(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class NJ extends La{constructor(e){super(e),this.removeGroupControls=pi,this.removeListeners=pi,this.controls=new BJ(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pi}update(){const{dragControls:e}=this.node.getProps(),{dragControls:t}=this.node.prevProps||{};e!==t&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const mP=n=>(e,t)=>{n&&$e.postRender(()=>n(e,t))};class FJ extends La{constructor(){super(...arguments),this.removePointerDownListener=pi}onPointerDown(e){this.session=new YL(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:XL(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:s}=this.node.getProps();return{onSessionStart:mP(e),onStart:mP(t),onMove:i,onEnd:(r,o)=>{delete this.session,s&&$e.postRender(()=>s(r,o))}}}mount(){this.removePointerDownListener=$h(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let yx=!1;class OJ extends P.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:s}=this.props,{projection:r}=e;r&&(t.group&&t.group.add(r),i&&i.register&&s&&i.register(r),yx&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),Og.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:s,isPresent:r}=this.props,{projection:o}=i;return o&&(o.isPresent=r,yx=!0,s||e.layoutDependency!==t||t===void 0||e.isPresent!==r?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||$e.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),AT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:s}=e;yx=!0,s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),i&&i.deregister&&i.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function e3(n){const[e,t]=VL(),i=P.useContext(tT);return S.jsx(OJ,{...n,layoutGroup:i,switchLayoutGroup:P.useContext(QL),isPresent:e,safeToRemove:t})}const LJ={pan:{Feature:FJ},drag:{Feature:NJ,ProjectionNode:zL,MeasureLayout:e3}};function gP(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const s="onHover"+t,r=i[s];r&&$e.postRender(()=>r(e,op(e)))}class jJ extends La{mount(){const{current:e}=this.node;e&&(this.unmount=d7(e,(t,i)=>(gP(this.node,i,"Start"),s=>gP(this.node,s,"End"))))}unmount(){}}class UJ extends La{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ip(Rf(this.node.current,"focus",()=>this.onFocus()),Rf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function yP(n,e,t){const{props:i}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const s="onTap"+(t==="End"?"":t),r=i[s];r&&$e.postRender(()=>r(e,op(e)))}class zJ extends La{mount(){const{current:e}=this.node;e&&(this.unmount=p7(e,(t,i)=>(yP(this.node,i,"Start"),(s,{success:r})=>yP(this.node,s,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const nk=new WeakMap,vx=new WeakMap,VJ=n=>{const e=nk.get(n.target);e&&e(n)},HJ=n=>{n.forEach(VJ)};function GJ({root:n,...e}){const t=n||document;vx.has(t)||vx.set(t,{});const i=vx.get(t),s=JSON.stringify(e);return i[s]||(i[s]=new IntersectionObserver(HJ,{root:n,...e})),i[s]}function WJ(n,e,t){const i=GJ(e);return nk.set(n,t),i.observe(n),()=>{nk.delete(n),i.unobserve(n)}}const JJ={some:0,all:1};class KJ extends La{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:s="some",once:r}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof s=="number"?s:JJ[s]},a=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,r&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=d?h:f;m&&m(c)};return WJ(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(qJ(e,t))&&this.startObserver()}unmount(){}}function qJ({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const QJ={inView:{Feature:KJ},tap:{Feature:zJ},focus:{Feature:UJ},hover:{Feature:jJ}},$J={layout:{ProjectionNode:zL,MeasureLayout:e3}},XJ={...SJ,...QJ,...LJ,...$J},ke=gJ(XJ,yJ),YJ=50,vP=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),ZJ=()=>({time:0,x:vP(),y:vP()}),eK={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function bP(n,e,t,i){const s=t[e],{length:r,position:o}=eK[e],a=s.current,c=t.time;s.current=n[`scroll${o}`],s.scrollLength=n[`scroll${r}`]-n[`client${r}`],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Zu(0,s.scrollLength,s.current);const d=i-c;s.velocity=d>YJ?0:oT(s.current-a,d)}function tK(n,e,t){bP(n,"x",e,t),bP(n,"y",e,t),e.time=t}function nK(n,e){const t={x:0,y:0};let i=n;for(;i&&i!==e;)if(TT(i))t.x+=i.offsetLeft,t.y+=i.offsetTop,i=i.offsetParent;else if(i.tagName==="svg"){const s=i.getBoundingClientRect();i=i.parentElement;const r=i.getBoundingClientRect();t.x+=s.left-r.left,t.y+=s.top-r.top}else if(i instanceof SVGGraphicsElement){const{x:s,y:r}=i.getBBox();t.x+=s,t.y+=r;let o=null,a=i.parentNode;for(;!o;)a.tagName==="svg"&&(o=a),a=i.parentNode;i=o}else break;return t}const ik={start:0,center:.5,end:1};function xP(n,e,t=0){let i=0;if(n in ik&&(n=ik[n]),typeof n=="string"){const s=parseFloat(n);n.endsWith("px")?i=s:n.endsWith("%")?n=s/100:n.endsWith("vw")?i=s/100*document.documentElement.clientWidth:n.endsWith("vh")?i=s/100*document.documentElement.clientHeight:n=s}return typeof n=="number"&&(i=e*n),t+i}const iK=[0,0];function sK(n,e,t,i){let s=Array.isArray(n)?n:iK,r=0,o=0;return typeof n=="number"?s=[n,n]:typeof n=="string"&&(n=n.trim(),n.includes(" ")?s=n.split(" "):s=[n,ik[n]?n:"0"]),r=xP(s[0],t,i),o=xP(s[1],e),r-o}const rK={All:[[0,0],[1,1]]},oK={x:0,y:0};function aK(n){return"getBBox"in n&&n.tagName!=="svg"?n.getBBox():{width:n.clientWidth,height:n.clientHeight}}function lK(n,e,t){const{offset:i=rK.All}=t,{target:s=n,axis:r="y"}=t,o=r==="y"?"height":"width",a=s!==n?nK(s,n):oK,c=s===n?{width:n.scrollWidth,height:n.scrollHeight}:aK(s),d={width:n.clientWidth,height:n.clientHeight};e[r].offset.length=0;let h=!e[r].interpolate;const f=i.length;for(let m=0;m<f;m++){const y=sK(i[m],d[o],c[o],a[r]);!h&&y!==e[r].interpolatorOffsets[m]&&(h=!0),e[r].offset[m]=y}h&&(e[r].interpolate=pT(e[r].offset,GO(i),{clamp:!1}),e[r].interpolatorOffsets=[...e[r].offset]),e[r].progress=Os(0,1,e[r].interpolate(e[r].current))}function cK(n,e=n,t){if(t.x.targetOffset=0,t.y.targetOffset=0,e!==n){let i=e;for(;i&&i!==n;)t.x.targetOffset+=i.offsetLeft,t.y.targetOffset+=i.offsetTop,i=i.offsetParent}t.x.targetLength=e===n?e.scrollWidth:e.clientWidth,t.y.targetLength=e===n?e.scrollHeight:e.clientHeight,t.x.containerLength=n.clientWidth,t.y.containerLength=n.clientHeight}function uK(n,e,t,i={}){return{measure:s=>{cK(n,i.target,t),tK(n,t,s),(i.offset||i.target)&&lK(n,t,i)},notify:()=>e(t)}}const ch=new WeakMap,SP=new WeakMap,bx=new WeakMap,CP=n=>n===document.scrollingElement?window:n;function t3(n,{container:e=document.scrollingElement,...t}={}){if(!e)return pi;let i=bx.get(e);i||(i=new Set,bx.set(e,i));const s=ZJ(),r=uK(e,n,s,t);if(i.add(r),!ch.has(e)){const a=()=>{for(const f of i)f.measure(fn.timestamp);$e.preUpdate(c)},c=()=>{for(const f of i)f.notify()},d=()=>$e.read(a);ch.set(e,d);const h=CP(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&SP.set(e,k7(e,d)),h.addEventListener("scroll",d,{passive:!0}),d()}const o=ch.get(e);return $e.read(o,!1,!0),()=>{var d;Ls(o);const a=bx.get(e);if(!a||(a.delete(r),a.size))return;const c=ch.get(e);ch.delete(e),c&&(CP(e).removeEventListener("scroll",c),(d=SP.get(e))==null||d(),window.removeEventListener("resize",c))}}const kP=new Map;function dK(n){const e={value:0},t=t3(i=>{e.value=i[n.axis].progress*100},n);return{currentTime:e,cancel:t}}function n3({source:n,container:e,...t}){const{axis:i}=t;n&&(e=n);const s=kP.get(e)??new Map;kP.set(e,s);const r=t.target??"self",o=s.get(r)??{},a=i+(t.offset??[]).join(",");return o[a]||(o[a]=!t.target&&qO()?new ScrollTimeline({source:e,axis:i}):dK({container:e,...t})),o[a]}function hK(n,e){const t=n3(e);return n.attachTimeline({timeline:e.target?void 0:t,observe:i=>(i.pause(),mL(s=>{i.time=i.iterationDuration*s},t))})}function fK(n){return n.length===2}function pK(n,e){return fK(n)?t3(t=>{n(t[e.axis].progress,t)},e):mL(n,n3(e))}function mK(n,{axis:e="y",container:t=document.scrollingElement,...i}={}){if(!t)return pi;const s={axis:e,container:t,...i};return typeof n=="function"?pK(n,s):hK(n,s)}const gK=()=>({scrollX:Ms(0),scrollY:Ms(0),scrollXProgress:Ms(0),scrollYProgress:Ms(0)}),Lm=n=>n?!n.current:!1;function yK({container:n,target:e,...t}={}){const i=Ra(gK),s=P.useRef(null),r=P.useRef(!1),o=P.useCallback(()=>(s.current=mK((a,{x:c,y:d})=>{i.scrollX.set(c.current),i.scrollXProgress.set(c.progress),i.scrollY.set(d.current),i.scrollYProgress.set(d.progress)},{...t,container:(n==null?void 0:n.current)||void 0,target:(e==null?void 0:e.current)||void 0}),()=>{var a;(a=s.current)==null||a.call(s)}),[n,e,JSON.stringify(t.offset)]);return yv(()=>{if(r.current=!1,Lm(n)||Lm(e)){r.current=!0;return}else return o()},[o]),P.useEffect(()=>{if(r.current)return Af(!Lm(n)),Af(!Lm(e)),o()},[o]),i}function vK(n){const e=Ra(()=>Ms(n)),{isStatic:t}=P.useContext(Sv);if(t){const[,i]=P.useState(n);P.useEffect(()=>e.on("change",i),[])}return e}function i3(n,e){const t=vK(e()),i=()=>t.set(e());return i(),yv(()=>{const s=()=>$e.preRender(i,!1,!0),r=n.map(o=>o.on("change",s));return()=>{r.forEach(o=>o()),Ls(i)}}),t}function bK(n){qh.current=[],n();const e=i3(qh.current,n);return qh.current=void 0,e}function s3(n,e,t,i){if(typeof n=="function")return bK(n);if(t!==void 0&&!Array.isArray(t)&&typeof e!="function")return xK(n,e,t,i);const o=typeof e=="function"?e:T7(e,t,i);return Array.isArray(n)?wP(n,o):wP([n],([a])=>o(a))}function wP(n,e){const t=Ra(()=>[]);return i3(n,()=>{t.length=0;const i=n.length;for(let s=0;s<i;s++)t[s]=n[s].get();return e(t)})}function xK(n,e,t,i){const s=Ra(()=>Object.keys(t)),r=Ra(()=>({}));for(const o of s)r[o]=s3(n,e,t[o],i);return r}const SK={some:0,all:1};function CK(n,e,{root:t,margin:i,amount:s="some"}={}){const r=wT(n),o=new WeakMap,a=d=>{d.forEach(h=>{const f=o.get(h.target);if(h.isIntersecting!==!!f)if(h.isIntersecting){const m=e(h.target,h);typeof m=="function"?o.set(h.target,m):c.unobserve(h.target)}else typeof f=="function"&&(f(h),o.delete(h.target))})},c=new IntersectionObserver(a,{root:t,rootMargin:i,threshold:typeof s=="number"?s:SK[s]});return r.forEach(d=>c.observe(d)),()=>c.disconnect()}function kK(n,{root:e,margin:t,amount:i,once:s=!1,initial:r=!1}={}){const[o,a]=P.useState(r);return P.useEffect(()=>{if(!n.current||s&&o)return;const c=()=>(a(!0),s?void 0:()=>a(!1)),d={root:e&&e.current||void 0,margin:t,amount:i};return CK(n.current,c,d)},[e,n,t,s,i]),o}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TK=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),TP=n=>{const e=TK(n);return e.charAt(0).toUpperCase()+e.slice(1)},r3=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),AK=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _K=P.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:o,...a},c)=>P.createElement("svg",{ref:c,...EK,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:r3("lucide",s),...!r&&!AK(a)&&{"aria-hidden":"true"},...a},[...o.map(([d,h])=>P.createElement(d,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=(n,e)=>{const t=P.forwardRef(({className:i,...s},r)=>P.createElement(_K,{ref:r,iconNode:e,className:r3(`lucide-${wK(TP(n))}`,`lucide-${n}`,i),...s}));return t.displayName=TP(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MK=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],kv=Ee("activity",MK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RK=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Pf=Ee("arrow-left",RK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],AP=Ee("arrow-right",PK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IK=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],BK=Ee("bell",IK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DK=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],NK=Ee("brain",DK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FK=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jm=Ee("check",FK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OK=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],EP=Ee("chevron-right",OK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LK=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jK=Ee("circle-check-big",LK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UK=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],o3=Ee("clock",UK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],VK=Ee("frown",zK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],GK=Ee("globe",HK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WK=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],ed=Ee("heart",WK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JK=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],xx=Ee("image",JK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],qK=Ee("map-pin",KK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QK=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],$K=Ee("map",QK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XK=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],YK=Ee("meh",XK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],eq=Ee("menu",ZK);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tq=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],a3=Ee("message-circle",tq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nq=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],l3=Ee("mic-off",nq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iq=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],sk=Ee("mic",iq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sq=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],rq=Ee("pause",sq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oq=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],aq=Ee("phone",oq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lq=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],FT=Ee("play",lq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cq=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],uq=Ee("plus",cq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dq=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],hq=Ee("radio",dq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fq=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],pq=Ee("rocket",fq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mq=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gq=Ee("settings",mq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yq=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],c3=Ee("shield",yq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vq=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],OT=Ee("smile",vq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bq=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],jl=Ee("sparkles",bq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xq=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],u3=Ee("star",xq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sq=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],_P=Ee("trending-down",Sq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cq=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],kq=Ee("trending-up",Cq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wq=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],rk=Ee("triangle-alert",wq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tq=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],d3=Ee("user",Tq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aq=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Eq=Ee("users",Aq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _q=[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],MP=Ee("video-off",_q);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mq=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Rq=Ee("video",Mq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pq=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],h3=Ee("volume-2",Pq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iq=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Bq=Ee("wand-sparkles",Iq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dq=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],LT=Ee("x",Dq);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nq=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],jT=Ee("zap",Nq),RP=({children:n,color:e="bg-white",className:t="",onClick:i})=>S.jsx(ke.button,{whileHover:{x:-4,y:-4,boxShadow:"8px 8px 0px 0px black"},whileTap:{x:0,y:0,boxShadow:"0px 0px 0px 0px black"},onClick:i,className:`
      ${e} ${t}
      relative px-8 py-4 rounded-2xl font-black text-xl border-[3px] border-black 
      shadow-[4px_4px_0px_0px_black] flex items-center justify-center gap-3 transition-all
    `,children:n}),Fq=({text:n,color:e="bg-black text-white"})=>S.jsx("div",{className:`${e} py-4 border-y-[3px] border-black overflow-hidden whitespace-nowrap`,children:S.jsx(ke.div,{animate:{x:[0,-1e3]},transition:{ease:"linear",duration:20,repeat:1/0},className:"inline-block",children:[...Array(10)].map((t,i)=>S.jsxs("span",{className:"text-2xl font-black uppercase mx-8 tracking-widest",children:[n," ",S.jsx("span",{className:"text-[#FFD93D]",children:""})]},i))})}),Sx=({icon:n,title:e,desc:t,color:i,rotate:s})=>S.jsxs(ke.div,{whileHover:{scale:1.05,rotate:0},className:`${i} p-8 rounded-[30px] border-[3px] border-black shadow-[8px_8px_0px_0px_black] h-full flex flex-col items-start relative overflow-hidden`,style:{rotate:`${s}deg`},children:[S.jsx("div",{className:"bg-black/10 p-4 rounded-2xl mb-6 border-2 border-black",children:S.jsx(n,{size:40,className:"text-black",strokeWidth:2.5})}),S.jsx("h3",{className:"text-3xl font-black text-black mb-4 uppercase leading-none",children:e}),S.jsx("p",{className:"text-lg font-bold text-black/70 leading-snug",children:t}),S.jsx("div",{className:"absolute -bottom-10 -right-10 opacity-10",children:S.jsx(n,{size:150})})]}),Oq=()=>{const{scrollYProgress:n}=yK(),e=s3(n,[0,1],[0,200]),t=P.useRef(null),i=kK(t,{once:!0,margin:"-100px"});return S.jsxs("div",{className:"min-h-screen bg-[#FFF4E0] font-sans selection:bg-black selection:text-[#FFD93D] overflow-x-hidden",children:[S.jsx("nav",{className:"fixed top-0 w-full z-50 px-4 py-4 pointer-events-none",children:S.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center pointer-events-auto",children:[S.jsxs(ke.div,{initial:{y:-100},animate:{y:0},className:"flex items-center gap-3 bg-white px-6 py-3 rounded-2xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsx("div",{className:"bg-[#FF6B6B] p-2 rounded-lg border-2 border-black",children:S.jsx(ed,{className:"text-white fill-white",size:24})}),S.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"WeCare"})]}),S.jsx(ke.div,{initial:{y:-100},animate:{y:0},transition:{delay:.1},children:S.jsx(Wh,{to:"/dashboard",children:S.jsx("button",{className:"bg-[#4D96FF] text-white px-6 py-3 rounded-xl border-[3px] border-black font-black uppercase shadow-[4px_4px_0px_0px_black] hover:translate-y-1 hover:shadow-[2px_2px_0px_0px_black] transition-all",children:"Launch App "})})})]})}),S.jsxs("header",{className:"relative pt-40 pb-20 px-6 overflow-hidden",children:[S.jsx("div",{className:"absolute top-20 left-10 text-[#FFD93D] animate-spin-slow opacity-50 hidden lg:block",children:S.jsx(u3,{size:120,strokeWidth:3})}),S.jsx("div",{className:"absolute bottom-20 right-10 text-[#6BCB77] animate-bounce opacity-50 hidden lg:block",children:S.jsx(jT,{size:120,strokeWidth:3})}),S.jsxs("div",{className:"max-w-7xl mx-auto grid lg:grid-cols-2 gap-16 items-center",children:[S.jsxs("div",{className:"space-y-8 relative z-10",children:[S.jsx(ke.div,{initial:{scale:0},animate:{scale:1},className:"inline-block bg-[#A29BFE] px-6 py-2 rounded-full border-[3px] border-black shadow-[4px_4px_0px_0px_black] rotate-[-2deg]",children:S.jsxs("span",{className:"font-black text-white uppercase tracking-wider flex items-center gap-2",children:[S.jsx(jl,{size:18,fill:"white"})," The World's Friendliest AI"]})}),S.jsxs(ke.h1,{initial:{x:-100,opacity:0},animate:{x:0,opacity:1},className:"text-6xl lg:text-8xl font-black text-black leading-[0.9] tracking-tighter",children:["A PATIENT FRIEND ",S.jsx("br",{}),"FOR ",S.jsx("span",{className:"text-[#4D96FF] underline decoration-4 decoration-black underline-offset-4",children:"EVERY MIND."})]}),S.jsx(ke.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-2xl font-bold text-black/70 max-w-lg",children:"Safe, private, and endless conversations. Designed for learning, therapy, and pure fun."}),S.jsxs(ke.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"flex flex-col sm:flex-row gap-6",children:[S.jsx(Wh,{to:"/dashboard",children:S.jsxs(RP,{color:"bg-[#FFD93D]",children:["GET STARTED ",S.jsx(AP,{strokeWidth:4})]})}),S.jsxs(RP,{color:"bg-white",className:"text-black",children:[S.jsx(FT,{fill:"black",size:20})," WATCH DEMO"]})]}),S.jsxs("div",{className:"flex items-center gap-4 pt-4",children:[S.jsx("div",{className:"flex -space-x-4",children:[1,2,3,4].map(s=>S.jsx("div",{className:"w-12 h-12 rounded-full border-[3px] border-black bg-gray-200 overflow-hidden",children:S.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${s*13}`,alt:"User"})},s))}),S.jsxs("div",{className:"font-bold text-lg leading-tight",children:["Trusted by ",S.jsx("br",{})," 10,000+ Families"]})]})]}),S.jsxs(ke.div,{style:{y:e},className:"relative hidden lg:block",children:[S.jsxs("div",{className:"relative z-10 bg-white p-6 rounded-[40px] border-[4px] border-black shadow-[16px_16px_0px_0px_black] rotate-2",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b-[3px] border-black pb-4",children:[S.jsx("div",{className:"w-5 h-5 rounded-full bg-[#FF6B6B] border-2 border-black"}),S.jsx("div",{className:"w-5 h-5 rounded-full bg-[#FFD93D] border-2 border-black"}),S.jsx("div",{className:"w-5 h-5 rounded-full bg-[#6BCB77] border-2 border-black"}),S.jsx("div",{className:"ml-auto bg-gray-100 px-4 py-1 rounded-full border-2 border-black text-xs font-bold text-gray-400",children:"neuropal.app"})]}),S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{className:"flex gap-4 items-end",children:[S.jsx("div",{className:"w-16 h-16 rounded-2xl border-[3px] border-black overflow-hidden bg-[#FFD93D]",children:S.jsx("img",{src:"https://api.dicebear.com/7.x/bottts/svg?seed=Buddy",alt:"Bot"})}),S.jsxs("div",{className:"bg-[#E0E0E0] p-4 rounded-2xl rounded-bl-none border-[3px] border-black relative",children:[S.jsx("p",{className:"font-bold text-lg",children:"Hi! I'm Buddy. Do you like dinosaurs? "}),S.jsx("div",{className:"absolute -bottom-3 -left-1 w-6 h-6 bg-[#E0E0E0] border-l-[3px] border-b-[3px] border-black clip-path-polygon"})]})]}),S.jsxs("div",{className:"flex gap-4 items-end justify-end",children:[S.jsx("div",{className:"bg-[#4D96FF] text-white p-4 rounded-2xl rounded-br-none border-[3px] border-black",children:S.jsx("p",{className:"font-bold text-lg",children:"YES! T-Rex is my favorite! "})}),S.jsx("div",{className:"w-16 h-16 rounded-2xl border-[3px] border-black overflow-hidden bg-white",children:S.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Kid",alt:"User"})})]})]}),S.jsxs("div",{className:"mt-8 bg-gray-100 p-3 rounded-xl border-[3px] border-black flex justify-between items-center text-gray-400 font-bold",children:[S.jsx("span",{children:"Type a message..."}),S.jsx("div",{className:"bg-[#6BCB77] p-2 rounded-lg border-2 border-black text-white",children:S.jsx(AP,{size:20})})]})]}),S.jsx("div",{className:"absolute -top-10 -right-10 w-full h-full bg-[#FF6B6B] rounded-[40px] border-[4px] border-black -z-10 rotate-[-4deg]"})]})]})]}),S.jsx(Fq,{text:"NO JUDGEMENT  ALWAYS LISTENING  100% PRIVATE  FUN LEARNING "}),S.jsx("section",{ref:t,className:"py-24 px-6 bg-[#4D96FF]",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px"},children:S.jsxs("div",{className:"max-w-7xl mx-auto",children:[S.jsxs(ke.div,{className:"text-center mb-16 relative",initial:{y:50,opacity:0},animate:i?{y:0,opacity:1}:{},children:[S.jsx("div",{className:"inline-block bg-white px-6 py-2 rounded-full border-[3px] border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,0.2)] mb-4 -rotate-2",children:S.jsx("h2",{className:"text-xl font-black text-black uppercase",children:"Why It Works"})}),S.jsxs("h2",{className:"text-5xl md:text-6xl font-black text-white drop-shadow-[4px_4px_0px_black]",style:{WebkitTextStroke:"2px black"},children:["DESIGNED FOR ",S.jsx("br",{})," DIFFERENT MINDS"]})]}),S.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[S.jsx(Sx,{icon:OT,color:"bg-[#FFD93D]",rotate:-2,title:"Zero Judgement",desc:"Ask the same question 100 times. Buddy never gets tired, annoyed, or impatient. Just pure support."}),S.jsx(Sx,{icon:h3,color:"bg-white",rotate:2,title:"Calm Voices",desc:"No shouting or sudden noises. We use scientifically calibrated tones that are soothing and easy to process."}),S.jsx(Sx,{icon:c3,color:"bg-[#FF6B6B]",rotate:-1,title:"Total Privacy",desc:"What happens in NeuroPal stays in NeuroPal. No data selling. No ads. Just safe space."})]})]})}),S.jsxs("section",{className:"py-24 px-6 bg-[#FFD93D] relative overflow-hidden",children:[S.jsxs("div",{className:"max-w-4xl mx-auto text-center relative z-10",children:[S.jsxs("h2",{className:"text-5xl md:text-7xl font-black text-black mb-8 leading-tight",children:["READY TO MEET ",S.jsx("br",{})," YOUR NEW BUDDY?"]}),S.jsx("div",{className:"bg-white p-8 rounded-[40px] border-[4px] border-black shadow-[12px_12px_0px_0px_black] rotate-1",children:S.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[S.jsx("div",{className:"w-full md:w-1/3",children:S.jsxs("div",{className:"aspect-square bg-[#A29BFE] rounded-3xl border-[3px] border-black overflow-hidden relative",children:[S.jsx("img",{src:"https://api.dicebear.com/7.x/bottts/svg?seed=Buddy&backgroundColor=A29BFE",className:"w-full h-full object-cover"}),S.jsx("div",{className:"absolute bottom-4 right-4 bg-[#6BCB77] text-white px-3 py-1 rounded-full border-2 border-black font-bold text-sm animate-bounce",children:"Hello! "})]})}),S.jsxs("div",{className:"w-full md:w-2/3 text-left space-y-6",children:[S.jsx("h3",{className:"text-3xl font-black uppercase",children:"Create Your Avatar"}),S.jsx("p",{className:"text-xl font-bold text-gray-600",children:"Customize appearance, voice, and personality. Make a friend that understands YOU."}),S.jsx(Wh,{to:"/dashboard",className:"block",children:S.jsxs("button",{className:"w-full py-4 bg-[#4D96FF] text-white rounded-xl border-[3px] border-black font-black text-2xl shadow-[6px_6px_0px_0px_black] hover:translate-y-1 hover:shadow-[2px_2px_0px_0px_black] transition-all flex items-center justify-center gap-3",children:[S.jsx(jl,{fill:"white"})," START CREATING"]})})]})]})})]}),S.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",style:{backgroundImage:"radial-gradient(#000 2px, transparent 2px)",backgroundSize:"20px 20px"}})]}),S.jsxs("footer",{className:"bg-black text-white pt-20 pb-10 px-6 border-t-[6px] border-[#FF6B6B]",children:[S.jsxs("div",{className:"max-w-7xl mx-auto grid md:grid-cols-4 gap-12 mb-16",children:[S.jsxs("div",{className:"md:col-span-2 space-y-6",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"bg-[#4D96FF] p-2 rounded-lg border-2 border-white",children:S.jsx(ed,{className:"text-white fill-white",size:24})}),S.jsx("h2",{className:"text-4xl font-black italic",children:"NeuroPal"})]}),S.jsx("p",{className:"text-xl font-bold text-gray-400 max-w-sm",children:"Making the world a little less lonely and a lot more understandable for everyone."})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-[#FFD93D] font-black uppercase text-xl mb-6",children:"Explore"}),S.jsxs("ul",{className:"space-y-4 font-bold text-lg text-gray-300",children:[S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"About Us"}),S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"Safety Center"}),S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"For Schools"})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-[#6BCB77] font-black uppercase text-xl mb-6",children:"Legal"}),S.jsxs("ul",{className:"space-y-4 font-bold text-lg text-gray-300",children:[S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"Privacy Policy"}),S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"Terms of Service"}),S.jsx("li",{className:"hover:text-white hover:translate-x-2 transition-transform cursor-pointer",children:"Cookie Settings"})]})]})]}),S.jsx("div",{className:"text-center pt-10 border-t border-gray-800",children:S.jsx("p",{className:"font-bold text-gray-500",children:" 2026 NeuroPal Inc. Built with  and ."})})]})]})};function f3(n,e){return function(){return n.apply(e,arguments)}}const{toString:Lq}=Object.prototype,{getPrototypeOf:UT}=Object,{iterator:wv,toStringTag:p3}=Symbol,Tv=(n=>e=>{const t=Lq.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Us=n=>(n=n.toLowerCase(),e=>Tv(e)===n),Av=n=>e=>typeof e===n,{isArray:vd}=Array,td=Av("undefined");function ap(n){return n!==null&&!td(n)&&n.constructor!==null&&!td(n.constructor)&&mi(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const m3=Us("ArrayBuffer");function jq(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&m3(n.buffer),e}const Uq=Av("string"),mi=Av("function"),g3=Av("number"),lp=n=>n!==null&&typeof n=="object",zq=n=>n===!0||n===!1,Lg=n=>{if(Tv(n)!=="object")return!1;const e=UT(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(p3 in n)&&!(wv in n)},Vq=n=>{if(!lp(n)||ap(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},Hq=Us("Date"),Gq=Us("File"),Wq=Us("Blob"),Jq=Us("FileList"),Kq=n=>lp(n)&&mi(n.pipe),qq=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||mi(n.append)&&((e=Tv(n))==="formdata"||e==="object"&&mi(n.toString)&&n.toString()==="[object FormData]"))},Qq=Us("URLSearchParams"),[$q,Xq,Yq,Zq]=["ReadableStream","Request","Response","Headers"].map(Us),eQ=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function cp(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,s;if(typeof n!="object"&&(n=[n]),vd(n))for(i=0,s=n.length;i<s;i++)e.call(null,n[i],i,n);else{if(ap(n))return;const r=t?Object.getOwnPropertyNames(n):Object.keys(n),o=r.length;let a;for(i=0;i<o;i++)a=r[i],e.call(null,n[a],a,n)}}function y3(n,e){if(ap(n))return null;e=e.toLowerCase();const t=Object.keys(n);let i=t.length,s;for(;i-- >0;)if(s=t[i],e===s.toLowerCase())return s;return null}const kl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,v3=n=>!td(n)&&n!==kl;function ok(){const{caseless:n,skipUndefined:e}=v3(this)&&this||{},t={},i=(s,r)=>{const o=n&&y3(t,r)||r;Lg(t[o])&&Lg(s)?t[o]=ok(t[o],s):Lg(s)?t[o]=ok({},s):vd(s)?t[o]=s.slice():(!e||!td(s))&&(t[o]=s)};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&cp(arguments[s],i);return t}const tQ=(n,e,t,{allOwnKeys:i}={})=>(cp(e,(s,r)=>{t&&mi(s)?n[r]=f3(s,t):n[r]=s},{allOwnKeys:i}),n),nQ=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),iQ=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},sQ=(n,e,t,i)=>{let s,r,o;const a={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),r=s.length;r-- >0;)o=s[r],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&UT(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},rQ=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},oQ=n=>{if(!n)return null;if(vd(n))return n;let e=n.length;if(!g3(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},aQ=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&UT(Uint8Array)),lQ=(n,e)=>{const i=(n&&n[wv]).call(n);let s;for(;(s=i.next())&&!s.done;){const r=s.value;e.call(n,r[0],r[1])}},cQ=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},uQ=Us("HTMLFormElement"),dQ=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,s){return i.toUpperCase()+s}),PP=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),hQ=Us("RegExp"),b3=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};cp(t,(s,r)=>{let o;(o=e(s,r,n))!==!1&&(i[r]=o||s)}),Object.defineProperties(n,i)},fQ=n=>{b3(n,(e,t)=>{if(mi(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(mi(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},pQ=(n,e)=>{const t={},i=s=>{s.forEach(r=>{t[r]=!0})};return vd(n)?i(n):i(String(n).split(e)),t},mQ=()=>{},gQ=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function yQ(n){return!!(n&&mi(n.append)&&n[p3]==="FormData"&&n[wv])}const vQ=n=>{const e=new Array(10),t=(i,s)=>{if(lp(i)){if(e.indexOf(i)>=0)return;if(ap(i))return i;if(!("toJSON"in i)){e[s]=i;const r=vd(i)?[]:{};return cp(i,(o,a)=>{const c=t(o,s+1);!td(c)&&(r[a]=c)}),e[s]=void 0,r}}return i};return t(n,0)},bQ=Us("AsyncFunction"),xQ=n=>n&&(lp(n)||mi(n))&&mi(n.then)&&mi(n.catch),x3=((n,e)=>n?setImmediate:e?((t,i)=>(kl.addEventListener("message",({source:s,data:r})=>{s===kl&&r===t&&i.length&&i.shift()()},!1),s=>{i.push(s),kl.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",mi(kl.postMessage)),SQ=typeof queueMicrotask<"u"?queueMicrotask.bind(kl):typeof process<"u"&&process.nextTick||x3,CQ=n=>n!=null&&mi(n[wv]),H={isArray:vd,isArrayBuffer:m3,isBuffer:ap,isFormData:qq,isArrayBufferView:jq,isString:Uq,isNumber:g3,isBoolean:zq,isObject:lp,isPlainObject:Lg,isEmptyObject:Vq,isReadableStream:$q,isRequest:Xq,isResponse:Yq,isHeaders:Zq,isUndefined:td,isDate:Hq,isFile:Gq,isBlob:Wq,isRegExp:hQ,isFunction:mi,isStream:Kq,isURLSearchParams:Qq,isTypedArray:aQ,isFileList:Jq,forEach:cp,merge:ok,extend:tQ,trim:eQ,stripBOM:nQ,inherits:iQ,toFlatObject:sQ,kindOf:Tv,kindOfTest:Us,endsWith:rQ,toArray:oQ,forEachEntry:lQ,matchAll:cQ,isHTMLForm:uQ,hasOwnProperty:PP,hasOwnProp:PP,reduceDescriptors:b3,freezeMethods:fQ,toObjectSet:pQ,toCamelCase:dQ,noop:mQ,toFiniteNumber:gQ,findKey:y3,global:kl,isContextDefined:v3,isSpecCompliantForm:yQ,toJSONObject:vQ,isAsyncFn:bQ,isThenable:xQ,setImmediate:x3,asap:SQ,isIterable:CQ};function Ae(n,e,t,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}H.inherits(Ae,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const S3=Ae.prototype,C3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{C3[n]={value:n}});Object.defineProperties(Ae,C3);Object.defineProperty(S3,"isAxiosError",{value:!0});Ae.from=(n,e,t,i,s,r)=>{const o=Object.create(S3);H.toFlatObject(n,o,function(h){return h!==Error.prototype},d=>d!=="isAxiosError");const a=n&&n.message?n.message:"Error",c=e==null&&n?n.code:e;return Ae.call(o,a,c,t,i,s),n&&o.cause==null&&Object.defineProperty(o,"cause",{value:n,configurable:!0}),o.name=n&&n.name||"Error",r&&Object.assign(o,r),o};const kQ=null;function ak(n){return H.isPlainObject(n)||H.isArray(n)}function k3(n){return H.endsWith(n,"[]")?n.slice(0,-2):n}function IP(n,e,t){return n?n.concat(e).map(function(s,r){return s=k3(s),!t&&r?"["+s+"]":s}).join(t?".":""):e}function wQ(n){return H.isArray(n)&&!n.some(ak)}const TQ=H.toFlatObject(H,{},null,function(e){return/^is[A-Z]/.test(e)});function Ev(n,e,t){if(!H.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=H.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,k){return!H.isUndefined(k[x])});const i=t.metaTokens,s=t.visitor||h,r=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(e);if(!H.isFunction(s))throw new TypeError("visitor must be a function");function d(v){if(v===null)return"";if(H.isDate(v))return v.toISOString();if(H.isBoolean(v))return v.toString();if(!c&&H.isBlob(v))throw new Ae("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(v)||H.isTypedArray(v)?c&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function h(v,x,k){let C=v;if(v&&!k&&typeof v=="object"){if(H.endsWith(x,"{}"))x=i?x:x.slice(0,-2),v=JSON.stringify(v);else if(H.isArray(v)&&wQ(v)||(H.isFileList(v)||H.endsWith(x,"[]"))&&(C=H.toArray(v)))return x=k3(x),C.forEach(function(T,E){!(H.isUndefined(T)||T===null)&&e.append(o===!0?IP([x],E,r):o===null?x:x+"[]",d(T))}),!1}return ak(v)?!0:(e.append(IP(k,x,r),d(v)),!1)}const f=[],m=Object.assign(TQ,{defaultVisitor:h,convertValue:d,isVisitable:ak});function y(v,x){if(!H.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(v),H.forEach(v,function(C,A){(!(H.isUndefined(C)||C===null)&&s.call(e,C,H.isString(A)?A.trim():A,x,m))===!0&&y(C,x?x.concat(A):[A])}),f.pop()}}if(!H.isObject(n))throw new TypeError("data must be an object");return y(n),e}function BP(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function zT(n,e){this._pairs=[],n&&Ev(n,this,e)}const w3=zT.prototype;w3.append=function(e,t){this._pairs.push([e,t])};w3.toString=function(e){const t=e?function(i){return e.call(this,i,BP)}:BP;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function AQ(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function T3(n,e,t){if(!e)return n;const i=t&&t.encode||AQ;H.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let r;if(s?r=s(e,t):r=H.isURLSearchParams(e)?e.toString():new zT(e,t).toString(i),r){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+r}return n}class DP{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,function(i){i!==null&&e(i)})}}const A3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},EQ=typeof URLSearchParams<"u"?URLSearchParams:zT,_Q=typeof FormData<"u"?FormData:null,MQ=typeof Blob<"u"?Blob:null,RQ={isBrowser:!0,classes:{URLSearchParams:EQ,FormData:_Q,Blob:MQ},protocols:["http","https","file","blob","url","data"]},VT=typeof window<"u"&&typeof document<"u",lk=typeof navigator=="object"&&navigator||void 0,PQ=VT&&(!lk||["ReactNative","NativeScript","NS"].indexOf(lk.product)<0),IQ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",BQ=VT&&window.location.href||"http://localhost",DQ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:VT,hasStandardBrowserEnv:PQ,hasStandardBrowserWebWorkerEnv:IQ,navigator:lk,origin:BQ},Symbol.toStringTag,{value:"Module"})),Nn={...DQ,...RQ};function NQ(n,e){return Ev(n,new Nn.classes.URLSearchParams,{visitor:function(t,i,s,r){return Nn.isNode&&H.isBuffer(t)?(this.append(i,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...e})}function FQ(n){return H.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function OQ(n){const e={},t=Object.keys(n);let i;const s=t.length;let r;for(i=0;i<s;i++)r=t[i],e[r]=n[r];return e}function E3(n){function e(t,i,s,r){let o=t[r++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=r>=t.length;return o=!o&&H.isArray(s)?s.length:o,c?(H.hasOwnProp(s,o)?s[o]=[s[o],i]:s[o]=i,!a):((!s[o]||!H.isObject(s[o]))&&(s[o]=[]),e(t,i,s[o],r)&&H.isArray(s[o])&&(s[o]=OQ(s[o])),!a)}if(H.isFormData(n)&&H.isFunction(n.entries)){const t={};return H.forEachEntry(n,(i,s)=>{e(FQ(i),s,t,0)}),t}return null}function LQ(n,e,t){if(H.isString(n))try{return(e||JSON.parse)(n),H.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const up={transitional:A3,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",s=i.indexOf("application/json")>-1,r=H.isObject(e);if(r&&H.isHTMLForm(e)&&(e=new FormData(e)),H.isFormData(e))return s?JSON.stringify(E3(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(i.indexOf("application/x-www-form-urlencoded")>-1)return NQ(e,this.formSerializer).toString();if((a=H.isFileList(e))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ev(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return r||s?(t.setContentType("application/json",!1),LQ(e)):e}],transformResponse:[function(e){const t=this.transitional||up.transitional,i=t&&t.forcedJSONParsing,s=this.responseType==="json";if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(i&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?Ae.from(a,Ae.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nn.classes.FormData,Blob:Nn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],n=>{up.headers[n]={}});const jQ=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UQ=n=>{const e={};let t,i,s;return n&&n.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),i=o.substring(s+1).trim(),!(!t||e[t]&&jQ[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},NP=Symbol("internals");function uh(n){return n&&String(n).trim().toLowerCase()}function jg(n){return n===!1||n==null?n:H.isArray(n)?n.map(jg):String(n)}function zQ(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const VQ=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Cx(n,e,t,i,s){if(H.isFunction(i))return i.call(this,e,t);if(s&&(e=t),!!H.isString(e)){if(H.isString(i))return e.indexOf(i)!==-1;if(H.isRegExp(i))return i.test(e)}}function HQ(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function GQ(n,e){const t=H.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(s,r,o){return this[i].call(this,e,s,r,o)},configurable:!0})})}let gi=class{constructor(e){e&&this.set(e)}set(e,t,i){const s=this;function r(a,c,d){const h=uh(c);if(!h)throw new Error("header name must be a non-empty string");const f=H.findKey(s,h);(!f||s[f]===void 0||d===!0||d===void 0&&s[f]!==!1)&&(s[f||c]=jg(a))}const o=(a,c)=>H.forEach(a,(d,h)=>r(d,h,c));if(H.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(H.isString(e)&&(e=e.trim())&&!VQ(e))o(UQ(e),t);else if(H.isObject(e)&&H.isIterable(e)){let a={},c,d;for(const h of e){if(!H.isArray(h))throw TypeError("Object iterator must return a key-value pair");a[d=h[0]]=(c=a[d])?H.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}o(a,t)}else e!=null&&r(t,e,i);return this}get(e,t){if(e=uh(e),e){const i=H.findKey(this,e);if(i){const s=this[i];if(!t)return s;if(t===!0)return zQ(s);if(H.isFunction(t))return t.call(this,s,i);if(H.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=uh(e),e){const i=H.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||Cx(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let s=!1;function r(o){if(o=uh(o),o){const a=H.findKey(i,o);a&&(!t||Cx(i,i[a],a,t))&&(delete i[a],s=!0)}}return H.isArray(e)?e.forEach(r):r(e),s}clear(e){const t=Object.keys(this);let i=t.length,s=!1;for(;i--;){const r=t[i];(!e||Cx(this,this[r],r,e,!0))&&(delete this[r],s=!0)}return s}normalize(e){const t=this,i={};return H.forEach(this,(s,r)=>{const o=H.findKey(i,r);if(o){t[o]=jg(s),delete t[r];return}const a=e?HQ(r):String(r).trim();a!==r&&delete t[r],t[a]=jg(s),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return H.forEach(this,(i,s)=>{i!=null&&i!==!1&&(t[s]=e&&H.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(s=>i.set(s)),i}static accessor(e){const i=(this[NP]=this[NP]={accessors:{}}).accessors,s=this.prototype;function r(o){const a=uh(o);i[a]||(GQ(s,o),i[a]=!0)}return H.isArray(e)?e.forEach(r):r(e),this}};gi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(gi.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});H.freezeMethods(gi);function kx(n,e){const t=this||up,i=e||t,s=gi.from(i.headers);let r=i.data;return H.forEach(n,function(a){r=a.call(t,r,s.normalize(),e?e.status:void 0)}),s.normalize(),r}function _3(n){return!!(n&&n.__CANCEL__)}function bd(n,e,t){Ae.call(this,n??"canceled",Ae.ERR_CANCELED,e,t),this.name="CanceledError"}H.inherits(bd,Ae,{__CANCEL__:!0});function M3(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new Ae("Request failed with status code "+t.status,[Ae.ERR_BAD_REQUEST,Ae.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function WQ(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function JQ(n,e){n=n||10;const t=new Array(n),i=new Array(n);let s=0,r=0,o;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),h=i[r];o||(o=d),t[s]=c,i[s]=d;let f=r,m=0;for(;f!==s;)m+=t[f++],f=f%n;if(s=(s+1)%n,s===r&&(r=(r+1)%n),d-o<e)return;const y=h&&d-h;return y?Math.round(m*1e3/y):void 0}}function KQ(n,e){let t=0,i=1e3/e,s,r;const o=(d,h=Date.now())=>{t=h,s=null,r&&(clearTimeout(r),r=null),n(...d)};return[(...d)=>{const h=Date.now(),f=h-t;f>=i?o(d,h):(s=d,r||(r=setTimeout(()=>{r=null,o(s)},i-f)))},()=>s&&o(s)]}const Dy=(n,e,t=3)=>{let i=0;const s=JQ(50,250);return KQ(r=>{const o=r.loaded,a=r.lengthComputable?r.total:void 0,c=o-i,d=s(c),h=o<=a;i=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:d||void 0,estimated:d&&a&&h?(a-o)/d:void 0,event:r,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(f)},t)},FP=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},OP=n=>(...e)=>H.asap(()=>n(...e)),qQ=Nn.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Nn.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Nn.origin),Nn.navigator&&/(msie|trident)/i.test(Nn.navigator.userAgent)):()=>!0,QQ=Nn.hasStandardBrowserEnv?{write(n,e,t,i,s,r,o){if(typeof document>"u")return;const a=[`${n}=${encodeURIComponent(e)}`];H.isNumber(t)&&a.push(`expires=${new Date(t).toUTCString()}`),H.isString(i)&&a.push(`path=${i}`),H.isString(s)&&a.push(`domain=${s}`),r===!0&&a.push("secure"),H.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function $Q(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function XQ(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function R3(n,e,t){let i=!$Q(e);return n&&(i||t==!1)?XQ(n,e):e}const LP=n=>n instanceof gi?{...n}:n;function Ql(n,e){e=e||{};const t={};function i(d,h,f,m){return H.isPlainObject(d)&&H.isPlainObject(h)?H.merge.call({caseless:m},d,h):H.isPlainObject(h)?H.merge({},h):H.isArray(h)?h.slice():h}function s(d,h,f,m){if(H.isUndefined(h)){if(!H.isUndefined(d))return i(void 0,d,f,m)}else return i(d,h,f,m)}function r(d,h){if(!H.isUndefined(h))return i(void 0,h)}function o(d,h){if(H.isUndefined(h)){if(!H.isUndefined(d))return i(void 0,d)}else return i(void 0,h)}function a(d,h,f){if(f in e)return i(d,h);if(f in n)return i(void 0,d)}const c={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(d,h,f)=>s(LP(d),LP(h),f,!0)};return H.forEach(Object.keys({...n,...e}),function(h){const f=c[h]||s,m=f(n[h],e[h],h);H.isUndefined(m)&&f!==a||(t[h]=m)}),t}const P3=n=>{const e=Ql({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:r,headers:o,auth:a}=e;if(e.headers=o=gi.from(o),e.url=T3(R3(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),H.isFormData(t)){if(Nn.hasStandardBrowserEnv||Nn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(H.isFunction(t.getHeaders)){const c=t.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([h,f])=>{d.includes(h.toLowerCase())&&o.set(h,f)})}}if(Nn.hasStandardBrowserEnv&&(i&&H.isFunction(i)&&(i=i(e)),i||i!==!1&&qQ(e.url))){const c=s&&r&&QQ.read(r);c&&o.set(s,c)}return e},YQ=typeof XMLHttpRequest<"u",ZQ=YQ&&function(n){return new Promise(function(t,i){const s=P3(n);let r=s.data;const o=gi.from(s.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:d}=s,h,f,m,y,v;function x(){y&&y(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let k=new XMLHttpRequest;k.open(s.method.toUpperCase(),s.url,!0),k.timeout=s.timeout;function C(){if(!k)return;const T=gi.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),_={data:!a||a==="text"||a==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:T,config:n,request:k};M3(function(B){t(B),x()},function(B){i(B),x()},_),k=null}"onloadend"in k?k.onloadend=C:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(C)},k.onabort=function(){k&&(i(new Ae("Request aborted",Ae.ECONNABORTED,n,k)),k=null)},k.onerror=function(E){const _=E&&E.message?E.message:"Network Error",R=new Ae(_,Ae.ERR_NETWORK,n,k);R.event=E||null,i(R),k=null},k.ontimeout=function(){let E=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const _=s.transitional||A3;s.timeoutErrorMessage&&(E=s.timeoutErrorMessage),i(new Ae(E,_.clarifyTimeoutError?Ae.ETIMEDOUT:Ae.ECONNABORTED,n,k)),k=null},r===void 0&&o.setContentType(null),"setRequestHeader"in k&&H.forEach(o.toJSON(),function(E,_){k.setRequestHeader(_,E)}),H.isUndefined(s.withCredentials)||(k.withCredentials=!!s.withCredentials),a&&a!=="json"&&(k.responseType=s.responseType),d&&([m,v]=Dy(d,!0),k.addEventListener("progress",m)),c&&k.upload&&([f,y]=Dy(c),k.upload.addEventListener("progress",f),k.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(h=T=>{k&&(i(!T||T.type?new bd(null,n,k):T),k.abort(),k=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const A=WQ(s.url);if(A&&Nn.protocols.indexOf(A)===-1){i(new Ae("Unsupported protocol "+A+":",Ae.ERR_BAD_REQUEST,n));return}k.send(r||null)})},e$=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,s;const r=function(d){if(!s){s=!0,a();const h=d instanceof Error?d:this.reason;i.abort(h instanceof Ae?h:new bd(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,r(new Ae(`timeout ${e} of ms exceeded`,Ae.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(d=>{d.unsubscribe?d.unsubscribe(r):d.removeEventListener("abort",r)}),n=null)};n.forEach(d=>d.addEventListener("abort",r));const{signal:c}=i;return c.unsubscribe=()=>H.asap(a),c}},t$=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,s;for(;i<t;)s=i+e,yield n.slice(i,s),i=s},n$=async function*(n,e){for await(const t of i$(n))yield*t$(t,e)},i$=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},jP=(n,e,t,i)=>{const s=n$(n,e);let r=0,o,a=c=>{o||(o=!0,i&&i(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await s.next();if(d){a(),c.close();return}let f=h.byteLength;if(t){let m=r+=f;t(m)}c.enqueue(new Uint8Array(h))}catch(d){throw a(d),d}},cancel(c){return a(c),s.return()}},{highWaterMark:2})},UP=64*1024,{isFunction:Um}=H,s$=(({Request:n,Response:e})=>({Request:n,Response:e}))(H.global),{ReadableStream:zP,TextEncoder:VP}=H.global,HP=(n,...e)=>{try{return!!n(...e)}catch{return!1}},r$=n=>{n=H.merge.call({skipUndefined:!0},s$,n);const{fetch:e,Request:t,Response:i}=n,s=e?Um(e):typeof fetch=="function",r=Um(t),o=Um(i);if(!s)return!1;const a=s&&Um(zP),c=s&&(typeof VP=="function"?(v=>x=>v.encode(x))(new VP):async v=>new Uint8Array(await new t(v).arrayBuffer())),d=r&&a&&HP(()=>{let v=!1;const x=new t(Nn.origin,{body:new zP,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!x}),h=o&&a&&HP(()=>H.isReadableStream(new i("").body)),f={stream:h&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!f[v]&&(f[v]=(x,k)=>{let C=x&&x[v];if(C)return C.call(x);throw new Ae(`Response type '${v}' is not supported`,Ae.ERR_NOT_SUPPORT,k)})});const m=async v=>{if(v==null)return 0;if(H.isBlob(v))return v.size;if(H.isSpecCompliantForm(v))return(await new t(Nn.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(H.isArrayBufferView(v)||H.isArrayBuffer(v))return v.byteLength;if(H.isURLSearchParams(v)&&(v=v+""),H.isString(v))return(await c(v)).byteLength},y=async(v,x)=>{const k=H.toFiniteNumber(v.getContentLength());return k??m(x)};return async v=>{let{url:x,method:k,data:C,signal:A,cancelToken:T,timeout:E,onDownloadProgress:_,onUploadProgress:R,responseType:B,headers:I,withCredentials:L="same-origin",fetchOptions:O}=P3(v),W=e||fetch;B=B?(B+"").toLowerCase():"text";let ie=e$([A,T&&T.toAbortSignal()],E),he=null;const ae=ie&&ie.unsubscribe&&(()=>{ie.unsubscribe()});let le;try{if(R&&d&&k!=="get"&&k!=="head"&&(le=await y(I,C))!==0){let ye=new t(x,{method:"POST",body:C,duplex:"half"}),_e;if(H.isFormData(C)&&(_e=ye.headers.get("content-type"))&&I.setContentType(_e),ye.body){const[Dt,Ye]=FP(le,Dy(OP(R)));C=jP(ye.body,UP,Dt,Ye)}}H.isString(L)||(L=L?"include":"omit");const K=r&&"credentials"in t.prototype,ee={...O,signal:ie,method:k.toUpperCase(),headers:I.normalize().toJSON(),body:C,duplex:"half",credentials:K?L:void 0};he=r&&new t(x,ee);let z=await(r?W(he,O):W(x,ee));const X=h&&(B==="stream"||B==="response");if(h&&(_||X&&ae)){const ye={};["status","statusText","headers"].forEach(Xt=>{ye[Xt]=z[Xt]});const _e=H.toFiniteNumber(z.headers.get("content-length")),[Dt,Ye]=_&&FP(_e,Dy(OP(_),!0))||[];z=new i(jP(z.body,UP,Dt,()=>{Ye&&Ye(),ae&&ae()}),ye)}B=B||"text";let te=await f[H.findKey(f,B)||"text"](z,v);return!X&&ae&&ae(),await new Promise((ye,_e)=>{M3(ye,_e,{data:te,headers:gi.from(z.headers),status:z.status,statusText:z.statusText,config:v,request:he})})}catch(K){throw ae&&ae(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new Ae("Network Error",Ae.ERR_NETWORK,v,he),{cause:K.cause||K}):Ae.from(K,K&&K.code,v,he)}}},o$=new Map,I3=n=>{let e=n&&n.env||{};const{fetch:t,Request:i,Response:s}=e,r=[i,s,t];let o=r.length,a=o,c,d,h=o$;for(;a--;)c=r[a],d=h.get(c),d===void 0&&h.set(c,d=a?new Map:r$(e)),h=d;return d};I3();const HT={http:kQ,xhr:ZQ,fetch:{get:I3}};H.forEach(HT,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const GP=n=>`- ${n}`,a$=n=>H.isFunction(n)||n===null||n===!1;function l$(n,e){n=H.isArray(n)?n:[n];const{length:t}=n;let i,s;const r={};for(let o=0;o<t;o++){i=n[o];let a;if(s=i,!a$(i)&&(s=HT[(a=String(i)).toLowerCase()],s===void 0))throw new Ae(`Unknown adapter '${a}'`);if(s&&(H.isFunction(s)||(s=s.get(e))))break;r[a||"#"+o]=s}if(!s){const o=Object.entries(r).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let a=t?o.length>1?`since :
`+o.map(GP).join(`
`):" "+GP(o[0]):"as no adapter specified";throw new Ae("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s}const B3={getAdapter:l$,adapters:HT};function wx(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new bd(null,n)}function WP(n){return wx(n),n.headers=gi.from(n.headers),n.data=kx.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),B3.getAdapter(n.adapter||up.adapter,n)(n).then(function(i){return wx(n),i.data=kx.call(n,n.transformResponse,i),i.headers=gi.from(i.headers),i},function(i){return _3(i)||(wx(n),i&&i.response&&(i.response.data=kx.call(n,n.transformResponse,i.response),i.response.headers=gi.from(i.response.headers))),Promise.reject(i)})}const D3="1.13.2",_v={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{_v[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const JP={};_v.transitional=function(e,t,i){function s(r,o){return"[Axios v"+D3+"] Transitional option '"+r+"'"+o+(i?". "+i:"")}return(r,o,a)=>{if(e===!1)throw new Ae(s(o," has been removed"+(t?" in "+t:"")),Ae.ERR_DEPRECATED);return t&&!JP[o]&&(JP[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,a):!0}};_v.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function c$(n,e,t){if(typeof n!="object")throw new Ae("options must be an object",Ae.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let s=i.length;for(;s-- >0;){const r=i[s],o=e[r];if(o){const a=n[r],c=a===void 0||o(a,r,n);if(c!==!0)throw new Ae("option "+r+" must be "+c,Ae.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ae("Unknown option "+r,Ae.ERR_BAD_OPTION)}}const Ug={assertOptions:c$,validators:_v},qs=Ug.validators;let Ul=class{constructor(e){this.defaults=e||{},this.interceptors={request:new DP,response:new DP}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const r=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?r&&!String(i.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+r):i.stack=r}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ql(this.defaults,t);const{transitional:i,paramsSerializer:s,headers:r}=t;i!==void 0&&Ug.assertOptions(i,{silentJSONParsing:qs.transitional(qs.boolean),forcedJSONParsing:qs.transitional(qs.boolean),clarifyTimeoutError:qs.transitional(qs.boolean)},!1),s!=null&&(H.isFunction(s)?t.paramsSerializer={serialize:s}:Ug.assertOptions(s,{encode:qs.function,serialize:qs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ug.assertOptions(t,{baseUrl:qs.spelling("baseURL"),withXsrfToken:qs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&H.merge(r.common,r[t.method]);r&&H.forEach(["delete","get","head","post","put","patch","common"],v=>{delete r[v]}),t.headers=gi.concat(o,r);const a=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(t)===!1||(c=c&&x.synchronous,a.unshift(x.fulfilled,x.rejected))});const d=[];this.interceptors.response.forEach(function(x){d.push(x.fulfilled,x.rejected)});let h,f=0,m;if(!c){const v=[WP.bind(this),void 0];for(v.unshift(...a),v.push(...d),m=v.length,h=Promise.resolve(t);f<m;)h=h.then(v[f++],v[f++]);return h}m=a.length;let y=t;for(;f<m;){const v=a[f++],x=a[f++];try{y=v(y)}catch(k){x.call(this,k);break}}try{h=WP.call(this,y)}catch(v){return Promise.reject(v)}for(f=0,m=d.length;f<m;)h=h.then(d[f++],d[f++]);return h}getUri(e){e=Ql(this.defaults,e);const t=R3(e.baseURL,e.url,e.allowAbsoluteUrls);return T3(t,e.params,e.paramsSerializer)}};H.forEach(["delete","get","head","options"],function(e){Ul.prototype[e]=function(t,i){return this.request(Ql(i||{},{method:e,url:t,data:(i||{}).data}))}});H.forEach(["post","put","patch"],function(e){function t(i){return function(r,o,a){return this.request(Ql(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}Ul.prototype[e]=t(),Ul.prototype[e+"Form"]=t(!0)});let u$=class N3{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const i=this;this.promise.then(s=>{if(!i._listeners)return;let r=i._listeners.length;for(;r-- >0;)i._listeners[r](s);i._listeners=null}),this.promise.then=s=>{let r;const o=new Promise(a=>{i.subscribe(a),r=a}).then(s);return o.cancel=function(){i.unsubscribe(r)},o},e(function(r,o,a){i.reason||(i.reason=new bd(r,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new N3(function(s){e=s}),cancel:e}}};function d$(n){return function(t){return n.apply(null,t)}}function h$(n){return H.isObject(n)&&n.isAxiosError===!0}const ck={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(ck).forEach(([n,e])=>{ck[e]=n});function F3(n){const e=new Ul(n),t=f3(Ul.prototype.request,e);return H.extend(t,Ul.prototype,e,{allOwnKeys:!0}),H.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return F3(Ql(n,s))},t}const ut=F3(up);ut.Axios=Ul;ut.CanceledError=bd;ut.CancelToken=u$;ut.isCancel=_3;ut.VERSION=D3;ut.toFormData=Ev;ut.AxiosError=Ae;ut.Cancel=ut.CanceledError;ut.all=function(e){return Promise.all(e)};ut.spread=d$;ut.isAxiosError=h$;ut.mergeConfig=Ql;ut.AxiosHeaders=gi;ut.formToJSON=n=>E3(H.isHTMLForm(n)?new FormData(n):n);ut.getAdapter=B3.getAdapter;ut.HttpStatusCode=ck;ut.default=ut;const{Axios:qne,AxiosError:Qne,CanceledError:$ne,isCancel:Xne,CancelToken:Yne,VERSION:Zne,all:eie,Cancel:tie,isAxiosError:nie,spread:iie,toFormData:sie,AxiosHeaders:rie,HttpStatusCode:oie,formToJSON:aie,getAdapter:lie,mergeConfig:cie}=ut,nd=({children:n})=>S.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white via-blue-50 to-purple-50 font-nunito",children:S.jsx(ke.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:n})}),O3=({text:n="Loading..."})=>S.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 p-8",children:[S.jsx("div",{className:"flex space-x-2",children:[0,1,2].map(e=>S.jsx(ke.div,{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full",animate:{y:[-10,10,-10]},transition:{duration:.6,repeat:1/0,delay:e*.1}},e))}),S.jsx("p",{className:"text-lg text-slate-600 font-semibold",children:n})]}),KP=["bg-[#FFD93D]","bg-[#FF6B6B]","bg-[#A29BFE]","bg-[#FF9F43]"],f$=n=>KP[n%KP.length],p$=async()=>(await ut.get("/api/avatars")).data.avatars,qP=({onClick:n,children:e,className:t="",color:i="bg-white",rotate:s=0})=>S.jsx(ke.div,{whileHover:{scale:1.02,rotate:0},whileTap:{scale:.96},onClick:n,className:`
      ${i} ${t}
      relative border-[3px] border-black rounded-[30px] p-4
      shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]
      cursor-pointer flex flex-col items-center justify-between
      transition-all duration-200 hover:shadow-[12px_12px_0px_0px_rgba(0,0,0,1)]
    `,style:{rotate:`${s}deg`},children:e}),m$=()=>{const n=tp(),{data:e=[],isLoading:t}=XF({queryKey:["avatars"],queryFn:p$});return t?S.jsx(nd,{children:S.jsx("div",{className:"min-h-screen bg-[#4D96FF] flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px"},children:S.jsx("div",{className:"bg-white p-8 rounded-3xl border-[3px] border-black shadow-[8px_8px_0px_0px_black]",children:S.jsx(O3,{text:"GATHERING THE SQUAD..."})})})}):S.jsx(nd,{children:S.jsx("div",{className:"min-h-screen bg-[#4D96FF] font-sans selection:bg-black selection:text-white pb-24 relative",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px",backgroundColor:"#4D96FF"},children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[S.jsxs("div",{className:"flex justify-between items-center mb-8",children:[S.jsxs(ke.button,{whileHover:{x:-2,y:-2,boxShadow:"4px 4px 0px 0px black"},whileTap:{x:0,y:0,boxShadow:"0px 0px 0px 0px black"},onClick:()=>n("/"),className:"bg-white px-5 py-3 rounded-xl border-[3px] border-black shadow-[2px_2px_0px_0px_black] flex items-center gap-2 group transition-all",children:[S.jsx("div",{className:"bg-black text-white p-1 rounded-md group-hover:bg-[#FF6B6B] transition-colors",children:S.jsx(Pf,{size:20,strokeWidth:3})}),S.jsx("span",{className:"font-black text-black text-sm md:text-base uppercase tracking-wide hidden sm:block",children:"Back Home"})]}),S.jsxs(ke.button,{whileHover:{x:2,y:-2,boxShadow:"6px 6px 0px 0px black"},whileTap:{x:0,y:0,boxShadow:"2px 2px 0px 0px black"},onClick:()=>n("/sessions"),className:"bg-[#A29BFE] px-5 py-3 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black] flex items-center gap-2 group transition-all",children:[S.jsx(kv,{size:20,strokeWidth:3,className:"text-black"}),S.jsx("span",{className:"font-black text-black text-sm md:text-base uppercase tracking-wide",children:"Session History"})]})]}),S.jsxs(ke.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,type:"spring",bounce:.4},className:"text-center mb-16 relative",children:[S.jsx(jl,{className:"absolute top-0 left-4 md:left-1/4 w-12 h-12 text-[#FFD93D] animate-pulse",strokeWidth:3}),S.jsx(jl,{className:"absolute bottom-0 right-4 md:right-1/4 w-8 h-8 text-[#FF6B6B] animate-bounce",strokeWidth:3}),S.jsx("div",{className:"inline-block bg-black text-[#FFD93D] px-6 py-2 rounded-full border-[3px] border-white shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] font-black text-xl -rotate-2 mb-4",children:"WELCOME BACK! "}),S.jsx("h1",{className:"text-6xl md:text-8xl font-black text-white drop-shadow-[6px_6px_0px_rgba(0,0,0,1)] flex flex-wrap items-center justify-center gap-4 tracking-tight",style:{WebkitTextStroke:"3px black"},children:"MY AI SQUAD"}),S.jsx("p",{className:"text-2xl font-black text-black mt-4 uppercase tracking-wide",children:"Chat, Play, and Learn Together! "})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:[e.map((i,s)=>S.jsx(ke.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:s*.1,duration:.4},children:S.jsxs(qP,{onClick:()=>n("/chat",{state:{avatar:i}}),color:f$(s),rotate:s%2===0?1:-1,className:"h-full min-h-[400px]",children:[S.jsxs("div",{className:"w-full aspect-square bg-white rounded-[20px] border-[3px] border-black mb-4 overflow-hidden relative shadow-sm group",children:[S.jsx("img",{src:i.image_url,alt:i.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"}),S.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:S.jsx(a3,{size:64,className:"text-white drop-shadow-lg",strokeWidth:3})})]}),S.jsxs("div",{className:"text-center w-full bg-white/50 rounded-xl p-3 border-2 border-black/10",children:[S.jsx("h3",{className:"text-3xl font-black text-black uppercase leading-none mb-2",children:i.name}),S.jsx("div",{className:"flex items-center justify-center gap-2",children:S.jsx("span",{className:"bg-black text-white text-xs font-bold px-3 py-1 rounded-full uppercase",children:"Chat Now"})})]}),S.jsx("div",{className:"absolute -top-3 bg-white w-6 h-6 rounded-full border-[3px] border-black shadow-sm z-10"})]})},i.id)),S.jsx(ke.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:e.length*.1,duration:.4},children:S.jsxs(qP,{onClick:()=>n("/create"),color:"bg-[#6BCB77]",rotate:2,className:"h-full min-h-[400px] justify-center group",children:[S.jsx(ke.div,{whileHover:{rotate:90},transition:{duration:.3},className:"mb-6 bg-white rounded-full p-6 border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:S.jsx(uq,{className:"w-16 h-16 text-black",strokeWidth:4})}),S.jsxs("h3",{className:"text-4xl font-black text-white drop-shadow-[3px_3px_0px_black] text-center uppercase leading-none",style:{WebkitTextStroke:"1.5px black"},children:["Create ",S.jsx("br",{})," New Friend"]}),S.jsx("div",{className:"mt-4 bg-black text-[#6BCB77] px-4 py-2 rounded-lg font-black uppercase text-sm border-[2px] border-white shadow-lg",children:"Let's Build! "})]})})]}),e.length===0&&!t&&S.jsx(ke.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-12 text-center",children:S.jsx("div",{className:"inline-block bg-white p-6 rounded-2xl border-[3px] border-black shadow-[8px_8px_0px_0px_black] rotate-1",children:S.jsx("p",{className:"text-2xl font-black",children:"It's quiet in here... click the Green Card to start! "})})})]})})})},Tx=[{id:"pNInz6obpgDQGcFmaJgB",name:"Adam",gender:"Male",accent:"American"},{id:"21m00Tcm4TlvDq8ikWAM",name:"Rachel",gender:"Female",accent:"American"},{id:"EXAVITQu4vr4xnSDxMaL",name:"Sarah",gender:"Female",accent:"American"},{id:"nPczCjzI2devNBz1zQrb",name:"Brian",gender:"Male",accent:"American"},{id:"AZnzlk1XvdvUeBnXmlld",name:"Domi",gender:"Female",accent:"American"},{id:"ErXwobaYiN019PkySvjV",name:"Antoni",gender:"Male",accent:"American"},{id:"MF3mGyEYCl7XYWbV9V6O",name:"Elli",gender:"Female",accent:"American"},{id:"TxGEqnHWrfWFTfGW9XjX",name:"Josh",gender:"Male",accent:"American"},{id:"VR6AewLTigWG4xSOukaG",name:"Arnold",gender:"Male",accent:"American"},{id:"pFZP5JQG7iQjIQuC4Bku",name:"Lily",gender:"Female",accent:"British"}],g$=n=>{const e=["bg-[#FFD93D]","bg-[#FF6B6B]","bg-[#6BCB77]","bg-[#4D96FF]","bg-[#A29BFE]"];return e[n%e.length]},Oo=({onClick:n,disabled:e,children:t,colorClass:i="bg-black text-white",icon:s,className:r=""})=>S.jsxs(ke.button,{whileHover:{x:-2,y:-2},whileTap:{x:2,y:2},onClick:n,disabled:e,className:`
      relative w-full py-4 px-6 rounded-xl font-black text-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]
      flex items-center justify-center gap-3 transition-all
      ${e?"opacity-50 grayscale cursor-not-allowed":`${i} hover:shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]`}
      ${r}
    `,children:[s&&S.jsx(s,{size:24,strokeWidth:3}),t]}),zm=({title:n,color:e,icon:t,children:i,rotate:s=0})=>S.jsxs("div",{className:`
      ${e} p-6 rounded-3xl border-[3px] border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] relative
      transform transition-transform hover:scale-[1.01] mb-8
    `,style:{rotate:`${s}deg`},children:[S.jsxs("div",{className:"absolute -top-6 left-6 bg-black text-white px-4 py-2 rounded-lg border-[3px] border-white shadow-[2px_2px_0px_0px_rgba(0,0,0,0.5)] flex items-center gap-2 transform -rotate-2 z-10",children:[S.jsx(t,{size:18,className:"text-[#FFD93D]"}),S.jsx("span",{className:"font-black uppercase tracking-wider text-sm",children:n})]}),S.jsx("div",{className:"mt-4",children:i})]}),y$=()=>{var A;const n=tp(),e=Qw(),[t,i]=P.useState(null),[s,r]=P.useState(!1),o=P.useRef(null),[a,c]=P.useState({name:"",description:"",knowledgeBase:"",imageUrl:"",systemPrompt:"",voiceId:Tx[0].id,language:"en"}),d=Im({mutationFn:async T=>(await ut.post("/api/generate-image",T)).data,onSuccess:T=>c(E=>({...E,imageUrl:T.image_url}))}),h=Im({mutationFn:async T=>(await ut.post("/api/generate-prompt",T)).data,onSuccess:T=>c(E=>({...E,systemPrompt:T.system_prompt}))}),f=Im({mutationFn:async T=>(await ut.post("/api/create-agent",T)).data,onSuccess:()=>{e.invalidateQueries(["avatars"]),n("/dashboard")}}),m=()=>{a.name.trim()&&d.mutate({name:a.name,description:a.description||"portrait"})},y=Im({mutationFn:async T=>{const E=new FormData;return E.append("file",T),(await ut.post("/api/upload-avatar-image",E,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:T=>{c(E=>({...E,imageUrl:T.image_url}))}}),v=T=>{var _;const E=(_=T.target.files)==null?void 0:_[0];E&&y.mutate(E)},x=()=>{a.knowledgeBase.trim()&&h.mutate({knowledge_base:a.knowledgeBase})},k=()=>{a.name&&a.imageUrl&&a.systemPrompt&&f.mutate({name:a.name,image_url:a.imageUrl,system_prompt:a.systemPrompt,voice_id:a.voiceId,language:a.language,first_message:`Hi! I'm ${a.name}. Let's chat!`,model_id:a.language==="en"?"eleven_turbo_v2":"eleven_turbo_v2_5"})},C=(T,E)=>{T.stopPropagation(),i(t===E?null:E)};return S.jsx(nd,{children:S.jsxs("div",{className:"min-h-screen bg-[#4D96FF] p-6 font-sans selection:bg-black selection:text-white pb-24",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px",backgroundColor:"#4D96FF"},children:[S.jsxs("div",{className:"max-w-7xl mx-auto",children:[S.jsxs("div",{className:"flex justify-between items-center mb-10",children:[S.jsx(Oo,{onClick:()=>n("/dashboard"),colorClass:"bg-white text-black",icon:Pf,className:"w-auto",children:"Back"}),S.jsx("div",{className:"hidden md:block bg-black text-[#FFD93D] px-6 py-3 rounded-full border-[3px] border-white shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] font-black text-xl rotate-1",children:"BUILD-A-BUDDY WORKSHOP "})]}),S.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-start",children:[S.jsxs("div",{className:"lg:col-span-7",children:[S.jsx("div",{className:"text-center lg:text-left mb-8",children:S.jsxs("h1",{className:"text-6xl font-black text-white drop-shadow-[4px_4px_0px_rgba(0,0,0,1)] tracking-tight",style:{WebkitTextStroke:"2px black"},children:["MAKE YOUR ",S.jsx("br",{})," ",S.jsx("span",{className:"text-[#FFD93D]",children:"NEW BEST FRIEND!"})]})}),S.jsx(zm,{title:"Step 1: The Basics",color:"bg-[#FF6B6B]",icon:OT,rotate:-1,children:S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"font-black text-black text-lg mb-1 block",children:"NAME *"}),S.jsx("input",{value:a.name,onChange:T=>c({...a,name:T.target.value}),placeholder:"e.g. Buddy the Robot",className:"w-full text-2xl font-black p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] focus:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] outline-none"})]}),S.jsxs("div",{children:[S.jsxs("label",{className:"font-black text-black text-lg mb-1 block flex items-center gap-2",children:["LANGUAGE ",S.jsx(GK,{size:20})]}),S.jsxs("div",{className:"relative",children:[S.jsxs("select",{value:a.language,onChange:T=>c({...a,language:T.target.value}),className:"w-full text-xl font-bold p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] outline-none appearance-none bg-white cursor-pointer",children:[S.jsx("option",{value:"en",children:"English "}),S.jsx("option",{value:"hi",children:"Hindi "}),S.jsx("option",{value:"es",children:"Spanish "}),S.jsx("option",{value:"fr",children:"French "})]}),S.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:S.jsx(Pf,{className:"-rotate-90",strokeWidth:3})})]})]})]})}),S.jsx(zm,{title:"Step 2: Appearance",color:"bg-[#FFD93D]",icon:xx,rotate:1,children:S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"font-black text-black text-lg mb-1 block",children:"DESCRIPTION"}),S.jsx("input",{value:a.description,onChange:T=>c({...a,description:T.target.value}),placeholder:"e.g. friendly cartoon, colorful",className:"w-full text-lg font-bold p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] outline-none bg-white"})]}),S.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[S.jsx(Oo,{onClick:m,disabled:!a.name||d.isPending,colorClass:"bg-black text-white",icon:Bq,children:d.isPending?"PAINTING...":"GENERATE IMAGE"}),S.jsx(Oo,{onClick:()=>{var T;return(T=o.current)==null?void 0:T.click()},disabled:y.isPending,colorClass:"bg-white text-black",icon:xx,children:y.isPending?"UPLOADING...":"UPLOAD PHOTO"})]}),S.jsx("input",{ref:o,type:"file",accept:"image/*",onChange:v,className:"hidden"})]})}),S.jsx(zm,{title:"Step 3: Personality",color:"bg-[#4D96FF]",icon:jT,rotate:-.5,children:S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"font-black text-black text-lg mb-1 block",children:"KNOWLEDGE BASE *"}),S.jsx("textarea",{value:a.knowledgeBase,onChange:T=>c({...a,knowledgeBase:T.target.value}),placeholder:"Tell us what your friend is good at! (e.g. Helping with homework, jokes)",rows:4,className:"w-full text-lg font-bold p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] outline-none resize-none bg-white"})]}),S.jsx(Oo,{onClick:x,disabled:!a.knowledgeBase||h.isPending,colorClass:"bg-[#FFF]",className:"text-black",icon:jl,children:h.isPending?"GENERATING...":"GENERATE PERSONALITY"})]})}),S.jsx(zm,{title:"Step 4: Pick a Voice",color:"bg-[#6BCB77]",icon:h3,rotate:1,children:S.jsxs("div",{className:"space-y-4",children:[S.jsx(Oo,{onClick:()=>r(!0),colorClass:"bg-[#F0F0F0] text-black",icon:jl,children:"CLONE YOUR OWN VOICE "}),S.jsx("div",{className:"grid grid-cols-2 gap-4 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:Tx.map((T,E)=>S.jsxs(ke.div,{whileTap:{scale:.95},onClick:()=>c({...a,voiceId:T.id}),className:`
                          cursor-pointer border-[3px] border-black rounded-xl p-3 flex flex-col gap-2 relative shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all
                          ${g$(E)}
                          ${a.voiceId===T.id?"translate-x-[2px] translate-y-[2px] shadow-none ring-4 ring-white":"hover:-translate-y-1"}
                        `,children:[S.jsxs("div",{className:"flex justify-between items-start",children:[S.jsx("span",{className:"font-black text-black uppercase text-sm",children:T.name}),a.voiceId===T.id&&S.jsx("div",{className:"bg-black text-white rounded-full p-1",children:S.jsx(jm,{size:10,strokeWidth:4})})]}),S.jsxs("div",{className:"flex flex-wrap gap-1",children:[S.jsx("span",{className:"text-[10px] font-bold bg-black/10 px-1 rounded",children:T.gender}),S.jsx("span",{className:"text-[10px] font-bold bg-black/10 px-1 rounded",children:T.accent})]}),S.jsx("button",{onClick:_=>C(_,T.id),className:"mt-2 w-full py-2 bg-white border-2 border-black rounded-lg flex items-center justify-center hover:bg-black hover:text-white transition-colors",children:t===T.id?S.jsx(rq,{size:14,fill:"currentColor"}):S.jsx(FT,{size:14,fill:"currentColor"})})]},T.id))})]})})]}),S.jsx("div",{className:"lg:col-span-5 relative",children:S.jsx("div",{className:"sticky top-6",children:S.jsxs("div",{className:"bg-[#A29BFE] p-6 rounded-[40px] border-[4px] border-black shadow-[12px_12px_0px_0px_rgba(0,0,0,1)] rotate-1",children:[S.jsx("div",{className:"flex justify-center -mt-10 mb-6",children:S.jsx("div",{className:"bg-black text-white px-8 py-2 rounded-full border-[3px] border-white font-black text-xl shadow-lg",children:"YOUR FRIEND"})}),S.jsx("div",{className:"bg-white p-4 rounded-[30px] border-[3px] border-black mb-6 shadow-[inset_4px_4px_0px_0px_rgba(0,0,0,0.1)]",children:S.jsx("div",{className:"aspect-square bg-slate-100 rounded-[20px] overflow-hidden border-[2px] border-black relative",children:d.isPending?S.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#FFD93D]",children:[S.jsx(ke.div,{animate:{rotate:360},transition:{repeat:1/0,duration:2,ease:"linear"},children:S.jsx(u3,{size:60,strokeWidth:3,className:"text-black"})}),S.jsx("p",{className:"mt-4 font-black text-xl",children:"PAINTING..."})]}):a.imageUrl?S.jsx("img",{src:a.imageUrl,alt:"Avatar",className:"w-full h-full object-cover"}):S.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#f0f0f0] text-gray-400",children:[S.jsx(xx,{size:64}),S.jsx("p",{className:"font-black mt-2",children:"NO PHOTO YET"})]})})}),a.systemPrompt&&S.jsxs(ke.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#6BCB77] p-4 rounded-xl border-[3px] border-black mb-6",children:[S.jsx("p",{className:"font-black text-black text-xs uppercase mb-1",children:"Generated Personality:"}),S.jsx("p",{className:"font-bold text-sm line-clamp-3",children:a.systemPrompt})]}),S.jsxs("div",{className:"text-center space-y-4",children:[S.jsxs("div",{children:[S.jsx("h2",{className:"text-4xl font-black text-black uppercase break-words leading-none mb-2",children:a.name||"???"}),S.jsx("p",{className:"font-bold text-black/60 uppercase tracking-widest text-sm",children:(A=Tx.find(T=>T.id===a.voiceId))==null?void 0:A.name})]}),S.jsx(Oo,{onClick:k,disabled:!a.systemPrompt||f.isPending,colorClass:"bg-[#FF6B6B] text-white",icon:pq,children:f.isPending?"BUILDING...":"SAVE FRIEND!"})]})]})})})]})]}),S.jsx(BT,{children:s&&S.jsx(ke.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>r(!1),children:S.jsxs(ke.div,{initial:{scale:.8,y:50,rotate:-2},animate:{scale:1,y:0,rotate:0},exit:{scale:.8,y:50},onClick:T=>T.stopPropagation(),className:"bg-[#FFD93D] rounded-3xl p-8 max-w-md w-full border-[4px] border-black shadow-[16px_16px_0px_0px_rgba(0,0,0,1)] relative overflow-hidden",children:[S.jsx("button",{onClick:()=>r(!1),className:"absolute top-4 right-4 font-black hover:scale-110",children:"X"}),S.jsxs("div",{className:"text-center relative z-10",children:[S.jsx("div",{className:"w-20 h-20 bg-white border-[3px] border-black rounded-full flex items-center justify-center mx-auto mb-6 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]",children:S.jsx(jl,{className:"w-10 h-10 text-black",strokeWidth:3})}),S.jsx("h2",{className:"text-3xl font-black text-black mb-4 uppercase leading-none",children:"Clone Your Voice "}),S.jsx("p",{className:"text-lg font-bold text-black/70 mb-6",children:"Create an AI that sounds exactly like you! Upload voice samples to train a custom model."}),S.jsxs("div",{className:"bg-white border-[3px] border-black rounded-xl p-4 mb-6 rotate-1",children:[S.jsxs("div",{className:"flex items-center justify-center gap-1",children:[S.jsx("span",{className:"text-4xl font-black text-[#FF6B6B]",children:"$5"}),S.jsx("span",{className:"font-bold text-black",children:"/month"})]}),S.jsx("p",{className:"text-xs font-black uppercase mt-1",children:"Unlimited voice clones"})]}),S.jsxs("ul",{className:"text-left font-bold text-black space-y-2 mb-8 pl-4",children:[S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx(jm,{className:"text-[#6BCB77]",strokeWidth:4})," High-quality cloning"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx(jm,{className:"text-[#6BCB77]",strokeWidth:4})," Unlimited voices"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx(jm,{className:"text-[#6BCB77]",strokeWidth:4})," Priority Support"]})]}),S.jsxs("div",{className:"flex gap-4",children:[S.jsx(Oo,{onClick:()=>r(!1),colorClass:"bg-white text-black",className:"text-base",children:"Maybe Later"}),S.jsx(Oo,{onClick:()=>{},colorClass:"bg-[#FF6B6B] text-white",className:"text-base",children:"Upgrade Now"})]})]})]})})})]})})};var QP={};function v$(n,e){return e.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(i){if(i!=="default"&&!(i in n)){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}})}),Object.freeze(n)}var b$=Object.defineProperty,x$=(n,e,t)=>e in n?b$(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$P=(n,e,t)=>x$(n,typeof e!="symbol"?e+"":e,t);let $n=class{constructor(){$P(this,"_locking"),$P(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const t=new Promise(s=>e=()=>{this._locks-=1,s()}),i=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),i}};function It(n,e){if(!n)throw new Error(e)}const S$=34028234663852886e22,C$=-34028234663852886e22,k$=4294967295,w$=2147483647,T$=-2147483648;function zg(n){if(typeof n!="number")throw new Error("invalid int 32: "+typeof n);if(!Number.isInteger(n)||n>w$||n<T$)throw new Error("invalid int 32: "+n)}function uk(n){if(typeof n!="number")throw new Error("invalid uint 32: "+typeof n);if(!Number.isInteger(n)||n>k$||n<0)throw new Error("invalid uint 32: "+n)}function L3(n){if(typeof n!="number")throw new Error("invalid float 32: "+typeof n);if(Number.isFinite(n)&&(n>S$||n<C$))throw new Error("invalid float 32: "+n)}const j3=Symbol("@bufbuild/protobuf/enum-type");function A$(n){const e=n[j3];return It(e,"missing enum type on enum object"),e}function U3(n,e,t,i){n[j3]=z3(e,t.map(s=>({no:s.no,name:s.name,localName:n[s.no]})))}function z3(n,e,t){const i=Object.create(null),s=Object.create(null),r=[];for(const o of e){const a=V3(o);r.push(a),i[o.name]=a,s[o.no]=a}return{typeName:n,values:r,findName(o){return i[o]},findNumber(o){return s[o]}}}function E$(n,e,t){const i={};for(const s of e){const r=V3(s);i[r.localName]=r.no,i[r.no]=r.localName}return U3(i,n,e),i}function V3(n){return"localName"in n?n:Object.assign(Object.assign({},n),{localName:n.name})}class GT{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const i=this.getType(),s=i.runtime.bin,r=s.makeReadOptions(t);return s.readMessage(this,r.readerFactory(e),e.byteLength,r),this}fromJson(e,t){const i=this.getType(),s=i.runtime.json,r=s.makeReadOptions(t);return s.readMessage(i,e,r,this),this}fromJsonString(e,t){let i;try{i=JSON.parse(e)}catch(s){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(s instanceof Error?s.message:String(s)))}return this.fromJson(i,t)}toBinary(e){const t=this.getType(),i=t.runtime.bin,s=i.makeWriteOptions(e),r=s.writerFactory();return i.writeMessage(this,r,s),r.finish()}toJson(e){const t=this.getType(),i=t.runtime.json,s=i.makeWriteOptions(e);return i.writeMessage(this,s)}toJsonString(e){var t;const i=this.toJson(e);return JSON.stringify(i,null,(t=e==null?void 0:e.prettySpaces)!==null&&t!==void 0?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function _$(n,e,t,i){var s;const r=(s=i==null?void 0:i.localName)!==null&&s!==void 0?s:e.substring(e.lastIndexOf(".")+1),o={[r]:function(a){n.util.initFields(this),n.util.initPartial(a,this)}}[r];return Object.setPrototypeOf(o.prototype,new GT),Object.assign(o,{runtime:n,typeName:e,fields:n.util.newFieldList(t),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return n.util.equals(o,a,c)}}),o}function M$(){let n=0,e=0;for(let i=0;i<28;i+=7){let s=this.buf[this.pos++];if(n|=(s&127)<<i,!(s&128))return this.assertBounds(),[n,e]}let t=this.buf[this.pos++];if(n|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[n,e];for(let i=3;i<=31;i+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<i,!(s&128))return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function Ax(n,e,t){for(let r=0;r<28;r=r+7){const o=n>>>r,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(t.push(c),!a)return}const i=n>>>28&15|(e&7)<<4,s=!!(e>>3);if(t.push((s?i|128:i)&255),!!s){for(let r=3;r<31;r=r+7){const o=e>>>r,a=!!(o>>>7),c=(a?o|128:o)&255;if(t.push(c),!a)return}t.push(e>>>31&1)}}const Vg=4294967296;function XP(n){const e=n[0]==="-";e&&(n=n.slice(1));const t=1e6;let i=0,s=0;function r(o,a){const c=Number(n.slice(o,a));s*=t,i=i*t+c,i>=Vg&&(s=s+(i/Vg|0),i=i%Vg)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),e?G3(i,s):WT(i,s)}function R$(n,e){let t=WT(n,e);const i=t.hi&2147483648;i&&(t=G3(t.lo,t.hi));const s=H3(t.lo,t.hi);return i?"-"+s:s}function H3(n,e){if({lo:n,hi:e}=P$(n,e),e<=2097151)return String(Vg*e+n);const t=n&16777215,i=(n>>>24|e<<8)&16777215,s=e>>16&65535;let r=t+i*6777216+s*6710656,o=i+s*8147497,a=s*2;const c=1e7;return r>=c&&(o+=Math.floor(r/c),r%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+YP(o)+YP(r)}function P$(n,e){return{lo:n>>>0,hi:e>>>0}}function WT(n,e){return{lo:n|0,hi:e|0}}function G3(n,e){return e=~e,n?n=~n+1:e+=1,WT(n,e)}const YP=n=>{const e=String(n);return"0000000".slice(e.length)+e};function ZP(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let t=0;t<9;t++)e.push(n&127|128),n=n>>7;e.push(1)}}function I$(){let n=this.buf[this.pos++],e=n&127;if(!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,!(n&128))return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,!(n&128))return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let t=5;n&128&&t<10;t++)n=this.buf[this.pos++];if(n&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function B$(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof QP!="object"||QP.BUF_BIGINT_DISABLE!=="1")){const s=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const d=typeof c=="bigint"?c:BigInt(c);if(d>r||d<s)throw new Error("int64 invalid: ".concat(c));return d},uParse(c){const d=typeof c=="bigint"?c:BigInt(c);if(d>a||d<o)throw new Error("uint64 invalid: ".concat(c));return d},enc(c){return n.setBigInt64(0,this.parse(c),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(c){return n.setBigInt64(0,this.uParse(c),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(c,d){return n.setInt32(0,c,!0),n.setInt32(4,d,!0),n.getBigInt64(0,!0)},uDec(c,d){return n.setInt32(0,c,!0),n.setInt32(4,d,!0),n.getBigUint64(0,!0)}}}const t=s=>It(/^-?[0-9]+$/.test(s),"int64 invalid: ".concat(s)),i=s=>It(/^[0-9]+$/.test(s),"uint64 invalid: ".concat(s));return{zero:"0",supported:!1,parse(s){return typeof s!="string"&&(s=s.toString()),t(s),s},uParse(s){return typeof s!="string"&&(s=s.toString()),i(s),s},enc(s){return typeof s!="string"&&(s=s.toString()),t(s),XP(s)},uEnc(s){return typeof s!="string"&&(s=s.toString()),i(s),XP(s)},dec(s,r){return R$(s,r)},uDec(s,r){return H3(s,r)}}}const gt=B$();var $;(function(n){n[n.DOUBLE=1]="DOUBLE",n[n.FLOAT=2]="FLOAT",n[n.INT64=3]="INT64",n[n.UINT64=4]="UINT64",n[n.INT32=5]="INT32",n[n.FIXED64=6]="FIXED64",n[n.FIXED32=7]="FIXED32",n[n.BOOL=8]="BOOL",n[n.STRING=9]="STRING",n[n.BYTES=12]="BYTES",n[n.UINT32=13]="UINT32",n[n.SFIXED32=15]="SFIXED32",n[n.SFIXED64=16]="SFIXED64",n[n.SINT32=17]="SINT32",n[n.SINT64=18]="SINT64"})($||($={}));var Ia;(function(n){n[n.BIGINT=0]="BIGINT",n[n.STRING=1]="STRING"})(Ia||(Ia={}));function Lo(n,e,t){if(e===t)return!0;if(n==$.BYTES){if(!(e instanceof Uint8Array)||!(t instanceof Uint8Array)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}switch(n){case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==t}return!1}function id(n,e){switch(n){case $.BOOL:return!1;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==0?gt.zero:"0";case $.DOUBLE:case $.FLOAT:return 0;case $.BYTES:return new Uint8Array(0);case $.STRING:return"";default:return 0}}function W3(n,e){switch(n){case $.BOOL:return e===!1;case $.STRING:return e==="";case $.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var jt;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(jt||(jt={}));class D${constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let t=new Uint8Array(e),i=0;for(let s=0;s<this.chunks.length;s++)t.set(this.chunks[s],i),i+=this.chunks[s].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(uk(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return zg(e),ZP(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){L3(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){uk(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){zg(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return zg(e),e=(e<<1^e>>31)>>>0,ZP(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),i=new DataView(t.buffer),s=gt.enc(e);return i.setInt32(0,s.lo,!0),i.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),i=new DataView(t.buffer),s=gt.uEnc(e);return i.setInt32(0,s.lo,!0),i.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=gt.enc(e);return Ax(t.lo,t.hi,this.buf),this}sint64(e){let t=gt.enc(e),i=t.hi>>31,s=t.lo<<1^i,r=(t.hi<<1|t.lo>>>31)^i;return Ax(s,r,this.buf),this}uint64(e){let t=gt.uEnc(e);return Ax(t.lo,t.hi,this.buf),this}}class N${constructor(e,t){this.varint64=M$,this.uint32=I$,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,i=e&7;if(t<=0||i<0||i>5)throw new Error("illegal tag: field no "+t+" wire type "+i);return[t,i]}skip(e,t){let i=this.pos;switch(e){case jt.Varint:for(;this.buf[this.pos++]&128;);break;case jt.Bit64:this.pos+=4;case jt.Bit32:this.pos+=4;break;case jt.LengthDelimited:let s=this.uint32();this.pos+=s;break;case jt.StartGroup:for(;;){const[r,o]=this.tag();if(o===jt.EndGroup){if(t!==void 0&&r!==t)throw new Error("invalid end group tag");break}this.skip(o,r)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(i,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return gt.dec(...this.varint64())}uint64(){return gt.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),i=-(e&1);return e=(e>>>1|(t&1)<<31)^i,t=t>>>1^i,gt.dec(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return gt.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return gt.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function F$(n,e,t,i){let s;return{typeName:e,extendee:t,get field(){if(!s){const r=typeof i=="function"?i():i;r.name=e.split(".").pop(),r.jsonName="[".concat(e,"]"),s=n.util.newFieldList([r]).list()[0]}return s},runtime:n}}function J3(n){const e=n.field.localName,t=Object.create(null);return t[e]=O$(n),[t,()=>t[e]]}function O$(n){const e=n.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return id(e.T,e.L);case"message":const t=e.T,i=new t;return t.fieldWrapper?t.fieldWrapper.unwrapField(i):i;case"map":throw"map fields are not allowed to be extensions"}}function L$(n,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let t=n.length-1;t>=0;--t)if(n[t].no==e.no)return[n[t]];return[]}return n.filter(t=>t.no===e.no)}let Gr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Mv=[];for(let n=0;n<Gr.length;n++)Mv[Gr[n].charCodeAt(0)]=n;Mv[45]=Gr.indexOf("+");Mv[95]=Gr.indexOf("/");const K3={dec(n){let e=n.length*3/4;n[n.length-2]=="="?e-=2:n[n.length-1]=="="&&(e-=1);let t=new Uint8Array(e),i=0,s=0,r,o=0;for(let a=0;a<n.length;a++){if(r=Mv[n.charCodeAt(a)],r===void 0)switch(n[a]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=r,s=1;break;case 1:t[i++]=o<<2|(r&48)>>4,o=r,s=2;break;case 2:t[i++]=(o&15)<<4|(r&60)>>2,o=r,s=3;break;case 3:t[i++]=(o&3)<<6|r,s=0;break}}if(s==1)throw Error("invalid base64 string.");return t.subarray(0,i)},enc(n){let e="",t=0,i,s=0;for(let r=0;r<n.length;r++)switch(i=n[r],t){case 0:e+=Gr[i>>2],s=(i&3)<<4,t=1;break;case 1:e+=Gr[s|i>>4],s=(i&15)<<2,t=2;break;case 2:e+=Gr[s|i>>6],e+=Gr[i&63],t=0;break}return t&&(e+=Gr[s],e+="=",t==1&&(e+="=")),e}};function j$(n,e,t){Q3(e,n);const i=e.runtime.bin.makeReadOptions(t),s=L$(n.getType().runtime.bin.listUnknownFields(n),e.field),[r,o]=J3(e);for(const a of s)e.runtime.bin.readField(r,i.readerFactory(a.data),e.field,a.wireType,i);return o()}function U$(n,e,t,i){Q3(e,n);const s=e.runtime.bin.makeReadOptions(i),r=e.runtime.bin.makeWriteOptions(i);if(q3(n,e)){const d=n.getType().runtime.bin.listUnknownFields(n).filter(h=>h.no!=e.field.no);n.getType().runtime.bin.discardUnknownFields(n);for(const h of d)n.getType().runtime.bin.onUnknownField(n,h.no,h.wireType,h.data)}const o=r.writerFactory();let a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,t,o,r);const c=s.readerFactory(o.finish());for(;c.pos<c.len;){const[d,h]=c.tag(),f=c.skip(h,d);n.getType().runtime.bin.onUnknownField(n,d,h,f)}}function q3(n,e){const t=n.getType();return e.extendee.typeName===t.typeName&&!!t.runtime.bin.listUnknownFields(n).find(i=>i.no==e.field.no)}function Q3(n,e){It(n.extendee.typeName==e.getType().typeName,"extension ".concat(n.typeName," can only be applied to message ").concat(n.extendee.typeName))}function $3(n,e){const t=n.localName;if(n.repeated)return e[t].length>0;if(n.oneof)return e[n.oneof.localName].case===t;switch(n.kind){case"enum":case"scalar":return n.opt||n.req?e[t]!==void 0:n.kind=="enum"?e[t]!==n.T.values[0].no:!W3(n.T,e[t]);case"message":return e[t]!==void 0;case"map":return Object.keys(e[t]).length>0}}function eI(n,e){const t=n.localName,i=!n.opt&&!n.req;if(n.repeated)e[t]=[];else if(n.oneof)e[n.oneof.localName]={case:void 0};else switch(n.kind){case"map":e[t]={};break;case"enum":e[t]=i?n.T.values[0].no:void 0;break;case"scalar":e[t]=i?id(n.T,n.L):void 0;break;case"message":e[t]=void 0;break}}function Wr(n,e){if(n===null||typeof n!="object"||!Object.getOwnPropertyNames(GT.prototype).every(i=>i in n&&typeof n[i]=="function"))return!1;const t=n.getType();return t===null||typeof t!="function"||!("typeName"in t)||typeof t.typeName!="string"?!1:e===void 0?!0:t.typeName==e.typeName}function X3(n,e){return Wr(e)||!n.fieldWrapper?e:n.fieldWrapper.wrapField(e)}$.DOUBLE,$.FLOAT,$.INT64,$.UINT64,$.INT32,$.UINT32,$.BOOL,$.STRING,$.BYTES;const tI={ignoreUnknownFields:!1},nI={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function z$(n){return n?Object.assign(Object.assign({},tI),n):tI}function V$(n){return n?Object.assign(Object.assign({},nI),n):nI}const Ny=Symbol(),Hg=Symbol();function H$(){return{makeReadOptions:z$,makeWriteOptions:V$,readMessage(n,e,t,i){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(Xs(e)));i=i??new n;const s=new Map,r=t.typeRegistry;for(const[o,a]of Object.entries(e)){const c=n.fields.findJsonName(o);if(c){if(c.oneof){if(a===null&&c.kind=="scalar")continue;const d=s.get(c.oneof);if(d!==void 0)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(d,'", "').concat(o,'"'));s.set(c.oneof,o)}iI(i,a,c,t,n)}else{let d=!1;if(r!=null&&r.findExtension&&o.startsWith("[")&&o.endsWith("]")){const h=r.findExtension(o.substring(1,o.length-1));if(h&&h.extendee.typeName==n.typeName){d=!0;const[f,m]=J3(h);iI(f,a,h.field,t,h),U$(i,h,m(),t)}}if(!d&&!t.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return i},writeMessage(n,e){const t=n.getType(),i={};let s;try{for(s of t.fields.byNumber()){if(!$3(s,n)){if(s.req)throw"required field not set";if(!e.emitDefaultValues||!W$(s))continue}const o=s.oneof?n[s.oneof.localName].value:n[s.localName],a=sI(s,o,e);a!==void 0&&(i[e.useProtoFieldName?s.name:s.jsonName]=a)}const r=e.typeRegistry;if(r!=null&&r.findExtensionFor)for(const o of t.runtime.bin.listUnknownFields(n)){const a=r.findExtensionFor(t.typeName,o.no);if(a&&q3(n,a)){const c=j$(n,a,e),d=sI(a.field,c,e);d!==void 0&&(i[a.field.jsonName]=d)}}}catch(r){const o=s?"cannot encode field ".concat(t.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(t.typeName," to JSON"),a=r instanceof Error?r.message:String(r);throw new Error(o+(a.length>0?": ".concat(a):""))}return i},readScalar(n,e,t){return Xh(n,e,t??Ia.BIGINT,!0)},writeScalar(n,e,t){if(e!==void 0&&(t||W3(n,e)))return Gg(n,e)},debug:Xs}}function Xs(n){if(n===null)return"null";switch(typeof n){case"object":return Array.isArray(n)?"array":"object";case"string":return n.length>100?"string":'"'.concat(n.split('"').join('\\"'),'"');default:return String(n)}}function iI(n,e,t,i,s){let r=t.localName;if(t.repeated){if(It(t.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(e)));const o=n[r];for(const a of e){if(a===null)throw new Error("cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(a)));switch(t.kind){case"message":o.push(t.T.fromJson(a,i));break;case"enum":const c=Ex(t.T,a,i.ignoreUnknownFields,!0);c!==Hg&&o.push(c);break;case"scalar":try{o.push(Xh(t.T,a,t.L,!0))}catch(d){let h="cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(a));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}}else if(t.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(e)));const o=n[r];for(const[a,c]of Object.entries(e)){if(c===null)throw new Error("cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: map value null"));let d;try{d=G$(t.K,a)}catch(h){let f="cannot decode map key for field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(e));throw h instanceof Error&&h.message.length>0&&(f+=": ".concat(h.message)),new Error(f)}switch(t.V.kind){case"message":o[d]=t.V.T.fromJson(c,i);break;case"enum":const h=Ex(t.V.T,c,i.ignoreUnknownFields,!0);h!==Hg&&(o[d]=h);break;case"scalar":try{o[d]=Xh(t.V.T,c,Ia.BIGINT,!0)}catch(f){let m="cannot decode map value for field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(e));throw f instanceof Error&&f.message.length>0&&(m+=": ".concat(f.message)),new Error(m)}break}}}else switch(t.oneof&&(n=n[t.oneof.localName]={case:r},r="value"),t.kind){case"message":const o=t.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let a=n[r];Wr(a)?a.fromJson(e,i):(n[r]=a=o.fromJson(e,i),o.fieldWrapper&&!t.oneof&&(n[r]=o.fieldWrapper.unwrapField(a)));break;case"enum":const c=Ex(t.T,e,i.ignoreUnknownFields,!1);switch(c){case Ny:eI(t,n);break;case Hg:break;default:n[r]=c;break}break;case"scalar":try{const d=Xh(t.T,e,t.L,!1);switch(d){case Ny:eI(t,n);break;default:n[r]=d;break}}catch(d){let h="cannot decode field ".concat(s.typeName,".").concat(t.name," from JSON: ").concat(Xs(e));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}function G$(n,e){if(n===$.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Xh(n,e,Ia.BIGINT,!0).toString()}function Xh(n,e,t,i){if(e===null)return i?id(n,t):Ny;switch(n){case $.DOUBLE:case $.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const s=Number(e);if(Number.isNaN(s)||!Number.isFinite(s))break;return n==$.FLOAT&&L3(s),s;case $.INT32:case $.FIXED32:case $.SFIXED32:case $.SINT32:case $.UINT32:let r;if(typeof e=="number"?r=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(r=Number(e)),r===void 0)break;return n==$.UINT32||n==$.FIXED32?uk(r):zg(r),r;case $.INT64:case $.SFIXED64:case $.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=gt.parse(e);return t?o.toString():o;case $.FIXED64:case $.UINT64:if(typeof e!="number"&&typeof e!="string")break;const a=gt.uParse(e);return t?a.toString():a;case $.BOOL:if(typeof e!="boolean")break;return e;case $.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case $.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return K3.dec(e)}throw new Error}function Ex(n,e,t,i){if(e===null)return n.typeName=="google.protobuf.NullValue"?0:i?n.values[0].no:Ny;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const s=n.findName(e);if(s!==void 0)return s.no;if(t)return Hg;break}throw new Error("cannot decode enum ".concat(n.typeName," from JSON: ").concat(Xs(e)))}function W$(n){return n.repeated||n.kind=="map"?!0:!(n.oneof||n.kind=="message"||n.opt||n.req)}function sI(n,e,t){if(n.kind=="map"){It(typeof e=="object"&&e!=null);const i={},s=Object.entries(e);switch(n.V.kind){case"scalar":for(const[o,a]of s)i[o.toString()]=Gg(n.V.T,a);break;case"message":for(const[o,a]of s)i[o.toString()]=a.toJson(t);break;case"enum":const r=n.V.T;for(const[o,a]of s)i[o.toString()]=_x(r,a,t.enumAsInteger);break}return t.emitDefaultValues||s.length>0?i:void 0}if(n.repeated){It(Array.isArray(e));const i=[];switch(n.kind){case"scalar":for(let s=0;s<e.length;s++)i.push(Gg(n.T,e[s]));break;case"enum":for(let s=0;s<e.length;s++)i.push(_x(n.T,e[s],t.enumAsInteger));break;case"message":for(let s=0;s<e.length;s++)i.push(e[s].toJson(t));break}return t.emitDefaultValues||i.length>0?i:void 0}switch(n.kind){case"scalar":return Gg(n.T,e);case"enum":return _x(n.T,e,t.enumAsInteger);case"message":return X3(n.T,e).toJson(t)}}function _x(n,e,t){var i;if(It(typeof e=="number"),n.typeName=="google.protobuf.NullValue")return null;if(t)return e;const s=n.findNumber(e);return(i=s==null?void 0:s.name)!==null&&i!==void 0?i:e}function Gg(n,e){switch(n){case $.INT32:case $.SFIXED32:case $.SINT32:case $.FIXED32:case $.UINT32:return It(typeof e=="number"),e;case $.FLOAT:case $.DOUBLE:return It(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case $.STRING:return It(typeof e=="string"),e;case $.BOOL:return It(typeof e=="boolean"),e;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return It(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case $.BYTES:return It(e instanceof Uint8Array),K3.enc(e)}}const Bc=Symbol("@bufbuild/protobuf/unknown-fields"),rI={readUnknownFields:!0,readerFactory:n=>new N$(n)},oI={writeUnknownFields:!0,writerFactory:()=>new D$};function J$(n){return n?Object.assign(Object.assign({},rI),n):rI}function K$(n){return n?Object.assign(Object.assign({},oI),n):oI}function q$(){return{makeReadOptions:J$,makeWriteOptions:K$,listUnknownFields(n){var e;return(e=n[Bc])!==null&&e!==void 0?e:[]},discardUnknownFields(n){delete n[Bc]},writeUnknownFields(n,e){const i=n[Bc];if(i)for(const s of i)e.tag(s.no,s.wireType).raw(s.data)},onUnknownField(n,e,t,i){const s=n;Array.isArray(s[Bc])||(s[Bc]=[]),s[Bc].push({no:e,wireType:t,data:i})},readMessage(n,e,t,i,s){const r=n.getType(),o=s?e.len:e.pos+t;let a,c;for(;e.pos<o&&([a,c]=e.tag(),!(s===!0&&c==jt.EndGroup));){const d=r.fields.find(a);if(!d){const h=e.skip(c,a);i.readUnknownFields&&this.onUnknownField(n,a,c,h);continue}aI(n,e,d,c,i)}if(s&&(c!=jt.EndGroup||a!==t))throw new Error("invalid end group tag")},readField:aI,writeMessage(n,e,t){const i=n.getType();for(const s of i.fields.byNumber()){if(!$3(s,n)){if(s.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(s.name," to binary: required field not set"));continue}const r=s.oneof?n[s.oneof.localName].value:n[s.localName];lI(s,r,e,t)}return t.writeUnknownFields&&this.writeUnknownFields(n,e),e},writeField(n,e,t,i){e!==void 0&&lI(n,e,t,i)}}}function aI(n,e,t,i,s){let{repeated:r,localName:o}=t;switch(t.oneof&&(n=n[t.oneof.localName],n.case!=o&&delete n.value,n.case=o,o="value"),t.kind){case"scalar":case"enum":const a=t.kind=="enum"?$.INT32:t.T;let c=Fy;if(t.kind=="scalar"&&t.L>0&&(c=$$),r){let m=n[o];if(i==jt.LengthDelimited&&a!=$.STRING&&a!=$.BYTES){let v=e.uint32()+e.pos;for(;e.pos<v;)m.push(c(e,a))}else m.push(c(e,a))}else n[o]=c(e,a);break;case"message":const d=t.T;r?n[o].push(Wg(e,new d,s,t)):Wr(n[o])?Wg(e,n[o],s,t):(n[o]=Wg(e,new d,s,t),d.fieldWrapper&&!t.oneof&&!t.repeated&&(n[o]=d.fieldWrapper.unwrapField(n[o])));break;case"map":let[h,f]=Q$(t,e,s);n[o][h]=f;break}}function Wg(n,e,t,i){const s=e.getType().runtime.bin,r=i==null?void 0:i.delimited;return s.readMessage(e,n,r?i.no:n.uint32(),t,r),e}function Q$(n,e,t){const i=e.uint32(),s=e.pos+i;let r,o;for(;e.pos<s;){const[a]=e.tag();switch(a){case 1:r=Fy(e,n.K);break;case 2:switch(n.V.kind){case"scalar":o=Fy(e,n.V.T);break;case"enum":o=e.int32();break;case"message":o=Wg(e,new n.V.T,t,void 0);break}break}}if(r===void 0&&(r=id(n.K,Ia.BIGINT)),typeof r!="string"&&typeof r!="number"&&(r=r.toString()),o===void 0)switch(n.V.kind){case"scalar":o=id(n.V.T,Ia.BIGINT);break;case"enum":o=n.V.T.values[0].no;break;case"message":o=new n.V.T;break}return[r,o]}function $$(n,e){const t=Fy(n,e);return typeof t=="bigint"?t.toString():t}function Fy(n,e){switch(e){case $.STRING:return n.string();case $.BOOL:return n.bool();case $.DOUBLE:return n.double();case $.FLOAT:return n.float();case $.INT32:return n.int32();case $.INT64:return n.int64();case $.UINT64:return n.uint64();case $.FIXED64:return n.fixed64();case $.BYTES:return n.bytes();case $.FIXED32:return n.fixed32();case $.SFIXED32:return n.sfixed32();case $.SFIXED64:return n.sfixed64();case $.SINT64:return n.sint64();case $.UINT32:return n.uint32();case $.SINT32:return n.sint32()}}function lI(n,e,t,i){It(e!==void 0);const s=n.repeated;switch(n.kind){case"scalar":case"enum":let r=n.kind=="enum"?$.INT32:n.T;if(s)if(It(Array.isArray(e)),n.packed)Y$(t,r,n.no,e);else for(const o of e)Yh(t,r,n.no,o);else Yh(t,r,n.no,e);break;case"message":if(s){It(Array.isArray(e));for(const o of e)cI(t,i,n,o)}else cI(t,i,n,e);break;case"map":It(typeof e=="object"&&e!=null);for(const[o,a]of Object.entries(e))X$(t,i,n,o,a);break}}function X$(n,e,t,i,s){n.tag(t.no,jt.LengthDelimited),n.fork();let r=i;switch(t.K){case $.INT32:case $.FIXED32:case $.UINT32:case $.SFIXED32:case $.SINT32:r=Number.parseInt(i);break;case $.BOOL:It(i=="true"||i=="false"),r=i=="true";break}switch(Yh(n,t.K,1,r),t.V.kind){case"scalar":Yh(n,t.V.T,2,s);break;case"enum":Yh(n,$.INT32,2,s);break;case"message":It(s!==void 0),n.tag(2,jt.LengthDelimited).bytes(s.toBinary(e));break}n.join()}function cI(n,e,t,i){const s=X3(t.T,i);t.delimited?n.tag(t.no,jt.StartGroup).raw(s.toBinary(e)).tag(t.no,jt.EndGroup):n.tag(t.no,jt.LengthDelimited).bytes(s.toBinary(e))}function Yh(n,e,t,i){It(i!==void 0);let[s,r]=Y3(e);n.tag(t,s)[r](i)}function Y$(n,e,t,i){if(!i.length)return;n.tag(t,jt.LengthDelimited).fork();let[,s]=Y3(e);for(let r=0;r<i.length;r++)n[s](i[r]);n.join()}function Y3(n){let e=jt.Varint;switch(n){case $.BYTES:case $.STRING:e=jt.LengthDelimited;break;case $.DOUBLE:case $.FIXED64:case $.SFIXED64:e=jt.Bit64;break;case $.FIXED32:case $.SFIXED32:case $.FLOAT:e=jt.Bit32;break}const t=$[n].toLowerCase();return[e,t]}function Z$(){return{setEnumType:U3,initPartial(n,e){if(n===void 0)return;const t=e.getType();for(const i of t.fields.byMember()){const s=i.localName,r=e,o=n;if(o[s]!=null)switch(i.kind){case"oneof":const a=o[s].case;if(a===void 0)continue;const c=i.findField(a);let d=o[s].value;c&&c.kind=="message"&&!Wr(d,c.T)?d=new c.T(d):c&&c.kind==="scalar"&&c.T===$.BYTES&&(d=dh(d)),r[s]={case:a,value:d};break;case"scalar":case"enum":let h=o[s];i.T===$.BYTES&&(h=i.repeated?h.map(dh):dh(h)),r[s]=h;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===$.BYTES)for(const[y,v]of Object.entries(o[s]))r[s][y]=dh(v);else Object.assign(r[s],o[s]);break;case"message":const m=i.V.T;for(const y of Object.keys(o[s])){let v=o[s][y];m.fieldWrapper||(v=new m(v)),r[s][y]=v}break}break;case"message":const f=i.T;if(i.repeated)r[s]=o[s].map(m=>Wr(m,f)?m:new f(m));else{const m=o[s];f.fieldWrapper?f.typeName==="google.protobuf.BytesValue"?r[s]=dh(m):r[s]=m:r[s]=Wr(m,f)?m:new f(m)}break}}},equals(n,e,t){return e===t?!0:!e||!t?!1:n.fields.byMember().every(i=>{const s=e[i.localName],r=t[i.localName];if(i.repeated){if(s.length!==r.length)return!1;switch(i.kind){case"message":return s.every((o,a)=>i.T.equals(o,r[a]));case"scalar":return s.every((o,a)=>Lo(i.T,o,r[a]));case"enum":return s.every((o,a)=>Lo($.INT32,o,r[a]))}throw new Error("repeated cannot contain ".concat(i.kind))}switch(i.kind){case"message":let o=s,a=r;return i.T.fieldWrapper&&(o!==void 0&&!Wr(o)&&(o=i.T.fieldWrapper.wrapField(o)),a!==void 0&&!Wr(a)&&(a=i.T.fieldWrapper.wrapField(a))),i.T.equals(o,a);case"enum":return Lo($.INT32,s,r);case"scalar":return Lo(i.T,s,r);case"oneof":if(s.case!==r.case)return!1;const c=i.findField(s.case);if(c===void 0)return!0;switch(c.kind){case"message":return c.T.equals(s.value,r.value);case"enum":return Lo($.INT32,s.value,r.value);case"scalar":return Lo(c.T,s.value,r.value)}throw new Error("oneof cannot contain ".concat(c.kind));case"map":const d=Object.keys(s).concat(Object.keys(r));switch(i.V.kind){case"message":const h=i.V.T;return d.every(m=>h.equals(s[m],r[m]));case"enum":return d.every(m=>Lo($.INT32,s[m],r[m]));case"scalar":const f=i.V.T;return d.every(m=>Lo(f,s[m],r[m]))}break}})},clone(n){const e=n.getType(),t=new e,i=t;for(const s of e.fields.byMember()){const r=n[s.localName];let o;if(s.repeated)o=r.map(Vm);else if(s.kind=="map"){o=i[s.localName];for(const[a,c]of Object.entries(r))o[a]=Vm(c)}else s.kind=="oneof"?o=s.findField(r.case)?{case:r.case,value:Vm(r.value)}:{case:void 0}:o=Vm(r);i[s.localName]=o}for(const s of e.runtime.bin.listUnknownFields(n))e.runtime.bin.onUnknownField(i,s.no,s.wireType,s.data);return t}}}function Vm(n){if(n===void 0)return n;if(Wr(n))return n.clone();if(n instanceof Uint8Array){const e=new Uint8Array(n.byteLength);return e.set(n),e}return n}function dh(n){return n instanceof Uint8Array?n:new Uint8Array(n)}function eX(n,e,t){return{syntax:n,json:H$(),bin:q$(),util:Object.assign(Object.assign({},Z$()),{newFieldList:e,initFields:t}),makeMessageType(i,s,r){return _$(this,i,s,r)},makeEnum:E$,makeEnumType:z3,getEnumType:A$,makeExtension(i,s,r){return F$(this,i,s,r)}}}class tX{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const t={};for(const i of this.list())t[i.jsonName]=t[i.name]=i;this.jsonNames=t}return this.jsonNames[e]}find(e){if(!this.numbers){const t={};for(const i of this.list())t[i.no]=i;this.numbers=t}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const i of this.list())i.oneof?i.oneof!==t&&(t=i.oneof,e.push(t)):e.push(i)}return this.members}}function Z3(n,e){const t=e4(n);return e?t:aX(oX(t))}function nX(n){return Z3(n,!1)}const iX=e4;function e4(n){let e=!1;const t=[];for(let i=0;i<n.length;i++){let s=n.charAt(i);switch(s){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t.push(s),e=!1;break;default:e&&(e=!1,s=s.toUpperCase()),t.push(s);break}}return t.join("")}const sX=new Set(["constructor","toString","toJSON","valueOf"]),rX=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),t4=n=>"".concat(n,"$"),oX=n=>rX.has(n)?t4(n):n,aX=n=>sX.has(n)?t4(n):n;class lX{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=nX(e)}addField(e){It(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}function cX(n,e){var t,i,s,r,o,a;const c=[];let d;for(const h of typeof n=="function"?n():n){const f=h;if(f.localName=Z3(h.name,h.oneof!==void 0),f.jsonName=(t=h.jsonName)!==null&&t!==void 0?t:iX(h.name),f.repeated=(i=h.repeated)!==null&&i!==void 0?i:!1,h.kind=="scalar"&&(f.L=(s=h.L)!==null&&s!==void 0?s:Ia.BIGINT),f.delimited=(r=h.delimited)!==null&&r!==void 0?r:!1,f.req=(o=h.req)!==null&&o!==void 0?o:!1,f.opt=(a=h.opt)!==null&&a!==void 0?a:!1,h.packed===void 0&&(f.packed=h.kind=="enum"||h.kind=="scalar"&&h.T!=$.BYTES&&h.T!=$.STRING),h.oneof!==void 0){const m=typeof h.oneof=="string"?h.oneof:h.oneof.name;(!d||d.name!=m)&&(d=new lX(m)),f.oneof=d,d.addField(f)}c.push(f)}return c}const U=eX("proto3",n=>new tX(n,e=>cX(e)),n=>{for(const e of n.getType().fields.byMember()){if(e.opt)continue;const t=e.localName,i=n;if(e.repeated){i[t]=[];continue}switch(e.kind){case"oneof":i[t]={case:void 0};break;case"enum":i[t]=0;break;case"map":i[t]={};break;case"scalar":i[t]=id(e.T,e.L);break}}});class ai extends GT{constructor(e){super(),this.seconds=gt.zero,this.nanos=0,U.util.initPartial(e,this)}fromJson(e,t){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(U.json.debug(e)));const i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const s=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(s))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=gt.parse(s/1e3),this.nanos=0,i[7]&&(this.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),this}toJson(e){const t=Number(this.seconds)*1e3;if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let i="Z";if(this.nanos>0){const s=(this.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?i="."+s.substring(0,3)+"Z":s.substring(6)==="000"?i="."+s.substring(0,6)+"Z":i="."+s+"Z"}return new Date(t).toISOString().replace(".000Z",i)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ai.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ai({seconds:gt.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return new ai().fromBinary(e,t)}static fromJson(e,t){return new ai().fromJson(e,t)}static fromJsonString(e,t){return new ai().fromJsonString(e,t)}static equals(e,t){return U.util.equals(ai,e,t)}}ai.runtime=U;ai.typeName="google.protobuf.Timestamp";ai.fields=U.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const uX=U.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ai},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:dX,repeated:!0},{no:5,name:"events",kind:"message",T:fX,repeated:!0}]),dX=U.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:hX,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),hX=U.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ai},{no:3,name:"value",kind:"scalar",T:2}]),fX=U.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ai},{no:7,name:"normalized_end_timestamp",kind:"message",T:ai,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),n4=U.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),ws=U.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),qt=U.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),JT=U.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Bh=U.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),If=U.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Rs=U.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),ml=U.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),pX=U.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),mn=U.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Rv=U.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Oy,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:m4}]),Oy=U.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),mX=U.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:U.getEnumType(qt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),$l=U.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(ku)},{no:4,name:"tracks",kind:"message",T:hu,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:mX},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:U.getEnumType(Bf)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:U.getEnumType(Rs)},{no:18,name:"kind_details",kind:"enum",T:U.getEnumType(gX),repeated:!0}]),ku=U.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Bf=U.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),gX=U.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),sn=U.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),yX=U.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Ta,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(i4)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),hu=U.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:U.getEnumType(ws)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:U.getEnumType(qt)},{no:10,name:"layers",kind:"message",T:Ta,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:yX,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:U.getEnumType(sn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:m4},{no:19,name:"audio_features",kind:"enum",T:U.getEnumType(mn),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(n4)}]),Ta=U.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(JT)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),i4=U.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Jn=U.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:U.getEnumType(Pe)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:KT,oneof:"value"},{no:3,name:"speaker",kind:"message",T:vX,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:a4,oneof:"value"},{no:7,name:"transcription",kind:"message",T:bX,oneof:"value"},{no:8,name:"metrics",kind:"message",T:uX,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Ly,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:qT,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:QT,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:$T,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:jy,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:Uy,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:zy,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:s4,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Pe=U.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),s4=U.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:U.getEnumType(sn)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),r4=U.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:KT,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Ly,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:qT,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:QT,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:$T,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:jy,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:Uy,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:zy,oneof:"value"}]),vX=U.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:o4,repeated:!0}]),o4=U.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),KT=U.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),a4=U.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),bX=U.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:xX,repeated:!0}]),xX=U.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Ly=U.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),qT=U.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),QT=U.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),$T=U.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:l4,oneof:"value"}]),l4=U.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),c4=U.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),u4=U.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:U.getEnumType(d4)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),d4=U.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),h4=U.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:U.getEnumType(f4)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),f4=U.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),p4=U.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:uI},{no:2,name:"screen",kind:"message",T:uI},{no:3,name:"resume_connection",kind:"enum",T:U.getEnumType(If)},{no:4,name:"disabled_codecs",kind:"message",T:SX},{no:5,name:"force_relay",kind:"enum",T:U.getEnumType(If)}]),uI=U.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:U.getEnumType(If)}]),SX=U.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Oy,repeated:!0},{no:2,name:"publish",kind:"message",T:Oy,repeated:!0}]),m4=U.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),dk=U.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),g4=U.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:U.getEnumType(dk)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),y4=U.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),jy=U.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:U.getEnumType(sn)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:g4,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:y4,oneof:"content_header"}],{localName:"DataStream_Header"}),Uy=U.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),zy=U.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),CX=U.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),Ts=U.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),hk=U.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),kX=U.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),wX=U.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Ba,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ba,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Pv,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Df,oneof:"message"},{no:5,name:"mute",kind:"message",T:Iv,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Bv,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:v4,oneof:"message"},{no:8,name:"leave",kind:"message",T:Dv,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:x4,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:k4,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:t1,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Qs,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ZT,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:A4,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:YT,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:b4,oneof:"message"}]),dI=U.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:TX,oneof:"message"},{no:2,name:"answer",kind:"message",T:Ba,oneof:"message"},{no:3,name:"offer",kind:"message",T:Ba,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Pv,oneof:"message"},{no:5,name:"update",kind:"message",T:_X,oneof:"message"},{no:6,name:"track_published",kind:"message",T:XT,oneof:"message"},{no:8,name:"leave",kind:"message",T:Dv,oneof:"message"},{no:9,name:"mute",kind:"message",T:Iv,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:MX,oneof:"message"},{no:11,name:"room_update",kind:"message",T:RX,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:IX,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:DX,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:FX,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:LX,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:EX,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:AX,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:UX,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:HX,oneof:"message"},{no:22,name:"request_response",kind:"message",T:GX,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:WX,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:jX,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:QX,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:OX,oneof:"message"}]),fk=U.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Ta,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(i4)}]),Df=U.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:U.getEnumType(ws)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:U.getEnumType(qt)},{no:9,name:"layers",kind:"message",T:Ta,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:fk,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:U.getEnumType(sn)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(n4)},{no:17,name:"audio_features",kind:"enum",T:U.getEnumType(mn),repeated:!0}]),Pv=U.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:U.getEnumType(Ts)},{no:3,name:"final",kind:"scalar",T:8}]),Iv=U.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),TX=U.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Rv},{no:2,name:"participant",kind:"message",T:$l},{no:3,name:"other_participants",kind:"message",T:$l,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:S4,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:p4},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:u4},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Oy,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),AX=U.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:S4,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:p4},{no:3,name:"server_info",kind:"message",T:u4},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),XT=U.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:hu}]),EX=U.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Ba=U.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),_X=U.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:$l,repeated:!0}]),Bv=U.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:c4,repeated:!0}]),v4=U.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:U.getEnumType(JT)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),YT=U.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:U.getEnumType(mn),repeated:!0}]),b4=U.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Dv=U.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:U.getEnumType(Rs)},{no:3,name:"action",kind:"enum",T:U.getEnumType(wu)},{no:4,name:"regions",kind:"message",T:zX}]),wu=U.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),x4=U.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Ta,repeated:!0}]),ZT=U.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),S4=U.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),MX=U.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:o4,repeated:!0}]),RX=U.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Rv}]),PX=U.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:U.getEnumType(Bh)},{no:3,name:"score",kind:"scalar",T:2}]),IX=U.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:PX,repeated:!0}]),BX=U.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(hk)}]),DX=U.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:BX,repeated:!0}]),e1=U.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(JT)},{no:2,name:"enabled",kind:"scalar",T:8}]),NX=U.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:e1,repeated:!0}]),FX=U.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:e1,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:NX,repeated:!0}]),OX=U.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:CX,repeated:!0}]),C4=U.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),k4=U.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:C4,repeated:!0}]),LX=U.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),jX=U.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Rv},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:$l},{no:4,name:"other_participants",kind:"message",T:$l,repeated:!0}]),t1=U.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Ba},{no:2,name:"subscription",kind:"message",T:Bv},{no:3,name:"publish_tracks",kind:"message",T:XT,repeated:!0},{no:4,name:"data_channels",kind:"message",T:T4,repeated:!0},{no:5,name:"offer",kind:"message",T:Ba},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:w4,repeated:!0}]),w4=U.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),T4=U.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:U.getEnumType(Ts)}]),Qs=U.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:U.getEnumType(kX),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),A4=U.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),UX=U.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),zX=U.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:VX,repeated:!0}]),VX=U.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),HX=U.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:U.getEnumType(pX)}]),GX=U.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:U.getEnumType(n1)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:Pv,oneof:"request"},{no:5,name:"add_track",kind:"message",T:Df,oneof:"request"},{no:6,name:"mute",kind:"message",T:Iv,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:ZT,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:YT,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:b4,oneof:"request"}]),n1=U.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),WX=U.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),E4=U.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),JX=U.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:h4},{no:2,name:"connection_settings",kind:"message",T:E4},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:Df,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:Ba},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:U.getEnumType(ml)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:t1}]),KX=U.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:U.getEnumType(qX)},{no:2,name:"join_request",kind:"scalar",T:12}]),qX=U.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),QX=U.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function $X(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Jg={exports:{}},XX=Jg.exports,hI;function YX(){return hI||(hI=1,function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(XX,function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),s=["trace","debug","info","warn","error"],r={},o=null;function a(x,k){var C=x[k];if(typeof C.bind=="function")return C.bind(x);try{return Function.prototype.bind.call(C,x)}catch{return function(){return Function.prototype.apply.apply(C,[x,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(x){return x==="debug"&&(x="log"),typeof console===t?!1:x==="trace"&&i?c:console[x]!==void 0?a(console,x):console.log!==void 0?a(console,"log"):e}function h(){for(var x=this.getLevel(),k=0;k<s.length;k++){var C=s[k];this[C]=k<x?e:this.methodFactory(C,x,this.name)}if(this.log=this.debug,typeof console===t&&x<this.levels.SILENT)return"No console available for logging"}function f(x){return function(){typeof console!==t&&(h.call(this),this[x].apply(this,arguments))}}function m(x,k,C){return d(x)||f.apply(this,arguments)}function y(x,k){var C=this,A,T,E,_="loglevel";typeof x=="string"?_+=":"+x:typeof x=="symbol"&&(_=void 0);function R(W){var ie=(s[W]||"silent").toUpperCase();if(!(typeof window===t||!_)){try{window.localStorage[_]=ie;return}catch{}try{window.document.cookie=encodeURIComponent(_)+"="+ie+";"}catch{}}}function B(){var W;if(!(typeof window===t||!_)){try{W=window.localStorage[_]}catch{}if(typeof W===t)try{var ie=window.document.cookie,he=encodeURIComponent(_),ae=ie.indexOf(he+"=");ae!==-1&&(W=/^([^;]+)/.exec(ie.slice(ae+he.length+1))[1])}catch{}return C.levels[W]===void 0&&(W=void 0),W}}function I(){if(!(typeof window===t||!_)){try{window.localStorage.removeItem(_)}catch{}try{window.document.cookie=encodeURIComponent(_)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function L(W){var ie=W;if(typeof ie=="string"&&C.levels[ie.toUpperCase()]!==void 0&&(ie=C.levels[ie.toUpperCase()]),typeof ie=="number"&&ie>=0&&ie<=C.levels.SILENT)return ie;throw new TypeError("log.setLevel() called with invalid level: "+W)}C.name=x,C.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},C.methodFactory=k||m,C.getLevel=function(){return E??T??A},C.setLevel=function(W,ie){return E=L(W),ie!==!1&&R(E),h.call(C)},C.setDefaultLevel=function(W){T=L(W),B()||C.setLevel(W,!1)},C.resetLevel=function(){E=null,I(),h.call(C)},C.enableAll=function(W){C.setLevel(C.levels.TRACE,W)},C.disableAll=function(W){C.setLevel(C.levels.SILENT,W)},C.rebuild=function(){if(o!==C&&(A=L(o.getLevel())),h.call(C),o===C)for(var W in r)r[W].rebuild()},A=L(o?o.getLevel():"WARN");var O=B();O!=null&&(E=L(O)),h.call(C)}o=new y,o.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var C=r[k];return C||(C=r[k]=new y(k,o.methodFactory)),C};var v=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=v),o},o.getLoggers=function(){return r},o.default=o,o})}(Jg)),Jg.exports}var Nv=YX(),pk;(function(n){n[n.trace=0]="trace",n[n.debug=1]="debug",n[n.info=2]="info",n[n.warn=3]="warn",n[n.error=4]="error",n[n.silent=5]="silent"})(pk||(pk={}));var js;(function(n){n.Default="livekit",n.Room="livekit-room",n.TokenSource="livekit-token-source",n.Participant="livekit-participant",n.Track="livekit-track",n.Publication="livekit-track-publication",n.Engine="livekit-engine",n.Signal="livekit-signal",n.PCManager="livekit-pc-manager",n.PCTransport="livekit-pc-transport",n.E2EE="lk-e2ee"})(js||(js={}));let Me=Nv.getLogger("livekit");Object.values(js).map(n=>Nv.getLogger(n));Me.setDefaultLevel(pk.info);function uo(n){const e=Nv.getLogger(n);return e.setDefaultLevel(Me.getLevel()),e}const ZX=Nv.getLogger("lk-e2ee"),hh=7e3,eY=[0,300,2*2*300,3*3*300,4*4*300,hh,hh,hh,hh,hh];class tY{constructor(e){this._retryDelays=e!==void 0?[...e]:eY}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+Math.random()*1e3}}function nY(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function D(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(h){try{d(i.next(h))}catch(f){o(f)}}function c(h){try{d(i.throw(h))}catch(f){o(f)}}function d(h){h.done?r(h.value):s(h.value).then(a,c)}d((i=i.apply(n,e||[])).next())})}function fI(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof fI=="function"?fI(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,c){o=n[r](o),s(a,c,o.done,o.value)})}}function s(r,o,a,c){Promise.resolve(c).then(function(d){r({value:d,done:a})},o)}}var Hm={exports:{}},pI;function iY(){if(pI)return Hm.exports;pI=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(_,R,B){return Function.prototype.apply.call(_,R,B)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:t=function(_){return Object.getOwnPropertyNames(_)};function i(E){console&&console.warn&&console.warn(E)}var s=Number.isNaN||function(_){return _!==_};function r(){r.init.call(this)}Hm.exports=r,Hm.exports.once=C,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function a(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(E){if(typeof E!="number"||E<0||s(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");o=E}}),r.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||s(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function c(E){return E._maxListeners===void 0?r.defaultMaxListeners:E._maxListeners}r.prototype.getMaxListeners=function(){return c(this)},r.prototype.emit=function(_){for(var R=[],B=1;B<arguments.length;B++)R.push(arguments[B]);var I=_==="error",L=this._events;if(L!==void 0)I=I&&L.error===void 0;else if(!I)return!1;if(I){var O;if(R.length>0&&(O=R[0]),O instanceof Error)throw O;var W=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw W.context=O,W}var ie=L[_];if(ie===void 0)return!1;if(typeof ie=="function")e(ie,this,R);else for(var he=ie.length,ae=v(ie,he),B=0;B<he;++B)e(ae[B],this,R);return!0};function d(E,_,R,B){var I,L,O;if(a(R),L=E._events,L===void 0?(L=E._events=Object.create(null),E._eventsCount=0):(L.newListener!==void 0&&(E.emit("newListener",_,R.listener?R.listener:R),L=E._events),O=L[_]),O===void 0)O=L[_]=R,++E._eventsCount;else if(typeof O=="function"?O=L[_]=B?[R,O]:[O,R]:B?O.unshift(R):O.push(R),I=c(E),I>0&&O.length>I&&!O.warned){O.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=E,W.type=_,W.count=O.length,i(W)}return E}r.prototype.addListener=function(_,R){return d(this,_,R,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(_,R){return d(this,_,R,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(E,_,R){var B={fired:!1,wrapFn:void 0,target:E,type:_,listener:R},I=h.bind(B);return I.listener=R,B.wrapFn=I,I}r.prototype.once=function(_,R){return a(R),this.on(_,f(this,_,R)),this},r.prototype.prependOnceListener=function(_,R){return a(R),this.prependListener(_,f(this,_,R)),this},r.prototype.removeListener=function(_,R){var B,I,L,O,W;if(a(R),I=this._events,I===void 0)return this;if(B=I[_],B===void 0)return this;if(B===R||B.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete I[_],I.removeListener&&this.emit("removeListener",_,B.listener||R));else if(typeof B!="function"){for(L=-1,O=B.length-1;O>=0;O--)if(B[O]===R||B[O].listener===R){W=B[O].listener,L=O;break}if(L<0)return this;L===0?B.shift():x(B,L),B.length===1&&(I[_]=B[0]),I.removeListener!==void 0&&this.emit("removeListener",_,W||R)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(_){var R,B,I;if(B=this._events,B===void 0)return this;if(B.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):B[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete B[_]),this;if(arguments.length===0){var L=Object.keys(B),O;for(I=0;I<L.length;++I)O=L[I],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=B[_],typeof R=="function")this.removeListener(_,R);else if(R!==void 0)for(I=R.length-1;I>=0;I--)this.removeListener(_,R[I]);return this};function m(E,_,R){var B=E._events;if(B===void 0)return[];var I=B[_];return I===void 0?[]:typeof I=="function"?R?[I.listener||I]:[I]:R?k(I):v(I,I.length)}r.prototype.listeners=function(_){return m(this,_,!0)},r.prototype.rawListeners=function(_){return m(this,_,!1)},r.listenerCount=function(E,_){return typeof E.listenerCount=="function"?E.listenerCount(_):y.call(E,_)},r.prototype.listenerCount=y;function y(E){var _=this._events;if(_!==void 0){var R=_[E];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}r.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function v(E,_){for(var R=new Array(_),B=0;B<_;++B)R[B]=E[B];return R}function x(E,_){for(;_+1<E.length;_++)E[_]=E[_+1];E.pop()}function k(E){for(var _=new Array(E.length),R=0;R<_.length;++R)_[R]=E[R].listener||E[R];return _}function C(E,_){return new Promise(function(R,B){function I(O){E.removeListener(_,L),B(O)}function L(){typeof E.removeListener=="function"&&E.removeListener("error",I),R([].slice.call(arguments))}T(E,_,L,{once:!0}),_!=="error"&&A(E,I,{once:!0})})}function A(E,_,R){typeof E.on=="function"&&T(E,"error",_,R)}function T(E,_,R,B){if(typeof E.on=="function")B.once?E.once(_,R):E.on(_,R);else if(typeof E.addEventListener=="function")E.addEventListener(_,function I(L){B.once&&E.removeEventListener(_,I),R(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Hm.exports}var lr=iY();let _4=!0,M4=!0;function Dh(n,e,t){const i=n.match(e);return i&&i.length>=t&&parseFloat(i[t],10)}function tc(n,e,t){if(!n.RTCPeerConnection)return;const i=n.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(o,a){if(o!==e)return s.apply(this,arguments);const c=d=>{const h=t(d);h&&(a.handleEvent?a.handleEvent(h):a(h))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),s.apply(this,[o,c])};const r=i.removeEventListener;i.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return r.apply(this,arguments);if(!this._eventMap[e].has(a))return r.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,r.apply(this,[o,c])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function sY(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(_4=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function rY(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(M4=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function R4(){if(typeof window=="object"){if(_4)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function i1(n,e){M4&&console.warn(n+" is deprecated, please use "+e+" instead.")}function oY(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const i=t.userAgentData.brands.find(s=>s.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Dh(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Dh(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Dh(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=Dh(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function mI(n){return Object.prototype.toString.call(n)==="[object Object]"}function P4(n){return mI(n)?Object.keys(n).reduce(function(e,t){const i=mI(n[t]),s=i?P4(n[t]):n[t],r=i&&!Object.keys(s).length;return s===void 0||r?e:Object.assign(e,{[t]:s})},{}):n}function mk(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?mk(n,n.get(e[i]),t):i.endsWith("Ids")&&e[i].forEach(s=>{mk(n,n.get(s),t)})}))}function gI(n,e,t){const i=t?"outbound-rtp":"inbound-rtp",s=new Map;if(e===null)return s;const r=[];return n.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&r.push(o)}),r.forEach(o=>{n.forEach(a=>{a.type===i&&a.trackId===o.id&&mk(n,a,s)})}),s}const yI=R4;function I4(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const i=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(d=>{if(d==="require"||d==="advanced"||d==="mediaSource")return;const h=typeof a[d]=="object"?a[d]:{ideal:a[d]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const f=function(m,y){return m?m+y.charAt(0).toUpperCase()+y.slice(1):y==="deviceId"?"sourceId":y};if(h.ideal!==void 0){c.optional=c.optional||[];let m={};typeof h.ideal=="number"?(m[f("min",d)]=h.ideal,c.optional.push(m),m={},m[f("max",d)]=h.ideal,c.optional.push(m)):(m[f("",d)]=h.ideal,c.optional.push(m))}h.exact!==void 0&&typeof h.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[f("",d)]=h.exact):["min","max"].forEach(m=>{h[m]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[f(m,d)]=h[m])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},s=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const d=function(h,f,m){f in h&&!(m in h)&&(h[m]=h[f],delete h[f])};a=JSON.parse(JSON.stringify(a)),d(a.audio,"autoGainControl","googAutoGainControl"),d(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=i(a.audio)}if(a&&typeof a.video=="object"){let d=a.video.facingMode;d=d&&(typeof d=="object"?d:{ideal:d});const h=e.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!h)){delete a.video.facingMode;let f;if(d.exact==="environment"||d.ideal==="environment"?f=["back","rear"]:(d.exact==="user"||d.ideal==="user")&&(f=["front"]),f)return t.mediaDevices.enumerateDevices().then(m=>{m=m.filter(v=>v.kind==="videoinput");let y=m.find(v=>f.some(x=>v.label.toLowerCase().includes(x)));return!y&&m.length&&f.includes("back")&&(y=m[m.length-1]),y&&(a.video.deviceId=d.exact?{exact:y.deviceId}:{ideal:y.deviceId}),a.video=i(a.video),yI("chrome: "+JSON.stringify(a)),c(a)})}a.video=i(a.video)}return yI("chrome: "+JSON.stringify(a)),c(a)},r=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,d){s(a,h=>{t.webkitGetUserMedia(h,c,f=>{d&&d(r(f))})})};if(t.getUserMedia=o.bind(t),t.mediaDevices.getUserMedia){const a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(c){return s(c,d=>a(d).then(h=>{if(d.audio&&!h.getAudioTracks().length||d.video&&!h.getVideoTracks().length)throw h.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return h},h=>Promise.reject(r(h))))}}}function B4(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function D4(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",s=>{let r;n.RTCPeerConnection.prototype.getReceivers?r=this.getReceivers().find(a=>a.track&&a.track.id===s.track.id):r={track:s.track};const o=new Event("track");o.track=s.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[i.stream],this.dispatchEvent(o)}),i.stream.getTracks().forEach(s=>{let r;n.RTCPeerConnection.prototype.getReceivers?r=this.getReceivers().find(a=>a.track&&a.track.id===s.id):r={track:s};const o=new Event("track");o.track=s,o.receiver=r,o.transceiver={receiver:r},o.streams=[i.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else tc(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function N4(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(s,r){return{track:r,get dtmf(){return this._dtmf===void 0&&(r.kind==="audio"?this._dtmf=s.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:s}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const s=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,c){let d=s.apply(this,arguments);return d||(d=e(this,a),this._senders.push(d)),d};const r=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){r.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(r){this._senders=this._senders||[],t.apply(this,[r]),r.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(r){this._senders=this._senders||[],i.apply(this,[r]),r.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function F4(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(o=>o._pc=this),r});const i=n.RTCPeerConnection.prototype.addTrack;i&&(n.RTCPeerConnection.prototype.addTrack=function(){const r=i.apply(this,arguments);return r._pc=this,r}),n.RTCRtpSender.prototype.getStats=function(){const r=this;return this._pc.getStats().then(o=>gI(o,r.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const s=t.apply(this,[]);return s.forEach(r=>r._pc=this),s}),tc(n,"track",i=>(i.receiver._pc=i.srcElement,i)),n.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(r=>gI(r,s.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const i=arguments[0];let s,r,o;return this.getSenders().forEach(a=>{a.track===i&&(s?o=!0:s=a)}),this.getReceivers().forEach(a=>(a.track===i&&(r?o=!0:r=a),a.track===i)),o||s&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function O4(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(d=>{if(this.getSenders().find(f=>f.track===d))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();t.apply(this,arguments);const c=this.getSenders().filter(d=>a.indexOf(d)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],i.apply(this,arguments)};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),s.apply(this,arguments)}}function L4(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return O4(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const h=t.apply(this);return this._reverseStreams=this._reverseStreams||{},h.map(f=>this._reverseStreams[f.id])};const i=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(h){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},h.getTracks().forEach(f=>{if(this.getSenders().find(y=>y.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[h.id]){const f=new n.MediaStream(h.getTracks());this._streams[h.id]=f,this._reverseStreams[f.id]=h,h=f}i.apply(this,[h])};const s=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(h){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[h.id]||h]),delete this._reverseStreams[this._streams[h.id]?this._streams[h.id].id:h.id],delete this._streams[h.id]},n.RTCPeerConnection.prototype.addTrack=function(h,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(x=>x===h))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===h))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const v=this._streams[f.id];if(v)v.addTrack(h),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new n.MediaStream([h]);this._streams[f.id]=x,this._reverseStreams[x.id]=f,this.addStream(x)}return this.getSenders().find(x=>x.track===h)};function r(d,h){let f=h.sdp;return Object.keys(d._reverseStreams||[]).forEach(m=>{const y=d._reverseStreams[m],v=d._streams[y.id];f=f.replace(new RegExp(v.id,"g"),y.id)}),new RTCSessionDescription({type:h.type,sdp:f})}function o(d,h){let f=h.sdp;return Object.keys(d._reverseStreams||[]).forEach(m=>{const y=d._reverseStreams[m],v=d._streams[y.id];f=f.replace(new RegExp(y.id,"g"),v.id)}),new RTCSessionDescription({type:h.type,sdp:f})}["createOffer","createAnswer"].forEach(function(d){const h=n.RTCPeerConnection.prototype[d],f={[d](){const m=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[v=>{const x=r(this,v);m[0].apply(null,[x])},v=>{m[1]&&m[1].apply(null,v)},arguments[2]]):h.apply(this,arguments).then(v=>r(this,v))}};n.RTCPeerConnection.prototype[d]=f[d]});const a=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const d=c.get.apply(this);return d.type===""?d:r(this,d)}}),n.RTCPeerConnection.prototype.removeTrack=function(h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!h._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(h._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let m;Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(x=>h.track===x)&&(m=this._streams[y])}),m&&(m.getTracks().length===1?this.removeStream(this._reverseStreams[m.id]):m.removeTrack(h.track),this.dispatchEvent(new Event("negotiationneeded")))}}function gk(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const i=n.RTCPeerConnection.prototype[t],s={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=s[t]})}function j4(n,e){tc(n,"negotiationneeded",t=>{const i=t.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return t})}var vI=Object.freeze({__proto__:null,fixNegotiationNeeded:j4,shimAddTrackRemoveTrack:L4,shimAddTrackRemoveTrackWithNative:O4,shimGetSendersWithDtmf:N4,shimGetUserMedia:I4,shimMediaStream:B4,shimOnTrack:D4,shimPeerConnection:gk,shimSenderReceiverGetStats:F4});function U4(n,e){const t=n&&n.navigator,i=n&&n.MediaStreamTrack;if(t.getUserMedia=function(s,r,o){i1("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(s).then(r,o)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const s=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),s(o.audio,"autoGainControl","mozAutoGainControl"),s(o.audio,"noiseSuppression","mozNoiseSuppression")),r(o)},i&&i.prototype.getSettings){const o=i.prototype.getSettings;i.prototype.getSettings=function(){const a=o.apply(this,arguments);return s(a,"mozAutoGainControl","autoGainControl"),s(a,"mozNoiseSuppression","noiseSuppression"),a}}if(i&&i.prototype.applyConstraints){const o=i.prototype.applyConstraints;i.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),s(a,"autoGainControl","mozAutoGainControl"),s(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function aY(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(i)})}function z4(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function yk(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const r=n.RTCPeerConnection.prototype[s],o={[s](){return arguments[0]=new(s==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[s]=o[s]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[r,o,a]=arguments;return i.apply(this,[r||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(d=>{d.type=t[d.type]||d.type})}catch(d){if(d.name!=="TypeError")throw d;c.forEach((h,f)=>{c.set(f,Object.assign({},h,{type:t[h.type]||h.type}))})}return c}).then(o,a)}}function V4(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(r=>r._pc=this),s});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=t.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function H4(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i}),tc(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function G4(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){i1("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&t.getTracks().includes(i.track)&&this.removeTrack(i)})})}function W4(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function J4(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const s=i.length>0;s&&i.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=e.apply(this,arguments);if(s){const{sender:o}=r,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=i,o.sendEncodings=i,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return r})}function K4(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function q4(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Q4(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var bI=Object.freeze({__proto__:null,shimAddTransceiver:J4,shimCreateAnswer:Q4,shimCreateOffer:q4,shimGetDisplayMedia:aY,shimGetParameters:K4,shimGetUserMedia:U4,shimOnTrack:z4,shimPeerConnection:yk,shimRTCDataChannel:W4,shimReceiverGetStats:H4,shimRemoveStream:G4,shimSenderGetStats:V4});function $4(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(s=>e.call(this,s,i)),i.getVideoTracks().forEach(s=>e.call(this,s,i))},n.RTCPeerConnection.prototype.addTrack=function(i){for(var s=arguments.length,r=new Array(s>1?s-1:0),o=1;o<s;o++)r[o-1]=arguments[o];return r&&r.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(t);if(i===-1)return;this._localStreams.splice(i,1);const s=t.getTracks();this.getSenders().forEach(r=>{s.includes(r.track)&&this.removeTrack(r)})})}}function X4(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);const r=new Event("addstream");r.stream=s,this.dispatchEvent(r)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(r=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(r)>=0)return;i._remoteStreams.push(r);const o=new Event("addstream");o.stream=r,i.dispatchEvent(o)})}),e.apply(i,arguments)}}}function Y4(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,i=e.createAnswer,s=e.setLocalDescription,r=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(d,h){const f=arguments.length>=2?arguments[2]:arguments[0],m=t.apply(this,[f]);return h?(m.then(d,h),Promise.resolve()):m},e.createAnswer=function(d,h){const f=arguments.length>=2?arguments[2]:arguments[0],m=i.apply(this,[f]);return h?(m.then(d,h),Promise.resolve()):m};let a=function(c,d,h){const f=s.apply(this,[c]);return h?(f.then(d,h),Promise.resolve()):f};e.setLocalDescription=a,a=function(c,d,h){const f=r.apply(this,[c]);return h?(f.then(d,h),Promise.resolve()):f},e.setRemoteDescription=a,a=function(c,d,h){const f=o.apply(this,[c]);return h?(f.then(d,h),Promise.resolve()):f},e.addIceCandidate=a}function Z4(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,i=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=s=>i(ej(s))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,s,r){e.mediaDevices.getUserMedia(i).then(s,r)}).bind(e))}function ej(n){return n&&n.video!==void 0?Object.assign({},n,{video:P4(n.video)}):n}function tj(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(i,s){if(i&&i.iceServers){const r=[];for(let o=0;o<i.iceServers.length;o++){let a=i.iceServers[o];a.urls===void 0&&a.url?(i1("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,r.push(a)):r.push(i.iceServers[o])}i.iceServers=r}return new e(i,s)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function nj(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ij(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const r=this.getTransceivers().find(o=>o.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveVideo===!0&&!r&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function sj(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var xI=Object.freeze({__proto__:null,shimAudioContext:sj,shimCallbacksAPI:Y4,shimConstraints:ej,shimCreateOfferLegacy:ij,shimGetUserMedia:Z4,shimLocalStreamsAPI:$4,shimRTCIceServerUrls:tj,shimRemoteStreamsAPI:X4,shimTrackEventTransceiver:nj}),Mx={exports:{}},SI;function lY(){return SI||(SI=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(t){return t.split(`
m=`).map((s,r)=>(r>0?"m="+s:s).trim()+`\r
`)},e.getDescription=function(t){const i=e.splitSections(t);return i&&i[0]},e.getMediaSections=function(t){const i=e.splitSections(t);return i.shift(),i},e.matchPrefix=function(t,i){return e.splitLines(t).filter(s=>s.indexOf(i)===0)},e.parseCandidate=function(t){let i;t.indexOf("a=candidate:")===0?i=t.substring(12).split(" "):i=t.substring(10).split(" ");const s={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let r=8;r<i.length;r+=2)switch(i[r]){case"raddr":s.relatedAddress=i[r+1];break;case"rport":s.relatedPort=parseInt(i[r+1],10);break;case"tcptype":s.tcpType=i[r+1];break;case"ufrag":s.ufrag=i[r+1],s.usernameFragment=i[r+1];break;default:s[i[r]]===void 0&&(s[i[r]]=i[r+1]);break}return s},e.writeCandidate=function(t){const i=[];i.push(t.foundation);const s=t.component;s==="rtp"?i.push(1):s==="rtcp"?i.push(2):i.push(s),i.push(t.protocol.toUpperCase()),i.push(t.priority),i.push(t.address||t.ip),i.push(t.port);const r=t.type;return i.push("typ"),i.push(r),r!=="host"&&t.relatedAddress&&t.relatedPort&&(i.push("raddr"),i.push(t.relatedAddress),i.push("rport"),i.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(i.push("ufrag"),i.push(t.usernameFragment||t.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let i=t.substring(9).split(" ");const s={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),s.name=i[0],s.clockRate=parseInt(i[1],10),s.channels=i.length===3?parseInt(i[2],10):1,s.numChannels=s.channels,s},e.writeRtpMap=function(t){let i=t.payloadType;t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType);const s=t.channels||t.numChannels||1;return"a=rtpmap:"+i+" "+t.name+"/"+t.clockRate+(s!==1?"/"+s:"")+`\r
`},e.parseExtmap=function(t){const i=t.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const i={};let s;const r=t.substring(t.indexOf(" ")+1).split(";");for(let o=0;o<r.length;o++)s=r[o].trim().split("="),i[s[0].trim()]=s[1];return i},e.writeFmtp=function(t){let i="",s=t.payloadType;if(t.preferredPayloadType!==void 0&&(s=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const r=[];Object.keys(t.parameters).forEach(o=>{t.parameters[o]!==void 0?r.push(o+"="+t.parameters[o]):r.push(o)}),i+="a=fmtp:"+s+" "+r.join(";")+`\r
`}return i},e.parseRtcpFb=function(t){const i=t.substring(t.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(t){let i="",s=t.payloadType;return t.preferredPayloadType!==void 0&&(s=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(r=>{i+="a=rtcp-fb:"+s+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(t){const i=t.indexOf(" "),s={ssrc:parseInt(t.substring(7,i),10)},r=t.indexOf(":",i);return r>-1?(s.attribute=t.substring(i+1,r),s.value=t.substring(r+1)):s.attribute=t.substring(i+1),s},e.parseSsrcGroup=function(t){const i=t.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(s=>parseInt(s,10))}},e.getMid=function(t){const i=e.matchPrefix(t,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(t){const i=t.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(t,i){return{role:"auto",fingerprints:e.matchPrefix(t+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,i){let s="a=setup:"+i+`\r
`;return t.fingerprints.forEach(r=>{s+="a=fingerprint:"+r.algorithm+" "+r.value+`\r
`}),s},e.parseCryptoLine=function(t){const i=t.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const i=t.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,i){return e.matchPrefix(t+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,i){const s=e.matchPrefix(t+i,"a=ice-ufrag:")[0],r=e.matchPrefix(t+i,"a=ice-pwd:")[0];return s&&r?{usernameFragment:s.substring(12),password:r.substring(10)}:null},e.writeIceParameters=function(t){let i="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(t){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=e.splitLines(t)[0].split(" ");i.profile=r[2];for(let a=3;a<r.length;a++){const c=r[a],d=e.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(d){const h=e.parseRtpMap(d),f=e.matchPrefix(t,"a=fmtp:"+c+" ");switch(h.parameters=f.length?e.parseFmtp(f[0]):{},h.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),i.codecs.push(h),h.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(h.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(a=>{i.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(h=>h.type===c.type&&h.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),i},e.writeRtpDescription=function(t,i){let s="";s+="m="+t+" ",s+=i.codecs.length>0?"9":"0",s+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",s+=i.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,s+=`c=IN IP4 0.0.0.0\r
`,s+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(o=>{s+=e.writeRtpMap(o),s+=e.writeFmtp(o),s+=e.writeRtcpFb(o)});let r=0;return i.codecs.forEach(o=>{o.maxptime>r&&(r=o.maxptime)}),r>0&&(s+="a=maxptime:"+r+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(o=>{s+=e.writeExtmap(o)}),s},e.parseRtpEncodingParameters=function(t){const i=[],s=e.parseRtpParameters(t),r=s.fecMechanisms.indexOf("RED")!==-1,o=s.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(t,"a=ssrc:").map(m=>e.parseSsrcMedia(m)).filter(m=>m.attribute==="cname"),c=a.length>0&&a[0].ssrc;let d;const h=e.matchPrefix(t,"a=ssrc-group:FID").map(m=>m.substring(17).split(" ").map(v=>parseInt(v,10)));h.length>0&&h[0].length>1&&h[0][0]===c&&(d=h[0][1]),s.codecs.forEach(m=>{if(m.name.toUpperCase()==="RTX"&&m.parameters.apt){let y={ssrc:c,codecPayloadType:parseInt(m.parameters.apt,10)};c&&d&&(y.rtx={ssrc:d}),i.push(y),r&&(y=JSON.parse(JSON.stringify(y)),y.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},i.push(y))}}),i.length===0&&c&&i.push({ssrc:c});let f=e.matchPrefix(t,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substring(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substring(5),10)*1e3*.95-50*40*8:f=void 0,i.forEach(m=>{m.maxBitrate=f})),i},e.parseRtcpParameters=function(t){const i={},s=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];s&&(i.cname=s.value,i.ssrc=s.ssrc);const r=e.matchPrefix(t,"a=rtcp-rsize");i.reducedSize=r.length>0,i.compound=r.length===0;const o=e.matchPrefix(t,"a=rtcp-mux");return i.mux=o.length>0,i},e.writeRtcpParameters=function(t){let i="";return t.reducedSize&&(i+=`a=rtcp-rsize\r
`),t.mux&&(i+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(i+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),i},e.parseMsid=function(t){let i;const s=e.matchPrefix(t,"a=msid:");if(s.length===1)return i=s[0].substring(7).split(" "),{stream:i[0],track:i[1]};const r=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(r.length>0)return i=r[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(t){const i=e.parseMLine(t),s=e.matchPrefix(t,"a=max-message-size:");let r;s.length>0&&(r=parseInt(s[0].substring(19),10)),isNaN(r)&&(r=65536);const o=e.matchPrefix(t,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:i.fmt,maxMessageSize:r};const a=e.matchPrefix(t,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:r}}},e.writeSctpDescription=function(t,i){let s=[];return t.protocol!=="DTLS/SCTP"?s=["m="+t.kind+" 9 "+t.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:s=["m="+t.kind+" 9 "+t.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&s.push("a=max-message-size:"+i.maxMessageSize+`\r
`),s.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,i,s){let r;const o=i!==void 0?i:2;return t?r=t:r=e.generateSessionId(),`v=0\r
o=`+(s||"thisisadapterortc")+" "+r+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,i){const s=e.splitLines(t);for(let r=0;r<s.length;r++)switch(s[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return s[r].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const s=e.splitLines(t)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},e.parseOLine=function(t){const s=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const i=e.splitLines(t);for(let s=0;s<i.length;s++)if(i[s].length<2||i[s].charAt(1)!=="=")return!1;return!0},n.exports=e}(Mx)),Mx.exports}var rj=lY(),Tu=$X(rj),cY=v$({__proto__:null,default:Tu},[rj]);function Kg(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const s=new e(i),r=Tu.parseCandidate(i.candidate);for(const o in r)o in s||Object.defineProperty(s,o,{value:r[o]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(i)},n.RTCIceCandidate.prototype=e.prototype,tc(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function vk(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||tc(n,"icecandidate",e=>{if(e.candidate){const t=Tu.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function qg(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(a){if(!a||!a.sdp)return!1;const c=Tu.splitSections(a.sdp);return c.shift(),c.some(d=>{const h=Tu.parseMLine(d);return h&&h.kind==="application"&&h.protocol.indexOf("SCTP")!==-1})},i=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const d=parseInt(c[1],10);return d!==d?-1:d},s=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},r=function(a,c){let d=65536;e.browser==="firefox"&&e.version===57&&(d=65535);const h=Tu.matchPrefix(a.sdp,"a=max-message-size:");return h.length>0?d=parseInt(h[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(d=2147483637),d},o=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const c=i(arguments[0]),d=s(c),h=r(arguments[0],c);let f;d===0&&h===0?f=Number.POSITIVE_INFINITY:d===0||h===0?f=Math.max(d,h):f=Math.min(d,h);const m={};Object.defineProperty(m,"maxMessageSize",{get(){return f}}),this._sctp=m}return o.apply(this,arguments)}}function Qg(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(i,s){const r=i.send;i.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(i.readyState==="open"&&s.sctp&&c>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return r.apply(i,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const s=t.apply(this,arguments);return e(s,this),s},tc(n,"datachannel",i=>(e(i.channel,i.target),i))}function bk(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const i=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{const r=s.target;if(r._lastConnectionState!==r.connectionState){r._lastConnectionState=r.connectionState;const o=new Event("connectionstatechange",s);r.dispatchEvent(o)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function xk(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const r=s.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&s instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:s.type,sdp:r}):s.sdp=r}return t.apply(this,arguments)}}function $g(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Xg(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return t.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?t.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>t.apply(this,[o]))})}var uY=Object.freeze({__proto__:null,removeExtmapAllowMixed:xk,shimAddIceCandidateNullOrEmpty:$g,shimConnectionState:bk,shimMaxMessageSize:qg,shimParameterlessSetLocalDescription:Xg,shimRTCIceCandidate:Kg,shimRTCIceCandidateRelayProtocol:vk,shimSendThrowTypeError:Qg});function dY(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const t=R4,i=oY(n),s={browserDetails:i,commonShim:uY,extractVersion:Dh,disableLog:sY,disableWarnings:rY,sdp:cY};switch(i.browser){case"chrome":if(!vI||!gk||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),s;if(i.version===null)return t("Chrome shim can not determine version, not shimming."),s;t("adapter.js shimming chrome."),s.browserShim=vI,$g(n,i),Xg(n),I4(n,i),B4(n),gk(n,i),D4(n),L4(n,i),N4(n),F4(n),j4(n,i),Kg(n),vk(n),bk(n),qg(n,i),Qg(n),xk(n,i);break;case"firefox":if(!bI||!yk||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),s;t("adapter.js shimming firefox."),s.browserShim=bI,$g(n,i),Xg(n),U4(n,i),yk(n,i),z4(n),G4(n),V4(n),H4(n),W4(n),J4(n),K4(n),q4(n),Q4(n),Kg(n),bk(n),qg(n,i),Qg(n);break;case"safari":if(!xI||!e.shimSafari)return t("Safari shim is not included in this adapter release."),s;t("adapter.js shimming safari."),s.browserShim=xI,$g(n,i),Xg(n),tj(n),ij(n),Y4(n),$4(n),X4(n),nj(n),Z4(n),sj(n),Kg(n),vk(n),qg(n,i),Qg(n),xk(n,i);break;default:t("Unsupported browser!");break}return s}dY({window:typeof window>"u"?void 0:window});class ci extends Promise{constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}const hY=/version\/(\d+(\.?_?\d+)+)/i;let Rx;function yi(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const t=navigator.userAgent.toLowerCase();if(Rx===void 0||e){const i=fY.find(s=>{let{test:r}=s;return r.test(t)});Rx=i==null?void 0:i.describe(t)}return Rx}const fY=[{test:/firefox|iceweasel|fxios/i,describe(n){return{name:"Firefox",version:Yg(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Px(n)}}},{test:/chrom|crios|crmo/i,describe(n){return{name:"Chrome",version:Yg(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n),os:n.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Px(n)}}},{test:/safari|applewebkit/i,describe(n){return{name:"Safari",version:Yg(hY,n),os:n.includes("mobile/")?"iOS":"macOS",osVersion:Px(n)}}}];function Yg(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=e.match(n);return i&&i.length>=t&&i[t]||""}function Px(n){return n.includes("mac os")?Yg(/\(.+?(\d+_\d+(:?_\d+)?)/,n,1).replace(/_/g,"."):void 0}var pY="2.17.0";const mY=pY,gY=16;class cr extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var lt;(function(n){n[n.NotAllowed=0]="NotAllowed",n[n.ServerUnreachable=1]="ServerUnreachable",n[n.InternalError=2]="InternalError",n[n.Cancelled=3]="Cancelled",n[n.LeaveRequest=4]="LeaveRequest",n[n.Timeout=5]="Timeout",n[n.WebSocket=6]="WebSocket",n[n.ServiceNotFound=7]="ServiceNotFound"})(lt||(lt={}));class Se extends cr{constructor(e,t,i,s){super(1,e),this.name="ConnectionError",this.status=i,this.reason=t,this.context=s,this.reasonName=lt[t]}static notAllowed(e,t,i){return new Se(e,lt.NotAllowed,t,i)}static timeout(e){return new Se(e,lt.Timeout)}static leaveRequest(e,t){return new Se(e,lt.LeaveRequest,void 0,t)}static internal(e,t){return new Se(e,lt.InternalError,void 0,t)}static cancelled(e){return new Se(e,lt.Cancelled)}static serverUnreachable(e,t){return new Se(e,lt.ServerUnreachable,t)}static websocket(e,t,i){return new Se(e,lt.WebSocket,t,i)}static serviceNotFound(e,t){return new Se(e,lt.ServiceNotFound,void 0,t)}}class s1 extends cr{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Kr extends cr{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class yY extends cr{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class Ot extends cr{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Au extends cr{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class CI extends cr{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class kI extends cr{constructor(e,t){super(15,e),this.name="SignalRequestError",this.reason=t,this.reasonName=typeof t=="string"?t:n1[t]}}var Gn;(function(n){n[n.AlreadyOpened=0]="AlreadyOpened",n[n.AbnormalEnd=1]="AbnormalEnd",n[n.DecodeFailed=2]="DecodeFailed",n[n.LengthExceeded=3]="LengthExceeded",n[n.Incomplete=4]="Incomplete",n[n.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",n[n.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(Gn||(Gn={}));class Gi extends cr{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Gn[t]}}class Dc extends cr{constructor(e){super(18,e),this.name="SignalReconnectError"}}var Vy;(function(n){n.PermissionDenied="PermissionDenied",n.NotFound="NotFound",n.DeviceInUse="DeviceInUse",n.Other="Other"})(Vy||(Vy={}));(function(n){function e(t){if(t&&"name"in t)return t.name==="NotFoundError"||t.name==="DevicesNotFoundError"?n.NotFound:t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?n.PermissionDenied:t.name==="NotReadableError"||t.name==="TrackStartError"?n.DeviceInUse:n.Other}n.getFailure=e})(Vy||(Vy={}));class kn{}kn.setTimeout=function(){return setTimeout(...arguments)};kn.setInterval=function(){return setInterval(...arguments)};kn.clearTimeout=function(){return clearTimeout(...arguments)};kn.clearInterval=function(){return clearInterval(...arguments)};var Z;(function(n){n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting",n.Reconnected="reconnected",n.Disconnected="disconnected",n.ConnectionStateChanged="connectionStateChanged",n.Moved="moved",n.MediaDevicesChanged="mediaDevicesChanged",n.ParticipantConnected="participantConnected",n.ParticipantDisconnected="participantDisconnected",n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalAudioSilenceDetected="localAudioSilenceDetected",n.ActiveSpeakersChanged="activeSpeakersChanged",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.ParticipantAttributesChanged="participantAttributesChanged",n.ParticipantActive="participantActive",n.RoomMetadataChanged="roomMetadataChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.AudioPlaybackStatusChanged="audioPlaybackChanged",n.VideoPlaybackStatusChanged="videoPlaybackChanged",n.MediaDevicesError="mediaDevicesError",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.SignalConnected="signalConnected",n.RecordingStatusChanged="recordingStatusChanged",n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ActiveDeviceChanged="activeDeviceChanged",n.ChatMessage="chatMessage",n.LocalTrackSubscribed="localTrackSubscribed",n.MetricsReceived="metricsReceived"})(Z||(Z={}));var de;(function(n){n.TrackPublished="trackPublished",n.TrackSubscribed="trackSubscribed",n.TrackSubscriptionFailed="trackSubscriptionFailed",n.TrackUnpublished="trackUnpublished",n.TrackUnsubscribed="trackUnsubscribed",n.TrackMuted="trackMuted",n.TrackUnmuted="trackUnmuted",n.LocalTrackPublished="localTrackPublished",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackCpuConstrained="localTrackCpuConstrained",n.LocalSenderCreated="localSenderCreated",n.ParticipantMetadataChanged="participantMetadataChanged",n.ParticipantNameChanged="participantNameChanged",n.DataReceived="dataReceived",n.SipDTMFReceived="sipDTMFReceived",n.TranscriptionReceived="transcriptionReceived",n.IsSpeakingChanged="isSpeakingChanged",n.ConnectionQualityChanged="connectionQualityChanged",n.TrackStreamStateChanged="trackStreamStateChanged",n.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",n.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",n.TrackCpuConstrained="trackCpuConstrained",n.MediaDevicesError="mediaDevicesError",n.AudioStreamAcquired="audioStreamAcquired",n.ParticipantPermissionsChanged="participantPermissionsChanged",n.PCTrackAdded="pcTrackAdded",n.AttributesChanged="attributesChanged",n.LocalTrackSubscribed="localTrackSubscribed",n.ChatMessage="chatMessage",n.Active="active"})(de||(de={}));var ce;(function(n){n.TransportsCreated="transportsCreated",n.Connected="connected",n.Disconnected="disconnected",n.Resuming="resuming",n.Resumed="resumed",n.Restarting="restarting",n.Restarted="restarted",n.SignalResumed="signalResumed",n.SignalRestarted="signalRestarted",n.Closing="closing",n.MediaTrackAdded="mediaTrackAdded",n.ActiveSpeakersUpdate="activeSpeakersUpdate",n.DataPacketReceived="dataPacketReceived",n.RTPVideoMapUpdate="rtpVideoMapUpdate",n.DCBufferStatusChanged="dcBufferStatusChanged",n.ParticipantUpdate="participantUpdate",n.RoomUpdate="roomUpdate",n.SpeakersChanged="speakersChanged",n.StreamStateChanged="streamStateChanged",n.ConnectionQualityUpdate="connectionQualityUpdate",n.SubscriptionError="subscriptionError",n.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",n.RemoteMute="remoteMute",n.SubscribedQualityUpdate="subscribedQualityUpdate",n.LocalTrackUnpublished="localTrackUnpublished",n.LocalTrackSubscribed="localTrackSubscribed",n.Offline="offline",n.SignalRequestResponse="signalRequestResponse",n.SignalConnected="signalConnected",n.RoomMoved="roomMoved"})(ce||(ce={}));var oe;(function(n){n.Message="message",n.Muted="muted",n.Unmuted="unmuted",n.Restarted="restarted",n.Ended="ended",n.Subscribed="subscribed",n.Unsubscribed="unsubscribed",n.CpuConstrained="cpuConstrained",n.UpdateSettings="updateSettings",n.UpdateSubscription="updateSubscription",n.AudioPlaybackStarted="audioPlaybackStarted",n.AudioPlaybackFailed="audioPlaybackFailed",n.AudioSilenceDetected="audioSilenceDetected",n.VisibilityChanged="visibilityChanged",n.VideoDimensionsChanged="videoDimensionsChanged",n.VideoPlaybackStarted="videoPlaybackStarted",n.VideoPlaybackFailed="videoPlaybackFailed",n.ElementAttached="elementAttached",n.ElementDetached="elementDetached",n.UpstreamPaused="upstreamPaused",n.UpstreamResumed="upstreamResumed",n.SubscriptionPermissionChanged="subscriptionPermissionChanged",n.SubscriptionStatusChanged="subscriptionStatusChanged",n.SubscriptionFailed="subscriptionFailed",n.TrackProcessorUpdate="trackProcessorUpdate",n.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",n.TranscriptionReceived="transcriptionReceived",n.TimeSyncUpdate="timeSyncUpdate",n.PreConnectBufferFlushed="preConnectBufferFlushed"})(oe||(oe={}));function vY(n){return typeof n>"u"?n:typeof structuredClone=="function"?typeof n=="object"&&n!==null?structuredClone(Object.assign({},n)):structuredClone(n):JSON.parse(JSON.stringify(n))}class st{constructor(e,t,i,s,r){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(t!==void 0&&i!==void 0)this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:i,maxFramerate:s,priority:r};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const bY=["vp8","h264"],xY=["vp8","h264","vp9","av1","h265"];function SY(n){return!!bY.find(e=>e===n)}const CY=SY;var wI;(function(n){n[n.PREFER_REGRESSION=0]="PREFER_REGRESSION",n[n.SIMULCAST=1]="SIMULCAST",n[n.REGRESSION=2]="REGRESSION"})(wI||(wI={}));var Sk;(function(n){n.telephone={maxBitrate:12e3},n.speech={maxBitrate:24e3},n.music={maxBitrate:48e3},n.musicStereo={maxBitrate:64e3},n.musicHighQuality={maxBitrate:96e3},n.musicHighQualityStereo={maxBitrate:128e3}})(Sk||(Sk={}));const Nf={h90:new st(160,90,9e4,20),h180:new st(320,180,16e4,20),h216:new st(384,216,18e4,20),h360:new st(640,360,45e4,20),h540:new st(960,540,8e5,25),h720:new st(1280,720,17e5,30),h1080:new st(1920,1080,3e6,30),h1440:new st(2560,1440,5e6,30),h2160:new st(3840,2160,8e6,30)},Ck={h120:new st(160,120,7e4,20),h180:new st(240,180,125e3,20),h240:new st(320,240,14e4,20),h360:new st(480,360,33e4,20),h480:new st(640,480,5e5,20),h540:new st(720,540,6e5,25),h720:new st(960,720,13e5,30),h1080:new st(1440,1080,23e5,30),h1440:new st(1920,1440,38e5,30)},r1={h360fps3:new st(640,360,2e5,3,"medium"),h360fps15:new st(640,360,4e5,15,"medium"),h720fps5:new st(1280,720,8e5,5,"medium"),h720fps15:new st(1280,720,15e5,15,"medium"),h720fps30:new st(1280,720,2e6,30,"medium"),h1080fps15:new st(1920,1080,25e5,15,"medium"),h1080fps30:new st(1920,1080,5e6,30,"medium"),original:new st(0,0,7e6,30,"medium")};function oj(n,e,t){var i,s,r,o;const{optionsWithoutProcessor:a,audioProcessor:c,videoProcessor:d}=cj(n??{}),h=e==null?void 0:e.processor,f=t==null?void 0:t.processor,m=a??{};return m.audio===!0&&(m.audio={}),m.video===!0&&(m.video={}),m.audio&&(kk(m.audio,e),(i=(r=m.audio).deviceId)!==null&&i!==void 0||(r.deviceId={ideal:"default"}),(c||h)&&(m.audio.processor=c??h)),m.video&&(kk(m.video,t),(s=(o=m.video).deviceId)!==null&&s!==void 0||(o.deviceId={ideal:"default"}),(d||f)&&(m.video.processor=d??f)),m}function kk(n,e){return Object.keys(e).forEach(t=>{n[t]===void 0&&(n[t]=e[t])}),n}function o1(n){var e,t,i,s;const r={};if(n.video)if(typeof n.video=="object"){const o={},a=o,c=n.video;Object.keys(c).forEach(d=>{switch(d){case"resolution":kk(a,c.resolution);break;default:a[d]=c[d]}}),r.video=o,(e=(i=r.video).deviceId)!==null&&e!==void 0||(i.deviceId={ideal:"default"})}else r.video=n.video?{deviceId:{ideal:"default"}}:!1;else r.video=!1;return n.audio?typeof n.audio=="object"?(r.audio=n.audio,(t=(s=r.audio).deviceId)!==null&&t!==void 0||(s.deviceId={ideal:"default"})):r.audio={deviceId:{ideal:"default"}}:r.audio=!1,r}function aj(n){return D(this,arguments,void 0,function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const i=lj();if(i){const s=i.createAnalyser();s.fftSize=2048;const r=s.frequencyBinCount,o=new Uint8Array(r);i.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(s),yield wn(t),s.getByteTimeDomainData(o);const c=o.some(d=>d!==128&&d!==0);return i.close(),!c}return!1}()})}function lj(){var n;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const t=new e({latencyHint:"interactive"});if(t.state==="suspended"&&typeof window<"u"&&(!((n=window.document)===null||n===void 0)&&n.body)){const i=()=>D(this,void 0,void 0,function*(){var s;try{t.state==="suspended"&&(yield t.resume())}catch(r){console.warn("Error trying to auto-resume audio context",r)}finally{(s=window.document.body)===null||s===void 0||s.removeEventListener("click",i)}});t.addEventListener("statechange",()=>{var s;t.state==="closed"&&((s=window.document.body)===null||s===void 0||s.removeEventListener("click",i))}),window.document.body.addEventListener("click",i)}return t}}function kY(n){return n==="audioinput"?Q.Source.Microphone:n==="videoinput"?Q.Source.Camera:Q.Source.Unknown}function wk(n){return n===Q.Source.Microphone?"audioinput":n===Q.Source.Camera?"videoinput":void 0}function wY(n){var e,t;let i=(e=n.video)!==null&&e!==void 0?e:!0;return n.resolution&&n.resolution.width>0&&n.resolution.height>0&&(i=typeof i=="boolean"?{}:i,Yl()?i=Object.assign(Object.assign({},i),{width:{max:n.resolution.width},height:{max:n.resolution.height},frameRate:n.resolution.frameRate}):i=Object.assign(Object.assign({},i),{width:{ideal:n.resolution.width},height:{ideal:n.resolution.height},frameRate:n.resolution.frameRate})),{audio:(t=n.audio)!==null&&t!==void 0?t:!1,video:i,controller:n.controller,selfBrowserSurface:n.selfBrowserSurface,surfaceSwitching:n.surfaceSwitching,systemAudio:n.systemAudio,preferCurrentTab:n.preferCurrentTab}}function Zh(n){return n.split("/")[1].toLowerCase()}function TY(n){const e=[];return n.forEach(t=>{t.track!==void 0&&e.push(new XT({cid:t.track.mediaStreamID,track:t.trackInfo}))}),e}function Ne(n){return"mediaStreamTrack"in n?{trackID:n.sid,source:n.source,muted:n.isMuted,enabled:n.mediaStreamTrack.enabled,kind:n.kind,streamID:n.mediaStreamID,streamTrackID:n.mediaStreamTrack.id}:{trackID:n.trackSid,enabled:n.isEnabled,muted:n.isMuted,trackInfo:Object.assign({mimeType:n.mimeType,name:n.trackName,encrypted:n.isEncrypted,kind:n.kind,source:n.source},n.track?Ne(n.track):{})}}function AY(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function EY(n,e){var t;n===void 0&&(n={}),e===void 0&&(e={});const i=[...Object.keys(e),...Object.keys(n)],s={};for(const r of i)n[r]!==e[r]&&(s[r]=(t=e[r])!==null&&t!==void 0?t:"");return s}function cj(n){const e=Object.assign({},n);let t,i;return typeof e.audio=="object"&&e.audio.processor&&(t=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(i=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:t,videoProcessor:i,optionsWithoutProcessor:vY(e)}}function _Y(n){switch(n){case qt.CAMERA:return Q.Source.Camera;case qt.MICROPHONE:return Q.Source.Microphone;case qt.SCREEN_SHARE:return Q.Source.ScreenShare;case qt.SCREEN_SHARE_AUDIO:return Q.Source.ScreenShareAudio;default:return Q.Source.Unknown}}function TI(n,e){return n.width*n.height<e.width*e.height}function MY(n,e){var t;return(t=n.layers)===null||t===void 0?void 0:t.find(i=>i.quality===e)}const RY=5e3,fh=[];var Pi;(function(n){n[n.LOW=0]="LOW",n[n.MEDIUM=1]="MEDIUM",n[n.HIGH=2]="HIGH"})(Pi||(Pi={}));class Q extends lr.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var s;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Me,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),RY):this.handleAppVisibilityChanged()},this.log=uo((s=i.loggerName)!==null&&s!==void 0?s:js.Track),this.loggerContextCb=i.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ne(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Q.Kind.Video&&(t="video"),this.attachedElements.length===0&&this.kind===Q.Kind.Video&&this.addAppVisibilityListener(),e||(t==="audio"&&(fh.forEach(r=>{r.parentElement===null&&!e&&(e=r)}),e&&fh.splice(fh.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),fu(this.mediaStreamTrack,e);const i=e.srcObject.getTracks(),s=i.some(r=>r.kind==="audio");return e.play().then(()=>{this.emit(s?oe.AudioPlaybackStarted:oe.VideoPlaybackStarted)}).catch(r=>{r.name==="NotAllowedError"?this.emit(s?oe.AudioPlaybackFailed:oe.VideoPlaybackFailed,r):r.name==="AbortError"?Me.debug("".concat(s?"audio":"video"," playback aborted, likely due to new play request")):Me.warn("could not playback ".concat(s?"audio":"video"),r),s&&e&&i.some(o=>o.kind==="video")&&r.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(oe.ElementAttached,e),e}detach(e){try{if(e){Eu(this.mediaStreamTrack,e);const i=this.attachedElements.indexOf(e);return i>=0&&(this.attachedElements.splice(i,1),this.recycleElement(e),this.emit(oe.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(i=>{Eu(this.mediaStreamTrack,i),t.push(i),this.recycleElement(i),this.emit(oe.ElementDetached,i)}),this.attachedElements=[],t}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=uo(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),fh.forEach(i=>{i.parentElement||(t=!1)}),t&&fh.push(e)}}handleAppVisibilityChanged(){return D(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Q.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){ui()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){ui()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function fu(n,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let i;n.kind==="audio"?i=t.getAudioTracks():i=t.getVideoTracks(),i.includes(n)||(i.forEach(s=>{t.removeTrack(s)}),t.addTrack(n)),(!Yl()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(Yl()||Xl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function Eu(n,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(n),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}(function(n){let e;(function(d){d.Audio="audio",d.Video="video",d.Unknown="unknown"})(e=n.Kind||(n.Kind={}));let t;(function(d){d.Camera="camera",d.Microphone="microphone",d.ScreenShare="screen_share",d.ScreenShareAudio="screen_share_audio",d.Unknown="unknown"})(t=n.Source||(n.Source={}));let i;(function(d){d.Active="active",d.Paused="paused",d.Unknown="unknown"})(i=n.StreamState||(n.StreamState={}));function s(d){switch(d){case e.Audio:return ws.AUDIO;case e.Video:return ws.VIDEO;default:return ws.DATA}}n.kindToProto=s;function r(d){switch(d){case ws.AUDIO:return e.Audio;case ws.VIDEO:return e.Video;default:return e.Unknown}}n.kindFromProto=r;function o(d){switch(d){case t.Camera:return qt.CAMERA;case t.Microphone:return qt.MICROPHONE;case t.ScreenShare:return qt.SCREEN_SHARE;case t.ScreenShareAudio:return qt.SCREEN_SHARE_AUDIO;default:return qt.UNKNOWN}}n.sourceToProto=o;function a(d){switch(d){case qt.CAMERA:return t.Camera;case qt.MICROPHONE:return t.Microphone;case qt.SCREEN_SHARE:return t.ScreenShare;case qt.SCREEN_SHARE_AUDIO:return t.ScreenShareAudio;default:return t.Unknown}}n.sourceFromProto=a;function c(d){switch(d){case hk.ACTIVE:return i.Active;case hk.PAUSED:return i.Paused;default:return i.Unknown}}n.streamStateFromProto=c})(Q||(Q={}));const PY="|",AI="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function IY(n){const e=n.split(PY);return e.length>1?[e[0],n.substr(e[0].length+1)]:[n,""]}function wn(n){return new ci(e=>kn.setTimeout(e,n))}function Tk(){return"addTransceiver"in RTCPeerConnection.prototype}function Ak(){return"addTrack"in RTCPeerConnection.prototype}function BY(){if(!("getCapabilities"in RTCRtpSender)||Yl()||Xl())return!1;const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function DY(){if(!("getCapabilities"in RTCRtpSender)||Xl())return!1;if(Yl()){const t=yi();if(t!=null&&t.version&&ar(t.version,"16")<0||(t==null?void 0:t.os)==="iOS"&&(t!=null&&t.osVersion)&&ar(t.osVersion,"16")<0)return!1}const n=RTCRtpSender.getCapabilities("video");let e=!1;if(n){for(const t of n.codecs)if(t.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function As(n){return n==="av1"||n==="vp9"}function Ek(n){return!document||Ff()?!1:(n||(n=document.createElement("audio")),"setSinkId"in n)}function NY(){return typeof RTCPeerConnection>"u"?!1:Tk()||Ak()}function Xl(){var n;return((n=yi())===null||n===void 0?void 0:n.name)==="Firefox"}function EI(){const n=yi();return!!n&&n.name==="Chrome"&&n.os!=="iOS"}function Yl(){var n;return((n=yi())===null||n===void 0?void 0:n.name)==="Safari"}function Ff(){const n=yi();return(n==null?void 0:n.name)==="Safari"||(n==null?void 0:n.os)==="iOS"}function FY(){const n=yi();return(n==null?void 0:n.name)==="Safari"&&n.version.startsWith("17.")||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&ar(n.osVersion,"17")>=0}function OY(n){return n||(n=yi()),(n==null?void 0:n.name)==="Safari"&&ar(n.version,"18.3")>0||(n==null?void 0:n.os)==="iOS"&&!!(n!=null&&n.osVersion)&&ar(n.osVersion,"18.3")>0}function uj(){var n,e;return ui()?(e=(n=navigator.userAgentData)===null||n===void 0?void 0:n.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function LY(){const n=yi(),e="17.2";if(n)return n.name!=="Safari"&&n.os!=="iOS"||n.os==="iOS"&&n.osVersion&&ar(n.osVersion,e)>=0?!0:n.name==="Safari"&&ar(n.version,e)>=0}function ui(){return typeof document<"u"}function or(){return navigator.product=="ReactNative"}function sd(n){return n.hostname.endsWith(".livekit.cloud")||n.hostname.endsWith(".livekit.run")}function Ix(n){return sd(n)?n.hostname.split(".")[0]:null}function dj(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function hj(){if(!or())return;let n=dj();if(n)return n.platform}function _I(){if(ui())return window.devicePixelRatio;if(or()){let n=dj();if(n)return n.devicePixelRatio}return 1}function ar(n,e){const t=n.split("."),i=e.split("."),s=Math.min(t.length,i.length);for(let r=0;r<s;++r){const o=parseInt(t[r],10),a=parseInt(i[r],10);if(o>a)return 1;if(o<a)return-1;if(r===s-1&&o===a)return 0}return n===""&&e!==""?-1:e===""?1:t.length==i.length?0:t.length<i.length?-1:1}function jY(n){for(const e of n)e.target.handleResize(e)}function UY(n){for(const e of n)e.target.handleVisibilityChanged(e)}let Bx=null;const MI=()=>(Bx||(Bx=new ResizeObserver(jY)),Bx);let Dx=null;const RI=()=>(Dx||(Dx=new IntersectionObserver(UY,{root:null,rootMargin:"0px"})),Dx);function zY(){var n;const e=new h4({sdk:f4.JS,protocol:gY,version:mY});return or()&&(e.os=(n=hj())!==null&&n!==void 0?n:""),e}function PI(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=document.createElement("canvas");s.width=n,s.height=e;const r=s.getContext("2d");r==null||r.fillRect(0,0,s.width,s.height),i&&r&&(r.beginPath(),r.arc(n/2,e/2,50,0,Math.PI*2,!0),r.closePath(),r.fillStyle="grey",r.fill());const o=s.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=t,a}let ph;function Nx(){if(!ph){const n=new AudioContext,e=n.createOscillator(),t=n.createGain();t.gain.setValueAtTime(0,0);const i=n.createMediaStreamDestination();if(e.connect(t),t.connect(i),e.start(),[ph]=i.stream.getAudioTracks(),!ph)throw Error("Could not get empty media stream audio track");ph.enabled=!1}return ph.clone()}class Yi{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((i,s)=>D(this,void 0,void 0,function*(){this.resolve=i,this.reject=s,e&&(yield e(i,s))})).finally(()=>{var i;this._isResolved=!0,(i=this.onFinally)===null||i===void 0||i.call(this)})}}function VY(n){return xY.includes(n)}function Aa(n){if(typeof n=="string"||typeof n=="number")return n;if(Array.isArray(n))return n[0];if(n.exact!==void 0)return Array.isArray(n.exact)?n.exact[0]:n.exact;if(n.ideal!==void 0)return Array.isArray(n.ideal)?n.ideal[0]:n.ideal;throw Error("could not unwrap constraint")}function HY(n){return n.startsWith("http")?n.replace(/^(http)/,"ws"):n}function Of(n){return n.startsWith("ws")?n.replace(/^(ws)/,"http"):n}function GY(n,e){return n.segments.map(t=>{let{id:i,text:s,language:r,startTime:o,endTime:a,final:c}=t;var d;const h=(d=e.get(i))!==null&&d!==void 0?d:Date.now(),f=Date.now();return c?e.delete(i):e.set(i,h),{id:i,text:s,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:c,language:r,firstReceivedTime:h,lastReceivedTime:f}})}function WY(n){const{id:e,timestamp:t,message:i,editTimestamp:s}=n;return{id:e,timestamp:Number.parseInt(t.toString()),editTimestamp:s?Number.parseInt(s.toString()):void 0,message:i}}function II(n){switch(n.reason){case lt.LeaveRequest:return n.context;case lt.Cancelled:return Rs.CLIENT_INITIATED;case lt.NotAllowed:return Rs.USER_REJECTED;case lt.ServerUnreachable:return Rs.JOIN_FAILURE;default:return Rs.UNKNOWN_REASON}}function Zg(n){return n!==void 0?Number(n):void 0}function gl(n){return n!==void 0?BigInt(n):void 0}function _u(n){return!!n&&!(n instanceof MediaStreamTrack)&&n.isLocal}function rr(n){return!!n&&n.kind==Q.Kind.Audio}function ja(n){return!!n&&n.kind==Q.Kind.Video}function jo(n){return _u(n)&&ja(n)}function Br(n){return _u(n)&&rr(n)}function _k(n){return!!n&&!n.isLocal}function JY(n){return!!n&&!n.isLocal}function Fx(n){return _k(n)&&ja(n)}function KY(n){return n.isLocal}function qY(n,e){const t=[];let i=new TextEncoder().encode(n);for(;i.length>e;){let s=e;for(;s>0;){const r=i[s];if(r!==void 0&&(r&192)!==128)break;s--}t.push(i.slice(0,s)),i=i.slice(s)}return i.length>0&&t.push(i),t}function QY(n){var e;const t=n.get("Cache-Control");if(t){const i=(e=t.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(i)return parseInt(i,10)}}function $Y(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=XY(n,e);return t?i:a1(i,"v1")}function XY(n,e){const t=new URL(HY(n));return e.forEach((i,s)=>{t.searchParams.set(s,i)}),a1(t,"rtc")}function YY(n){const e=new URL(Of(n));return a1(e,"validate")}function fj(n){return n.endsWith("/")?n:"".concat(n,"/")}function a1(n,e){return n.pathname="".concat(fj(n.pathname)).concat(e),n}function BI(n){if(typeof n=="string")return dI.fromJson(JSON.parse(n),{ignoreUnknownFields:!0});if(n instanceof ArrayBuffer)return dI.fromBinary(new Uint8Array(n));throw new Error("could not decode websocket message: ".concat(typeof n))}function ZY(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(n instanceof AbortSignal))return e;const t=n.reason;switch(typeof t){case"string":return t;case"object":return t instanceof Error?t.message:e;default:return"toString"in t?t.toString():e}}const eZ=10,mh="lk_e2ee",tZ="LKFrameEncryptionKey",nZ={sharedKey:!1,ratchetSalt:tZ,ratchetWindowSize:8,failureTolerance:eZ,keyringSize:16};var Ea;(function(n){n.SetKey="setKey",n.RatchetRequest="ratchetRequest",n.KeyRatcheted="keyRatcheted"})(Ea||(Ea={}));var DI;(function(n){n.KeyRatcheted="keyRatcheted"})(DI||(DI={}));var ma;(function(n){n.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",n.EncryptionError="encryptionError"})(ma||(ma={}));var NI;(function(n){n.Error="cryptorError"})(NI||(NI={}));function iZ(){return sZ()||Mk()}function Mk(){return typeof window.RTCRtpScriptTransform<"u"}function sZ(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function rZ(n){var e,t,i,s,r;if(((e=n.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((t=n.value)===null||t===void 0?void 0:t.case)!=="metrics"&&((i=n.value)===null||i===void 0?void 0:i.case)!=="speaker"&&((s=n.value)===null||s===void 0?void 0:s.case)!=="transcription"&&((r=n.value)===null||r===void 0?void 0:r.case)!=="encryptedPacket")return new r4({value:n.value})}class die extends lr.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(t,i,s)=>{Me.debug("key ratcheted event received",{ratchetResult:t,participantId:i,keyIndex:s})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},nZ),e),this.on(Ea.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,i){const s={key:e,participantIdentity:t,keyIndex:i};if(!this.options.sharedKey&&!t)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(t??"shared","-").concat(i??0),s),this.emit(Ea.SetKey,s)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(Ea.RatchetRequest,e,t)}}var FI;(function(n){n[n.InvalidKey=0]="InvalidKey",n[n.MissingKey=1]="MissingKey",n[n.InternalError=2]="InternalError"})(FI||(FI={}));class oZ extends lr.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=i=>{var s,r;const{kind:o,data:a}=i.data;switch(o){case"error":if(Me.error(a.error.message),a.uuid){const h=this.decryptDataRequests.get(a.uuid);if(h!=null&&h.reject){h.reject(a.error);break}const f=this.encryptDataRequests.get(a.uuid);if(f!=null&&f.reject){f.reject(a.error);break}}this.emit(ma.EncryptionError,a.error,a.participantIdentity);break;case"initAck":a.enabled&&this.keyProvider.getKeys().forEach(h=>{this.postKey(h)});break;case"enable":if(a.enabled&&this.keyProvider.getKeys().forEach(h=>{this.postKey(h)}),this.encryptionEnabled!==a.enabled&&a.participantIdentity===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity))this.emit(ma.ParticipantEncryptionStatusChanged,a.enabled,this.room.localParticipant),this.encryptionEnabled=a.enabled;else if(a.participantIdentity){const h=(r=this.room)===null||r===void 0?void 0:r.getParticipantByIdentity(a.participantIdentity);if(!h)throw TypeError("couldn't set encryption status, participant not found".concat(a.participantIdentity));this.emit(ma.ParticipantEncryptionStatusChanged,a.enabled,h)}break;case"ratchetKey":this.keyProvider.emit(Ea.KeyRatcheted,a.ratchetResult,a.participantIdentity,a.keyIndex);break;case"decryptDataResponse":const c=this.decryptDataRequests.get(a.uuid);c!=null&&c.resolve&&c.resolve(a);break;case"encryptDataResponse":const d=this.encryptDataRequests.get(a.uuid);d!=null&&d.resolve&&d.resolve(a);break}},this.onWorkerError=i=>{Me.error("e2ee worker encountered an error:",{error:i.error}),this.emit(ma.EncryptionError,i.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!iZ())throw new s1("tried to setup end-to-end encryption on an unsupported browser");if(Me.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:ZX.getLevel()}};this.worker&&(Me.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){Me.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){!e||e.length===0?Me.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ce.RTPVideoMapUpdate,t=>{this.postRTPMap(t)})}setupEventListeners(e,t){e.on(Z.TrackPublished,(i,s)=>this.setParticipantCryptorEnabled(i.trackInfo.encryption!==sn.NONE,s.identity)),e.on(Z.ConnectionStateChanged,i=>{i===Qe.Connected&&e.remoteParticipants.forEach(s=>{s.trackPublications.forEach(r=>{this.setParticipantCryptorEnabled(r.trackInfo.encryption!==sn.NONE,s.identity)})})}).on(Z.TrackUnsubscribed,(i,s,r)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:r.identity,trackId:i.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(Z.TrackSubscribed,(i,s,r)=>{this.setupE2EEReceiver(i,r.identity,s.trackInfo)}).on(Z.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(i=>{this.postKey(i)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(de.LocalSenderCreated,(i,s)=>D(this,void 0,void 0,function*(){this.setupE2EESender(s,i)})),e.localParticipant.on(de.LocalTrackPublished,i=>{if(!ja(i.track)||!Ff())return;const s={kind:"updateCodec",data:{trackId:i.track.mediaStreamID,codec:Zh(i.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}),t.on(Ea.SetKey,i=>this.postKey(i)).on(Ea.RatchetRequest,(i,s)=>this.postRatchetRequest(i,s))}encryptData(e){return D(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),i={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},s=new Yi;return s.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,s),this.worker.postMessage(i),s.promise})}handleEncryptedData(e,t,i,s){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const r=crypto.randomUUID(),o={kind:"decryptDataRequest",data:{uuid:r,payload:e,iv:t,participantIdentity:i,keyIndex:s}},a=new Yi;return a.onFinally=()=>{this.decryptDataRequests.delete(r)},this.decryptDataRequests.set(r,a),this.worker.postMessage(o),a.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const i={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(i)}postKey(e){let{key:t,participantIdentity:i,keyIndex:s}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:i,isPublisher:i===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity),key:t,keyIndex:s}};this.worker.postMessage(o)}postEnable(e,t){if(this.worker){const i={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(i)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((t=this.room)===null||t===void 0)&&t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const i={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,i){if(e.receiver){if(!(i!=null&&i.mimeType)||i.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,e.kind==="video"?Zh(i.mimeType):void 0)}}setupE2EESender(e,t){if(!_u(e)||!t){t||Me.warn("early return because sender is not ready");return}this.handleSender(t,e.mediaStreamID,void 0)}handleReceiver(e,t,i,s){return D(this,void 0,void 0,function*(){if(this.worker){if(Mk()&&!EI()){const r={kind:"decode",participantIdentity:i,trackId:t,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(mh in e&&s){const c={kind:"updateCodec",data:{trackId:t,codec:s,participantIdentity:i}};this.worker.postMessage(c);return}let r=e.writableStream,o=e.readableStream;if(!r||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,r=c.writable,e.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:r,trackId:t,codec:s,participantIdentity:i,isReuse:mh in e}};this.worker.postMessage(a,[o,r])}e[mh]=!0}})}handleSender(e,t,i){var s;if(!(mh in e||!this.worker)){if(!(!((s=this.room)===null||s===void 0)&&s.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Mk()&&!EI()){Me.info("initialize script transform");const r={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{Me.info("initialize encoded streams");const r=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:r.readable,writableStream:r.writable,codec:i,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(o,[r.readable,r.writable])}e[mh]=!0}}}const aZ=500,lZ=15e3;class Mu{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new Mu),this._instance}addFailedConnectionAttempt(e){var t;const i=new URL(e),s=Ix(i);if(!s)return;let r=(t=this.failedConnectionAttempts.get(s))!==null&&t!==void 0?t:0;this.failedConnectionAttempts.set(s,r+1),this.backOffPromises.set(s,wn(Math.min(aZ*Math.pow(2,r),lZ)))}getBackOffPromise(e){const t=new URL(e),i=t&&Ix(t);return i&&this.backOffPromises.get(i)||Promise.resolve()}resetFailedConnectionAttempts(e){const t=new URL(e),i=t&&Ix(t);i&&(this.failedConnectionAttempts.set(i,0),this.backOffPromises.set(i,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}Mu._instance=null;const Ox="default";class gn{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new gn),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var r;if(((r=gn.userMediaPromiseMap)===null||r===void 0?void 0:r.size)>0){Me.debug("awaiting getUserMedia promise");try{t?yield gn.userMediaPromiseMap.get(t):yield Promise.all(gn.userMediaPromiseMap.values())}catch{Me.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(s&&!(Yl()&&i.hasDeviceInUse(t))&&(o.filter(c=>c.kind===t).length===0||o.some(c=>{const d=c.label==="",h=t?c.kind===t:!0;return d&&h}))){const c={video:t!=="audioinput"&&t!=="audiooutput",audio:t!=="videoinput"&&{deviceId:{ideal:"default"}}},d=yield navigator.mediaDevices.getUserMedia(c);o=yield navigator.mediaDevices.enumerateDevices(),d.getTracks().forEach(h=>{h.stop()})}return i._previousDevices=o,t&&(o=o.filter(a=>a.kind===t)),o}()})}normalizeDeviceId(e,t,i){return D(this,void 0,void 0,function*(){if(t!==Ox)return t;const s=yield this.getDevices(e),r=s.find(a=>a.deviceId===Ox);if(!r){Me.warn("could not reliably determine default device");return}const o=s.find(a=>a.deviceId!==Ox&&a.groupId===(i??r.groupId));if(!o){Me.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?gn.userMediaPromiseMap.has(e):gn.userMediaPromiseMap.size>0}}gn.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];gn.userMediaPromiseMap=new Map;var ef;(function(n){n[n.WAITING=0]="WAITING",n[n.RUNNING=1]="RUNNING",n[n.COMPLETED=2]="COMPLETED"})(ef||(ef={}));class cZ{constructor(){this.pendingTasks=new Map,this.taskMutex=new $n,this.nextTaskIndex=0}run(e){return D(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:ef.WAITING};this.pendingTasks.set(t.id,t);const i=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=ef.RUNNING,yield e()}finally{t.status=ef.COMPLETED,this.pendingTasks.delete(t.id),i()}})}flush(){return D(this,void 0,void 0,function*(){return this.run(()=>D(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class uZ{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i,s;if(!((i=t.signal)===null||i===void 0)&&i.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const r=new WebSocket(e,(s=t.protocols)!==null&&s!==void 0?s:[]);r.binaryType="arraybuffer",this.ws=r;const o=function(){let{closeCode:a,reason:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.close(a,c)};this.opened=new ci((a,c)=>{const d=()=>{c(Se.websocket("Encountered websocket error during connection establishment"))};r.onopen=()=>{a({readable:new ReadableStream({start(h){r.onmessage=f=>{let{data:m}=f;return h.enqueue(m)},r.onerror=f=>h.error(f)},cancel:o}),writable:new WritableStream({write(h){r.send(h)},abort(){r.close()},close:o}),protocol:r.protocol,extensions:r.extensions}),r.removeEventListener("error",d)},r.addEventListener("error",d)}),this.closed=new ci((a,c)=>{const d=()=>D(this,void 0,void 0,function*(){const h=new ci(m=>{r.readyState!==WebSocket.CLOSED&&r.addEventListener("close",y=>{m(y)},{once:!0})}),f=yield ci.race([wn(250),h]);f?a(f):c(Se.websocket("Encountered unspecified websocket error without a timely close event"))});r.onclose=h=>{let{code:f,reason:m}=h;a({closeCode:f,reason:m}),r.removeEventListener("error",d)},r.addEventListener("error",d)}),t.signal&&(t.signal.onabort=()=>r.close()),this.close=o}}const dZ=["syncState","trickle","offer","answer","simulate","leave"];function hZ(n){const e=dZ.indexOf(n.case)>=0;return Me.trace("request allowed to bypass queue:",{canPass:e,req:n}),e}var at;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.CONNECTED=1]="CONNECTED",n[n.RECONNECTING=2]="RECONNECTING",n[n.DISCONNECTING=3]="DISCONNECTING",n[n.DISCONNECTED=4]="DISCONNECTED"})(at||(at={}));const fZ=250;class l1{get currentState(){return this.state}get isDisconnected(){return this.state===at.DISCONNECTING||this.state===at.DISCONNECTED}get isEstablishingConnection(){return this.state===at.CONNECTING||this.state===at.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;this.rtt=0,this.state=at.DISCONNECTED,this.log=Me,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=uo((i=t.loggerName)!==null&&i!==void 0?i:js.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new cZ,this.queuedRequests=[],this.closingLock=new $n,this.connectionLock=new $n,this.state=at.DISCONNECTED}get logContext(){var e,t;return(t=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:{}}join(e,t,i,s){return D(this,arguments,void 0,function(r,o,a,c){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){return d.state=at.CONNECTING,d.options=a,yield d.connect(r,o,a,c,h)}()})}reconnect(e,t,i,s){return D(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=at.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:i,reconnectReason:s}),void 0,this.useV0SignalPath)})}connect(e,t,i,s){return D(this,arguments,void 0,function(r,o,a,c){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){const f=yield d.connectionLock.lock();d.connectOptions=a,d.useV0SignalPath=h;const m=zY(),y=h?pZ(o,m,a):mZ(o,m,a),v=$Y(r,y,h).toString(),x=YY(v).toString();return new Promise((k,C)=>D(d,void 0,void 0,function*(){var A,T;try{let E=!1;const _=O=>D(this,void 0,void 0,function*(){if(E)return;E=!0;const W=O instanceof Event?O.currentTarget:O,ie=ZY(W,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(ie)).catch(he=>{this.log.error(he),this.close()}):this.close(),R(),C(Se.cancelled(ie))});c==null||c.addEventListener("abort",_);const R=()=>{clearTimeout(B),c==null||c.removeEventListener("abort",_)},B=setTimeout(()=>{_(Se.timeout("room connection has timed out (signal)"))},a.websocketTimeout),I=(O,W)=>{this.handleSignalConnected(O,B,W)},L=new URL(v);L.searchParams.has("access_token")&&L.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(L),Object.assign({reconnect:a.reconnect,reconnectReason:a.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new uZ(v);try{this.ws.closed.then(K=>{var ee;this.isEstablishingConnection&&C(Se.internal("Websocket got closed during a (re)connection attempt: ".concat(K.reason))),K.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:K.reason,code:K.closeCode,wasClean:K.closeCode===1e3,state:this.state})),this.state===at.CONNECTED&&this.handleOnClose((ee=K.reason)!==null&&ee!==void 0?ee:"Unexpected WS error"))}).catch(K=>{this.isEstablishingConnection&&C(Se.internal("Websocket error during a (re)connection attempt: ".concat(K)))});const O=yield this.ws.opened.catch(K=>D(this,void 0,void 0,function*(){if(this.state!==at.CONNECTED){this.state=at.DISCONNECTED,clearTimeout(B);const ee=yield this.handleConnectionError(K,x);C(ee);return}this.handleWSError(K),C(K)}));if(clearTimeout(B),!O)return;const W=O.readable.getReader();this.streamWriter=O.writable.getWriter();const ie=yield W.read();if(W.releaseLock(),!ie.value)throw Se.internal("no message received as first message");const he=BI(ie.value),ae=this.validateFirstMessage(he,(A=a.reconnect)!==null&&A!==void 0?A:!1);if(!ae.isValid){C(ae.error);return}((T=he.message)===null||T===void 0?void 0:T.case)==="join"&&(this.pingTimeoutDuration=he.message.value.pingTimeout,this.pingIntervalDuration=he.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const le=ae.shouldProcessFirstMessage?he:void 0;I(O,le),k(ae.response)}catch(O){C(O)}finally{R()}}finally{f()}}))}()})}startReadingLoop(e,t){return D(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield wn(this.signalLatency));const{done:i,value:s}=yield e.read();if(i)break;const r=BI(s);this.handleSignalResponse(r)}})}close(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return function*(){if([at.DISCONNECTING||at.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const s=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=at.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:i});const r=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([r,wn(fZ)])}}catch(r){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:r}))}finally{t&&(e.state=at.DISCONNECTED),s()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:pu(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:pu(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Pv({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Iv({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return D(this,arguments,void 0,function(i,s){var r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const a=r.getNextRequestId();return yield r.sendRequest({case:"updateMetadata",value:new ZT({requestId:a,metadata:i,name:s,attributes:o})}),a}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new x4({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new k4({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:gt.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new A4({timestamp:gt.parse(Date.now()),rtt:gt.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new YT({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Dv({reason:Rs.CLIENT_INITIATED,action:wu.DISCONNECT})})}sendRequest(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!s&&!hZ(t)&&i.state===at.RECONNECTING){i.queuedRequests.push(()=>D(i,void 0,void 0,function*(){yield this.sendRequest(t,!0)}));return}if(s||(yield i.requestQueue.flush()),i.signalLatency&&(yield wn(i.signalLatency)),i.isDisconnected){i.log.debug("skipping signal request (type: ".concat(t.case,") - SignalClient disconnected"));return}if(!i.streamWriter){i.log.error("cannot send signal request before connected, type: ".concat(t==null?void 0:t.case),i.logContext);return}const o=new wX({message:t});try{i.useJSON?yield i.streamWriter.write(o.toJsonString()):yield i.streamWriter.write(o.toBinary())}catch(a){i.log.error("error sending signal message",Object.assign(Object.assign({},i.logContext),{error:a}))}}()})}handleSignalResponse(e){var t,i;const s=e.message;if(s==null){this.log.debug("received unsupported message",this.logContext);return}let r=!1;if(s.case==="answer"){const o=OI(s.value);this.onAnswer&&this.onAnswer(o,s.value.id,s.value.midToTrackId)}else if(s.case==="offer"){const o=OI(s.value);this.onOffer&&this.onOffer(o,s.value.id,s.value.midToTrackId)}else if(s.case==="trickle"){const o=JSON.parse(s.value.candidateInit);this.onTrickle&&this.onTrickle(o,s.value.target)}else s.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((t=s.value.participants)!==null&&t!==void 0?t:[]):s.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(s.value):s.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((i=s.value.speakers)!==null&&i!==void 0?i:[]):s.case==="leave"?this.onLeave&&this.onLeave(s.value):s.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(s.value.sid,s.value.muted):s.case==="roomUpdate"?this.onRoomUpdate&&s.value.room&&this.onRoomUpdate(s.value.room):s.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(s.value):s.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(s.value):s.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(s.value):s.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(s.value):s.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(s.value):s.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(s.value):s.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(s.value):s.case==="pong"||(s.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(s.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):s.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(s.value):s.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(s.value.trackSid):s.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(s.value.token),this.onRoomMoved&&this.onRoomMoved(s.value)):s.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(s.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:s.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return D(this,void 0,void 0,function*(){if(this.state===at.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=kn.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&kn.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=kn.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&kn.clearInterval(this.pingInterval)}handleSignalConnected(e,t,i){this.state=at.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),i)}validateFirstMessage(e,t){var i,s,r,o,a;return((i=e.message)===null||i===void 0?void 0:i.case)==="join"?{isValid:!0,response:e.message.value}:this.state===at.RECONNECTING&&((s=e.message)===null||s===void 0?void 0:s.case)!=="leave"?((r=e.message)===null||r===void 0?void 0:r.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((o=e.message)===null||o===void 0?void 0:o.case)==="leave"?{isValid:!1,error:Se.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:t?{isValid:!1,error:Se.internal("Unexpected first message")}:{isValid:!1,error:Se.internal("did not receive join response, got ".concat((a=e.message)===null||a===void 0?void 0:a.case," instead"))}}handleConnectionError(e,t){return D(this,void 0,void 0,function*(){try{const i=yield fetch(t);switch(i.status){case 404:return Se.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const s=yield i.text();return Se.notAllowed(s,i.status);default:break}return e instanceof Se?e:Se.internal("Encountered unknown websocket error during connection: ".concat(e),{status:i.status,statusText:i.statusText})}catch(i){return i instanceof Se?i:Se.serverUnreachable(i instanceof Error?i.message:"server was not reachable")}})}}function OI(n){const e={type:"offer",sdp:n.sdp};switch(n.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=n.type;break}return e}function pu(n,e){return new Ba({sdp:n.sdp,type:n.type,id:e})}function pZ(n,e,t){var i;const s=new URLSearchParams;return s.set("access_token",n),t.reconnect&&(s.set("reconnect","1"),t.sid&&s.set("sid",t.sid)),s.set("auto_subscribe",t.autoSubscribe?"1":"0"),s.set("sdk",or()?"reactnative":"js"),s.set("version",e.version),s.set("protocol",e.protocol.toString()),e.deviceModel&&s.set("device_model",e.deviceModel),e.os&&s.set("os",e.os),e.osVersion&&s.set("os_version",e.osVersion),e.browser&&s.set("browser",e.browser),e.browserVersion&&s.set("browser_version",e.browserVersion),t.adaptiveStream&&s.set("adaptive_stream","1"),t.reconnectReason&&s.set("reconnect_reason",t.reconnectReason.toString()),!((i=navigator.connection)===null||i===void 0)&&i.type&&s.set("network",navigator.connection.type),s}function mZ(n,e,t){const i=new URLSearchParams;i.set("access_token",n);const s=new JX({clientInfo:e,connectionSettings:new E4({autoSubscribe:!!t.autoSubscribe,adaptiveStream:!!t.adaptiveStream}),reconnect:!!t.reconnect,participantSid:t.sid?t.sid:void 0});t.reconnectReason&&(s.reconnectReason=t.reconnectReason);const r=new KX({joinRequest:s.toBinary()});return i.set("join_request",btoa(new TextDecoder("utf-8").decode(r.toBinary()))),i}class LI{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class gZ{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const i=Date.now();i-this._lastCleanup>this.ttl/2&&this.cleanup();const s=i+this.ttl;return this._map.set(e,{value:t,expiresAt:s}),this}get(e){const t=this._map.get(e);if(t){if(t.expiresAt<Date.now()){this._map.delete(e);return}return t.value}}has(e){const t=this._map.get(e);return t?t.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,i]of this._map.entries())i.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,i]of this._map.entries())i.expiresAt>=Date.now()&&e(i.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],i=this.asValueMap();for(const[s,r]of i.entries())t.push(e(r,s,i));return t}asValueMap(){const e=new Map;for(const[t,i]of this._map.entries())i.expiresAt>=Date.now()&&e.set(t,i.value);return e}}var ds={},Lx={},jx={exports:{}},jI;function c1(){if(jI)return jx.exports;jI=1;var n=jx.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(n).forEach(function(e){var t=n[e];t.forEach(function(i){i.reg||(i.reg=/(.*)/),i.format||(i.format="%s")})}),jx.exports}var UI;function yZ(){return UI||(UI=1,function(n){var e=function(a){return String(Number(a))===a?Number(a):a},t=function(a,c,d,h){if(h&&!d)c[h]=e(a[1]);else for(var f=0;f<d.length;f+=1)a[f+1]!=null&&(c[d[f]]=e(a[f+1]))},i=function(a,c,d){var h=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:h&&!c[a.name]&&(c[a.name]={});var f=a.push?{}:h?c[a.name]:c;t(d.match(a.reg),f,a.names,a.name),a.push&&c[a.push].push(f)},s=c1(),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(a){var c={},d=[],h=c;return a.split(/(\r\n|\r|\n)/).filter(r).forEach(function(f){var m=f[0],y=f.slice(2);m==="m"&&(d.push({rtp:[],fmtp:[]}),h=d[d.length-1]);for(var v=0;v<(s[m]||[]).length;v+=1){var x=s[m][v];if(x.reg.test(y))return i(x,h,y)}}),c.media=d,c};var o=function(a,c){var d=c.split(/=(.+)/,2);return d.length===2?a[d[0]]=e(d[1]):d.length===1&&c.length>1&&(a[d[0]]=void 0),a};n.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(a){return a.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(a){for(var c=[],d=a.split(" ").map(e),h=0;h<d.length;h+=3)c.push({component:d[h],ip:d[h+1],port:d[h+2]});return c},n.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},n.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(d){var h,f=!1;return d[0]!=="~"?h=e(d):(h=e(d.substring(1,d.length)),f=!0),{scid:h,paused:f}})})}}(Lx)),Lx}var Ux,zI;function vZ(){if(zI)return Ux;zI=1;var n=c1(),e=/%[sdv%]/g,t=function(o){var a=1,c=arguments,d=c.length;return o.replace(e,function(h){if(a>=d)return h;var f=c[a];switch(a+=1,h){case"%%":return"%";case"%s":return String(f);case"%d":return Number(f);case"%v":return""}})},i=function(o,a,c){var d=a.format instanceof Function?a.format(a.push?c:c[a.name]):a.format,h=[o+"="+d];if(a.names)for(var f=0;f<a.names.length;f+=1){var m=a.names[f];a.name?h.push(c[a.name][m]):h.push(c[a.names[f]])}else h.push(c[a.name]);return t.apply(null,h)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],r=["i","c","b","a"];return Ux=function(o,a){a=a||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(f){f.payloads==null&&(f.payloads="")});var c=a.outerOrder||s,d=a.innerOrder||r,h=[];return c.forEach(function(f){n[f].forEach(function(m){m.name in o&&o[m.name]!=null?h.push(i(f,m,o)):m.push in o&&o[m.push]!=null&&o[m.push].forEach(function(y){h.push(i(f,m,y))})})}),o.media.forEach(function(f){h.push(i("m",n.m[0],f)),d.forEach(function(m){n[m].forEach(function(y){y.name in f&&f[y.name]!=null?h.push(i(m,y,f)):y.push in f&&f[y.push]!=null&&f[y.push].forEach(function(v){h.push(i(m,y,v))})})})}),h.join(`\r
`)+`\r
`},Ux}var VI;function bZ(){if(VI)return ds;VI=1;var n=yZ(),e=vZ(),t=c1();return ds.grammar=t,ds.write=e,ds.parse=n.parse,ds.parseParams=n.parseParams,ds.parseFmtpConfig=n.parseFmtpConfig,ds.parsePayloads=n.parsePayloads,ds.parseRemoteCandidates=n.parseRemoteCandidates,ds.parseImageAttributes=n.parseImageAttributes,ds.parseSimulcastStreamList=n.parseSimulcastStreamList,ds}var Xo=bZ();function u1(n,e,t){var i,s,r;e===void 0&&(e=50),t===void 0&&(t={});var o=(i=t.isImmediate)!=null&&i,a=(s=t.callback)!=null&&s,c=t.maxWait,d=Date.now(),h=[];function f(){if(c!==void 0){var y=Date.now()-d;if(y+e>=c)return c-y}return e}var m=function(){var y=[].slice.call(arguments),v=this;return new Promise(function(x,k){var C=o&&r===void 0;if(r!==void 0&&clearTimeout(r),r=setTimeout(function(){if(r=void 0,d=Date.now(),!o){var T=n.apply(v,y);a&&a(T),h.forEach(function(E){return(0,E.resolve)(T)}),h=[]}},f()),C){var A=n.apply(v,y);return a&&a(A),x(A)}h.push({resolve:x,reject:k})})};return m.cancel=function(y){r!==void 0&&clearTimeout(r),h.forEach(function(v){return(0,v.reject)(y)}),h=[]},m}const xZ=.7,SZ=20,Ru={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class HI extends lr.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;super(),this.log=Me,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=u1(s=>D(this,void 0,void 0,function*(){this.emit(Ru.NegotiationStarted);try{yield this.createAndSendOffer()}catch(r){if(s)s(r);else throw r}}),SZ),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=uo((i=t.loggerName)!==null&&i!==void 0?i:js.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new $n}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=t=>{var i;t.candidate&&((i=this.onIceCandidate)===null||i===void 0||i.call(this,t.candidate))},e.onicecandidateerror=t=>{var i;(i=this.onIceCandidateError)===null||i===void 0||i.call(this,t)},e.oniceconnectionstatechange=()=>{var t;(t=this.onIceConnectionStateChange)===null||t===void 0||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;(t=this.onSignalingStatechange)===null||t===void 0||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,e.connectionState)},e.ondatachannel=t=>{var i;(i=this.onDataChannel)===null||i===void 0||i.call(this,t)},e.ontrack=t=>{var i;(i=this.onTrack)===null||i===void 0||i.call(this,t)},e}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return D(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return D(this,void 0,void 0,function*(){var i;if(e.type==="answer"&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let s;if(e.type==="offer"){let{stereoMids:r,nackMids:o}=CZ(e);this.remoteStereoMids=r,this.remoteNackMids=o}else if(e.type==="answer"){const r=Xo.parse((i=e.sdp)!==null&&i!==void 0?i:"");r.media.forEach(o=>{const a=d1(o.mid);o.type==="audio"&&this.trackBitrates.some(c=>{if(!c.transceiver||a!=c.transceiver.mid)return!1;let d=0;if(o.rtp.some(f=>f.codec.toUpperCase()===c.codec.toUpperCase()?(d=f.payload,!0):!1),d===0)return!0;let h=!1;for(const f of o.fmtp)if(f.payload===d){f.config=f.config.split(";").filter(m=>!m.includes("maxaveragebitrate")).join(";"),c.maxbr>0&&(f.config+=";maxaveragebitrate=".concat(c.maxbr*1e3)),h=!0;break}return h||c.maxbr>0&&o.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(c.maxbr*1e3)}),!0})}),s=Xo.write(r)}return yield this.setMungedSDP(e,s,!0),this.pendingCandidates.forEach(r=>{this.pc.addIceCandidate(r)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Ru.NegotiationComplete),e.sdp&&Xo.parse(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(Ru.RTPVideoPayloadTypes,o.rtp)})),!0})}createAndSendOffer(e){return D(this,void 0,void 0,function*(){var t;const i=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const a=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&a)yield this._pc.setRemoteDescription(a);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const s=this.latestOfferId+1;this.latestOfferId=s;const r=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:r.sdp},this.logContext));const o=Xo.parse((t=r.sdp)!==null&&t!==void 0?t:"");if(o.media.forEach(a=>{WI(a),a.type==="audio"?GI(a,["all"],[]):a.type==="video"&&this.trackBitrates.some(c=>{if(!a.msid||!c.cid||!a.msid.includes(c.cid))return!1;let d=0;if(a.rtp.some(f=>f.codec.toUpperCase()===c.codec.toUpperCase()?(d=f.payload,!0):!1),d===0||(As(c.codec)&&!Yl()&&this.ensureVideoDDExtensionForSVC(a,o),!As(c.codec)))return!0;const h=Math.round(c.maxbr*xZ);for(const f of a.fmtp)if(f.payload===d){f.config.includes("x-google-start-bitrate")||(f.config+=";x-google-start-bitrate=".concat(h));break}return!0})}),this.latestOfferId>s){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:s}));return}yield this.setMungedSDP(r,Xo.write(o)),this.onOffer(r,this.latestOfferId)}finally{i()}})}createAndSetAnswer(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),i=Xo.parse((e=t.sdp)!==null&&e!==void 0?e:"");return i.media.forEach(s=>{WI(s),s.type==="audio"&&GI(s,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Xo.write(i)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Ot("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Ot("PC closed, cannot configure");return(t=this._pc)===null||t===void 0?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var t;return(t=this._pc)===null||t===void 0?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&t!==void 0?t:"closed"}getICEConnectionState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&t!==void 0?t:"closed"}getSignallingState(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&t!==void 0?t:"closed"}getTransceivers(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&t!==void 0?t:[]}getSenders(){var e,t;return(t=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&t!==void 0?t:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return D(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const i=new Map,s=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":t=a.selectedCandidatePairId;break;case"candidate-pair":t===""&&a.selected&&(t=a.id),i.set(a.id,a);break;case"remote-candidate":s.set(a.id,"".concat(a.address,":").concat(a.port));break}}),t==="")return;const o=(e=i.get(t))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return s.get(o)})}setMungedSDP(e,t,i){return D(this,void 0,void 0,function*(){if(t){const s=e.sdp;e.sdp=t;try{this.log.debug("setting munged ".concat(i?"remote":"local"," description"),this.logContext),i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(r){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:r,sdp:t})),e.sdp=s}}try{i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(s){let r="unknown error";s instanceof Error?r=s.message:typeof s=="string"&&(r=s);const o={error:r,sdp:e.sdp};throw!i&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new Au(r)}})}ensureVideoDDExtensionForSVC(e,t){var i,s;if(!((i=e.ext)===null||i===void 0?void 0:i.some(o=>o.uri===AI))){if(this.ddExtID===0){let o=0;t.media.forEach(a=>{var c;a.type==="video"&&((c=a.ext)===null||c===void 0||c.forEach(d=>{d.value>o&&(o=d.value)}))}),this.ddExtID=o+1}(s=e.ext)===null||s===void 0||s.push({value:this.ddExtID,uri:AI})}}}function GI(n,e,t){const i=d1(n.mid);let s=0;n.rtp.some(r=>r.codec==="opus"?(s=r.payload,!0):!1),s>0&&(n.rtcpFb||(n.rtcpFb=[]),t.includes(i)&&!n.rtcpFb.some(r=>r.payload===s&&r.type==="nack")&&n.rtcpFb.push({payload:s,type:"nack"}),(e.includes(i)||e.length===1&&e[0]==="all")&&n.fmtp.some(r=>r.payload===s?(r.config.includes("stereo=1")||(r.config+=";stereo=1"),!0):!1))}function CZ(n){var e;const t=[],i=[],s=Xo.parse((e=n.sdp)!==null&&e!==void 0?e:"");let r=0;return s.media.forEach(o=>{var a;const c=d1(o.mid);o.type==="audio"&&(o.rtp.some(d=>d.codec==="opus"?(r=d.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(d=>d.payload===r&&d.type==="nack")&&i.push(c),o.fmtp.some(d=>d.payload===r?(d.config.includes("sprop-stereo=1")&&t.push(c),!0):!1))}),{stereoMids:t,nackMids:i}}function WI(n){if(n.connection){const e=n.connection.ip.indexOf(":")>=0;(n.connection.version===4&&e||n.connection.version===6&&!e)&&(n.connection.ip="0.0.0.0",n.connection.version=4)}}function d1(n){return typeof n=="number"?n.toFixed(0):n}const Rk="vp8",kZ={audioPreset:Sk.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:r1.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Rk,backupCodec:!0,preConnectBuffer:!1},pj={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},mj={deviceId:{ideal:"default"},resolution:Nf.h720.resolution},wZ={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new tY,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},h1={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Rt;(function(n){n[n.NEW=0]="NEW",n[n.CONNECTING=1]="CONNECTING",n[n.CONNECTED=2]="CONNECTED",n[n.FAILED=3]="FAILED",n[n.CLOSING=4]="CLOSING",n[n.CLOSED=5]="CLOSED"})(Rt||(Rt={}));class TZ{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,t,i){var s;this.peerConnectionTimeout=h1.peerConnectionTimeout,this.log=Me,this.updateState=()=>{var r,o;const a=this.state,c=this.requiredTransports.map(d=>d.getConnectionState());c.every(d=>d==="connected")?this.state=Rt.CONNECTED:c.some(d=>d==="failed")?this.state=Rt.FAILED:c.some(d=>d==="connecting")?this.state=Rt.CONNECTING:c.every(d=>d==="closed")?this.state=Rt.CLOSED:c.some(d=>d==="closed")?this.state=Rt.CLOSING:c.every(d=>d==="new")&&(this.state=Rt.NEW),a!==this.state&&(this.log.debug("pc state change: from ".concat(Rt[a]," to ").concat(Rt[this.state]),this.logContext),(r=this.onStateChange)===null||r===void 0||r.call(this,this.state,this.publisher.getConnectionState(),(o=this.subscriber)===null||o===void 0?void 0:o.getConnectionState()))},this.log=uo((s=i.loggerName)!==null&&s!==void 0?s:js.PCManager),this.loggerOptions=i,this.isPublisherConnectionRequired=t!=="subscriber-primary",this.isSubscriberConnectionRequired=t==="subscriber-primary",this.publisher=new HI(e,i),this._mode=t,t!=="publisher-only"&&(this.subscriber=new HI(e,i),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=r=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,r,Ts.SUBSCRIBER)},this.subscriber.onDataChannel=r=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,r)},this.subscriber.onTrack=r=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,r)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=r=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,r,Ts.PUBLISHER)},this.publisher.onTrack=r=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,r)},this.publisher.onOffer=(r,o)=>{var a;(a=this.onPublisherOffer)===null||a===void 0||a.call(this,r,o)},this.state=Rt.NEW,this.connectionLock=new $n,this.remoteOfferLock=new $n}get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions).loggerContextCb)===null||t===void 0?void 0:t.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return D(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const t=this.publisher;for(const i of t.getSenders())try{t.canRemoveTrack()&&t.removeTrack(i)}catch(s){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:s}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return D(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return D(this,void 0,void 0,function*(){var i;t===Ts.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(i=this.subscriber)===null||i===void 0?void 0:i.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return D(this,void 0,void 0,function*(){var i,s,r;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(i=this.subscriber)===null||i===void 0?void 0:i.getSignallingState().toString()}));const o=yield this.remoteOfferLock.lock();try{return(yield(s=this.subscriber)===null||s===void 0?void 0:s.setRemoteDescription(e,t))?yield(r=this.subscriber)===null||r===void 0?void 0:r.createAndSetAnswer():void 0}finally{o()}})}updateConfiguration(e,t){var i;this.publisher.setConfiguration(e),(i=this.subscriber)===null||i===void 0||i.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return D(this,void 0,void 0,function*(){var i;const s=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((i=this.requiredTransports)===null||i===void 0?void 0:i.map(r=>this.ensureTransportConnected(r,e,t)))}finally{s()}})}negotiate(e){return D(this,void 0,void 0,function*(){return new ci((t,i)=>D(this,void 0,void 0,function*(){const s=setTimeout(()=>{i(new Au("negotiation timed out"))},this.peerConnectionTimeout),r=()=>{clearTimeout(s),i(new Au("negotiation aborted"))};e.signal.addEventListener("abort",r),this.publisher.once(Ru.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Ru.NegotiationComplete,()=>{clearTimeout(s),t()})}),yield this.publisher.negotiate(o=>{clearTimeout(s),o instanceof Error?i(o):i(new Error(String(o)))})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const i=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(s=>s.receiver===e);return i==null?void 0:i.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Ts.PUBLISHER?this.publisher.getConnectedAddress():e===Ts.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return D(this,arguments,void 0,function(i,s){var r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(i.getConnectionState()!=="connected")return new Promise((c,d)=>D(r,void 0,void 0,function*(){const h=()=>{this.log.warn("abort transport connection",this.logContext),kn.clearTimeout(f),d(Se.cancelled("room connection has been cancelled"))};s!=null&&s.signal.aborted&&h(),s==null||s.signal.addEventListener("abort",h);const f=kn.setTimeout(()=>{s==null||s.signal.removeEventListener("abort",h),d(Se.internal("could not establish pc connection"))},o);for(;this.state!==Rt.CONNECTED;)if(yield wn(50),s!=null&&s.signal.aborted){d(Se.cancelled("room connection has been cancelled"));return}kn.clearTimeout(f),s==null||s.signal.removeEventListener("abort",h),c()}))}()})}}const gj=5e3,AZ=3e4;class Ge{static fetchRegionSettings(e,t,i){return D(this,void 0,void 0,function*(){const s=yield Ge.fetchLock.lock();try{const r=yield fetch("".concat(EZ(e),"/regions"),{headers:{authorization:"Bearer ".concat(t)},signal:i});if(r.ok){const o=QY(r.headers),a=o?o*1e3:gj;return{regionSettings:yield r.json(),updatedAtInMs:Date.now(),maxAgeInMs:a}}else throw r.status===401?Se.notAllowed("Could not fetch region settings: ".concat(r.statusText),r.status):Se.internal("Could not fetch region settings: ".concat(r.statusText))}catch(r){throw r instanceof Se?r:i!=null&&i.aborted?Se.cancelled("Region fetching was aborted"):Se.serverUnreachable("Could not fetch region settings, ".concat(r instanceof Error?"".concat(r.name,": ").concat(r.message):r))}finally{s()}})}static scheduleRefetch(e,t,i){return D(this,void 0,void 0,function*(){const s=Ge.settingsTimeouts.get(e.hostname);clearTimeout(s),Ge.settingsTimeouts.set(e.hostname,setTimeout(()=>D(this,void 0,void 0,function*(){try{const r=yield Ge.fetchRegionSettings(e,t);Ge.updateCachedRegionSettings(e,t,r)}catch(r){if(r instanceof Se&&r.reason===lt.NotAllowed){Me.debug("token is not valid, cancelling auto region refresh");return}Me.debug("auto refetching of region settings failed",{error:r}),Ge.scheduleRefetch(e,t,i)}}),i))})}static updateCachedRegionSettings(e,t,i){Ge.cache.set(e.hostname,i),Ge.scheduleRefetch(e,t,i.maxAgeInMs)}static stopRefetch(e){const t=Ge.settingsTimeouts.get(e);t&&(clearTimeout(t),Ge.settingsTimeouts.delete(e))}static scheduleCleanup(e){let t=Ge.connectionTrackers.get(e);t&&(t.cleanupTimeout&&clearTimeout(t.cleanupTimeout),t.cleanupTimeout=setTimeout(()=>{const i=Ge.connectionTrackers.get(e);i&&i.connectionCount===0&&(Me.debug("stopping region refetch after disconnect delay",{hostname:e}),Ge.stopRefetch(e)),i&&(i.cleanupTimeout=void 0)},AZ))}static cancelCleanup(e){const t=Ge.connectionTrackers.get(e);t!=null&&t.cleanupTimeout&&(clearTimeout(t.cleanupTimeout),t.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let t=Ge.connectionTrackers.get(e);t||(t={connectionCount:0},Ge.connectionTrackers.set(e,t)),t.connectionCount++,Ge.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,t=Ge.connectionTrackers.get(e);t&&(t.connectionCount=Math.max(0,t.connectionCount-1),t.connectionCount===0&&Ge.scheduleCleanup(e))}constructor(e,t){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return sd(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return D(this,void 0,void 0,function*(){return Ge.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return D(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let t=Ge.cache.get(this.serverUrl.hostname);(!t||Date.now()-t.updatedAtInMs>t.maxAgeInMs)&&(t=yield this.fetchRegionSettings(e),Ge.updateCachedRegionSettings(this.serverUrl,this.token,t));const i=t.regionSettings.regions.filter(s=>!this.attemptedRegions.find(r=>r.url===s.url));if(i.length>0){const s=i[0];return this.attemptedRegions.push(s),Me.debug("next region: ".concat(s.region)),s.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){Ge.updateCachedRegionSettings(this.serverUrl,this.token,e)}}Ge.cache=new Map;Ge.settingsTimeouts=new Map;Ge.connectionTrackers=new Map;Ge.fetchLock=new $n;function EZ(n){return"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")}class Bt extends Error{constructor(e,t,i){super(t),this.code=e,this.message=JI(t,Bt.MAX_MESSAGE_BYTES),this.data=i?JI(i,Bt.MAX_DATA_BYTES):void 0}static fromProto(e){return new Bt(e.code,e.message,e.data)}toProto(){return new l4({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Bt(Bt.ErrorCode[e],Bt.ErrorMessage[e],t)}}Bt.MAX_MESSAGE_BYTES=256;Bt.MAX_DATA_BYTES=15360;Bt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Bt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const yj=15360;function f1(n){return new TextEncoder().encode(n).length}function JI(n,e){if(f1(n)<=e)return n;let t=0,i=n.length;const s=new TextEncoder;for(;t<i;){const r=Math.floor((t+i+1)/2);s.encode(n.slice(0,r)).length<=e?t=r:i=r-1}return n.slice(0,t)}const p1=2e3;function Fv(n,e){if(!e)return 0;let t,i;return"bytesReceived"in n?(t=n.bytesReceived,i=e.bytesReceived):"bytesSent"in n&&(t=n.bytesSent,i=e.bytesSent),t===void 0||i===void 0||n.timestamp===void 0||e.timestamp===void 0?0:(t-i)*8*1e3/(n.timestamp-e.timestamp)}const m1=typeof MediaRecorder<"u";class _Z{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const MZ=m1?MediaRecorder:_Z;class RZ extends MZ{constructor(e,t){if(!m1)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),t);let i,s;const r=()=>s===void 0,o=()=>{this.removeEventListener("dataavailable",i),this.removeEventListener("stop",o),this.removeEventListener("error",a),s==null||s.close(),s=void 0},a=c=>{s==null||s.error(c),this.removeEventListener("dataavailable",i),this.removeEventListener("stop",o),this.removeEventListener("error",a),s=void 0};this.byteStream=new ReadableStream({start:c=>{s=c,i=d=>D(this,void 0,void 0,function*(){let h;if(d.data.arrayBuffer){const f=yield d.data.arrayBuffer();h=new Uint8Array(f)}else if(d.data.byteArray)h=d.data.byteArray;else throw new Error("no data available!");r()||c.enqueue(h)}),this.addEventListener("dataavailable",i)},cancel:()=>{o()}}),this.addEventListener("stop",o),this.addEventListener("error",a)}}function PZ(){return m1}const IZ=1e3,BZ=1e4;class vj extends Q{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=arguments.length>4?arguments[4]:void 0;super(e,t,r),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=u1(()=>D(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>D(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(oe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=s,this.muteLock=new $n,this.pauseUpstreamLock=new $n,this.trackChangeLock=new $n,this.trackChangeLock.lock().then(o=>D(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{o()}})),this._constraints=e.getConstraints(),i&&(this._constraints=i)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();if(e&&t)return{width:e,height:t}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return(t=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&t!==void 0?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return D(this,void 0,void 0,function*(){var i;if(e===this._mediaStreamTrack&&!t)return;this._mediaStreamTrack&&(this.attachedElements.forEach(r=>{Eu(this._mediaStreamTrack,r)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let s;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(fu(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),s=this.processor.processedTrack}this.sender&&((i=this.sender.transport)===null||i===void 0?void 0:i.state)!=="closed"&&(yield this.sender.replaceTrack(s??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(r=>{fu(s??e,r)}))})}waitForDimensions(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IZ;return function*(){var i;if(e.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((i=yi())===null||i===void 0?void 0:i.os)==="iOS"&&(yield wn(10));const s=Date.now();for(;Date.now()-s<t;){const r=e.dimensions;if(r)return r;yield wn(50)}throw new Kr("unable to get track dimensions after timeout")}()})}setDeviceId(e){return D(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Aa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Aa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===Q.Source.ScreenShare)return;const{deviceId:i,groupId:s}=e._mediaStreamTrack.getSettings(),r=e.kind===Q.Kind.Audio?"audioinput":"videoinput";return t?gn.getInstance().normalizeDeviceId(r,i,s):i}()})}mute(){return D(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return D(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return D(this,void 0,void 0,function*(){const i=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Kr("unable to replace an unpublished track");let s,r;return typeof t=="boolean"?s=t:t!==void 0&&(s=t.userProvidedTrack,r=t.stopProcessor),this.providedByUser=s??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),r&&this.processor&&(yield this.internalStopProcessor()),this}finally{i()}})}restart(e){return D(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:i,facingMode:s}=e,r=nY(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const o={audio:!1,video:!1};this.kind===Q.Kind.Video?o.video=i||s?{deviceId:i,facingMode:s}:!0:o.audio=i?Object.assign({deviceId:i},r):!0,this.attachedElements.forEach(d=>{Eu(this.mediaStreamTrack,d)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const c=(yield navigator.mediaDevices.getUserMedia(o)).getTracks()[0];return this.kind===Q.Kind.Video&&(yield c.applyConstraints(r)),c.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(c),this._constraints=e,this.emit(oe.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?oe.Muted:oe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),uj()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(oe.UpstreamPaused,this);const i=yi();if((i==null?void 0:i.name)==="Safari"&&ar(i.version,"12.0")<0)throw new s1("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return D(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(oe.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return D(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var r;const o=yield i.trackChangeLock.lock();try{i.log.debug("setting up processor",i.logContext);const a=document.createElement(i.kind),c={kind:i.kind,track:i._mediaStreamTrack,element:a,audioContext:i.audioContext};if(yield t.init(c),i.log.debug("processor initialized",i.logContext),i.processor&&(yield i.internalStopProcessor()),i.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(fu(i._mediaStreamTrack,a),a.muted=!0,a.play().catch(d=>{d instanceof DOMException&&d.name==="AbortError"?(i.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},i.logContext),{error:d})),setTimeout(()=>{a.play().catch(h=>{i.log.error("failed to play processor element",Object.assign(Object.assign({},i.logContext),{err:h}))})},100)):i.log.error("failed to play processor element",Object.assign(Object.assign({},i.logContext),{error:d}))}),i.processor=t,i.processorElement=a,i.processor.processedTrack){for(const d of i.attachedElements)d!==i.processorElement&&s&&(Eu(i._mediaStreamTrack,d),fu(i.processor.processedTrack,d));yield(r=i.sender)===null||r===void 0?void 0:r.replaceTrack(i.processor.processedTrack)}i.emit(oe.TrackProcessorUpdate,i.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const i=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{i()}}()})}internalStopProcessor(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var i,s;e.processor&&(e.log.debug("stopping processor",e.logContext),(i=e.processor.processedTrack)===null||i===void 0||i.stop(),yield e.processor.destroy(),e.processor=void 0,t||((s=e.processorElement)===null||s===void 0||s.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(oe.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!PZ()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let t="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(t)||(t="video/mp4"),this.localTrackRecorder=new RZ(this,{mimeType:t})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},BZ)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class Hy extends vj{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,t,i,r),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>D(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}o&&this.prevStats&&(this._currentBitrate=Fv(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(oe.AudioTrackFeatureUpdate,this,mn.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(oe.AudioTrackFeatureUpdate,this,mn.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=s,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const i=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Aa(this._constraints.deviceId);return this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||i)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return D(this,void 0,void 0,function*(){let t;if(e){const i=o1({audio:e});typeof i.audio!="boolean"&&(t=i.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return D(this,void 0,void 0,function*(){const i=yield t.restart.call(this,e);return this.checkForSilence(),i})}startMonitor(){ui()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},p1)))}setProcessor(e){return D(this,void 0,void 0,function*(){var t;const i=yield this.trackChangeLock.lock();try{if(!or()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const s={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(s),this.processor=e,this.processor.processedTrack&&(yield(t=this.sender)===null||t===void 0?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(oe.TrackProcessorUpdate,this.processor)}finally{i()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return D(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const t=yield this.sender.getStats();let i;return t.forEach(s=>{s.type==="outbound-rtp"&&(i={type:"audio",streamId:s.id,packetsSent:s.packetsSent,packetsLost:s.packetsLost,bytesSent:s.bytesSent,timestamp:s.timestamp,roundTripTime:s.roundTripTime,jitter:s.jitter})}),i})}checkForSilence(){return D(this,void 0,void 0,function*(){const e=yield aj(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(oe.AudioSilenceDetected)),e})}}function DZ(n,e,t){switch(n.kind){case"audio":return new Hy(n,e,!1,void 0,t);case"video":return new Gy(n,e,!1,t);default:throw new Kr("unsupported track type: ".concat(n.kind))}}const NZ=Object.values(Nf),FZ=Object.values(Ck),OZ=Object.values(r1),LZ=[Nf.h180,Nf.h360],jZ=[Ck.h180,Ck.h360],UZ=n=>[{scaleResolutionDownBy:2,fps:n.encoding.maxFramerate}].map(t=>{var i,s;return new st(Math.floor(n.width/t.scaleResolutionDownBy),Math.floor(n.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*(((i=n.encoding.maxFramerate)!==null&&i!==void 0?i:30)/((s=t.fps)!==null&&s!==void 0?s:30))))),t.fps,n.encoding.priority)}),Pk=["q","h","f"];function Ik(n,e,t,i){var s,r;let o=i==null?void 0:i.videoEncoding;n&&(o=i==null?void 0:i.screenShareEncoding);const a=i==null?void 0:i.simulcast,c=i==null?void 0:i.scalabilityMode,d=i==null?void 0:i.videoCodec;if(!o&&!a&&!c||!e||!t)return[{}];o||(o=VZ(n,e,t,d),Me.debug("using video encoding",o));const h=o.maxFramerate,f=new st(e,t,o.maxBitrate,o.maxFramerate,o.priority);if(c&&As(d)){const v=new bj(c),x=[];if(v.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const k=yi();if(Ff()||or()||(k==null?void 0:k.name)==="Chrome"&&ar(k==null?void 0:k.version,"113")<0){const C=v.suffix=="h"?2:3,A=OY(k);for(let T=0;T<v.spatial;T+=1)x.push({rid:Pk[2-T],maxBitrate:o.maxBitrate/Math.pow(C,T),maxFramerate:f.encoding.maxFramerate,scaleResolutionDownBy:A?Math.pow(2,T):void 0});x[0].scalabilityMode=c}else x.push({maxBitrate:o.maxBitrate,maxFramerate:f.encoding.maxFramerate,scalabilityMode:c});return f.encoding.priority&&(x[0].priority=f.encoding.priority,x[0].networkPriority=f.encoding.priority),Me.debug("using svc encoding",{encodings:x}),x}if(!a)return[o];let m=[];n?m=(s=qI(i==null?void 0:i.screenShareSimulcastLayers))!==null&&s!==void 0?s:KI(n,f):m=(r=qI(i==null?void 0:i.videoSimulcastLayers))!==null&&r!==void 0?r:KI(n,f);let y;if(m.length>0){const v=m[0];m.length>1&&([,y]=m);const x=Math.max(e,t);if(x>=960&&y)return zx(e,t,[v,y,f],h);if(x>=480)return zx(e,t,[v,f],h)}return zx(e,t,[f])}function zZ(n,e,t){var i,s,r,o;if(!t.backupCodec||t.backupCodec===!0||t.backupCodec.codec===t.videoCodec)return;e!==t.backupCodec.codec&&Me.warn("requested a different codec than specified as backup",{serverRequested:e,backup:t.backupCodec.codec}),t.videoCodec=e,t.videoEncoding=t.backupCodec.encoding;const a=n.mediaStreamTrack.getSettings(),c=(i=a.width)!==null&&i!==void 0?i:(s=n.dimensions)===null||s===void 0?void 0:s.width,d=(r=a.height)!==null&&r!==void 0?r:(o=n.dimensions)===null||o===void 0?void 0:o.height;return n.source===Q.Source.ScreenShare&&t.simulcast&&(t.simulcast=!1),Ik(n.source===Q.Source.ScreenShare,c,d,t)}function VZ(n,e,t,i){const s=HZ(n,e,t);let{encoding:r}=s[0];const o=Math.max(e,t);for(let a=0;a<s.length;a+=1){const c=s[a];if(r=c.encoding,c.width>=o)break}if(i)switch(i){case"av1":case"h265":r=Object.assign({},r),r.maxBitrate=r.maxBitrate*.7;break;case"vp9":r=Object.assign({},r),r.maxBitrate=r.maxBitrate*.85;break}return r}function HZ(n,e,t){if(n)return OZ;const i=e>t?e/t:t/e;return Math.abs(i-16/9)<Math.abs(i-4/3)?NZ:FZ}function KI(n,e){if(n)return UZ(e);const{width:t,height:i}=e,s=t>i?t/i:i/t;return Math.abs(s-16/9)<Math.abs(s-4/3)?LZ:jZ}function zx(n,e,t,i){const s=[];if(t.forEach((r,o)=>{if(o>=Pk.length)return;const a=Math.min(n,e),d={rid:Pk[o],scaleResolutionDownBy:Math.max(1,a/Math.min(r.width,r.height)),maxBitrate:r.encoding.maxBitrate},h=i&&r.encoding.maxFramerate?Math.min(i,r.encoding.maxFramerate):r.encoding.maxFramerate;h&&(d.maxFramerate=h);const f=Xl()||o===0;r.encoding.priority&&f&&(d.priority=r.encoding.priority,d.networkPriority=r.encoding.priority),s.push(d)}),or()&&hj()==="ios"){let r;s.forEach(a=>{r?a.maxFramerate&&a.maxFramerate>r&&(r=a.maxFramerate):r=a.maxFramerate});let o=!0;s.forEach(a=>{var c;a.maxFramerate!=r&&(o&&(o=!1,Me.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Me.info('Setting framerate of encoding "'.concat((c=a.rid)!==null&&c!==void 0?c:"",'" to ').concat(r)),a.maxFramerate=r)})}return s}function qI(n){if(n)return n.sort((e,t)=>{const{encoding:i}=e,{encoding:s}=t;return i.maxBitrate>s.maxBitrate?1:i.maxBitrate<s.maxBitrate?-1:i.maxBitrate===s.maxBitrate&&i.maxFramerate&&s.maxFramerate?i.maxFramerate>s.maxFramerate?1:-1:0})}class bj{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function GZ(n){return n.source===Q.Source.ScreenShare||n.constraints.height&&Aa(n.constraints.height)>=1080?"maintain-resolution":"balanced"}const WZ=5e3;class Gy extends vj{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,t,i,s),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>D(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let r;try{r=yield this.getSenderStats()}catch(c){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:c}));return}const o=new Map(r.map(c=>[c.rid,c])),a=r.some(c=>c.qualityLimitationReason==="cpu");if(a!==this.isCpuConstrained&&(this.isCpuConstrained=a,this.isCpuConstrained&&this.emit(oe.CpuConstrained)),this.prevStats){let c=0;o.forEach((d,h)=>{var f;const m=(f=this.prevStats)===null||f===void 0?void 0:f.get(h);c+=Fv(d,m)}),this._currentBitrate=c}this.prevStats=o}),this.senderLock=new $n}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!ui())return;const i=(t=this.sender)===null||t===void 0?void 0:t.getParameters();i&&(this.encodings=i.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},p1))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return D(this,void 0,void 0,function*(){var t,i,s,r,o;yield e.pauseUpstream.call(this);try{for(var a=!0,c=Jr(this.simulcastCodecs.values()),d;d=yield c.next(),t=d.done,!t;a=!0)r=d.value,a=!1,yield(o=r.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(h){i={error:h}}finally{try{!a&&!t&&(s=c.return)&&(yield s.call(c))}finally{if(i)throw i.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return D(this,void 0,void 0,function*(){var t,i,s,r,o;yield e.resumeUpstream.call(this);try{for(var a=!0,c=Jr(this.simulcastCodecs.values()),d;d=yield c.next(),t=d.done,!t;a=!0){r=d.value,a=!1;const h=r;yield(o=h.sender)===null||o===void 0?void 0:o.replaceTrack(h.mediaStreamTrack)}}catch(h){i={error:h}}finally{try{!a&&!t&&(s=c.return)&&(yield s.call(c))}finally{if(i)throw i.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return D(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return D(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const t=[],i=yield this.sender.getStats();return i.forEach(s=>{var r;if(s.type==="outbound-rtp"){const o={type:"video",streamId:s.id,frameHeight:s.frameHeight,frameWidth:s.frameWidth,framesPerSecond:s.framesPerSecond,framesSent:s.framesSent,firCount:s.firCount,pliCount:s.pliCount,nackCount:s.nackCount,packetsSent:s.packetsSent,bytesSent:s.bytesSent,qualityLimitationReason:s.qualityLimitationReason,qualityLimitationDurations:s.qualityLimitationDurations,qualityLimitationResolutionChanges:s.qualityLimitationResolutionChanges,rid:(r=s.rid)!==null&&r!==void 0?r:s.id,retransmittedPacketsSent:s.retransmittedPacketsSent,targetBitrate:s.targetBitrate,timestamp:s.timestamp},a=i.get(s.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),t.push(o)}}),t.sort((s,r)=>{var o,a;return((o=r.frameWidth)!==null&&o!==void 0?o:0)-((a=s.frameWidth)!==null&&a!==void 0?a:0)}),t})}setPublishingQuality(e){const t=[];for(let i=Pi.LOW;i<=Pi.HIGH;i+=1)t.push(new e1({quality:i,enabled:i<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(As(this.codec),t)}restartTrack(e){return D(this,void 0,void 0,function*(){var t,i,s,r,o;let a;if(e){const f=o1({video:e});typeof f.video!="boolean"&&(a=f.video)}yield this.restart(a),this.isCpuConstrained=!1;try{for(var c=!0,d=Jr(this.simulcastCodecs.values()),h;h=yield d.next(),t=h.done,!t;c=!0){r=h.value,c=!1;const f=r;f.sender&&((o=f.sender.transport)===null||o===void 0?void 0:o.state)!=="closed"&&(f.mediaStreamTrack=this.mediaStreamTrack.clone(),yield f.sender.replaceTrack(f.mediaStreamTrack))}}catch(f){i={error:f}}finally{try{!c&&!t&&(s=d.return)&&(yield s.call(d))}finally{if(i)throw i.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return D(this,arguments,void 0,function(i){var s=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,a,c,d,h,f;if(yield t.setProcessor.call(s,i,r),!((h=s.processor)===null||h===void 0)&&h.processedTrack)try{for(var m=!0,y=Jr(s.simulcastCodecs.values()),v;v=yield y.next(),o=v.done,!o;m=!0)d=v.value,m=!1,yield(f=d.sender)===null||f===void 0?void 0:f.replaceTrack(s.processor.processedTrack)}catch(x){a={error:x}}finally{try{!m&&!o&&(c=y.return)&&(yield c.call(y))}finally{if(a)throw a.error}}}()})}setDegradationPreference(e){return D(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(t){this.log.warn("failed to set degradationPreference",Object.assign({error:t},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const i={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,i),i}setSimulcastTrackSender(e,t){const i=this.simulcastCodecs.get(e);i&&(i.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},WZ))}setPublishingCodecs(e){return D(this,void 0,void 0,function*(){var t,i,s,r,o,a,c;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(As(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const d=[];try{for(t=!0,i=Jr(e);s=yield i.next(),r=s.done,!r;t=!0){c=s.value,t=!1;const h=c;if(!this.codec||this.codec===h.codec)yield this.setPublishingLayers(As(h.codec),h.qualities);else{const f=this.simulcastCodecs.get(h.codec);if(this.log.debug("try setPublishingCodec for ".concat(h.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:f})),!f||!f.sender){for(const m of h.qualities)if(m.enabled){d.push(h.codec);break}}else f.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(h.codec),this.logContext),yield QI(f.sender,f.encodings,h.qualities,this.senderLock,As(h.codec),this.log,this.logContext))}}}catch(h){o={error:h}}finally{try{!t&&!r&&(a=i.return)&&(yield a.call(i))}finally{if(o)throw o.error}}return d})}setPublishingLayers(e,t){return D(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),!(!this.sender||!this.encodings)&&(yield QI(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return D(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const t=this.sender.getParameters();t.encodings=t.encodings.map((i,s)=>{var r;return Object.assign(Object.assign({},i),{active:s===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((r=this.mediaStreamTrack.getSettings().height)!==null&&r!==void 0?r:360)/360)),scalabilityMode:s===0&&As(this.codec)?"L1T3":void 0,maxFramerate:s===0?15:0,maxBitrate:s===0?i.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:t.encodings})),this.encodings=t.encodings,yield this.sender.setParameters(t)}catch(t){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:t})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),uj()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function QI(n,e,t,i,s,r,o){return D(this,void 0,void 0,function*(){const a=yield i.lock();r.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:n,qualities:t,senderEncodings:e}));try{const c=n.getParameters(),{encodings:d}=c;if(!d)return;if(d.length!==e.length){r.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},o),{encodings:d,senderEncodings:e}));return}let h=!1;!1&&d[0].scalabilityMode||(s&&t.some(y=>y.enabled)&&t.forEach(y=>y.enabled=!0),d.forEach((m,y)=>{var v;let x=(v=m.rid)!==null&&v!==void 0?v:"";x===""&&(x="q");const k=xj(x),C=t.find(A=>A.quality===k);C&&m.active!==C.enabled&&(h=!0,m.active=C.enabled,r.debug("setting layer ".concat(C.quality," to ").concat(m.active?"enabled":"disabled"),o),Xl()&&(C.enabled?(m.scaleResolutionDownBy=e[y].scaleResolutionDownBy,m.maxBitrate=e[y].maxBitrate,m.maxFrameRate=e[y].maxFrameRate):(m.scaleResolutionDownBy=4,m.maxBitrate=10,m.maxFrameRate=2)))})),h&&(c.encodings=d,r.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:c.encodings})),yield n.setParameters(c))}finally{a()}})}function xj(n){switch(n){case"f":return Pi.HIGH;case"h":return Pi.MEDIUM;case"q":return Pi.LOW;default:return Pi.HIGH}}function $I(n,e,t,i){if(!t)return[new Ta({quality:Pi.HIGH,width:n,height:e,bitrate:0,ssrc:0})];if(i){const s=t[0].scalabilityMode,r=new bj(s),o=[],a=r.suffix=="h"?1.5:2,c=r.suffix=="h"?2:3;for(let d=0;d<r.spatial;d+=1)o.push(new Ta({quality:Math.min(Pi.HIGH,r.spatial-1)-d,width:Math.ceil(n/Math.pow(a,d)),height:Math.ceil(e/Math.pow(a,d)),bitrate:t[0].maxBitrate?Math.ceil(t[0].maxBitrate/Math.pow(c,d)):0,ssrc:0}));return o}return t.map(s=>{var r,o,a;const c=(r=s.scaleResolutionDownBy)!==null&&r!==void 0?r:1;let d=xj((o=s.rid)!==null&&o!==void 0?o:"");return new Ta({quality:d,width:Math.ceil(n/c),height:Math.ceil(e/c),bitrate:(a=s.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}const XI="_lossy",YI="_reliable",JZ=2*1e3,Vx="leave-reconnect",KZ=3e4,qZ=8*1024,QZ=256*1024;var Hi;(function(n){n[n.New=0]="New",n[n.Connected=1]="Connected",n[n.Disconnected=2]="Disconnected",n[n.Reconnecting=3]="Reconnecting",n[n.Closed=4]="Closed"})(Hi||(Hi={}));class $Z extends lr.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=h1.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Hi.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Me,this.reliableDataSequence=1,this.reliableMessageBuffer=new LI,this.reliableReceivedState=new gZ(KZ),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=i=>D(this,[i],void 0,function(s){var r=this;let{channel:o}=s;return function*(){if(o){if(o.label===YI)r.reliableDCSub=o;else if(o.label===XI)r.lossyDCSub=o;else return;r.log.debug("on data channel ".concat(o.id,", ").concat(o.label),r.logContext),o.onmessage=r.handleDataMessage}}()}),this.handleDataMessage=i=>D(this,void 0,void 0,function*(){var s,r,o,a,c;const d=yield this.dataProcessLock.lock();try{let h;if(i.data instanceof ArrayBuffer)h=i.data;else if(i.data instanceof Blob)h=yield i.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:i.data}));return}const f=Jn.fromBinary(new Uint8Array(h));if(f.sequence>0&&f.participantSid!==""){const m=this.reliableReceivedState.get(f.participantSid);if(m&&f.sequence<=m)return;this.reliableReceivedState.set(f.participantSid,f.sequence)}if(((s=f.value)===null||s===void 0?void 0:s.case)==="speaker")this.emit(ce.ActiveSpeakersUpdate,f.value.value.speakers);else if(((r=f.value)===null||r===void 0?void 0:r.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const m=yield(o=this.e2eeManager)===null||o===void 0?void 0:o.handleEncryptedData(f.value.value.encryptedValue,f.value.value.iv,f.participantIdentity,f.value.value.keyIndex),y=r4.fromBinary(m.payload),v=new Jn({value:y.value,participantIdentity:f.participantIdentity,participantSid:f.participantSid});((a=v.value)===null||a===void 0?void 0:a.case)==="user"&&ZI(v,v.value.value),this.emit(ce.DataPacketReceived,v,f.value.value.encryptionType)}else((c=f.value)===null||c===void 0?void 0:c.case)==="user"&&ZI(f,f.value.value),this.emit(ce.DataPacketReceived,f,sn.NONE)}finally{d()}}),this.handleDataError=i=>{const r=i.currentTarget.maxRetransmits===0?"lossy":"reliable";if(i instanceof ErrorEvent&&i.error){const{error:o}=i.error;this.log.error("DataChannel error on ".concat(r,": ").concat(i.message),Object.assign(Object.assign({},this.logContext),{error:o}))}else this.log.error("Unknown DataChannel error on ".concat(r),Object.assign(Object.assign({},this.logContext),{event:i}))},this.handleBufferedAmountLow=i=>{const r=i.currentTarget.maxRetransmits===0?Pe.LOSSY:Pe.RELIABLE;this.updateAndEmitDCBufferStatus(r)},this.handleDisconnect=(i,s)=>{if(this._isClosed)return;this.log.warn("".concat(i," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const r=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(ce.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(a===null){r(o);return}i===Vx&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=kn.setTimeout(()=>this.attemptReconnect(s).finally(()=>this.reconnectTimeout=void 0),a)},this.waitForRestarted=()=>new Promise((i,s)=>{this.pcState===Hi.Connected&&i();const r=()=>{this.off(ce.Disconnected,o),i()},o=()=>{this.off(ce.Restarted,r),s()};this.once(ce.Restarted,r),this.once(ce.Disconnected,o)}),this.updateAndEmitDCBufferStatus=i=>{if(i===Pe.RELIABLE){const r=this.dataChannelForKind(i);r&&this.reliableMessageBuffer.alignBufferedAmount(r.bufferedAmount)}const s=this.isBufferStatusLow(i);typeof s<"u"&&s!==this.dcBufferStatus.get(i)&&(this.dcBufferStatus.set(i,s),this.emit(ce.DCBufferStatusChanged,s,i))},this.isBufferStatusLow=i=>{const s=this.dataChannelForKind(i);if(s)return s.bufferedAmount<=s.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>D(this,void 0,void 0,function*(){!this.url||!(yield fetch(Of(this.url),{method:"HEAD"}).then(s=>s.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===at.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===at.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(ml.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>D(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(Of(this.url),{method:"HEAD"}),wn(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=uo((t=e.loggerName)!==null&&t!==void 0?t:js.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new l1(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new $n,this.dataProcessLock=new $n,this.dcBufferStatus=new Map([[Pe.LOSSY,!0],[Pe.RELIABLE,!0]]),this.client.onParticipantUpdate=i=>this.emit(ce.ParticipantUpdate,i),this.client.onConnectionQuality=i=>this.emit(ce.ConnectionQualityUpdate,i),this.client.onRoomUpdate=i=>this.emit(ce.RoomUpdate,i),this.client.onSubscriptionError=i=>this.emit(ce.SubscriptionError,i),this.client.onSubscriptionPermissionUpdate=i=>this.emit(ce.SubscriptionPermissionUpdate,i),this.client.onSpeakersChanged=i=>this.emit(ce.SpeakersChanged,i),this.client.onStreamStateUpdate=i=>this.emit(ce.StreamStateChanged,i),this.client.onRequestResponse=i=>this.emit(ce.SignalRequestResponse,i)}get logContext(){var e,t,i,s,r,o;return{room:(t=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||t===void 0?void 0:t.name,roomID:(s=(i=this.latestJoinResponse)===null||i===void 0?void 0:i.room)===null||s===void 0?void 0:s.sid,participant:(o=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.participant)===null||o===void 0?void 0:o.identity,pID:this.participantSid}}join(e,t,i,s){return D(this,arguments,void 0,function(r,o,a,c){var d=this;let h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return function*(){d.url=r,d.token=o,d.signalOpts=a,d.maxJoinAttempts=a.maxRetries;try{d.joinAttempts+=1,d.setupSignalClientCallbacks();const f=yield d.client.join(r,o,a,c,h);return d._isClosed=!1,d.latestJoinResponse=f,d.subscriberPrimary=f.subscriberPrimary,d.pcManager||(yield d.configure(f,!h)),(!d.subscriberPrimary||f.fastPublish)&&d.negotiate().catch(m=>{Me.error(m,d.logContext)}),d.registerOnLineListener(),d.clientConfiguration=f.clientConfiguration,d.emit(ce.SignalConnected,f),f}catch(f){if(f instanceof Se){if(f.reason===lt.ServerUnreachable){if(d.log.warn("Couldn't connect to server, attempt ".concat(d.joinAttempts," of ").concat(d.maxJoinAttempts),d.logContext),d.joinAttempts<d.maxJoinAttempts)return d.join(r,o,a,c,h)}else if(f.reason===lt.ServiceNotFound)return d.log.warn("Initial connection failed: ".concat(f.message,"  Retrying")),d.join(r,o,a,c,!0)}throw f}}()})}close(){return D(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(ce.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return D(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const t=i=>{i&&(i.close(),i.onbufferedamountlow=null,i.onclose=null,i.onclosing=null,i.onerror=null,i.onmessage=null,i.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new LI,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return D(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Kr("a track with the same ID has already been published");return new Promise((t,i)=>{const s=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],i(Se.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:r=>{clearTimeout(s),t(r)},reject:()=>{clearTimeout(s),i(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(t){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:t}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return D(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,t){return D(this,void 0,void 0,function*(){var i,s;if(this.pcManager&&this.pcManager.currentState!==Rt.NEW)return;this.participantSid=(i=e.participant)===null||i===void 0?void 0:i.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new TZ(r,t?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(ce.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(o,a)=>{this.client.sendIceCandidate(o,a)},this.pcManager.onPublisherOffer=(o,a)=>{this.client.sendOffer(o,a)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(o,a,c)=>D(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(o),this.logContext),["closed","disconnected","failed"].includes(a)&&(this.publisherConnectionPromise=void 0),o===Rt.CONNECTED){const f=this.pcState===Hi.New;this.pcState=Hi.Connected,f&&this.emit(ce.Connected,e)}else o===Rt.FAILED&&(this.pcState===Hi.Connected||this.pcState===Hi.Reconnecting)&&(this.pcState=Hi.Disconnected,this.handleDisconnect("peerconnection failed",c==="failed"?ml.RR_SUBSCRIBER_FAILED:ml.RR_PUBLISHER_FAILED));const d=this.client.isDisconnected||this.client.currentState===at.RECONNECTING,h=[Rt.FAILED,Rt.CLOSING,Rt.CLOSED].includes(o);d&&h&&!this._isClosed&&this.emit(ce.Offline)}),this.pcManager.onTrack=o=>{o.streams.length!==0&&this.emit(ce.MediaTrackAdded,o.track,o.streams[0],o.receiver)},XZ((s=e.serverInfo)===null||s===void 0?void 0:s.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,i)=>D(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:i})),this.midToTrackId=i,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,i)=>D(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=i;const s=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);s&&this.client.sendAnswer(s,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(t=e.track)===null||t===void 0?void 0:t.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:i}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],i(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ce.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(ce.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var t;this.token=e,(t=this.regionUrlProvider)===null||t===void 0||t.updateToken(e)},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(ce.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ce.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=(t=e.participant)===null||t===void 0?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(ce.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,i;const s={direction:"recvonly"};for(let r=0;r<e.numAudios;r++)(t=this.pcManager)===null||t===void 0||t.addPublisherTransceiverOfKind("audio",s);for(let r=0;r<e.numVideos;r++)(i=this.pcManager)===null||i===void 0||i.addPublisherTransceiverOfKind("video",s);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",ml.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:gj,regionSettings:e.regions})),e.action){case wu.DISCONNECT:this.emit(ce.Disconnected,e==null?void 0:e.reason),this.close();break;case wu.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Vx);break;case wu.RESUME:this.handleDisconnect(Vx)}}}makeRTCConfiguration(e){var t;const i=Object.assign({},this.rtcConfig);if(!((t=this.signalOpts)===null||t===void 0)&&t.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),i.encodedInsertableStreams=!0),e.iceServers&&!i.iceServers){const s=[];e.iceServers.forEach(r=>{const o={urls:r.urls};r.username&&(o.username=r.username),r.credential&&(o.credential=r.credential),s.push(o)}),i.iceServers=s}return e.clientConfiguration&&e.clientConfiguration.forceRelay===If.ENABLED&&(i.iceTransportPolicy="relay"),i.sdpSemantics="unified-plan",i.continualGatheringPolicy="gather_continually",i}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(XI,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(YI,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(Pe.LOSSY);if(e){const t=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(t,qZ),QZ)}},1e3))}createSender(e,t,i){return D(this,void 0,void 0,function*(){if(Tk())return yield this.createTransceiverRTCRtpSender(e,t,i);if(Ak())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Ot("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,i,s){return D(this,void 0,void 0,function*(){if(Tk())return this.createSimulcastTransceiverSender(e,t,i,s);if(Ak())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Ot("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,i){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ot("publisher is closed");const s=[];e.mediaStream&&s.push(e.mediaStream),ja(e)&&(e.codec=t.videoCodec);const r={direction:"sendonly",streams:s};return i&&(r.sendEncodings=i),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r)).sender})}createSimulcastTransceiverSender(e,t,i,s){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ot("publisher is closed");const r={direction:"sendonly"};s&&(r.sendEncodings=s);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(i.videoCodec)return e.setSimulcastTrackSender(i.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ot("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return D(this,void 0,void 0,function*(){var t,i,s;if(!this._isClosed){if(this.attemptingReconnect){Me.warn("already attempting reconnect, returning early",this.logContext);return}(((t=this.clientConfiguration)===null||t===void 0?void 0:t.resumeConnection)===If.DISABLED||((s=(i=this.pcManager)===null||i===void 0?void 0:i.currentState)!==null&&s!==void 0?s:Rt.NEW)===Rt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(r){this.reconnectAttempts+=1;let o=!0;r instanceof Ot?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:r})),o=!1):r instanceof Dc||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",ml.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ce.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(t){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:t}))}return null}restartConnection(e){return D(this,void 0,void 0,function*(){var t,i,s;try{if(!this.url||!this.token)throw new Ot("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ce.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let r;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Dc;r=yield this.join(e??this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(o){throw o instanceof Se&&o.reason===lt.NotAllowed?new Ot("could not reconnect, token might be expired"):new Dc}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ce.SignalRestarted,r),yield this.waitForPCReconnected(),this.client.currentState!==at.CONNECTED)throw new Dc("Signal connection got severed during reconnect");(t=this.regionUrlProvider)===null||t===void 0||t.resetAttempts(),this.emit(ce.Restarted)}catch(r){const o=yield(i=this.regionUrlProvider)===null||i===void 0?void 0:i.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(s=this.regionUrlProvider)===null||s===void 0||s.resetAttempts(),r}})}resumeConnection(e){return D(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new Ot("could not reconnect, url or token not saved");if(!this.pcManager)throw new Ot("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ce.Resuming);let i;try{this.setupSignalClientCallbacks(),i=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(s){let r="";throw s instanceof Error&&(r=s.message,this.log.error(s.message,Object.assign(Object.assign({},this.logContext),{error:s}))),s instanceof Se&&s.reason===lt.NotAllowed?new Ot("could not reconnect, token might be expired"):s instanceof Se&&s.reason===lt.LeaveRequest?s:new Dc(r)}if(this.emit(ce.SignalResumed),i){const s=this.makeRTCConfiguration(i);this.pcManager.updateConfiguration(s),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=i.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==at.CONNECTED)throw new Dc("Signal connection got severed during reconnect");this.client.setReconnected(),((t=this.reliableDC)===null||t===void 0?void 0:t.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),i!=null&&i.lastMessageSeq&&this.resendReliableMessagesForResume(i.lastMessageSeq),this.emit(ce.Resumed)})}waitForPCInitialConnection(e,t){return D(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ot("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return D(this,void 0,void 0,function*(){this.pcState=Hi.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield wn(JZ),!this.pcManager)throw new Ot("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Hi.Connected}catch(e){throw this.pcState=Hi.Disconnected,Se.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,t,i,s){return D(this,void 0,void 0,function*(){const r=new Jn({destinationIdentities:[e],kind:Pe.RELIABLE,value:{case:"rpcResponse",value:new $T({requestId:t,value:s?{case:"error",value:s.toProto()}:{case:"payload",value:i??""}})}});yield this.sendDataPacket(r,Pe.RELIABLE)})}publishRpcAck(e,t){return D(this,void 0,void 0,function*(){const i=new Jn({destinationIdentities:[e],kind:Pe.RELIABLE,value:{case:"rpcAck",value:new QT({requestId:t})}});yield this.sendDataPacket(i,Pe.RELIABLE)})}sendDataPacket(e,t){return D(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const r=rZ(e);if(r){const o=yield this.e2eeManager.encryptData(r.toBinary());e.value={case:"encryptedPacket",value:new s4({encryptedValue:o.payload,iv:o.iv,keyIndex:o.keyIndex})}}}t===Pe.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const i=e.toBinary(),s=this.dataChannelForKind(t);if(s){if(t===Pe.RELIABLE)yield this.waitForBufferStatusLow(t),this.reliableMessageBuffer.push({data:i,sequence:e.sequence});else{if(!this.isBufferStatusLow(t)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100===0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=i.byteLength}if(this.attemptingReconnect)return;s.send(i)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return D(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Pe.RELIABLE);const t=this.dataChannelForKind(Pe.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(i=>{t.send(i.data)})),this.updateAndEmitDCBufferStatus(Pe.RELIABLE)})}waitForBufferStatusLow(e){return new ci((t,i)=>D(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const s=()=>i(new Ot("engine closed"));for(this.once(ce.Closing,s);!this.dcBufferStatus.get(e);)yield wn(10);this.off(ce.Closing,s),t()}}))}ensureDataTransportConnected(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var r;if(!i.pcManager)throw new Ot("PC manager is closed");const o=s?i.pcManager.subscriber:i.pcManager.publisher,a=s?"Subscriber":"Publisher";if(!o)throw Se.internal("".concat(a," connection not set"));let c=!1;!s&&!i.dataChannelForKind(t,s)&&(i.createDataChannels(),c=!0),!c&&!s&&!i.pcManager.publisher.isICEConnected&&i.pcManager.publisher.getICEConnectionState()!=="checking"&&(c=!0),c&&i.negotiate().catch(f=>{Me.error(f,i.logContext)});const d=i.dataChannelForKind(t,s);if((d==null?void 0:d.readyState)==="open")return;const h=new Date().getTime()+i.peerConnectionTimeout;for(;new Date().getTime()<h;){if(o.isICEConnected&&((r=i.dataChannelForKind(t,s))===null||r===void 0?void 0:r.readyState)==="open")return;yield wn(50)}throw Se.internal("could not establish ".concat(a," connection, state: ").concat(o.getICEConnectionState()))}()})}ensurePublisherConnected(e){return D(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Rt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return D(this,void 0,void 0,function*(){return new ci((e,t)=>D(this,void 0,void 0,function*(){if(!this.pcManager){t(new Au("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const i=new AbortController,s=()=>{i.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t(new Au("cannot negotiate on closed engine")),this.on(ce.Closing,s),this.pcManager.publisher.once(Ru.RTPVideoPayloadTypes,r=>{const o=new Map;r.forEach(a=>{const c=a.codec.toLowerCase();VY(c)&&o.set(a.payload,c)}),this.emit(ce.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(i),e()}catch(r){r instanceof Au&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ml.RR_UNKNOWN),r instanceof Error?t(r):t(new Error(String(r)))}finally{this.off(ce.Closing,s)}}))})}dataChannelForKind(e,t){if(t){if(e===Pe.LOSSY)return this.lossyDCSub;if(e===Pe.RELIABLE)return this.reliableDCSub}else{if(e===Pe.LOSSY)return this.lossyDC;if(e===Pe.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var i,s,r,o;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const a=this.pcManager.publisher.getLocalDescription(),c=this.pcManager.publisher.getRemoteDescription(),d=(i=this.pcManager.subscriber)===null||i===void 0?void 0:i.getRemoteDescription(),h=(s=this.pcManager.subscriber)===null||s===void 0?void 0:s.getLocalDescription(),f=(o=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&o!==void 0?o:!0,m=new Array,y=new Array;e.forEach(v=>{v.isDesired!==f&&m.push(v.trackSid),v.isEnabled||y.push(v.trackSid)}),this.client.sendSyncState(new t1({answer:this.pcManager.mode==="publisher-only"?c?pu({sdp:c.sdp,type:c.type}):void 0:h?pu({sdp:h.sdp,type:h.type}):void 0,offer:this.pcManager.mode==="publisher-only"?a?pu({sdp:a.sdp,type:a.type}):void 0:d?pu({sdp:d.sdp,type:d.type}):void 0,subscription:new Bv({trackSids:m,subscribe:!f,participantTracks:[]}),publishTracks:TY(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:y,datachannelReceiveStates:this.reliableReceivedState.map((v,x)=>new w4({publisherSid:x,lastSeq:v}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(i,s)=>{(i==null?void 0:i.id)!==void 0&&i.id!==null&&e.push(new T4({label:i.label,id:i.id,target:s}))};return t(this.dataChannelForKind(Pe.LOSSY),Ts.PUBLISHER),t(this.dataChannelForKind(Pe.RELIABLE),Ts.PUBLISHER),t(this.dataChannelForKind(Pe.LOSSY,!0),Ts.SUBSCRIBER),t(this.dataChannelForKind(Pe.RELIABLE,!0),Ts.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&kn.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){ui()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){ui()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var t;const i=(t=this.pcManager)===null||t===void 0?void 0:t.getMidForReceiver(e);if(i){const s=Object.entries(this.midToTrackId).find(r=>{let[o]=r;return o===i});if(s)return s[1]}}}function XZ(n){return n!==void 0&&n>13}function ZI(n,e){const t=n.participantIdentity?n.participantIdentity:e.participantIdentity;n.participantIdentity=t,e.participantIdentity=t;const i=n.destinationIdentities.length!==0?n.destinationIdentities:e.destinationIdentities;n.destinationIdentities=i,e.destinationIdentities=i}class Sj{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new Gi("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Gn.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new Gi("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Gn.LengthExceeded)}}constructor(e,t,i,s){this.reader=t,this.totalByteSize=i,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=s}}class YZ extends Sj{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const i=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,i)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Yi,i=null,s=null;if(this.signal){const o=this.signal;s=()=>{var a;(a=t.reject)===null||a===void 0||a.call(t,o.reason)},o.addEventListener("abort",s),i=o}const r=()=>{e.releaseLock(),i&&s&&i.removeEventListener("abort",s),this.signal=void 0};return{next:()=>D(this,void 0,void 0,function*(){var o,a;try{const{done:c,value:d}=yield Promise.race([e.read(),t.promise,(a=(o=this.outOfBandFailureRejectingFuture)===null||o===void 0?void 0:o.promise)!==null&&a!==void 0?a:new Promise(()=>{})]);return c?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(d),{done:!1,value:d.content})}catch(c){throw r(),c}}),return(){return D(this,void 0,void 0,function*(){return r(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var i,s,r,o;let a=new Set;const c=t.signal?e.withAbortSignal(t.signal):e;try{for(var d=!0,h=Jr(c),f;f=yield h.next(),i=f.done,!i;d=!0){o=f.value,d=!1;const m=o;a.add(m)}}catch(m){s={error:m}}finally{try{!d&&!i&&(r=h.return)&&(yield r.call(h))}finally{if(s)throw s.error}}return Array.from(a)}()})}}class ZZ extends Sj{constructor(e,t,i,s){super(e,t,i,s),this.receivedChunks=new Map}handleChunkReceived(e){var t;const i=Zg(e.chunkIndex),s=this.receivedChunks.get(i);if(s&&s.version>e.version)return;this.receivedChunks.set(i,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(t=this.onProgress)===null||t===void 0||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let i=new Yi,s=null,r=null;if(this.signal){const a=this.signal;r=()=>{var c;(c=i.reject)===null||c===void 0||c.call(i,a.reason)},a.addEventListener("abort",r),s=a}const o=()=>{e.releaseLock(),s&&r&&s.removeEventListener("abort",r),this.signal=void 0};return{next:()=>D(this,void 0,void 0,function*(){var a,c;try{const{done:d,value:h}=yield Promise.race([e.read(),i.promise,(c=(a=this.outOfBandFailureRejectingFuture)===null||a===void 0?void 0:a.promise)!==null&&c!==void 0?c:new Promise(()=>{})]);if(d)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(h);let f;try{f=t.decode(h.content)}catch(m){throw new Gi("Cannot decode datastream chunk ".concat(h.chunkIndex," as text: ").concat(m),Gn.DecodeFailed)}return{done:!1,value:f}}}catch(d){throw o(),d}}),return(){return D(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return D(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var i,s,r,o;let a="";const c=t.signal?e.withAbortSignal(t.signal):e;try{for(var d=!0,h=Jr(c),f;f=yield h.next(),i=f.done,!i;d=!0)o=f.value,d=!1,a+=o}catch(m){s={error:m}}finally{try{!d&&!i&&(r=h.return)&&(yield r.call(h))}finally{if(s)throw s.error}}return a}()})}}class e2{constructor(){this.log=Me,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new Gi('A text stream handler for topic "'.concat(e,'" has already been set.'),Gn.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new Gi('A byte stream handler for topic "'.concat(e,'" has already been set.'),Gn.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,i,s,r;const o=Array.from(this.textStreamControllers.entries()).filter(c=>c[1].sendingParticipantIdentity===e),a=Array.from(this.byteStreamControllers.entries()).filter(c=>c[1].sendingParticipantIdentity===e);if(o.length>0||a.length>0){const c=new Gi("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Gn.AbnormalEnd);for(const[d,h]of a)(i=(t=h.outOfBandFailureRejectingFuture).reject)===null||i===void 0||i.call(t,c),this.byteStreamControllers.delete(d);for(const[d,h]of o)(r=(s=h.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(s,c),this.textStreamControllers.delete(d)}}handleDataStreamPacket(e,t){return D(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,i){return D(this,void 0,void 0,function*(){var s;if(e.contentHeader.case==="byteHeader"){const r=this.byteStreamHandlers.get(e.topic);if(!r){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let o;const a=new Yi;a.promise.catch(h=>{this.log.error(h)});const c={id:e.streamId,name:(s=e.contentHeader.value.name)!==null&&s!==void 0?s:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Zg(e.timestamp),attributes:e.attributes,encryptionType:i},d=new ReadableStream({start:h=>{if(o=h,this.textStreamControllers.has(e.streamId))throw new Gi("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Gn.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:c,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});r(new YZ(c,d,Zg(e.totalLength),a),{identity:t})}else if(e.contentHeader.case==="textHeader"){const r=this.textStreamHandlers.get(e.topic);if(!r){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let o;const a=new Yi;a.promise.catch(h=>{this.log.error(h)});const c={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:i},d=new ReadableStream({start:h=>{if(o=h,this.textStreamControllers.has(e.streamId))throw new Gi("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Gn.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:c,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});r(new ZZ(c,d,Zg(e.totalLength),a),{identity:t})}})}handleStreamChunk(e,t){const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?(i.controller.error(new Gi("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Gn.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e));const s=this.textStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==t?(s.controller.error(new Gi("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(s.info.encryptionType),Gn.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&s.controller.enqueue(e))}handleStreamTrailer(e,t){const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?i.controller.error(new Gi("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Gn.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close(),this.textStreamControllers.delete(e.streamId)));const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==t?s.controller.error(new Gi("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(s.info.encryptionType),Gn.EncryptionTypeMismatch)):(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class Cj{constructor(e,t,i){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=i,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return D(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class t2 extends Cj{}class n2 extends Cj{}const eB=15e3;class i2{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return D(this,void 0,void 0,function*(){var i;const s=crypto.randomUUID(),o=new TextEncoder().encode(e).byteLength,a=(i=t==null?void 0:t.attachments)===null||i===void 0?void 0:i.map(()=>crypto.randomUUID()),c=new Array(a?a.length+1:1).fill(0),d=(f,m)=>{var y;c[m]=f;const v=c.reduce((x,k)=>x+k,0);(y=t==null?void 0:t.onProgress)===null||y===void 0||y.call(t,v)},h=yield this.streamText({streamId:s,totalSize:o,destinationIdentities:t==null?void 0:t.destinationIdentities,topic:t==null?void 0:t.topic,attachedStreamIds:a,attributes:t==null?void 0:t.attributes});return yield h.write(e),d(1,0),yield h.close(),t!=null&&t.attachments&&a&&(yield Promise.all(t.attachments.map((f,m)=>D(this,void 0,void 0,function*(){return this._sendFile(a[m],f,{topic:t.topic,mimeType:f.type,onProgress:y=>{d(y,m+1)}})})))),h.info})}streamText(e){return D(this,void 0,void 0,function*(){var t,i,s;const r=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),o={id:r,mimeType:"text/plain",timestamp:Date.now(),topic:(i=e==null?void 0:e.topic)!==null&&i!==void 0?i:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((s=this.engine.e2eeManager)===null||s===void 0)&&s.isDataChannelEncryptionEnabled?sn.GCM:sn.NONE},a=new jy({streamId:r,mimeType:o.mimeType,topic:o.topic,timestamp:gl(o.timestamp),totalLength:gl(e==null?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new g4({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?dk.UPDATE:dk.CREATE})}}),c=e==null?void 0:e.destinationIdentities,d=new Jn({destinationIdentities:c,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(d,Pe.RELIABLE);let h=0;const f=this.engine,m=new WritableStream({write(x){return D(this,void 0,void 0,function*(){for(const k of qY(x,eB)){const C=new Uy({content:k,streamId:r,chunkIndex:gl(h)}),A=new Jn({destinationIdentities:c,value:{case:"streamChunk",value:C}});yield f.sendDataPacket(A,Pe.RELIABLE),h+=1}})},close(){return D(this,void 0,void 0,function*(){const x=new zy({streamId:r}),k=new Jn({destinationIdentities:c,value:{case:"streamTrailer",value:x}});yield f.sendDataPacket(k,Pe.RELIABLE)})},abort(x){console.log("Sink error:",x)}});let y=()=>D(this,void 0,void 0,function*(){yield v.close()});f.once(ce.Closing,y);const v=new t2(m,o,()=>this.engine.off(ce.Closing,y));return v})}sendFile(e,t){return D(this,void 0,void 0,function*(){const i=crypto.randomUUID();return yield this._sendFile(i,e,t),{id:i}})}_sendFile(e,t,i){return D(this,void 0,void 0,function*(){var s;const r=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:t.type,topic:i==null?void 0:i.topic,destinationIdentities:i==null?void 0:i.destinationIdentities}),o=t.stream().getReader();for(;;){const{done:a,value:c}=yield o.read();if(a)break;yield r.write(c)}return yield r.close(),r.info})}streamBytes(e){return D(this,void 0,void 0,function*(){var t,i,s,r,o,a;const c=(t=e==null?void 0:e.streamId)!==null&&t!==void 0?t:crypto.randomUUID(),d=e==null?void 0:e.destinationIdentities,h={id:c,mimeType:(i=e==null?void 0:e.mimeType)!==null&&i!==void 0?i:"application/octet-stream",topic:(s=e==null?void 0:e.topic)!==null&&s!==void 0?s:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(r=e==null?void 0:e.name)!==null&&r!==void 0?r:"unknown",encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?sn.GCM:sn.NONE},f=new jy({totalLength:gl((a=h.size)!==null&&a!==void 0?a:0),mimeType:h.mimeType,streamId:c,topic:h.topic,timestamp:gl(Date.now()),attributes:h.attributes,contentHeader:{case:"byteHeader",value:new y4({name:h.name})}}),m=new Jn({destinationIdentities:d,value:{case:"streamHeader",value:f}});yield this.engine.sendDataPacket(m,Pe.RELIABLE);let y=0;const v=new $n,x=this.engine,k=this.log,C=new WritableStream({write(T){return D(this,void 0,void 0,function*(){const E=yield v.lock();let _=0;try{for(;_<T.byteLength;){const R=T.slice(_,_+eB),B=new Jn({destinationIdentities:d,value:{case:"streamChunk",value:new Uy({content:R,streamId:c,chunkIndex:gl(y)})}});yield x.sendDataPacket(B,Pe.RELIABLE),y+=1,_+=R.byteLength}}finally{E()}})},close(){return D(this,void 0,void 0,function*(){const T=new zy({streamId:c}),E=new Jn({destinationIdentities:d,value:{case:"streamTrailer",value:T}});yield x.sendDataPacket(E,Pe.RELIABLE)})},abort(T){k.error("Sink error:",T)}});return new n2(C,h)})}}class kj extends Q{constructor(e,t,i,s,r){super(e,i,r),this.sid=t,this.receiver=s}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?oe.Muted:oe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=i=>{i.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(oe.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return D(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),p1)),AY()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const i=(t=this.receiver)===null||t===void 0?void 0:t.getSynchronizationSources()[0];if(i){const{timestamp:s,rtpTimestamp:r}=i;r&&this.rtpTimestamp!==r&&(this.emit(oe.TimeSyncUpdate,{timestamp:s,rtpTimestamp:r}),this.rtpTimestamp=r)}};e()}}class s2 extends kj{constructor(e,t,i,s,r,o){super(e,t,Q.Kind.Audio,i,o),this.monitorReceiver=()=>D(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Fv(a,this.prevStats)),this.prevStats=a}),this.audioContext=s,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const i of this.attachedElements)this.audioContext?(t=this.gainNode)===null||t===void 0||t.gain.setTargetAtTime(e,0,.1):i.volume=e;or()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(or())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return D(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Ek(t))return t.setSinkId(e)}))})}attach(e){const t=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ek(e)&&e.setSinkId(this.sinkId).catch(i=>{this.log.error("Failed to set sink id on remote audio track",i,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let i=this.sourceNode;this.webAudioPluginNodes.forEach(s=>{i.connect(s),i=s}),this.gainNode=e.createGain(),i.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(oe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(s=>{this.emit(oe.AudioPlaybackFailed,s)})}disconnectWebAudio(){var e,t;(e=this.gainNode)===null||e===void 0||e.disconnect(),(t=this.sourceNode)===null||t===void 0||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return D(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t;return e.forEach(i=>{i.type==="inbound-rtp"&&(t={type:"audio",streamId:i.id,timestamp:i.timestamp,jitter:i.jitter,bytesReceived:i.bytesReceived,concealedSamples:i.concealedSamples,concealmentEvents:i.concealmentEvents,silentConcealedSamples:i.silentConcealedSamples,silentConcealmentEvents:i.silentConcealmentEvents,totalAudioEnergy:i.totalAudioEnergy,totalSamplesDuration:i.totalSamplesDuration})}),t})}}const Hx=100;class r2 extends kj{constructor(e,t,i,s,r){super(e,t,Q.Kind.Video,i,r),this.elementInfos=[],this.monitorReceiver=()=>D(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Fv(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=u1(()=>{this.updateDimensions()},Hx),this.adaptiveStreamSettings=s}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===Q.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Eu(this._mediaStreamTrack,t):fu(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(t=>t.element===e)===void 0){const t=new o2(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(t=>t===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const t=this.elementInfos.filter(i=>i===e);for(const i of t)i.stopObserving();this.elementInfos=this.elementInfos.filter(i=>i!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const i of t)this.stopObservingElement(i);return t}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return D(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,i="",s=new Map;return e.forEach(r=>{r.type==="inbound-rtp"?(i=r.codecId,t={type:"video",streamId:r.id,framesDecoded:r.framesDecoded,framesDropped:r.framesDropped,framesReceived:r.framesReceived,packetsReceived:r.packetsReceived,packetsLost:r.packetsLost,frameWidth:r.frameWidth,frameHeight:r.frameHeight,pliCount:r.pliCount,firCount:r.firCount,nackCount:r.nackCount,jitter:r.jitter,timestamp:r.timestamp,bytesReceived:r.bytesReceived,decoderImplementation:r.decoderImplementation}):r.type==="codec"&&s.set(r.id,r)}),t&&i!==""&&s.get(i)&&(t.mimeType=s.get(i).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(i=>i.element===e);for(const i of t)this.stopObservingElementInfo(i)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return D(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,i;const s=this.elementInfos.reduce((c,d)=>Math.max(c,d.visibilityChangedAt||0),0),r=!((i=(t=this.adaptiveStreamSettings)===null||t===void 0?void 0:t.pauseVideoInBackground)!==null&&i!==void 0)||i?this.isInBackground:!1,o=this.elementInfos.some(c=>c.pictureInPicture),a=this.elementInfos.some(c=>c.visible)&&!r||o;if(!(this.lastVisible===a&&!e)){if(!a&&Date.now()-s<Hx){kn.setTimeout(()=>{this.updateVisibility()},Hx);return}this.lastVisible=a,this.emit(oe.VisibilityChanged,a,this)}}updateDimensions(){var e,t;let i=0,s=0;const r=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*r,c=o.height()*r;a+c>i+s&&(i=a,s=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===i&&((t=this.lastDimensions)===null||t===void 0?void 0:t.height)===s||(this.lastDimensions={width:i,height:s},this.emit(oe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return t==="screen"?_I():t||(_I()>2?2:1)}}class o2{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=i=>{var s;const{target:r,isIntersecting:o}=i;r===this.element&&(this.isIntersecting=o,this.isPiP=gh(this.element),this.visibilityChangedAt=Date.now(),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this))},this.onEnterPiP=()=>{var i,s,r;(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP),this.isPiP=gh(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.onLeavePiP=()=>{var i;this.isPiP=gh(this.element),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this)},this.element=e,this.isIntersecting=t??Bk(e),this.isPiP=ui()&&gh(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,i;this.isIntersecting=Bk(this.element),this.isPiP=gh(this.element),this.element.handleResize=()=>{var s;(s=this.handleResize)===null||s===void 0||s.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,RI().observe(this.element),MI().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(i=(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,i,s,r;(e=RI())===null||e===void 0||e.unobserve(this.element),(t=MI())===null||t===void 0||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(i=window.documentPictureInPicture)===null||i===void 0||i.removeEventListener("enter",this.onEnterPiP),(r=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||r===void 0||r.removeEventListener("pagehide",this.onLeavePiP)}}function gh(n){var e,t;return document.pictureInPictureElement===n?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Bk(n,(t=window.documentPictureInPicture)===null||t===void 0?void 0:t.window):!1}function Bk(n,e){const t=e||window;let i=n.offsetTop,s=n.offsetLeft;const r=n.offsetWidth,o=n.offsetHeight,{hidden:a}=n,{display:c}=getComputedStyle(n);for(;n.offsetParent;)n=n.offsetParent,i+=n.offsetTop,s+=n.offsetLeft;return i<t.pageYOffset+t.innerHeight&&s<t.pageXOffset+t.innerWidth&&i+o>t.pageYOffset&&s+r>t.pageXOffset&&!a&&c!=="none"}class Lr extends lr.EventEmitter{constructor(e,t,i,s){var r;super(),this.metadataMuted=!1,this.encryption=sn.NONE,this.log=Me,this.handleMuted=()=>{this.emit(oe.Muted)},this.handleUnmuted=()=>{this.emit(oe.Unmuted)},this.log=uo((r=s==null?void 0:s.loggerName)!==null&&r!==void 0?r:js.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=i,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off(oe.Muted,this.handleMuted),this.track.off(oe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(oe.Muted,this.handleMuted),e.on(oe.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ne(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==sn.NONE}get audioTrack(){if(rr(this.track))return this.track}get videoTrack(){if(ja(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(n){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(n.SubscriptionStatus||(n.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(n.PermissionStatus||(n.PermissionStatus={}))})(Lr||(Lr={}));class Dk extends Lr{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,t,i,s){super(e,t.sid,t.name,s),this.track=void 0,this.handleTrackEnded=()=>{this.emit(oe.Ended)},this.handleCpuConstrained=()=>{this.track&&ja(this.track)&&this.emit(oe.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(i)}setTrack(e){this.track&&(this.track.off(oe.Ended,this.handleTrackEnded),this.track.off(oe.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(oe.Ended,this.handleTrackEnded),e.on(oe.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return D(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return D(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return D(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return D(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(rr(this.track)){const t=this.track.getSourceTrackSettings(),i=new Set;return t.autoGainControl&&i.add(mn.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&i.add(mn.TF_ECHO_CANCELLATION),t.noiseSuppression&&i.add(mn.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&i.add(mn.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||i.add(mn.TF_NO_DTX),this.track.enhancedNoiseCancellation&&i.add(mn.TF_ENHANCED_NOISE_CANCELLATION),Array.from(i.values())}else return[]}}function Ov(n,e){return D(this,void 0,void 0,function*(){n??(n={});let t=!1;const{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:r}=cj(n);let o=r.audio,a=r.video;if(i&&typeof r.audio=="object"&&(r.audio.processor=i),s&&typeof r.video=="object"&&(r.video.processor=s),n.audio&&typeof r.audio=="object"&&typeof r.audio.deviceId=="string"){const f=r.audio.deviceId;r.audio.deviceId={exact:f},t=!0,o=Object.assign(Object.assign({},r.audio),{deviceId:{ideal:f}})}if(r.video&&typeof r.video=="object"&&typeof r.video.deviceId=="string"){const f=r.video.deviceId;r.video.deviceId={exact:f},t=!0,a=Object.assign(Object.assign({},r.video),{deviceId:{ideal:f}})}r.audio===!0?r.audio={deviceId:"default"}:typeof r.audio=="object"&&r.audio!==null&&(r.audio=Object.assign(Object.assign({},r.audio),{deviceId:r.audio.deviceId||"default"})),r.video===!0?r.video={deviceId:"default"}:typeof r.video=="object"&&!r.video.deviceId&&(r.video.deviceId="default");const c=oj(r,pj,mj),d=o1(c),h=navigator.mediaDevices.getUserMedia(d);r.audio&&(gn.userMediaPromiseMap.set("audioinput",h),h.catch(()=>gn.userMediaPromiseMap.delete("audioinput"))),r.video&&(gn.userMediaPromiseMap.set("videoinput",h),h.catch(()=>gn.userMediaPromiseMap.delete("videoinput")));try{const f=yield h;return yield Promise.all(f.getTracks().map(m=>D(this,void 0,void 0,function*(){const y=m.kind==="audio";let v=y?c.audio:c.video;(typeof v=="boolean"||!v)&&(v={});let x;const k=y?d.audio:d.video;typeof k!="boolean"&&(x=k);const C=m.getSettings().deviceId;x!=null&&x.deviceId&&Aa(x.deviceId)!==C?x.deviceId=C:x||(x={deviceId:C});const A=DZ(m,x,e);return A.kind===Q.Kind.Video?A.source=Q.Source.Camera:A.kind===Q.Kind.Audio&&(A.source=Q.Source.Microphone),A.mediaStream=f,rr(A)&&i?yield A.setProcessor(i):ja(A)&&s&&(yield A.setProcessor(s)),A})))}catch(f){if(!t)throw f;return Ov(Object.assign(Object.assign({},n),{audio:o,video:a}),e)}})}function a2(n){return D(this,void 0,void 0,function*(){return(yield Ov({audio:!1,video:!0}))[0]})}function wj(n){return D(this,void 0,void 0,function*(){return(yield Ov({audio:n??!0,video:!1}))[0]})}var na;(function(n){n.Excellent="excellent",n.Good="good",n.Poor="poor",n.Lost="lost",n.Unknown="unknown"})(na||(na={}));function l2(n){switch(n){case Bh.EXCELLENT:return na.Excellent;case Bh.GOOD:return na.Good;case Bh.POOR:return na.Poor;case Bh.LOST:return na.Lost;default:return na.Unknown}}class Tj extends lr.EventEmitter{get logContext(){var e,t;return Object.assign({},(t=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||t===void 0?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Bf.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===ku.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,i,s,r,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Bf.STANDARD;var c;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=na.Unknown,this.log=Me,this.log=uo((c=o==null?void 0:o.loggerName)!==null&&c!==void 0?c:js.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=i,this.metadata=s,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=r??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Yi,this.once(de.Active,()=>{var e,t;(t=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||t===void 0||t.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(Q.Source.Camera);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(Q.Source.Microphone);return!(!((e=t==null?void 0:t.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var t;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===ku.ACTIVE&&((t=this.participantInfo)===null||t===void 0?void 0:t.state)!==ku.ACTIVE&&this.emit(de.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,i=this.metadata;this.metadata=e,t&&this.emit(de.ParticipantMetadataChanged,i)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(de.ParticipantNameChanged,e)}_setAttributes(e){const t=EY(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(de.AttributesChanged,t)}setPermissions(e){var t,i,s,r,o,a;const c=this.permissions,d=e.canPublish!==((t=this.permissions)===null||t===void 0?void 0:t.canPublish)||e.canSubscribe!==((i=this.permissions)===null||i===void 0?void 0:i.canSubscribe)||e.canPublishData!==((s=this.permissions)===null||s===void 0?void 0:s.canPublishData)||e.hidden!==((r=this.permissions)===null||r===void 0?void 0:r.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((h,f)=>{var m;return h!==((m=this.permissions)===null||m===void 0?void 0:m.canPublishSources[f])})||e.canSubscribeMetrics!==((a=this.permissions)===null||a===void 0?void 0:a.canSubscribeMetrics);return this.permissions=e,d&&this.emit(de.ParticipantPermissionsChanged,c),d}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(de.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=l2(e),t!==this._connectionQuality&&this.emit(de.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&((t=(e=this.activeFuture).reject)===null||t===void 0||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>rr(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(oe.Muted,()=>{this.emit(de.TrackMuted,e)}),e.on(oe.Unmuted,()=>{this.emit(de.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function c2(n){var e,t,i;if(!n.participantSid&&!n.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new C4({participantIdentity:(e=n.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(t=n.participantSid)!==null&&t!==void 0?t:"",allTracks:(i=n.allowAll)!==null&&i!==void 0?i:!1,trackSids:n.allowedTrackSids||[]})}class u2 extends Tj{constructor(e,t,i,s,r,o){super(e,t,void 0,void 0,void 0,{loggerName:s.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=sn.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Yi)},this.handleReconnected=()=>{var a,c;(c=(a=this.reconnectFuture)===null||a===void 0?void 0:a.resolve)===null||c===void 0||c.call(a),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var a,c,d,h,f,m;this.reconnectFuture&&(this.reconnectFuture.promise.catch(y=>this.log.warn(y.message,this.logContext)),(c=(a=this.reconnectFuture)===null||a===void 0?void 0:a.reject)===null||c===void 0||c.call(a,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((h=(d=this.signalConnectedFuture).reject)===null||h===void 0||h.call(d,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(m=(f=this.activeAgentFuture)===null||f===void 0?void 0:f.reject)===null||m===void 0||m.call(f,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=a=>{var c,d;a.participant&&this.updateInfo(a.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Yi),(d=(c=this.signalConnectedFuture).resolve)===null||d===void 0||d.call(c)},this.handleSignalRequestResponse=a=>{const{requestId:c,reason:d,message:h}=a,f=this.pendingSignalRequests.get(c);f&&(d!==n1.OK&&f.reject(new kI(h,d)),this.pendingSignalRequests.delete(c))},this.handleDataPacket=a=>{switch(a.value.case){case"rpcResponse":let c=a.value.value,d=null,h=null;c.value.case==="payload"?d=c.value.value:c.value.case==="error"&&(h=Bt.fromProto(c.value.value)),this.handleIncomingRpcResponse(c.requestId,d,h);break;case"rpcAck":let f=a.value.value;this.handleIncomingRpcAck(f.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(a=>c2(a)))},this.onTrackUnmuted=a=>{this.onTrackMuted(a,a.isUpstreamPaused)},this.onTrackMuted=(a,c)=>{if(c===void 0&&(c=!0),!a.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ne(a)));return}this.engine.updateMuteStatus(a.sid,c)},this.onTrackUpstreamPaused=a=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ne(a))),this.onTrackMuted(a,!0)},this.onTrackUpstreamResumed=a=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ne(a))),this.onTrackMuted(a,a.isMuted)},this.onTrackFeatureUpdate=a=>{const c=this.audioTrackPublications.get(a.sid);if(!c){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(a.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(c.trackSid,c.getTrackFeatures())},this.onTrackCpuConstrained=(a,c)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Ne(c))),this.emit(de.LocalTrackCpuConstrained,a,c)},this.handleSubscribedQualityUpdate=a=>D(this,void 0,void 0,function*(){var c,d,h,f,m;if(!(!((m=this.roomOptions)===null||m===void 0)&&m.dynacast))return;const y=this.videoTrackPublications.get(a.trackSid);if(!y){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:a.trackSid}));return}if(!y.videoTrack)return;const v=yield y.videoTrack.setPublishingCodecs(a.subscribedCodecs);try{for(var x=!0,k=Jr(v),C;C=yield k.next(),c=C.done,!c;x=!0){f=C.value,x=!1;const A=f;CY(A)&&(this.log.debug("publish ".concat(A," for ").concat(y.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ne(y))),yield this.publishAdditionalCodecForTrack(y.videoTrack,A,y.options))}}catch(A){d={error:A}}finally{try{!x&&!c&&(h=k.return)&&(yield h.call(k))}finally{if(d)throw d.error}}}),this.handleLocalTrackUnpublished=a=>{const c=this.trackPublications.get(a.trackSid);if(!c){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:a.trackSid}));return}this.unpublishTrack(c.track)},this.handleTrackEnded=a=>D(this,void 0,void 0,function*(){if(a.source===Q.Source.ScreenShare||a.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ne(a))),this.unpublishTrack(a);else if(a.isUserProvided)yield a.mute();else if(Br(a)||jo(a))try{if(ui())try{const c=yield navigator==null?void 0:navigator.permissions.query({name:a.source===Q.Source.Camera?"camera":"microphone"});if(c&&c.state==="denied")throw this.log.warn("user has revoked access to ".concat(a.source),Object.assign(Object.assign({},this.logContext),Ne(a))),c.onchange=()=>{c.state!=="denied"&&(a.isMuted||a.restartTrack(),c.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}a.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ne(a))),Br(a)?yield a.restartTrack({deviceId:"default"}):yield a.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ne(a))),yield a.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=i,this.roomOptions=s,this.setupEngine(i),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=r,this.roomOutgoingDataStreamManager=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==sn.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(ce.RemoteMute,(i,s)=>{const r=this.trackPublications.get(i);!r||!r.track||(s?r.mute():r.unmute())}),!((t=this.signalConnectedFuture)===null||t===void 0)&&t.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(ce.Connected,this.handleReconnected).on(ce.SignalConnected,this.handleSignalConnected).on(ce.SignalRestarted,this.handleReconnected).on(ce.SignalResumed,this.handleReconnected).on(ce.Restarting,this.handleReconnecting).on(ce.Resuming,this.handleReconnecting).on(ce.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ce.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ce.Closing,this.handleClosing).on(ce.SignalRequestResponse,this.handleSignalRequestResponse).on(ce.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return D(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return D(this,arguments,void 0,function(t){var i=this;let{metadata:s,name:r,attributes:o}=t;return function*(){return new ci((a,c)=>D(i,void 0,void 0,function*(){var d,h;try{let f=!1;const m=yield this.engine.client.sendUpdateLocalMetadata((d=s??this.metadata)!==null&&d!==void 0?d:"",(h=r??this.name)!==null&&h!==void 0?h:"",o),y=performance.now();for(this.pendingSignalRequests.set(m,{resolve:a,reject:v=>{c(v),f=!0},values:{name:r,metadata:s,attributes:o}});performance.now()-y<5e3&&!f;){if((!r||this.name===r)&&(!s||this.metadata===s)&&(!o||Object.entries(o).every(v=>{let[x,k]=v;return this.attributes[x]===k||k===""&&!this.attributes[x]}))){this.pendingSignalRequests.delete(m),a();return}yield wn(50)}c(new kI("Request to update local metadata timed out","TimeoutError"))}catch(f){f instanceof Error?c(f):c(new Error(String(f)))}}))}()})}setCameraEnabled(e,t,i){return this.setTrackEnabled(Q.Source.Camera,e,t,i)}setMicrophoneEnabled(e,t,i){return this.setTrackEnabled(Q.Source.Microphone,e,t,i)}setScreenShareEnabled(e,t,i){return this.setTrackEnabled(Q.Source.ScreenShare,e,t,i)}setE2EEEnabled(e){return D(this,void 0,void 0,function*(){this.encryptionType=e?sn.GCM:sn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,i,s){return D(this,void 0,void 0,function*(){var r,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(t)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){const d=yield this.waitForPendingPublicationOfSource(e);return d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield d==null?void 0:d.unmute(),d}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:c=yield this.createTracks({video:(r=i)!==null&&r!==void 0?r:!0});break;case Q.Source.Microphone:c=yield this.createTracks({audio:(o=i)!==null&&o!==void 0?o:!0});break;case Q.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},i));break;default:throw new Kr(e)}}catch(d){throw c==null||c.forEach(h=>{h.stop()}),d instanceof Error&&this.emit(de.MediaDevicesError,d,wk(e)),this.pendingPublishing.delete(e),d}for(const d of c){const h=Object.assign(Object.assign({},this.roomOptions.publishDefaults),i);e===Q.Source.Microphone&&rr(d)&&h.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),d.startPreConnectBuffer())}try{const d=[];for(const f of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ne(f))),d.push(this.publishTrack(f,s));[a]=yield Promise.all(d)}catch(d){throw c==null||c.forEach(h=>{h.stop()}),d}finally{this.pendingPublishing.delete(e)}}else if(!(a!=null&&a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===Q.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrackPublication(Q.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return D(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(t=>this.publishTrack(t)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){return D(this,void 0,void 0,function*(){var t,i;e??(e={});const s=oj(e,(t=this.roomOptions)===null||t===void 0?void 0:t.audioCaptureDefaults,(i=this.roomOptions)===null||i===void 0?void 0:i.videoCaptureDefaults);try{return(yield Ov(s,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(a=>(rr(a)&&(this.microphoneError=void 0,a.setAudioContext(this.audioContext),a.source=Q.Source.Microphone,this.emit(de.AudioStreamAcquired)),ja(a)&&(this.cameraError=void 0,a.source=Q.Source.Camera),a))}catch(r){throw r instanceof Error&&(e.audio&&(this.microphoneError=r),e.video&&(this.cameraError=r)),r}})}createScreenTracks(e){return D(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new s1("getDisplayMedia not supported");e.resolution===void 0&&!FY()&&(e.resolution=r1.h1080fps30.resolution);const t=wY(e),i=yield navigator.mediaDevices.getDisplayMedia(t),s=i.getVideoTracks();if(s.length===0)throw new Kr("no video track found");const r=new Gy(s[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=Q.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const o=[r];if(i.getAudioTracks().length>0){this.emit(de.AudioStreamAcquired);const a=new Hy(i.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=Q.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,t){return D(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return D(this,arguments,void 0,function(i,s){var r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var a,c,d,h;Br(i)&&i.setAudioContext(r.audioContext),yield(a=r.reconnectFuture)===null||a===void 0?void 0:a.promise,r.republishPromise&&!o&&(yield r.republishPromise),_u(i)&&r.pendingPublishPromises.has(i)&&(yield r.pendingPublishPromises.get(i));let f;if(i instanceof MediaStreamTrack)f=i.getConstraints();else{f=i.constraints;let C;switch(i.source){case Q.Source.Microphone:C="audioinput";break;case Q.Source.Camera:C="videoinput"}C&&r.activeDeviceMap.has(C)&&(f=Object.assign(Object.assign({},f),{deviceId:r.activeDeviceMap.get(C)}))}if(i instanceof MediaStreamTrack)switch(i.kind){case"audio":i=new Hy(i,f,!0,r.audioContext,{loggerName:r.roomOptions.loggerName,loggerContextCb:()=>r.logContext});break;case"video":i=new Gy(i,f,!0,{loggerName:r.roomOptions.loggerName,loggerContextCb:()=>r.logContext});break;default:throw new Kr("unsupported MediaStreamTrack kind ".concat(i.kind))}else i.updateLoggerOptions({loggerName:r.roomOptions.loggerName,loggerContextCb:()=>r.logContext});let m;if(r.trackPublications.forEach(C=>{C.track&&C.track===i&&(m=C)}),m)return r.log.warn("track has already been published, skipping",Object.assign(Object.assign({},r.logContext),Ne(m))),m;const y=Object.assign(Object.assign({},r.roomOptions.publishDefaults),s),v="channelCount"in i.mediaStreamTrack.getSettings()&&i.mediaStreamTrack.getSettings().channelCount===2||i.mediaStreamTrack.getConstraints().channelCount===2,x=(c=y.forceStereo)!==null&&c!==void 0?c:v;x&&(y.dtx===void 0&&r.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},r.logContext),Ne(i))),y.red===void 0&&r.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(d=y.dtx)!==null&&d!==void 0||(y.dtx=!1),(h=y.red)!==null&&h!==void 0||(y.red=!1)),!LY()&&r.roomOptions.e2ee&&(r.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},r.logContext)),y.simulcast=!1),y.source&&(i.source=y.source);const k=new Promise((C,A)=>D(r,void 0,void 0,function*(){try{if(this.engine.client.currentState!==at.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Ne(i)}));let T=!1;const E=setTimeout(()=>{T=!0,i.stop(),A(new CI("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(E),T)return;const _=yield this.publish(i,y,x);C(_)}else try{const T=yield this.publish(i,y,x);C(T)}catch(T){A(T)}}catch(T){A(T)}}));r.pendingPublishPromises.set(i,k);try{return yield k}catch(C){throw C}finally{r.pendingPublishPromises.delete(i)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Yi),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Ne(e))),!1;const{canPublish:t,canPublishSources:i}=this.permissions;return t&&(i.length===0||i.map(s=>_Y(s)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Ne(e))),!1)}publish(e,t,i){return D(this,void 0,void 0,function*(){var s,r,o,a,c,d,h,f,m,y;if(!this.hasPermissionsToPublish(e))throw new CI("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(L=>_u(e)&&L.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ne(e))),t.stopMicTrackOnMute&&rr(e)&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&Xl()&&(t.simulcast=!1),t.videoCodec==="av1"&&!BY()&&(t.videoCodec=void 0),t.videoCodec==="vp9"&&!DY()&&(t.videoCodec=void 0),t.videoCodec===void 0&&(t.videoCodec=Rk),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(L=>t.videoCodec===Zh(L.mime))||(t.videoCodec=Zh(this.enabledPublishVideoCodecs[0].mime)));const x=t.videoCodec;e.on(oe.Muted,this.onTrackMuted),e.on(oe.Unmuted,this.onTrackUnmuted),e.on(oe.Ended,this.handleTrackEnded),e.on(oe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(oe.UpstreamResumed,this.onTrackUpstreamResumed),e.on(oe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const k=[],C=!(!((s=t.dtx)!==null&&s!==void 0)||s),A=e.getSourceTrackSettings();A.autoGainControl&&k.push(mn.TF_AUTO_GAIN_CONTROL),A.echoCancellation&&k.push(mn.TF_ECHO_CANCELLATION),A.noiseSuppression&&k.push(mn.TF_NOISE_SUPPRESSION),A.channelCount&&A.channelCount>1&&k.push(mn.TF_STEREO),C&&k.push(mn.TF_NO_DTX),Br(e)&&e.hasPreConnectBuffer&&k.push(mn.TF_PRECONNECT_BUFFER);const T=new Df({cid:e.mediaStreamTrack.id,name:t.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:C,encryption:this.encryptionType,stereo:i,disableRed:this.isE2EEEnabled||!(!((r=t.red)!==null&&r!==void 0)||r),stream:t==null?void 0:t.stream,backupCodecPolicy:t==null?void 0:t.backupCodecPolicy,audioFeatures:k});let E;if(e.kind===Q.Kind.Video){let L={width:0,height:0};try{L=yield e.waitForDimensions()}catch{const W=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:Nf.h720.resolution;L={width:W.width,height:W.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(e)),{dims:L}))}T.width=L.width,T.height=L.height,jo(e)&&(As(x)&&(e.source===Q.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Ne(e))))),t.scalabilityMode=(c=t.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),T.simulcastCodecs=[new fk({codec:x,cid:e.mediaStreamTrack.id})],t.backupCodec===!0&&(t.backupCodec={codec:Rk}),t.backupCodec&&x!==t.backupCodec.codec&&T.encryption===sn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),T.simulcastCodecs.push(new fk({codec:t.backupCodec.codec,cid:""})))),E=Ik(e.source===Q.Source.ScreenShare,T.width,T.height,t),T.layers=$I(T.width,T.height,E,As(t.videoCodec))}else e.kind===Q.Kind.Audio&&(E=[{maxBitrate:(d=t.audioPreset)===null||d===void 0?void 0:d.maxBitrate,priority:(f=(h=t.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&f!==void 0?f:"high",networkPriority:(y=(m=t.audioPreset)===null||m===void 0?void 0:m.priority)!==null&&y!==void 0?y:"high"}]);if(!this.engine||this.engine.isClosed)throw new Ot("cannot publish track when not connected");const _=()=>D(this,void 0,void 0,function*(){var L,O,W;if(!this.engine.pcManager)throw new Ot("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,E),this.emit(de.LocalSenderCreated,e.sender,e),jo(e)&&((L=t.degradationPreference)!==null&&L!==void 0||(t.degradationPreference=GZ(e)),e.setDegradationPreference(t.degradationPreference)),E)if(Xl()&&e.kind===Q.Kind.Audio){let ie;for(const he of this.engine.pcManager.publisher.getTransceivers())if(he.sender===e.sender){ie=he;break}ie&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ie,codec:"opus",maxbr:!((O=E[0])===null||O===void 0)&&O.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&As(e.codec)&&(!((W=E[0])===null||W===void 0)&&W.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:T.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});yield this.engine.negotiate()});let R;const B=new Promise((L,O)=>D(this,void 0,void 0,function*(){var W;try{R=yield this.engine.addTrack(T),L(R)}catch(ie){e.sender&&(!((W=this.engine.pcManager)===null||W===void 0)&&W.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(he=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(e)),{error:he}))})),O(ie)}}));if(this.enabledPublishVideoCodecs.length>0)R=(yield Promise.all([B,_()]))[0];else{R=yield B;let L;if(R.codecs.forEach(O=>{L===void 0&&(L=O.mimeType)}),L&&e.kind===Q.Kind.Video){const O=Zh(L);O!==x&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(e)),{codec:O})),t.videoCodec=O,E=Ik(e.source===Q.Source.ScreenShare,T.width,T.height,t))}yield _()}const I=new Dk(e.kind,R,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(I.on(oe.CpuConstrained,L=>this.onTrackCpuConstrained(L,I)),I.options=t,e.sid=R.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:R})),jo(e)?e.startMonitor(this.engine.client):Br(e)&&e.startMonitor(),this.addTrackPublication(I),this.emit(de.LocalTrackPublished,I),Br(e)&&R.audioFeatures.includes(mn.TF_PRECONNECT_BUFFER)){const L=e.getPreConnectBuffer(),O=e.getPreConnectBufferMimeType();this.on(de.LocalTrackSubscribed,W=>{if(W.trackSid===R.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Ne(e))),e.stopPreConnectBuffer()}}),L&&new Promise((ie,he)=>D(this,void 0,void 0,function*(){var ae,le,K,ee,z,X;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Ne(e)));const Dt=setTimeout(()=>{he(new Error("agent not active within 10 seconds"))},1e4),Ye=yield this.waitUntilActiveAgentPresent();clearTimeout(Dt),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Ne(e)));const Xt=yield this.streamBytes({name:"preconnect-buffer",mimeType:O,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[Ye.identity],attributes:{trackId:I.trackSid,sampleRate:String((z=A.sampleRate)!==null&&z!==void 0?z:"48000"),channels:String((X=A.channelCount)!==null&&X!==void 0?X:"1")}});try{for(var te=!0,ye=Jr(L),_e;_e=yield ye.next(),ae=_e.done,!ae;te=!0){ee=_e.value,te=!1;const an=ee;yield Xt.write(an)}}catch(an){le={error:an}}finally{try{!te&&!ae&&(K=ye.return)&&(yield K.call(ye))}finally{if(le)throw le.error}}yield Xt.close(),ie()}catch(Dt){he(Dt)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Ne(e)))}).catch(ie=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(e)),{error:ie}))})}return I})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,i){return D(this,void 0,void 0,function*(){var s;if(this.encryptionType!==sn.NONE)return;let r;if(this.trackPublications.forEach(y=>{y.track&&y.track===e&&(r=y)}),!r)throw new Kr("track is not published");if(!jo(e))throw new Kr("track is not a video track");const o=Object.assign(Object.assign({},(s=this.roomOptions)===null||s===void 0?void 0:s.publishDefaults),i),a=zZ(e,t,o);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ne(e)));return}const c=e.addSimulcastTrack(t,a);if(!c)return;const d=new Df({cid:c.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(d.layers=$I(d.width,d.height,a),!this.engine||this.engine.isClosed)throw new Ot("cannot publish track when not connected");const h=()=>D(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,c,o,a),yield this.engine.negotiate()}),m=(yield Promise.all([this.engine.addTrack(d),h()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:m}))})}unpublishTrack(e,t){return D(this,void 0,void 0,function*(){var i,s;if(_u(e)){const d=this.pendingPublishPromises.get(e);d&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Ne(e))),yield d)}const r=this.getPublicationForTrack(e),o=r?Ne(r):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!r||!r.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=r.track,e.off(oe.Muted,this.onTrackMuted),e.off(oe.Unmuted,this.onTrackUnmuted),e.off(oe.Ended,this.handleTrackEnded),e.off(oe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(oe.UpstreamResumed,this.onTrackUpstreamResumed),e.off(oe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),t===void 0&&(t=(s=(i=this.roomOptions)===null||i===void 0?void 0:i.stopLocalTrackOnUnpublish)!==null&&s!==void 0?s:!0),t?e.stop():e.stopMonitor();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Rt.FAILED&&c)try{for(const d of this.engine.pcManager.publisher.getTransceivers())d.sender===c&&(d.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),jo(e)){for(const[,d]of e.simulcastCodecs)d.sender&&(this.engine.removeTrack(d.sender)&&(a=!0),d.sender=void 0);e.simulcastCodecs.clear()}}catch(d){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:d}))}switch(this.trackPublications.delete(r.trackSid),r.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(r.trackSid);break;case Q.Kind.Video:this.videoTrackPublications.delete(r.trackSid);break}return this.emit(de.LocalTrackUnpublished,r),r.setTrack(void 0),a&&(yield this.engine.negotiate()),r})}unpublishTracks(e){return D(this,void 0,void 0,function*(){return(yield Promise.all(e.map(i=>this.unpublishTrack(i)))).filter(i=>!!i)})}republishAllTracks(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){i.republishPromise&&(yield i.republishPromise),i.republishPromise=new ci((r,o)=>D(i,void 0,void 0,function*(){try{const a=[];this.trackPublications.forEach(c=>{c.track&&(t&&(c.options=Object.assign(Object.assign({},c.options),t)),a.push(c))}),yield Promise.all(a.map(c=>D(this,void 0,void 0,function*(){const d=c.track;yield this.unpublishTrack(d,!1),s&&!d.isMuted&&d.source!==Q.Source.ScreenShare&&d.source!==Q.Source.ScreenShareAudio&&(Br(d)||jo(d))&&!d.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:c.trackSid})),yield d.restartTrack()),yield this.publishOrRepublishTrack(d,c.options,!0)}))),r()}catch(a){a instanceof Error?o(a):o(new Error(String(a)))}finally{this.republishPromise=void 0}})),yield i.republishPromise}()})}publishData(e){return D(this,arguments,void 0,function(t){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const r=s.reliable?Pe.RELIABLE:Pe.LOSSY,o=s.destinationIdentities,a=s.topic;let c=new KT({participantIdentity:i.identity,payload:t,destinationIdentities:o,topic:a});const d=new Jn({kind:r,value:{case:"user",value:c}});yield i.engine.sendDataPacket(d,r)}()})}publishDtmf(e,t){return D(this,void 0,void 0,function*(){const i=new Jn({kind:Pe.RELIABLE,value:{case:"sipDtmf",value:new a4({code:e,digit:t})}});yield this.engine.sendDataPacket(i,Pe.RELIABLE)})}sendChatMessage(e,t){return D(this,void 0,void 0,function*(){const i={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:t==null?void 0:t.attachments},s=new Jn({value:{case:"chatMessage",value:new Ly(Object.assign(Object.assign({},i),{timestamp:gt.parse(i.timestamp)}))}});return yield this.engine.sendDataPacket(s,Pe.RELIABLE),this.emit(de.ChatMessage,i),i})}editChatMessage(e,t){return D(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),s=new Jn({value:{case:"chatMessage",value:new Ly(Object.assign(Object.assign({},i),{timestamp:gt.parse(i.timestamp),editTimestamp:gt.parse(i.editTimestamp)}))}});return yield this.engine.sendDataPacket(s,Pe.RELIABLE),this.emit(de.ChatMessage,i),i})}sendText(e,t){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return D(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:t,method:i,payload:s,responseTimeout:r=15e3}=e;const o=7e3,a=o+1e3;return new ci((c,d)=>D(this,void 0,void 0,function*(){var h,f,m,y;if(f1(s)>yj){d(Bt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((f=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||f===void 0)&&f.version&&ar((y=(m=this.engine.latestJoinResponse)===null||m===void 0?void 0:m.serverInfo)===null||y===void 0?void 0:y.version,"1.8.0")<0){d(Bt.builtIn("UNSUPPORTED_SERVER"));return}const v=Math.max(r,a),x=crypto.randomUUID();yield this.publishRpcRequest(t,x,i,s,v);const k=setTimeout(()=>{this.pendingAcks.delete(x),d(Bt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(x),clearTimeout(C)},o);this.pendingAcks.set(x,{resolve:()=>{clearTimeout(k)},participantIdentity:t});const C=setTimeout(()=>{this.pendingResponses.delete(x),d(Bt.builtIn("RESPONSE_TIMEOUT"))},r);this.pendingResponses.set(x,{resolve:(A,T)=>{clearTimeout(C),this.pendingAcks.has(x)&&(this.log.warn("RPC response received before ack",x),this.pendingAcks.delete(x),clearTimeout(k)),T?d(T):c(A??"")},participantIdentity:t})}))}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,i){const s=this.pendingResponses.get(e);s?(s.resolve(t,i),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,i,s,r){return D(this,void 0,void 0,function*(){const o=new Jn({destinationIdentities:[e],kind:Pe.RELIABLE,value:{case:"rpcRequest",value:new qT({id:t,method:i,payload:s,responseTimeoutMs:r,version:1})}});yield this.engine.sendDataPacket(o,Pe.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:i}]of this.pendingAcks)i===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:i,resolve:s}]of this.pendingResponses)i===e&&(s(null,Bt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(t=>t.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(t=>{var i,s;const r=this.trackPublications.get(t.sid);if(r){const o=r.isMuted||((s=(i=r.track)===null||i===void 0?void 0:i.isUpstreamPaused)!==null&&s!==void 0?s:!1);o!==t.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(r)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(t.sid,o))}}),!0):!1}setActiveAgent(e){var t,i,s,r;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(i=(t=this.activeAgentFuture)===null||t===void 0?void 0:t.resolve)===null||i===void 0||i.call(t,e):(r=(s=this.activeAgentFuture)===null||s===void 0?void 0:s.reject)===null||r===void 0||r.call(s,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Yi),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(i=>{const s=i.track;s&&(e instanceof MediaStreamTrack?(Br(s)||jo(s))&&s.mediaStreamTrack===e&&(t=i):e===s&&(t=i))}),t}waitForPendingPublicationOfSource(e){return D(this,void 0,void 0,function*(){const i=Date.now();for(;Date.now()<i+1e4;){const s=Array.from(this.pendingPublishPromises.entries()).find(r=>{let[o]=r;return o.source===e});if(s)return s[1];yield wn(20)}})}}class d2 extends Lr{constructor(e,t,i,s){super(e,t.sid,t.name,s),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=r=>{this.setTrack(void 0),this.emit(oe.Ended,r)},this.handleVisibilityChange=r=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(r),this.logContext),this.visible=r,this.emitTrackUpdate()},this.handleVideoDimensionsChange=r=>{this.log.debug("adaptivestream video dimensions ".concat(r.width,"x").concat(r.height),this.logContext),this.videoDimensionsAdaptiveStream=r,this.emitTrackUpdate()},this.subscribed=i,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,i=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const s=new Bv({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new c4({participantSid:"",trackSids:[this.trackSid]})]});this.emit(oe.UpdateSubscription,s),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(i)}get subscriptionStatus(){return this.subscribed===!1?Lr.SubscriptionStatus.Unsubscribed:super.isSubscribed?Lr.SubscriptionStatus.Subscribed:Lr.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Lr.PermissionStatus.Allowed:Lr.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,i;this.isManualOperationAllowed()&&(((t=this.requestedVideoDimensions)===null||t===void 0?void 0:t.width)===e.width&&((i=this.requestedVideoDimensions)===null||i===void 0?void 0:i.height)===e.height||(Fx(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Fx(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:Pi.HIGH}setTrack(e){const t=this.subscriptionStatus,i=this.permissionStatus,s=this.track;s!==e&&(s&&(s.off(oe.VideoDimensionsChanged,this.handleVideoDimensionsChange),s.off(oe.VisibilityChanged,this.handleVisibilityChange),s.off(oe.Ended,this.handleEnded),s.detach(),s.stopMonitor(),this.emit(oe.Unsubscribed,s)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(oe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(oe.VisibilityChanged,this.handleVisibilityChange),e.on(oe.Ended,this.handleEnded),this.emit(oe.Subscribed,e)),this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,i=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(oe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?oe.Muted:oe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(oe.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(oe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Fx(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new v4({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Q.Kind.Video){let t=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(t)TI(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const i=MY(this.trackInfo,this.requestedMaxQuality);i&&TI(this.videoDimensionsAdaptiveStream,i)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:Pi.HIGH})),e.quality=Pi.HIGH)}this.emit(oe.UpdateSettings,e)}}class Wy extends Tj{static fromParticipantInfo(e,t,i){return new Wy(e,t.sid,t.identity,t.name,t.metadata,t.attributes,i,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,i,s,r,o,a){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Bf.STANDARD;super(t,i||"",s,r,o,a,c),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(oe.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Ne(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(oe.UpdateSubscription,t=>{t.participantTracks.forEach(i=>{i.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(t)}),e.on(oe.SubscriptionPermissionChanged,t=>{this.emit(de.TrackSubscriptionPermissionChanged,e,t)}),e.on(oe.SubscriptionStatusChanged,t=>{this.emit(de.TrackSubscriptionStatusChanged,e,t)}),e.on(oe.Subscribed,t=>{this.emit(de.TrackSubscribed,t,e)}),e.on(oe.Unsubscribed,t=>{this.emit(de.TrackUnsubscribed,t,e)}),e.on(oe.SubscriptionFailed,t=>{this.emit(de.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(t,e);const i=this.getTrackPublication(t);i&&i.track&&i.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,i,s,r,o){let a=this.getTrackPublicationBySid(t);if(a||t.startsWith("TR")||this.trackPublications.forEach(h=>{!a&&e.kind===h.kind.toString()&&(a=h)}),!a){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),this.emit(de.TrackSubscriptionFailed,t);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,t,i,s,r,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ne(a))),this.emit(de.TrackSubscriptionFailed,t);return}const c=e.kind==="video";let d;return c?d=new r2(e,t,s,r):d=new s2(e,t,s,this.audioContext,this.audioOutput),d.source=a.source,d.isMuted=a.isMuted,d.setMediaStream(i),d.start(),a.setTrack(d),this.volumeMap.has(a.source)&&_k(d)&&rr(d)&&d.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,i=new Map;return e.tracks.forEach(s=>{var r,o;let a=this.getTrackPublicationBySid(s.sid);if(a)a.updateInfo(s);else{const c=Q.kindFromProto(s.type);if(!c)return;a=new d2(c,s,(r=this.signalClient.connectOptions)===null||r===void 0?void 0:r.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),a.updateInfo(s),i.set(s.sid,a);const d=Array.from(this.trackPublications.values()).find(h=>h.source===(a==null?void 0:a.source));d&&a.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ne(d),newTrack:Ne(a)})),this.addTrackPublication(a)}t.set(s.sid,a)}),this.trackPublications.forEach(s=>{t.has(s.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ne(s))),this.unpublishTrack(s.trackSid,!0))}),i.forEach(s=>{this.emit(de.TrackPublished,s)}),!0}unpublishTrack(e,t){const i=this.trackPublications.get(e);if(!i)return;const{track:s}=i;switch(s&&(s.stop(),i.setTrack(void 0)),this.trackPublications.delete(e),i.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(e);break;case Q.Kind.Video:this.videoTrackPublications.delete(e);break}t&&this.emit(de.TrackUnpublished,i)}setAudioOutput(e){return D(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(i=>{var s;rr(i.track)&&_k(i.track)&&t.push(i.track.setSinkId((s=e.deviceId)!==null&&s!==void 0?s:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:i})),super.emit(e,...i)}}var Qe;(function(n){n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n.Reconnecting="reconnecting",n.SignalReconnecting="signalReconnecting"})(Qe||(Qe={}));const h2=4*1e3;class rd extends lr.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var t,i,s,r,o;if(super(),t=this,this.state=Qe.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Me,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(a,c,d)=>D(this,void 0,void 0,function*(){var h;if(!NY())throw or()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const f=yield this.disconnectLock.lock();if(this.state===Qe.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),f(),Promise.resolve();if(this.connectFuture)return f(),this.connectFuture.promise;this.setAndEmitConnectionState(Qe.Connecting),((h=this.regionUrlProvider)===null||h===void 0?void 0:h.getServerUrl().toString())!==fj(a)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),sd(new URL(a))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Ge(a,c):this.regionUrlProvider.updateToken(c),this.regionUrlProvider.fetchRegionSettings().then(v=>{var x;(x=this.regionUrlProvider)===null||x===void 0||x.setServerReportedRegions(v)}).catch(v=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:v}))}));const m=(v,x,k)=>D(this,void 0,void 0,function*(){var C,A;this.abortController&&this.abortController.abort();const T=new AbortController;this.abortController=T,f==null||f();try{if(yield Mu.getInstance().getBackOffPromise(a),T.signal.aborted)throw Se.cancelled("Connection attempt aborted");yield this.attemptConnection(k??a,c,d,T),this.abortController=void 0,v()}catch(E){if(this.regionUrlProvider&&E instanceof Se&&E.reason!==lt.Cancelled&&E.reason!==lt.NotAllowed){let _=null;try{this.log.debug("Fetching next region"),_=yield this.regionUrlProvider.getNextBestRegionUrl((C=this.abortController)===null||C===void 0?void 0:C.signal)}catch(R){if(R instanceof Se&&(R.status===401||R.reason===lt.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),x(R);return}}[lt.InternalError,lt.ServerUnreachable,lt.Timeout].includes(E.reason)&&(this.log.debug("Adding failed connection attempt to back off"),Mu.getInstance().addFailedConnectionAttempt(a)),_&&!(!((A=this.abortController)===null||A===void 0)&&A.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(E.message,". Retrying with another region: ").concat(_),this.logContext),this.recreateEngine(),yield m(v,x,_)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,II(E)),x(E))}else{let _=Rs.UNKNOWN_REASON;E instanceof Se&&(_=II(E)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,_),x(E)}}}),y=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Yi((v,x)=>{m(v,x,y)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(a,c,d,h,f,m)=>D(this,void 0,void 0,function*(){var y,v,x;const k=yield d.join(a,c,{autoSubscribe:h.autoSubscribe,adaptiveStream:typeof f.adaptiveStream=="object"?!0:f.adaptiveStream,maxRetries:h.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:h.websocketTimeout},m.signal,!f.singlePeerConnection);let C=k.serverInfo;if(C||(C={version:k.serverVersion,region:k.serverRegion}),this.serverInfo=C,this.log.debug("connected to Livekit Server ".concat(Object.entries(C).map(A=>{let[T,E]=A;return"".concat(T,": ").concat(E)}).join(", ")),{room:(y=k.room)===null||y===void 0?void 0:y.name,roomSid:(v=k.room)===null||v===void 0?void 0:v.sid,identity:(x=k.participant)===null||x===void 0?void 0:x.identity}),!C.version)throw new yY("unknown server version");return C.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),f.dynacast=!1),k}),this.applyJoinResponse=a=>{const c=a.participant;if(this.localParticipant.sid=c.sid,this.localParticipant.identity=c.identity,this.localParticipant.setEnabledPublishCodecs(a.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(a.sifTrailer)}catch(d){this.log.error(d instanceof Error?d.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:d}))}this.handleParticipantUpdates([c,...a.otherParticipants]),a.room&&this.handleRoomUpdate(a.room)},this.attemptConnection=(a,c,d,h)=>D(this,void 0,void 0,function*(){var f,m;this.state===Qe.Reconnecting||this.isResuming||!((f=this.engine)===null||f===void 0)&&f.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((m=this.regionUrlProvider)===null||m===void 0)&&m.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},h1),d),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const y=yield this.connectSignal(a,c,this.engine,this.connOptions,this.options,h);this.applyJoinResponse(y),this.setupLocalParticipantEvents(),this.emit(Z.SignalConnected)}catch(y){yield this.engine.close(),this.recreateEngine();const v=h.signal.aborted?Se.cancelled("Signal connection aborted"):Se.serverUnreachable("could not establish signal connection");throw y instanceof Error&&(v.message="".concat(v.message,": ").concat(y.message)),y instanceof Se&&(v.reason=y.reason,v.status=y.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:y})),v}if(h.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),Se.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,h)}catch(y){throw yield this.engine.close(),this.recreateEngine(),y}ui()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),ui()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Qe.Connected),this.emit(Z.Connected),Mu.getInstance().resetFailedConnectionAttempts(a),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return D(t,[...c],void 0,function(){var h=this;let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var m,y,v;const x=yield h.disconnectLock.lock();try{if(h.state===Qe.Disconnected){h.log.debug("already disconnected",h.logContext);return}if(h.log.info("disconnect from room",Object.assign({},h.logContext)),h.state===Qe.Connecting||h.state===Qe.Reconnecting||h.isResuming){const k="Abort connection attempt due to user initiated disconnect";h.log.warn(k,h.logContext),(m=h.abortController)===null||m===void 0||m.abort(k),(v=(y=h.connectFuture)===null||y===void 0?void 0:y.reject)===null||v===void 0||v.call(y,Se.cancelled("Client initiated disconnect")),h.connectFuture=void 0}h.engine&&(h.engine.client.isDisconnected||(yield h.engine.client.sendLeave()),yield h.engine.close()),h.handleDisconnect(f,Rs.CLIENT_INITIATED),h.engine=void 0}finally{x()}}()})},this.onPageLeave=()=>D(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>D(this,void 0,void 0,function*(){const a=[],c=yi();if(c&&c.os==="iOS"){const d="livekit-dummy-audio-el";let h=document.getElementById(d);if(!h){h=document.createElement("audio"),h.id=d,h.autoplay=!0,h.hidden=!0;const f=Nx();f.enabled=!0;const m=new MediaStream([f]);h.srcObject=m,document.addEventListener("visibilitychange",()=>{h&&(h.srcObject=document.hidden?null:m,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(h),this.once(Z.Disconnected,()=>{h==null||h.remove(),h=null})}a.push(h)}this.remoteParticipants.forEach(d=>{d.audioTrackPublications.forEach(h=>{h.track&&h.track.attachedElements.forEach(f=>{a.push(f)})})});try{yield Promise.all([this.acquireAudioContext(),...a.map(d=>(d.muted=!1,d.play()))]),this.handleAudioPlaybackStarted()}catch(d){throw this.handleAudioPlaybackFailed(d),d}}),this.startVideo=()=>D(this,void 0,void 0,function*(){const a=[];for(const c of this.remoteParticipants.values())c.videoTrackPublications.forEach(d=>{var h;(h=d.track)===null||h===void 0||h.attachedElements.forEach(f=>{a.includes(f)||a.push(f)})});yield Promise.all(a.map(c=>c.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(c=>{c.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const a of this.remoteParticipants.values())this.handleParticipantDisconnected(a.identity,a);this.setAndEmitConnectionState(Qe.Reconnecting)&&this.emit(Z.Reconnecting)},this.handleSignalRestarted=a=>D(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(a.serverRegion),Object.assign(Object.assign({},this.logContext),{region:a.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(a);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(c){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:c}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:a.serverRegion}))}catch{return}this.setAndEmitConnectionState(Qe.Connected),this.emit(Z.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=a=>{a.forEach(c=>{var d;if(c.identity===this.localParticipant.identity){this.localParticipant.updateInfo(c);return}c.identity===""&&(c.identity=(d=this.sidToIdentity.get(c.sid))!==null&&d!==void 0?d:"");let h=this.remoteParticipants.get(c.identity);c.state===ku.DISCONNECTED?this.handleParticipantDisconnected(c.identity,h):h=this.getOrCreateParticipant(c.identity,c)})},this.handleActiveSpeakersUpdate=a=>{const c=[],d={};a.forEach(h=>{if(d[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),c.push(this.localParticipant);else{const f=this.getRemoteParticipantBySid(h.sid);f&&(f.audioLevel=h.level,f.setIsSpeaking(!0),c.push(f))}}),d[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(h=>{d[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=c,this.emitWhenConnected(Z.ActiveSpeakersChanged,c)},this.handleSpeakersChanged=a=>{const c=new Map;this.activeSpeakers.forEach(h=>{const f=this.remoteParticipants.get(h.identity);f&&f.sid!==h.sid||c.set(h.sid,h)}),a.forEach(h=>{let f=this.getRemoteParticipantBySid(h.sid);h.sid===this.localParticipant.sid&&(f=this.localParticipant),f&&(f.audioLevel=h.level,f.setIsSpeaking(h.active),h.active?c.set(h.sid,f):c.delete(h.sid))});const d=Array.from(c.values());d.sort((h,f)=>f.audioLevel-h.audioLevel),this.activeSpeakers=d,this.emitWhenConnected(Z.ActiveSpeakersChanged,d)},this.handleStreamStateUpdate=a=>{a.streamStates.forEach(c=>{const d=this.getRemoteParticipantBySid(c.participantSid);if(!d)return;const h=d.getTrackPublicationBySid(c.trackSid);if(!h||!h.track)return;const f=Q.streamStateFromProto(c.state);h.track.setStreamState(f),f!==h.track.streamState&&(d.emit(de.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(Z.TrackStreamStateChanged,h,h.track.streamState,d))})},this.handleSubscriptionPermissionUpdate=a=>{const c=this.getRemoteParticipantBySid(a.participantSid);if(!c)return;const d=c.getTrackPublicationBySid(a.trackSid);d&&d.setAllowed(a.allowed)},this.handleSubscriptionError=a=>{const c=Array.from(this.remoteParticipants.values()).find(h=>h.trackPublications.has(a.trackSid));if(!c)return;const d=c.getTrackPublicationBySid(a.trackSid);d&&d.setSubscriptionError(a.err)},this.handleDataPacket=(a,c)=>{const d=this.remoteParticipants.get(a.participantIdentity);if(a.value.case==="user")this.handleUserPacket(d,a.value.value,a.kind,c);else if(a.value.case==="transcription")this.handleTranscription(d,a.value.value);else if(a.value.case==="sipDtmf")this.handleSipDtmf(d,a.value.value);else if(a.value.case==="chatMessage")this.handleChatMessage(d,a.value.value);else if(a.value.case==="metrics")this.handleMetrics(a.value.value,d);else if(a.value.case==="streamHeader"||a.value.case==="streamChunk"||a.value.case==="streamTrailer")this.handleDataStream(a,c);else if(a.value.case==="rpcRequest"){const h=a.value.value;this.handleIncomingRpcRequest(a.participantIdentity,h.id,h.method,h.payload,h.responseTimeoutMs,h.version)}},this.handleUserPacket=(a,c,d,h)=>{this.emit(Z.DataReceived,c.payload,a,d,c.topic,h),a==null||a.emit(de.DataReceived,c.payload,d,h)},this.handleSipDtmf=(a,c)=>{this.emit(Z.SipDTMFReceived,c,a),a==null||a.emit(de.SipDTMFReceived,c)},this.handleTranscription=(a,c)=>{const d=c.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(c.transcribedParticipantIdentity),h=d==null?void 0:d.trackPublications.get(c.trackId),f=GY(c,this.transcriptionReceivedTimes);h==null||h.emit(oe.TranscriptionReceived,f),d==null||d.emit(de.TranscriptionReceived,f,h),this.emit(Z.TranscriptionReceived,f,d,h)},this.handleChatMessage=(a,c)=>{const d=WY(c);this.emit(Z.ChatMessage,d,a)},this.handleMetrics=(a,c)=>{this.emit(Z.MetricsReceived,a,c)},this.handleDataStream=(a,c)=>{this.incomingDataStreamManager.handleDataStreamPacket(a,c)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Z.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=a=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:a})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Z.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Z.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Z.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>D(this,void 0,void 0,function*(){var a;((a=yi())===null||a===void 0?void 0:a.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(Z.MediaDevicesChanged)}),this.handleRoomUpdate=a=>{const c=this.roomInfo;this.roomInfo=a,c&&c.metadata!==a.metadata&&this.emitWhenConnected(Z.RoomMetadataChanged,a.metadata),(c==null?void 0:c.activeRecording)!==a.activeRecording&&this.emitWhenConnected(Z.RecordingStatusChanged,a.activeRecording)},this.handleConnectionQualityUpdate=a=>{a.updates.forEach(c=>{if(c.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(c.quality);return}const d=this.getRemoteParticipantBySid(c.participantSid);d&&d.setConnectionQuality(c.quality)})},this.onLocalParticipantMetadataChanged=a=>{this.emit(Z.ParticipantMetadataChanged,a,this.localParticipant)},this.onLocalParticipantNameChanged=a=>{this.emit(Z.ParticipantNameChanged,a,this.localParticipant)},this.onLocalAttributesChanged=a=>{this.emit(Z.ParticipantAttributesChanged,a,this.localParticipant)},this.onLocalTrackMuted=a=>{this.emit(Z.TrackMuted,a,this.localParticipant)},this.onLocalTrackUnmuted=a=>{this.emit(Z.TrackUnmuted,a,this.localParticipant)},this.onTrackProcessorUpdate=a=>{var c;(c=a==null?void 0:a.onPublish)===null||c===void 0||c.call(a,this)},this.onLocalTrackPublished=a=>D(this,void 0,void 0,function*(){var c,d,h,f,m,y;(c=a.track)===null||c===void 0||c.on(oe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=a.track)===null||d===void 0||d.on(oe.Restarted,this.onLocalTrackRestarted),(m=(f=(h=a.track)===null||h===void 0?void 0:h.getProcessor())===null||f===void 0?void 0:f.onPublish)===null||m===void 0||m.call(f,this),this.emit(Z.LocalTrackPublished,a,this.localParticipant),Br(a.track)&&(yield a.track.checkForSilence())&&this.emit(Z.LocalAudioSilenceDetected,a);const v=yield(y=a.track)===null||y===void 0?void 0:y.getDeviceId(!1),x=wk(a.source);x&&v&&v!==this.localParticipant.activeDeviceMap.get(x)&&(this.localParticipant.activeDeviceMap.set(x,v),this.emit(Z.ActiveDeviceChanged,x,v))}),this.onLocalTrackUnpublished=a=>{var c,d;(c=a.track)===null||c===void 0||c.off(oe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=a.track)===null||d===void 0||d.off(oe.Restarted,this.onLocalTrackRestarted),this.emit(Z.LocalTrackUnpublished,a,this.localParticipant)},this.onLocalTrackRestarted=a=>D(this,void 0,void 0,function*(){const c=yield a.getDeviceId(!1),d=wk(a.source);d&&c&&c!==this.localParticipant.activeDeviceMap.get(d)&&(this.log.debug("local track restarted, setting ".concat(d," ").concat(c," active"),this.logContext),this.localParticipant.activeDeviceMap.set(d,c),this.emit(Z.ActiveDeviceChanged,d,c))}),this.onLocalConnectionQualityChanged=a=>{this.emit(Z.ConnectionQualityChanged,a,this.localParticipant)},this.onMediaDevicesError=(a,c)=>{this.emit(Z.MediaDevicesError,a,c)},this.onLocalParticipantPermissionsChanged=a=>{this.emit(Z.ParticipantPermissionsChanged,a,this.localParticipant)},this.onLocalChatMessageSent=a=>{this.emit(Z.ChatMessage,a,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},wZ),e),this.log=uo((i=this.options.loggerName)!==null&&i!==void 0?i:js.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},pj),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},mj),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},kZ),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new e2,this.outgoingDataStreamManager=new i2(this.engine,this.log),this.disconnectLock=new $n,this.localParticipant=new u2("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Aa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Aa(this.options.audioCaptureDefaults.deviceId)),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&this.switchActiveDevice("audiooutput",Aa(this.options.audioOutput.deviceId)).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),ui()){const a=new AbortController;(o=(r=navigator.mediaDevices)===null||r===void 0?void 0:r.addEventListener)===null||o===void 0||o.call(r,"devicechange",this.handleDeviceChange,{signal:a.signal}),rd.cleanupRegistry&&rd.cleanupRegistry.register(this,()=>{a.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return D(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const t=!!this.options.encryption,i=this.options.encryption||this.options.e2ee;i&&("e2eeManager"in i?(this.e2eeManager=i.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new oZ(i,t),this.e2eeManager.on(ma.ParticipantEncryptionStatusChanged,(s,r)=>{KY(r)&&(this.isE2EEEnabled=s),this.emit(Z.ParticipantEncryptionStatusChanged,s,r)}),this.e2eeManager.on(ma.EncryptionError,(s,r)=>{const o=r?this.getParticipantByIdentity(r):void 0;this.emit(Z.EncryptionError,s,o)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&t!==void 0?t:!1}getSid(){return this.state===Qe.Disconnected?ci.resolve(""):this.roomInfo&&this.roomInfo.sid!==""?ci.resolve(this.roomInfo.sid):new ci((e,t)=>{const i=s=>{s.sid!==""&&(this.engine.off(ce.RoomUpdate,i),e(s.sid))};this.engine.on(ce.RoomUpdate,i),this.once(Z.Disconnected,()=>{this.engine.off(ce.RoomUpdate,i),t(new Ot("Room disconnected before room server id was available"))})})}get name(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&t!==void 0?t:0}get numPublishers(){var e,t;return(t=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&t!==void 0?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new $Z(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(ce.ParticipantUpdate,this.handleParticipantUpdates).on(ce.RoomUpdate,this.handleRoomUpdate).on(ce.SpeakersChanged,this.handleSpeakersChanged).on(ce.StreamStateChanged,this.handleStreamStateUpdate).on(ce.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ce.SubscriptionError,this.handleSubscriptionError).on(ce.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ce.MediaTrackAdded,(e,t,i)=>{this.onTrackAdded(e,t,i)}).on(ce.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ce.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ce.DataPacketReceived,this.handleDataPacket).on(ce.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Qe.SignalReconnecting)&&this.emit(Z.SignalReconnecting)}).on(ce.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Qe.Connected)&&this.emit(Z.Reconnected)}).on(ce.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Qe.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(ce.Restarting,this.handleRestarting).on(ce.SignalRestarted,this.handleSignalRestarted).on(ce.Offline,()=>{this.setAndEmitConnectionState(Qe.Reconnecting)&&this.emit(Z.Reconnecting)}).on(ce.DCBufferStatusChanged,(e,t)=>{this.emit(Z.DCBufferStatusChanged,e,t)}).on(ce.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(i=>{let{trackSid:s}=i;return s===e});if(!t){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(de.LocalTrackSubscribed,t),this.emitWhenConnected(Z.LocalTrackSubscribed,t,this.localParticipant)}).on(ce.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((t,i)=>{this.handleParticipantDisconnected(i,t)}),this.emit(Z.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return gn.getInstance().getDevices(e,t)}prepareConnection(e,t){return D(this,void 0,void 0,function*(){if(this.state===Qe.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(sd(new URL(e))&&t){this.regionUrlProvider=new Ge(e,t);const i=yield this.regionUrlProvider.getNextBestRegionUrl();i&&this.state===Qe.Disconnected&&(this.regionUrl=i,yield fetch(Of(i),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(i),this.logContext))}else yield fetch(Of(e),{method:"HEAD"})}catch(i){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:i}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return D(this,void 0,void 0,function*(){let i=()=>D(this,void 0,void 0,function*(){}),s;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":s=new Qs({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":s=new Qs({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":s=new Qs({scenario:{case:"serverLeave",value:!0}});break;case"migration":s=new Qs({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>D(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),s=new Qs({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>D(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),s=new Qs({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":s=new Qs({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),i=()=>D(this,void 0,void 0,function*(){const r=this.engine.client.onLeave;r&&r(new Dv({reason:Rs.CLIENT_INITIATED,action:wu.RECONNECT}))});break;case"subscriber-bandwidth":if(t===void 0||typeof t!="number")throw new Error("subscriber-bandwidth requires a number as argument");s=new Qs({scenario:{case:"subscriberBandwidth",value:gl(t)}});break;case"leave-full-reconnect":s=new Qs({scenario:{case:"leaveRequestFullReconnect",value:!0}})}s&&(yield this.engine.client.sendSimulateScenario(s),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return D(this,arguments,void 0,function(i,s){var r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var a,c,d,h,f,m,y;let v=!0,x=!1;const k=o?{exact:s}:s;if(i==="audioinput"){x=r.localParticipant.audioTrackPublications.size===0;const C=(a=r.getActiveDevice(i))!==null&&a!==void 0?a:r.options.audioCaptureDefaults.deviceId;r.options.audioCaptureDefaults.deviceId=k;const A=Array.from(r.localParticipant.audioTrackPublications.values()).filter(E=>E.source===Q.Source.Microphone);try{v=(yield Promise.all(A.map(E=>{var _;return(_=E.audioTrack)===null||_===void 0?void 0:_.setDeviceId(k)}))).every(E=>E===!0)}catch(E){throw r.options.audioCaptureDefaults.deviceId=C,E}const T=A.some(E=>{var _,R;return(R=(_=E.track)===null||_===void 0?void 0:_.isMuted)!==null&&R!==void 0?R:!1});v&&T&&(x=!0)}else if(i==="videoinput"){x=r.localParticipant.videoTrackPublications.size===0;const C=(c=r.getActiveDevice(i))!==null&&c!==void 0?c:r.options.videoCaptureDefaults.deviceId;r.options.videoCaptureDefaults.deviceId=k;const A=Array.from(r.localParticipant.videoTrackPublications.values()).filter(E=>E.source===Q.Source.Camera);try{v=(yield Promise.all(A.map(E=>{var _;return(_=E.videoTrack)===null||_===void 0?void 0:_.setDeviceId(k)}))).every(E=>E===!0)}catch(E){throw r.options.videoCaptureDefaults.deviceId=C,E}const T=A.some(E=>{var _,R;return(R=(_=E.track)===null||_===void 0?void 0:_.isMuted)!==null&&R!==void 0?R:!1});v&&T&&(x=!0)}else if(i==="audiooutput"){if(x=!0,!Ek()&&!r.options.webAudioMix||r.options.webAudioMix&&r.audioContext&&!("setSinkId"in r.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");r.options.webAudioMix&&(s=(d=yield gn.getInstance().normalizeDeviceId("audiooutput",s))!==null&&d!==void 0?d:""),(h=(y=r.options).audioOutput)!==null&&h!==void 0||(y.audioOutput={});const C=(f=r.getActiveDevice(i))!==null&&f!==void 0?f:r.options.audioOutput.deviceId;r.options.audioOutput.deviceId=s;try{r.options.webAudioMix&&((m=r.audioContext)===null||m===void 0||m.setSinkId(s)),yield Promise.all(Array.from(r.remoteParticipants.values()).map(A=>A.setAudioOutput({deviceId:s})))}catch(A){throw r.options.audioOutput.deviceId=C,A}}return x&&(r.localParticipant.activeDeviceMap.set(i,s),r.emit(Z.ActiveDeviceChanged,i,s)),v}()})}setupLocalParticipantEvents(){this.localParticipant.on(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(de.AttributesChanged,this.onLocalAttributesChanged).on(de.TrackMuted,this.onLocalTrackMuted).on(de.TrackUnmuted,this.onLocalTrackUnmuted).on(de.LocalTrackPublished,this.onLocalTrackPublished).on(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(de.MediaDevicesError,this.onMediaDevicesError).on(de.AudioStreamAcquired,this.startAudio).on(de.ChatMessage,this.onLocalChatMessageSent).on(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,i){if(this.state===Qe.Connecting||this.state===Qe.Reconnecting){const f=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(y=>y.id)}),this.onTrackAdded(e,t,i),m()},m=()=>{this.off(Z.Reconnected,f),this.off(Z.Connected,f),this.off(Z.Disconnected,m)};this.once(Z.Reconnected,f),this.once(Z.Connected,f),this.once(Z.Disconnected,m);return}if(this.state===Qe.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const s=IY(t.id),r=s[0];let o=s[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),r===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=Array.from(this.remoteParticipants.values()).find(f=>f.sid===r);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);return}if(!a.startsWith("TR")){const f=this.engine.getTrackIdForReceiver(i);if(!f){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(r),this.logContext);return}a=f}a.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(r,", streamId: ").concat(o,", trackId: ").concat(a),Object.assign(Object.assign({},this.logContext),{rpID:r,streamId:o,trackId:a}));let d;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?d=this.options.adaptiveStream:d={});const h=c.addSubscribedMediaTrack(e,a,t,i,d);h!=null&&h.isEncrypted&&!this.e2eeManager&&this.emit(Z.EncryptionError,new Error("Encrypted ".concat(h.source," track received from participant ").concat(c.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;var i,s;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Qe.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(r=>{r.trackPublications.forEach(o=>{r.unpublishTrack(o.trackSid)})}),this.localParticipant.trackPublications.forEach(r=>{var o,a,c;r.track&&this.localParticipant.unpublishTrack(r.track,e),e?((o=r.track)===null||o===void 0||o.detach(),(a=r.track)===null||a===void 0||a.stop()):(c=r.track)===null||c===void 0||c.stopMonitor()}),this.localParticipant.off(de.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(de.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(de.AttributesChanged,this.onLocalAttributesChanged).off(de.TrackMuted,this.onLocalTrackMuted).off(de.TrackUnmuted,this.onLocalTrackUnmuted).off(de.LocalTrackPublished,this.onLocalTrackPublished).off(de.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(de.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(de.MediaDevicesError,this.onMediaDevicesError).off(de.AudioStreamAcquired,this.startAudio).off(de.ChatMessage,this.onLocalChatMessageSent).off(de.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),ui()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(s=(i=navigator.mediaDevices)===null||i===void 0?void 0:i.removeEventListener)===null||s===void 0||s.call(i,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Qe.Disconnected),this.emit(Z.Disconnected,t)}}}handleParticipantDisconnected(e,t){var i;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(s=>{t.unpublishTrack(s.trackSid,!0)}),this.emit(Z.ParticipantDisconnected,t),t.setDisconnected(),(i=this.localParticipant)===null||i===void 0||i.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,i,s,r,o){return D(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),o!==1){yield this.engine.publishRpcResponse(e,t,null,Bt.builtIn("UNSUPPORTED_VERSION"));return}const a=this.rpcHandlers.get(i);if(!a){yield this.engine.publishRpcResponse(e,t,null,Bt.builtIn("UNSUPPORTED_METHOD"));return}let c=null,d=null;try{const h=yield a({requestId:t,callerIdentity:e,payload:s,responseTimeout:r});f1(h)>yj?(c=Bt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(i))):d=h}catch(h){h instanceof Bt?c=h:(this.log.warn("Uncaught error returned by RPC handler for ".concat(i,". Returning APPLICATION_ERROR instead."),h),c=Bt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,d,c)})}selectDefaultDevices(){return D(this,void 0,void 0,function*(){var e,t,i;const s=gn.getInstance().previousDevices,r=yield gn.getInstance().getDevices(void 0,!1),o=yi();if((o==null?void 0:o.name)==="Chrome"&&o.os!=="iOS")for(let c of r){const d=s.find(h=>h.deviceId===c.deviceId);d&&d.label!==""&&d.kind===c.kind&&d.label!==c.label&&this.getActiveDevice(c.kind)==="default"&&this.emit(Z.ActiveDeviceChanged,c.kind,c.deviceId)}const a=["audiooutput","audioinput","videoinput"];for(let c of a){const d=kY(c),h=this.localParticipant.getTrackPublication(d);if(h&&(!((e=h.track)===null||e===void 0)&&e.isUserProvided))continue;const f=r.filter(y=>y.kind===c),m=this.getActiveDevice(c);if(m===((t=s.filter(y=>y.kind===c)[0])===null||t===void 0?void 0:t.deviceId)&&f.length>0&&((i=f[0])===null||i===void 0?void 0:i.deviceId)!==m){yield this.switchActiveDevice(c,f[0].deviceId);continue}c==="audioinput"&&!Ff()||c==="videoinput"||f.length>0&&!f.find(y=>y.deviceId===this.getActiveDevice(c))&&(c!=="audiooutput"||!Ff())&&(yield this.switchActiveDevice(c,f[0].deviceId))}})}acquireAudioContext(){return D(this,void 0,void 0,function*(){var e,t;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=lj())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(s=>s.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),wn(200)])}catch(s){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:s}))}const i=((t=this.audioContext)===null||t===void 0?void 0:t.state)==="running";i!==this.canPlaybackAudio&&(this.audioEnabled=i,this.emit(Z.AudioPlaybackStatusChanged,i))})}createParticipant(e,t){var i;let s;return t?s=Wy.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):s=new Wy(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&s.setAudioContext(this.audioContext),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&s.setAudioOutput(this.options.audioOutput).catch(r=>this.log.warn("Could not set audio output: ".concat(r.message),this.logContext)),s}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const s=this.remoteParticipants.get(e);return t&&s.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),s}const i=this.createParticipant(e,t);return this.remoteParticipants.set(e,i),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Z.ParticipantConnected,i),i.on(de.TrackPublished,s=>{this.emitWhenConnected(Z.TrackPublished,s,i)}).on(de.TrackSubscribed,(s,r)=>{s.kind===Q.Kind.Audio?(s.on(oe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),s.on(oe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):s.kind===Q.Kind.Video&&(s.on(oe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),s.on(oe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Z.TrackSubscribed,s,r,i)}).on(de.TrackUnpublished,s=>{this.emit(Z.TrackUnpublished,s,i)}).on(de.TrackUnsubscribed,(s,r)=>{this.emit(Z.TrackUnsubscribed,s,r,i)}).on(de.TrackMuted,s=>{this.emitWhenConnected(Z.TrackMuted,s,i)}).on(de.TrackUnmuted,s=>{this.emitWhenConnected(Z.TrackUnmuted,s,i)}).on(de.ParticipantMetadataChanged,s=>{this.emitWhenConnected(Z.ParticipantMetadataChanged,s,i)}).on(de.ParticipantNameChanged,s=>{this.emitWhenConnected(Z.ParticipantNameChanged,s,i)}).on(de.AttributesChanged,s=>{this.emitWhenConnected(Z.ParticipantAttributesChanged,s,i)}).on(de.ConnectionQualityChanged,s=>{this.emitWhenConnected(Z.ConnectionQualityChanged,s,i)}).on(de.ParticipantPermissionsChanged,s=>{this.emitWhenConnected(Z.ParticipantPermissionsChanged,s,i)}).on(de.TrackSubscriptionStatusChanged,(s,r)=>{this.emitWhenConnected(Z.TrackSubscriptionStatusChanged,s,r,i)}).on(de.TrackSubscriptionFailed,(s,r)=>{this.emit(Z.TrackSubscriptionFailed,s,i,r)}).on(de.TrackSubscriptionPermissionChanged,(s,r)=>{this.emitWhenConnected(Z.TrackSubscriptionPermissionChanged,s,r,i)}).on(de.Active,()=>{this.emitWhenConnected(Z.ParticipantActive,i),i.kind===Bf.AGENT&&this.localParticipant.setActiveAgent(i)}),t&&i.updateInfo(t),i}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((i,s)=>(i.push(...s.getTrackPublications()),i),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&JY(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=kn.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Rs.STATE_MISMATCH))):e=0},h2)}clearConnectionReconcile(){this.connectionReconcileInterval&&kn.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Z.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,i]=e;this.emit(t,...i)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];if(this.state===Qe.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,i]);else if(this.state===Qe.Connected)return this.emit(e,...i);return!1}simulateParticipants(e){return D(this,void 0,void 0,function*(){var t,i,s,r;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Rv({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:gt.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new $l({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Z.SignalConnected),this.emit(Z.Connected),this.setAndEmitConnectionState(Qe.Connected),o.video){const c=new Dk(Q.Kind.Video,new hu({source:qt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ws.AUDIO,name:"video-dummy"}),new Gy(o.useRealTracks&&(!((t=window.navigator.mediaDevices)===null||t===void 0)&&t.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:PI(160*((i=a.aspectRatios[0])!==null&&i!==void 0?i:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(c),this.localParticipant.emit(de.LocalTrackPublished,c)}if(o.audio){const c=new Dk(Q.Kind.Audio,new hu({source:qt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ws.AUDIO}),new Hy(o.useRealTracks&&(!((s=navigator.mediaDevices)===null||s===void 0)&&s.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Nx(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(c),this.localParticipant.emit(de.LocalTrackPublished,c)}for(let c=0;c<a.count-1;c+=1){let d=new $l({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(c),state:ku.ACTIVE,tracks:[],joinedAt:gt.parse(Date.now())});const h=this.getOrCreateParticipant(d.identity,d);if(a.video){const f=PI(160*((r=a.aspectRatios[c%a.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),m=new hu({source:qt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ws.AUDIO});h.addSubscribedMediaTrack(f,m.sid,new MediaStream([f]),new RTCRtpReceiver),d.tracks=[...d.tracks,m]}if(a.audio){const f=Nx(),m=new hu({source:qt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ws.AUDIO});h.addSubscribedMediaTrack(f,m.sid,new MediaStream([f]),new RTCRtpReceiver),d.tracks=[...d.tracks,m]}h.updateInfo(d)}})}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];if(e!==Z.ActiveSpeakersChanged&&e!==Z.TranscriptionReceived){const r=Aj(i).filter(o=>o!==void 0);(e===Z.TrackSubscribed||e===Z.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:r})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:r}))}return super.emit(e,...i)}}rd.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(n=>{n()});function Aj(n){return n.map(e=>{if(e)return Array.isArray(e)?Aj(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var Ss;(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.SKIPPED=2]="SKIPPED",n[n.SUCCESS=3]="SUCCESS",n[n.FAILED=4]="FAILED"})(Ss||(Ss={}));class Ua extends lr.EventEmitter{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Ss.IDLE,this.logs=[],this.options={},this.url=e,this.token=t,this.name=this.constructor.name,this.room=new rd(i.roomOptions),this.connectOptions=i.connectOptions,this.options=i}run(e){return D(this,void 0,void 0,function*(){if(this.status!==Ss.IDLE)throw Error("check is running already");this.setStatus(Ss.RUNNING);try{yield this.perform()}catch(t){t instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(t.message):this.appendError(t.message))}return yield this.disconnect(),yield new Promise(t=>setTimeout(t,500)),this.status!==Ss.SKIPPED&&this.setStatus(this.isSuccess()?Ss.SUCCESS:Ss.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return D(this,void 0,void 0,function*(){return this.room.state===Qe.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return D(this,void 0,void 0,function*(){this.room&&this.room.state!==Qe.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Ss.SKIPPED)}switchProtocol(e){return D(this,void 0,void 0,function*(){let t=!1,i=!1;if(this.room.on(Z.Reconnecting,()=>{t=!0}),this.room.once(Z.Reconnected,()=>{i=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(r=>setTimeout(r,1e3)),!t)return;const s=Date.now()+1e4;for(;Date.now()<s;){if(i)return;yield wn(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class f2 extends Ua{get description(){return"Cloud regions"}perform(){return D(this,void 0,void 0,function*(){const e=new Ge(this.url,this.token);if(!e.isCloud()){this.skip();return}const t=[],i=new Set;for(let r=0;r<3;r++){const o=yield e.getNextBestRegionUrl();if(!o)break;if(i.has(o))continue;i.add(o);const a=yield this.checkCloudRegion(o);this.appendMessage("".concat(a.region," RTT: ").concat(a.rtt,"ms, duration: ").concat(a.duration,"ms")),t.push(a)}t.sort((r,o)=>(r.duration-o.duration)*.5+(r.rtt-o.rtt)*.5);const s=t[0];this.bestStats=s,this.appendMessage("best Cloud region: ".concat(s.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return D(this,void 0,void 0,function*(){var t,i;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const s=(t=this.room.serverInfo)===null||t===void 0?void 0:t.region;if(!s)throw new Error("Region not found");const r=yield this.room.localParticipant.streamText({topic:"test"}),o=1e3,c=1e6/o,d="A".repeat(o),h=Date.now();for(let v=0;v<c;v++)yield r.write(d);yield r.close();const f=Date.now(),m=yield(i=this.room.engine.pcManager)===null||i===void 0?void 0:i.publisher.getStats(),y={region:s,rtt:1e4,duration:f-h};return m==null||m.forEach(v=>{v.type==="candidate-pair"&&v.nominated&&(y.rtt=v.currentRoundTripTime*1e3)}),yield this.disconnect(),y})}}const Gx=1e4;class p2 extends Ua{get description(){return"Connection via UDP vs TCP"}perform(){return D(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),t=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-t.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-t.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=t):this.appendMessage("best connection quality via udp");const i=this.bestStats;this.appendMessage("upstream bitrate: ".concat((i.bitrateTotal/i.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((i.rttTotal/i.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((i.jitterTotal/i.count*1e3).toFixed(2)," ms")),i.packetsLost>0&&this.appendWarning("packets lost: ".concat((i.packetsLost/i.packetsSent*100).toFixed(2),"%")),i.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((i.qualityLimitationDurations.bandwidth/(Gx/1e3)*100).toFixed(2),"%")),i.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((i.qualityLimitationDurations.cpu/(Gx/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return D(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const t=document.createElement("canvas");t.width=1280,t.height=720;const i=t.getContext("2d");if(!i)throw new Error("Could not get canvas context");let s=0;const r=()=>{s=(s+1)%360,i.fillStyle="hsl(".concat(s,", 100%, 50%)"),i.fillRect(0,0,t.width,t.height),requestAnimationFrame(r)};r();const a=t.captureStream(30).getVideoTracks()[0],d=(yield this.room.localParticipant.publishTrack(a,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,h={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},f=setInterval(()=>D(this,void 0,void 0,function*(){const m=yield d.getRTCStatsReport();m==null||m.forEach(y=>{y.type==="outbound-rtp"?(h.packetsSent=y.packetsSent,h.qualityLimitationDurations=y.qualityLimitationDurations,h.bitrateTotal+=y.targetBitrate,h.count++):y.type==="remote-inbound-rtp"&&(h.packetsLost=y.packetsLost,h.rttTotal+=y.roundTripTime,h.jitterTotal+=y.jitter)})}),1e3);return yield new Promise(m=>setTimeout(m,Gx)),clearInterval(f),a.stop(),t.remove(),yield this.disconnect(),h})}}class m2 extends Ua{get description(){return"Can publish audio"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect(),i=yield wj();if(yield aj(i,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),t.localParticipant.publishTrack(i),yield new Promise(a=>setTimeout(a,3e3));const r=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let o=0;if(r.forEach(a=>{a.type==="outbound-rtp"&&(a.kind==="audio"||!a.kind&&a.mediaType==="audio")&&(o=a.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class g2 extends Ua{get description(){return"Can publish video"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect(),i=yield a2();yield this.checkForVideo(i.mediaStreamTrack),t.localParticipant.publishTrack(i),yield new Promise(o=>setTimeout(o,5e3));const s=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!s)throw new Error("Could not get RTCStats");let r=0;if(s.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(r+=o.packetsSent)}),r===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(r," video packets"))})}checkForVideo(e){return D(this,void 0,void 0,function*(){const t=new MediaStream;t.addTrack(e.clone());const i=document.createElement("video");i.srcObject=t,i.muted=!0,i.autoplay=!0,i.playsInline=!0,i.setAttribute("playsinline","true"),document.body.appendChild(i),yield new Promise(s=>{i.onplay=()=>{setTimeout(()=>{var r,o,a,c;const d=document.createElement("canvas"),h=e.getSettings(),f=(o=(r=h.width)!==null&&r!==void 0?r:i.videoWidth)!==null&&o!==void 0?o:1280,m=(c=(a=h.height)!==null&&a!==void 0?a:i.videoHeight)!==null&&c!==void 0?c:720;d.width=f,d.height=m;const y=d.getContext("2d");y.drawImage(i,0,0);const x=y.getImageData(0,0,d.width,d.height).data;let k=!0;for(let C=0;C<x.length;C+=4)if(x[C]!==0||x[C+1]!==0||x[C+2]!==0){k=!1;break}k?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),s()},1e3)},i.play()}),t.getTracks().forEach(s=>s.stop()),i.remove()})}}class y2 extends Ua{get description(){return"Resuming connection after interruption"}perform(){return D(this,void 0,void 0,function*(){var e;const t=yield this.connect();let i=!1,s=!1,r;const o=new Promise(d=>{setTimeout(d,5e3),r=d}),a=()=>{i=!0};t.on(Z.SignalReconnecting,a).on(Z.Reconnecting,a).on(Z.Reconnected,()=>{s=!0,r(!0)}),(e=t.engine.client.ws)===null||e===void 0||e.close();const c=t.engine.client.onClose;if(c&&c(""),yield o,i){if(!s||t.state!==Qe.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class v2 extends Ua{get description(){return"Can connect via TURN"}perform(){return D(this,void 0,void 0,function*(){var e,t,i;sd(new URL(this.url))&&(this.appendMessage("Using region specific url"),this.url=(e=yield new Ge(this.url,this.token).getNextBestRegionUrl())!==null&&e!==void 0?e:this.url);const s=new l1,r=yield s.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0);let o=!1,a=!1,c=!1;for(let d of r.iceServers)for(let h of d.urls)h.startsWith("turn:")?(a=!0,c=!0):h.startsWith("turns:")&&(a=!0,c=!0,o=!0),h.startsWith("stun:")&&(c=!0);c?a&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield s.close(),!((i=(t=this.connectOptions)===null||t===void 0?void 0:t.rtcConfig)===null||i===void 0)&&i.iceServers||a?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(d=>setTimeout(d,0)))})}}class b2 extends Ua{get description(){return"Establishing WebRTC connection"}perform(){return D(this,void 0,void 0,function*(){let e=!1,t=!1;this.room.on(Z.SignalConnected,()=>{var i;const s=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(r,o)=>{if(r.candidate){const a=new RTCIceCandidate(r);let c="".concat(a.protocol," ").concat(a.address,":").concat(a.port," ").concat(a.type);a.address&&(x2(a.address)?c+=" (private)":a.protocol==="tcp"&&a.tcpType==="passive"?(e=!0,c+=" (passive)"):a.protocol==="udp"&&(t=!0)),this.appendMessage(c)}s&&s(r,o)},!((i=this.room.engine.pcManager)===null||i===void 0)&&i.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=r=>{r instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(r.errorCode," ").concat(r.errorText," ").concat(r.url))})});try{yield this.connect(),Me.info("now the room is connected")}catch(i){throw this.appendWarning("ports need to be open on firewall in order to connect."),i}e||this.appendWarning("Server is not configured for ICE/TCP"),t||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function x2(n){const e=n.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const t=parseInt(e[1],10);if(t>=16&&t<=31)return!0}}return!1}class S2 extends Ua{get description(){return"Connecting to signal connection via WebSocket"}perform(){return D(this,void 0,void 0,function*(){var e,t,i;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let s=new l1,r;try{r=yield s.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0)}catch(o){if(sd(new URL(this.url))){this.appendMessage("Initial connection failed with error ".concat(o.message,". Retrying with region fallback"));const c=yield new Ge(this.url,this.token).getNextBestRegionUrl();c&&(r=yield s.join(c,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0),this.appendMessage("Fallback to region worked. To avoid initial connections failing, ensure you're calling room.prepareConnection() ahead of time"))}}r?(this.appendMessage("Connected to server, version ".concat(r.serverVersion,".")),((e=r.serverInfo)===null||e===void 0?void 0:e.edition)===d4.Cloud&&(!((t=r.serverInfo)===null||t===void 0)&&t.region)&&this.appendMessage("LiveKit Cloud: ".concat((i=r.serverInfo)===null||i===void 0?void 0:i.region))):this.appendError("Websocket connection could not be established"),yield s.close()})}}class hie extends lr.EventEmitter{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=t,this.options=i}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Ss.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Ss.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return D(this,void 0,void 0,function*(){const t=this.getNextCheckId(),i=new e(this.url,this.token,this.options),s=o=>{this.updateCheck(t,o)};i.on("update",s);const r=yield i.run();return i.off("update",s),r})}checkWebsocket(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(S2)})}checkWebRTC(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(b2)})}checkTURN(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(v2)})}checkReconnect(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(y2)})}checkPublishAudio(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(m2)})}checkPublishVideo(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(g2)})}checkConnectionProtocol(){return D(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(p2);if(e.data&&"protocol"in e.data){const t=e.data;this.options.protocol=t.protocol}return e})}checkCloudRegion(){return D(this,void 0,void 0,function*(){return this.createAndRunCheck(f2)})}}function Le(n,e,t){return(e=k2(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C2(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function k2(n){var e=C2(n,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Zn extends Error{constructor(e,t){var i;super(e,t),Le(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(i=Error.captureStackTrace)===null||i===void 0||i.call(Error,this,this.constructor)}}Le(Zn,"code","ERR_JOSE_GENERIC");class w2 extends Zn{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:i,reason:s,payload:t}}),Le(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),Le(this,"claim",void 0),Le(this,"reason",void 0),Le(this,"payload",void 0),this.claim=i,this.reason=s,this.payload=t}}Le(w2,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class T2 extends Zn{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:i,reason:s,payload:t}}),Le(this,"code","ERR_JWT_EXPIRED"),Le(this,"claim",void 0),Le(this,"reason",void 0),Le(this,"payload",void 0),this.claim=i,this.reason=s,this.payload=t}}Le(T2,"code","ERR_JWT_EXPIRED");class A2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}Le(A2,"code","ERR_JOSE_ALG_NOT_ALLOWED");class E2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JOSE_NOT_SUPPORTED")}}Le(E2,"code","ERR_JOSE_NOT_SUPPORTED");class _2 extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),Le(this,"code","ERR_JWE_DECRYPTION_FAILED")}}Le(_2,"code","ERR_JWE_DECRYPTION_FAILED");class M2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JWE_INVALID")}}Le(M2,"code","ERR_JWE_INVALID");class R2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JWS_INVALID")}}Le(R2,"code","ERR_JWS_INVALID");class P2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JWT_INVALID")}}Le(P2,"code","ERR_JWT_INVALID");class I2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JWK_INVALID")}}Le(I2,"code","ERR_JWK_INVALID");class B2 extends Zn{constructor(){super(...arguments),Le(this,"code","ERR_JWKS_INVALID")}}Le(B2,"code","ERR_JWKS_INVALID");class D2 extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),Le(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}Le(D2,"code","ERR_JWKS_NO_MATCHING_KEY");class N2 extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",t=arguments.length>1?arguments[1]:void 0;super(e,t),Le(this,Symbol.asyncIterator,void 0),Le(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}Le(N2,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class F2 extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",t=arguments.length>1?arguments[1]:void 0;super(e,t),Le(this,"code","ERR_JWKS_TIMEOUT")}}Le(F2,"code","ERR_JWKS_TIMEOUT");class O2 extends Zn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",t=arguments.length>1?arguments[1]:void 0;super(e,t),Le(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}Le(O2,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function $r(){return $r=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},$r.apply(null,arguments)}const tB=new Uint8Array(0);class Lf{static getFullOptions(e){return $r({clientTools:{},onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onAudio:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{},onInterruption:()=>{}},e)}constructor(e,t){var i=this;this.options=void 0,this.connection=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=0,this.canSendFeedback=!1,this.endSessionWithDetails=async function(s){i.status!=="connected"&&i.status!=="connecting"||(i.updateStatus("disconnecting"),await i.handleEndSession(),i.updateStatus("disconnected"),i.options.onDisconnect&&i.options.onDisconnect(s))},this.onMessage=async function(s){switch(s.type){case"interruption":return void i.handleInterruption(s);case"agent_response":return void i.handleAgentResponse(s);case"user_transcript":return void i.handleUserTranscript(s);case"internal_tentative_agent_response":return void i.handleTentativeAgentResponse(s);case"client_tool_call":try{await i.handleClientToolCall(s)}catch(r){i.onError(`Unexpected error in client tool call handling: ${r instanceof Error?r.message:String(r)}`,{clientToolName:s.client_tool_call.tool_name,toolCallId:s.client_tool_call.tool_call_id})}return;case"audio":return void i.handleAudio(s);case"vad_score":return void i.handleVadScore(s);case"ping":return void i.connection.sendMessage({type:"pong",event_id:s.ping_event.event_id});case"mcp_tool_call":return void i.handleMCPToolCall(s);case"mcp_connection_status":return void i.handleMCPConnectionStatus(s);case"agent_tool_request":return void i.handleAgentToolRequest(s);case"agent_tool_response":return void i.handleAgentToolResponse(s);case"conversation_initiation_metadata":return void i.handleConversationMetadata(s);case"asr_initiation_metadata":return void i.handleAsrInitiationMetadata(s);case"agent_chat_response_part":return void i.handleAgentChatResponsePart(s);case"error":return void i.handleErrorEvent(s);default:return void(i.options.onDebug&&i.options.onDebug(s))}},this.setVolume=({volume:s})=>{this.volume=s},this.options=e,this.connection=t,this.options.onConnect&&this.options.onConnect({conversationId:t.conversationId}),this.connection.onMessage(this.onMessage),this.connection.onDisconnect(this.endSessionWithDetails),this.connection.onModeChange(s=>this.updateMode(s)),this.updateStatus("connected")}endSession(){return this.endSessionWithDetails({reason:"user"})}async handleEndSession(){this.connection.close()}updateMode(e){e!==this.mode&&(this.mode=e,this.options.onModeChange&&this.options.onModeChange({mode:e}))}updateStatus(e){e!==this.status&&(this.status=e,this.options.onStatusChange&&this.options.onStatusChange({status:e}))}updateCanSendFeedback(){const e=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==e&&(this.canSendFeedback=e,this.options.onCanSendFeedbackChange&&this.options.onCanSendFeedbackChange({canSendFeedback:e}))}handleInterruption(e){e.interruption_event&&(this.lastInterruptTimestamp=e.interruption_event.event_id,this.options.onInterruption&&this.options.onInterruption({event_id:e.interruption_event.event_id}))}handleAgentResponse(e){this.options.onMessage&&this.options.onMessage({source:"ai",role:"agent",message:e.agent_response_event.agent_response})}handleUserTranscript(e){this.options.onMessage&&this.options.onMessage({source:"user",role:"user",message:e.user_transcription_event.user_transcript})}handleTentativeAgentResponse(e){this.options.onDebug&&this.options.onDebug({type:"tentative_agent_response",response:e.tentative_agent_response_internal_event.tentative_agent_response})}handleVadScore(e){this.options.onVadScore&&this.options.onVadScore({vadScore:e.vad_score_event.vad_score})}async handleClientToolCall(e){if(Object.prototype.hasOwnProperty.call(this.options.clientTools,e.client_tool_call.tool_name))try{var t;const i=(t=await this.options.clientTools[e.client_tool_call.tool_name](e.client_tool_call.parameters))!=null?t:"Client tool execution successful.",s=typeof i=="object"?JSON.stringify(i):String(i);this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:s,is_error:!1})}catch(i){this.onError(`Client tool execution failed with following error: ${i==null?void 0:i.message}`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${i==null?void 0:i.message}`,is_error:!0})}else{if(this.options.onUnhandledClientToolCall)return void this.options.onUnhandledClientToolCall(e.client_tool_call);this.onError(`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,is_error:!0})}}handleAudio(e){}handleMCPToolCall(e){this.options.onMCPToolCall&&this.options.onMCPToolCall(e.mcp_tool_call)}handleMCPConnectionStatus(e){this.options.onMCPConnectionStatus&&this.options.onMCPConnectionStatus(e.mcp_connection_status)}handleAgentToolRequest(e){this.options.onAgentToolRequest&&this.options.onAgentToolRequest(e.agent_tool_request)}handleAgentToolResponse(e){e.agent_tool_response.tool_name==="end_call"&&this.endSessionWithDetails({reason:"agent",context:new CloseEvent("end_call",{reason:"Agent ended the call"})}),this.options.onAgentToolResponse&&this.options.onAgentToolResponse(e.agent_tool_response)}handleConversationMetadata(e){this.options.onConversationMetadata&&this.options.onConversationMetadata(e.conversation_initiation_metadata_event)}handleAsrInitiationMetadata(e){this.options.onAsrInitiationMetadata&&this.options.onAsrInitiationMetadata(e.asr_initiation_metadata_event)}handleAgentChatResponsePart(e){this.options.onAgentChatResponsePart&&this.options.onAgentChatResponsePart(e.text_response_part)}handleErrorEvent(e){const t=e.error_event.error_type,i=e.error_event.message||e.error_event.reason||"Unknown error";t!=="max_duration_exceeded"?this.onError(`Server error: ${i}`,{errorType:t,code:e.error_event.code,debugMessage:e.error_event.debug_message,details:e.error_event.details}):this.endSessionWithDetails({reason:"error",message:i,context:new Event("max_duration_exceeded")})}onError(e,t){console.error(e,t),this.options.onError&&this.options.onError(e,t)}getId(){return this.connection.conversationId}isOpen(){return this.status==="connected"}setMicMuted(e){this.connection.setMicMuted(e)}getInputByteFrequencyData(){return tB}getOutputByteFrequencyData(){return tB}getInputVolume(){return 0}getOutputVolume(){return 0}sendFeedback(e){this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:e?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(this.lastFeedbackEventId===0?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")}sendContextualUpdate(e){this.connection.sendMessage({type:"contextual_update",text:e})}sendUserMessage(e){this.connection.sendMessage({type:"user_message",text:e})}sendUserActivity(){this.connection.sendMessage({type:"user_activity"})}sendMCPToolApprovalResult(e,t){this.connection.sendMessage({type:"mcp_tool_approval_result",tool_call_id:e,is_approved:t})}}let Ej=class{constructor(e={}){this.queue=[],this.disconnectionDetails=null,this.onDisconnectCallback=null,this.onMessageCallback=null,this.onModeChangeCallback=null,this.onDebug=void 0,this.onDebug=e.onDebug}debug(e){this.onDebug&&this.onDebug(e)}onMessage(e){this.onMessageCallback=e;const t=this.queue;this.queue=[],t.length>0&&queueMicrotask(()=>{t.forEach(e)})}onDisconnect(e){this.onDisconnectCallback=e;const t=this.disconnectionDetails;t&&queueMicrotask(()=>{e(t)})}onModeChange(e){this.onModeChangeCallback=e}updateMode(e){var t;(t=this.onModeChangeCallback)==null||t.call(this,e)}disconnect(e){var t;this.disconnectionDetails||(this.disconnectionDetails=e,(t=this.onDisconnectCallback)==null||t.call(this,e))}handleMessage(e){this.onMessageCallback?this.onMessageCallback(e):this.queue.push(e)}};function Jy(n){const[e,t]=n.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${n}`);const i=Number.parseInt(t);if(Number.isNaN(i))throw new Error(`Invalid sample rate: ${t}`);return{format:e,sampleRate:i}}const _j="0.13.0";function Nk(n){return!!n.type}const Mj="conversation_initiation_client_data";function Rj(n){var e;const t={type:Mj};var i,s,r,o,a,c,d,h;return n.overrides&&(t.conversation_config_override={agent:{prompt:(i=n.overrides.agent)==null?void 0:i.prompt,first_message:(s=n.overrides.agent)==null?void 0:s.firstMessage,language:(r=n.overrides.agent)==null?void 0:r.language},tts:{voice_id:(o=n.overrides.tts)==null?void 0:o.voiceId,speed:(a=n.overrides.tts)==null?void 0:a.speed,stability:(c=n.overrides.tts)==null?void 0:c.stability,similarity_boost:(d=n.overrides.tts)==null?void 0:d.similarityBoost},conversation:{text_only:(h=n.overrides.conversation)==null?void 0:h.textOnly}}),n.customLlmExtraBody&&(t.custom_llm_extra_body=n.customLlmExtraBody),n.dynamicVariables&&(t.dynamic_variables=n.dynamicVariables),n.userId&&(t.user_id=n.userId),(e=n.overrides)!=null&&e.client&&(t.source_info={source:n.overrides.client.source,version:n.overrides.client.version}),t}let nB=class extends Error{constructor(e,t){super(e),this.closeCode=void 0,this.closeReason=void 0,this.name="SessionConnectionError",this.closeCode=t==null?void 0:t.closeCode,this.closeReason=t==null?void 0:t.closeReason}},Fk=class Pj extends Ej{constructor(e,t,i,s){super(),this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.socket=e,this.conversationId=t,this.inputFormat=i,this.outputFormat=s,this.socket.addEventListener("error",r=>{setTimeout(()=>this.disconnect({reason:"error",message:"The connection was closed due to a socket error.",context:r}),0)}),this.socket.addEventListener("close",r=>{this.disconnect(r.code===1e3?{reason:"agent",context:r,closeCode:r.code,closeReason:r.reason||void 0}:{reason:"error",message:r.reason||"The connection was closed by the server.",context:r,closeCode:r.code,closeReason:r.reason||void 0})}),this.socket.addEventListener("message",r=>{try{const o=JSON.parse(r.data);if(!Nk(o))return void this.debug({type:"invalid_event",message:"Received invalid socket event",data:r.data});this.handleMessage(o)}catch(o){this.debug({type:"parsing_error",message:"Failed to parse socket message",error:o instanceof Error?o.message:String(o),data:r.data})}})}static async create(e){let t=null;try{var i,s,r;const a=(i=e.origin)!=null?i:"wss://api.elevenlabs.io";let c;const d=((s=e.overrides)==null||(s=s.client)==null?void 0:s.version)||_j,h=((r=e.overrides)==null||(r=r.client)==null?void 0:r.source)||"js_sdk";if(e.signedUrl){const A=e.signedUrl.includes("?")?"&":"?";c=`${e.signedUrl}${A}source=${h}&version=${d}`}else c=`${a}/v1/convai/conversation?agent_id=${e.agentId}&source=${h}&version=${d}`;const f=["convai"];e.authorization&&f.push(`bearer.${e.authorization}`),t=new WebSocket(c,f);const m=await new Promise((A,T)=>{t.addEventListener("open",()=>{var E;const _=Rj(e);(E=t)==null||E.send(JSON.stringify(_))},{once:!0}),t.addEventListener("error",E=>{setTimeout(()=>T(new nB("The connection was closed due to a socket error.")),0)}),t.addEventListener("close",E=>{T(new nB(E.reason||(E.code===1e3?"Connection closed normally before session could be established.":"Connection closed unexpectedly before session could be established."),{closeCode:E.code,closeReason:E.reason||void 0}))}),t.addEventListener("message",E=>{const _=JSON.parse(E.data);Nk(_)&&(_.type==="conversation_initiation_metadata"?A(_.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))},{once:!0})}),{conversation_id:y,agent_output_audio_format:v,user_input_audio_format:x}=m,k=Jy(x??"pcm_16000"),C=Jy(v);return new Pj(t,y,k,C)}catch(a){var o;throw(o=t)==null||o.close(),a}}close(){this.socket.close(1e3,"User ended conversation")}sendMessage(e){this.socket.send(JSON.stringify(e))}async setMicMuted(e){console.warn(`WebSocket connection setMicMuted called with ${e}, but this is handled by VoiceConversation`)}};function Ij(n){const e=new Uint8Array(n);return window.btoa(String.fromCharCode(...e))}function L2(n){const e=window.atob(n),t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.charCodeAt(s);return i.buffer}const Gm=new Map;function Bj(n,e){return async(t,i)=>{const s=Gm.get(n);if(s)return t.addModule(s);if(i)try{return await t.addModule(i),void Gm.set(n,i)}catch(a){throw new Error(`Failed to load the ${n} worklet module from path: ${i}. Error: ${a}`)}const r=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(r);try{return await t.addModule(o),void Gm.set(n,o)}catch{URL.revokeObjectURL(o)}try{const a=`data:application/javascript;base64,${btoa(e)}`;await t.addModule(a),Gm.set(n,a)}catch{throw new Error(`Failed to load the ${n} worklet module. Make sure the browser supports AudioWorklets. If you are using a strict CSP, you may need to self-host the worklet files.`)}}}const Dj=Bj("rawAudioProcessor",`/*
 * ulaw encoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const BIAS = 0x84;
const CLIP = 32635;
const encodeTable = [
  0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,
  4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
];

function encodeSample(sample) {
  let sign;
  let exponent;
  let mantissa;
  let muLawSample;
  sign = (sample >> 8) & 0x80;
  if (sign !== 0) sample = -sample;
  sample = sample + BIAS;
  if (sample > CLIP) sample = CLIP;
  exponent = encodeTable[(sample>>7) & 0xFF];
  mantissa = (sample >> (exponent+3)) & 0x0F;
  muLawSample = ~(sign | (exponent << 4) | mantissa);
  
  return muLawSample;
}

class RawAudioProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
              
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.isMuted = false;
          this.buffer = []; // Initialize an empty buffer
          this.bufferSize = data.sampleRate / 4;
          this.format = data.format;

          if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {
            globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {
              this.resampler = resampler;
            });
          }
          break;
        case "setMuted":
          this.isMuted = data.isMuted;
          break;
      }
    };
  }
  process(inputs) {
    if (!this.buffer) {
      return true;
    }
    
    const input = inputs[0]; // Get the first input node
    if (input.length > 0) {
      let channelData = input[0]; // Get the first channel's data

      // Resample the audio if necessary
      if (this.resampler) {
        channelData = this.resampler.full(channelData);
      }

      // Add channel data to the buffer
      this.buffer.push(...channelData);
      // Get max volume 
      let sum = 0.0;
      for (let i = 0; i < channelData.length; i++) {
        sum += channelData[i] * channelData[i];
      }
      const maxVolume = Math.sqrt(sum / channelData.length);
      // Check if buffer size has reached or exceeded the threshold
      if (this.buffer.length >= this.bufferSize) {
        const float32Array = this.isMuted 
          ? new Float32Array(this.buffer.length)
          : new Float32Array(this.buffer);

        let encodedArray = this.format === "ulaw"
          ? new Uint8Array(float32Array.length)
          : new Int16Array(float32Array.length);

        // Iterate through the Float32Array and convert each sample to PCM16
        for (let i = 0; i < float32Array.length; i++) {
          // Clamp the value to the range [-1, 1]
          let sample = Math.max(-1, Math.min(1, float32Array[i]));

          // Scale the sample to the range [-32768, 32767]
          let value = sample < 0 ? sample * 32768 : sample * 32767;
          if (this.format === "ulaw") {
            value = encodeSample(Math.round(value));
          }

          encodedArray[i] = value;
        }

        // Send the buffered data to the main script
        this.port.postMessage([encodedArray, maxVolume]);

        // Clear the buffer after sending
        this.buffer = [];
      }
    }
    return true; // Continue processing
  }
}
registerProcessor("rawAudioProcessor", RawAudioProcessor);
`);class jr extends Ej{constructor(e,t,i,s,r={}){super(r),this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.room=void 0,this.isConnected=!1,this.audioEventId=1,this.audioCaptureContext=null,this.audioElements=[],this.outputDeviceId=null,this.outputAnalyser=null,this.outputFrequencyData=null,this.room=e,this.conversationId=t,this.inputFormat=i,this.outputFormat=s,this.setupRoomEventListeners()}static async create(e){let t;if("conversationToken"in e&&e.conversationToken)t=e.conversationToken;else{if(!("agentId"in e)||!e.agentId)throw new Error("Either conversationToken or agentId is required for WebRTC connection");try{var i,s,r;const d=((i=e.overrides)==null||(i=i.client)==null?void 0:i.version)||_j,h=((s=e.overrides)==null||(s=s.client)==null?void 0:s.source)||"js_sdk",f=`${o=(r=e.origin)!=null?r:"https://api.elevenlabs.io",o.replace(/^wss:\/\//,"https://")}/v1/convai/conversation/token?agent_id=${e.agentId}&source=${h}&version=${d}`,m=await fetch(f);if(!m.ok)throw new Error(`ElevenLabs API returned ${m.status} ${m.statusText}`);if(t=(await m.json()).token,!t)throw new Error("No conversation token received from API")}catch(d){let h=d instanceof Error?d.message:String(d);throw d instanceof Error&&d.message.includes("401")&&(h="Your agent has authentication enabled, but no signed URL or conversation token was provided."),new Error(`Failed to fetch conversation token for agent ${e.agentId}: ${h}`)}}var o;const a=new rd;try{const d=`room_${Date.now()}`,h=Jy("pcm_48000"),f=Jy("pcm_48000"),m=new jr(a,d,h,f,e),y=e.livekitUrl||"wss://livekit.rtc.elevenlabs.io";var c;await a.connect(y,t),await new Promise(x=>{if(m.isConnected)x();else{const k=()=>{a.off(Z.Connected,k),x()};a.on(Z.Connected,k)}}),a.name&&(m.conversationId=((c=a.name.match(/(conv_[a-zA-Z0-9]+)/))==null?void 0:c[0])||a.name),e.textOnly||await a.localParticipant.setMicrophoneEnabled(!0);const v=Rj(e);return m.debug({type:Mj,message:v}),await m.sendMessage(v),m}catch(d){throw await a.disconnect(),d}}setupRoomEventListeners(){var e=this;this.room.on(Z.Connected,async function(){e.isConnected=!0,console.info("WebRTC room connected")}),this.room.on(Z.Disconnected,t=>{this.isConnected=!1,this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:t==null?void 0:t.toString()})})}),this.room.on(Z.ConnectionStateChanged,t=>{t===Qe.Disconnected&&(this.isConnected=!1,this.disconnect({reason:"error",message:`LiveKit connection state changed to ${t}`,context:new Event("connection_state_changed")}))}),this.room.on(Z.DataReceived,(t,i)=>{try{const s=JSON.parse(new TextDecoder().decode(t));if(s.type==="audio")return;Nk(s)?this.handleMessage(s):console.warn("Invalid socket event received:",s)}catch(s){console.warn("Failed to parse incoming data message:",s),console.warn("Raw payload:",new TextDecoder().decode(t))}}),this.room.on(Z.TrackSubscribed,async function(t,i,s){if(t.kind===Q.Kind.Audio&&s.identity.includes("agent")){const r=t,o=r.attach();if(o.autoplay=!0,o.controls=!1,e.outputDeviceId&&o.setSinkId)try{await o.setSinkId(e.outputDeviceId)}catch(a){console.warn("Failed to set output device for new audio element:",a)}o.style.display="none",document.body.appendChild(o),e.audioElements.push(o),e.audioElements.length===1&&(e.onDebug==null||e.onDebug({type:"audio_element_ready"})),await e.setupAudioCapture(r)}}),this.room.on(Z.ActiveSpeakersChanged,async function(t){e.updateMode(t.length>0&&t[0].identity.startsWith("agent")?"speaking":"listening")}),this.room.on(Z.ParticipantDisconnected,t=>{var i;(i=t.identity)!=null&&i.startsWith("agent")&&this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:"agent disconnected"})})})}close(){if(this.isConnected){try{this.room.localParticipant.audioTrackPublications.forEach(e=>{e.track&&e.track.stop()})}catch(e){console.warn("Error stopping local tracks:",e)}this.audioCaptureContext&&(this.audioCaptureContext.close().catch(e=>{console.warn("Error closing audio capture context:",e)}),this.audioCaptureContext=null),this.audioElements.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.audioElements=[],this.room.disconnect()}}async sendMessage(e){if(this.isConnected&&this.room.localParticipant){if(!("user_audio_chunk"in e))try{const t=new TextEncoder().encode(JSON.stringify(e));await this.room.localParticipant.publishData(t,{reliable:!0})}catch(t){this.debug({type:"send_message_error",message:{message:e,error:t}}),console.error("Failed to send message via WebRTC:",t)}}else console.warn("Cannot send message: room not connected or no local participant")}getRoom(){return this.room}async setMicMuted(e){if(!this.isConnected||!this.room.localParticipant)return void console.warn("Cannot set microphone muted: room not connected or no local participant");const t=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);if(t!=null&&t.track)try{e?await t.track.mute():await t.track.unmute()}catch{await this.room.localParticipant.setMicrophoneEnabled(!e)}else await this.room.localParticipant.setMicrophoneEnabled(!e)}async setupAudioCapture(e){try{const t=new AudioContext;this.audioCaptureContext=t,this.outputAnalyser=t.createAnalyser(),this.outputAnalyser.fftSize=2048,this.outputAnalyser.smoothingTimeConstant=.8;const i=new MediaStream([e.mediaStreamTrack]),s=t.createMediaStreamSource(i);s.connect(this.outputAnalyser),await Dj(t.audioWorklet);const r=new AudioWorkletNode(t,"rawAudioProcessor");this.outputAnalyser.connect(r),r.port.postMessage({type:"setFormat",format:this.outputFormat.format,sampleRate:this.outputFormat.sampleRate}),r.port.onmessage=o=>{const[a,c]=o.data;if(c>.01){const d=Ij(a.buffer),h=this.audioEventId++;this.handleMessage({type:"audio",audio_event:{audio_base_64:d,event_id:h}})}},s.connect(r)}catch(t){console.warn("Failed to set up audio capture:",t)}}setAudioVolume(e){this.audioElements.forEach(t=>{t.volume=e})}async setAudioOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");const t=this.audioElements.map(async function(i){try{await i.setSinkId(e)}catch(s){throw console.error("Failed to set sink ID for audio element:",s),s}});await Promise.all(t),this.outputDeviceId=e}async setAudioInputDevice(e){if(!this.isConnected||!this.room.localParticipant)throw new Error("Cannot change input device: room not connected or no local participant");try{const t=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);t!=null&&t.track&&(await t.track.stop(),await this.room.localParticipant.unpublishTrack(t.track));const i={deviceId:{exact:e},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}},s=await wj(i);await this.room.localParticipant.publishTrack(s,{name:"microphone",source:Q.Source.Microphone})}catch(t){console.error("Failed to change input device:",t);try{await this.room.localParticipant.setMicrophoneEnabled(!0)}catch(i){console.error("Failed to recover microphone after device switch error:",i)}throw t}}getOutputByteFrequencyData(){return this.outputAnalyser?(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.outputAnalyser.frequencyBinCount)),this.outputAnalyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData):null}}async function Nj(n){const e=function(t){return t.connectionType?t.connectionType:"conversationToken"in t&&t.conversationToken?"webrtc":"websocket"}(n);switch(e){case"websocket":return Fk.create(n);case"webrtc":return jr.create(n);default:throw new Error(`Unknown connection type: ${e}`)}}function Ok(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}async function Fj(n={default:0,android:3e3}){let e=n.default;var t;if(/android/i.test(navigator.userAgent))e=(t=n.android)!=null?t:e;else if(Ok()){var i;e=(i=n.ios)!=null?i:e}e>0&&await new Promise(s=>setTimeout(s,e))}class g1 extends Lf{static async startSession(e){const t=Lf.getFullOptions(e);t.onStatusChange&&t.onStatusChange({status:"connecting"}),t.onCanSendFeedbackChange&&t.onCanSendFeedbackChange({canSendFeedback:!1}),t.onModeChange&&t.onModeChange({mode:"listening"}),t.onCanSendFeedbackChange&&t.onCanSendFeedbackChange({canSendFeedback:!1});let i=null;try{return await Fj(t.connectionDelay),i=await Nj(e),new g1(t,i)}catch(r){var s;throw t.onStatusChange&&t.onStatusChange({status:"disconnected"}),(s=i)==null||s.close(),r}}}const iB={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}};class Pu{static async create({sampleRate:e,format:t,preferHeadphonesForIosDevices:i,inputDeviceId:s,workletPaths:r,libsampleratePath:o}){let a=null,c=null;try{const f=$r({sampleRate:{ideal:e}},iB);if(Ok()&&i){const C=(await window.navigator.mediaDevices.enumerateDevices()).find(A=>A.kind==="audioinput"&&["airpod","headphone","earphone"].find(T=>A.label.toLowerCase().includes(T)));C&&(f.deviceId={ideal:C.deviceId})}s&&(f.deviceId=Pu.getDeviceIdConstraint(s));const m=navigator.mediaDevices.getSupportedConstraints().sampleRate;a=new window.AudioContext(m?{sampleRate:e}:{});const y=a.createAnalyser();if(!m){const C=o||"https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js";await a.audioWorklet.addModule(C)}await Dj(a.audioWorklet,r==null?void 0:r.rawAudioProcessor);const v=$r({voiceIsolation:!0},f);c=await navigator.mediaDevices.getUserMedia({audio:v});const x=a.createMediaStreamSource(c),k=new AudioWorkletNode(a,"rawAudioProcessor");return k.port.postMessage({type:"setFormat",format:t,sampleRate:e}),x.connect(y),y.connect(k),await a.resume(),new Pu(a,y,k,c,x)}catch(f){var d,h;throw(d=c)==null||d.getTracks().forEach(m=>{m.stop()}),(h=a)==null||h.close(),f}}static getDeviceIdConstraint(e){if(e)return Ok()?{ideal:e}:{exact:e}}constructor(e,t,i,s,r){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.mediaStreamSource=void 0,this.context=e,this.analyser=t,this.worklet=i,this.inputStream=s,this.mediaStreamSource=r}async close(){this.inputStream.getTracks().forEach(e=>{e.stop()}),this.mediaStreamSource.disconnect(),await this.context.close()}setMuted(e){this.worklet.port.postMessage({type:"setMuted",isMuted:e})}async setInputDevice(e){try{const t=$r({},iB);e&&(t.deviceId=Pu.getDeviceIdConstraint(e));const i=$r({voiceIsolation:!0},t),s=await navigator.mediaDevices.getUserMedia({audio:i});this.inputStream.getTracks().forEach(r=>{r.stop()}),this.mediaStreamSource.disconnect(),this.inputStream=s,this.mediaStreamSource=this.context.createMediaStreamSource(s),this.mediaStreamSource.connect(this.analyser)}catch(t){throw console.error("Failed to switch input device:",t),t}}}const j2=Bj("audioConcatProcessor",`/*
 * ulaw decoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const decodeTable = [0,132,396,924,1980,4092,8316,16764];

function decodeSample(muLawSample) {
  let sign;
  let exponent;
  let mantissa;
  let sample;
  muLawSample = ~muLawSample;
  sign = (muLawSample & 0x80);
  exponent = (muLawSample >> 4) & 0x07;
  mantissa = muLawSample & 0x0F;
  sample = decodeTable[exponent] + (mantissa << (exponent+3));
  if (sign !== 0) sample = -sample;

  return sample;
}

class AudioConcatProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffers = []; // Initialize an empty buffer
    this.cursor = 0;
    this.currentBuffer = null;
    this.wasInterrupted = false;
    this.finished = false;
    
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.format = data.format;
          break;
        case "buffer":
          this.wasInterrupted = false;
          this.buffers.push(
            this.format === "ulaw"
              ? new Uint8Array(data.buffer)
              : new Int16Array(data.buffer)
          );
          break;
        case "interrupt":
          this.wasInterrupted = true;
          break;
        case "clearInterrupted":
          if (this.wasInterrupted) {
            this.wasInterrupted = false;
            this.buffers = [];
            this.currentBuffer = null;
          }
      }
    };
  }
  process(_, outputs) {
    let finished = false;
    const output = outputs[0][0];
    for (let i = 0; i < output.length; i++) {
      if (!this.currentBuffer) {
        if (this.buffers.length === 0) {
          finished = true;
          break;
        }
        this.currentBuffer = this.buffers.shift();
        this.cursor = 0;
      }

      let value = this.currentBuffer[this.cursor];
      if (this.format === "ulaw") {
        value = decodeSample(value);
      }
      output[i] = value / 32768;
      this.cursor++;

      if (this.cursor >= this.currentBuffer.length) {
        this.currentBuffer = null;
      }
    }

    if (this.finished !== finished) {
      this.finished = finished;
      this.port.postMessage({ type: "process", finished });
    }

    return true; // Continue processing
  }
}

registerProcessor("audioConcatProcessor", AudioConcatProcessor);
`);class Ky{static async create({sampleRate:e,format:t,outputDeviceId:i,workletPaths:s}){let r=null,o=null;try{r=new AudioContext({sampleRate:e});const d=r.createAnalyser(),h=r.createGain();o=new Audio,o.src="",o.load(),o.autoplay=!0,o.style.display="none",document.body.appendChild(o);const f=r.createMediaStreamDestination();o.srcObject=f.stream,h.connect(d),d.connect(f),await j2(r.audioWorklet,s==null?void 0:s.audioConcatProcessor);const m=new AudioWorkletNode(r,"audioConcatProcessor");return m.port.postMessage({type:"setFormat",format:t}),m.connect(h),await r.resume(),i&&o.setSinkId&&await o.setSinkId(i),new Ky(r,d,h,m,o)}catch(d){var a,c;throw(a=o)!=null&&a.parentNode&&o.parentNode.removeChild(o),(c=o)==null||c.pause(),r&&r.state!=="closed"&&await r.close(),d}}constructor(e,t,i,s,r){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.audioElement=void 0,this.context=e,this.analyser=t,this.gain=i,this.worklet=s,this.audioElement=r}async setOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");await this.audioElement.setSinkId(e||"")}async close(){this.audioElement.parentNode&&this.audioElement.parentNode.removeChild(this.audioElement),this.audioElement.pause(),await this.context.close()}}class tf extends Lf{static async requestWakeLock(){if("wakeLock"in navigator)try{return await navigator.wakeLock.request("screen")}catch{}return null}static async startSession(e){var t;const i=Lf.getFullOptions(e);i.onStatusChange&&i.onStatusChange({status:"connecting"}),i.onCanSendFeedbackChange&&i.onCanSendFeedbackChange({canSendFeedback:!1});let s=null,r=null,o=null,a=null,c=null;((t=e.useWakeLock)==null||t)&&(c=await tf.requestWakeLock());try{var d;return a=await navigator.mediaDevices.getUserMedia({audio:!0}),await Fj(i.connectionDelay),r=await Nj(e),[s,o]=await Promise.all([Pu.create($r({},r.inputFormat,{preferHeadphonesForIosDevices:e.preferHeadphonesForIosDevices,inputDeviceId:e.inputDeviceId,workletPaths:e.workletPaths,libsampleratePath:e.libsampleratePath})),Ky.create($r({},r.outputFormat,{outputDeviceId:e.outputDeviceId,workletPaths:e.workletPaths}))]),(d=a)==null||d.getTracks().forEach(x=>{x.stop()}),a=null,new tf(i,r,s,o,c)}catch(x){var h,f,m,y;i.onStatusChange&&i.onStatusChange({status:"disconnected"}),(h=a)==null||h.getTracks().forEach(k=>{k.stop()}),(f=r)==null||f.close(),await((m=s)==null?void 0:m.close()),await((y=o)==null?void 0:y.close());try{var v;await((v=c)==null?void 0:v.release()),c=null}catch{}throw x}}constructor(e,t,i,s,r){super(e,t),this.input=void 0,this.output=void 0,this.wakeLock=void 0,this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.visibilityChangeHandler=null,this.onInputWorkletMessage=o=>{this.status==="connected"&&this.connection.sendMessage({user_audio_chunk:Ij(o.data[0].buffer)})},this.onOutputWorkletMessage=({data:o})=>{o.type==="process"&&this.updateMode(o.finished?"listening":"speaking")},this.addAudioBase64Chunk=o=>{this.output.gain.gain.cancelScheduledValues(this.output.context.currentTime),this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"}),this.output.worklet.port.postMessage({type:"buffer",buffer:L2(o)})},this.fadeOutAudio=()=>{this.updateMode("listening"),this.output.worklet.port.postMessage({type:"interrupt"}),this.output.gain.gain.exponentialRampToValueAtTime(1e-4,this.output.context.currentTime+2),setTimeout(()=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"})},2e3)},this.calculateVolume=o=>{if(o.length===0)return 0;let a=0;for(let c=0;c<o.length;c++)a+=o[c]/255;return a/=o.length,a<0?0:a>1?1:a},this.setVolume=({volume:o})=>{const a=Number.isFinite(o)?Math.min(1,Math.max(0,o)):1;this.volume=a,this.connection instanceof jr?this.connection.setAudioVolume(a):this.output.gain.gain.value=a},this.input=i,this.output=s,this.wakeLock=r,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage,r&&(this.visibilityChangeHandler=()=>{var o;document.visibilityState==="visible"&&(o=this.wakeLock)!=null&&o.released&&tf.requestWakeLock().then(a=>{this.wakeLock=a})},document.addEventListener("visibilitychange",this.visibilityChangeHandler))}async handleEndSession(){await super.handleEndSession(),this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler);try{var e;await((e=this.wakeLock)==null?void 0:e.release()),this.wakeLock=null}catch{}await this.input.close(),await this.output.close()}handleInterruption(e){super.handleInterruption(e),this.fadeOutAudio()}handleAudio(e){var t,i;super.handleAudio(e),e.audio_event.alignment&&this.options.onAudioAlignment&&this.options.onAudioAlignment(e.audio_event.alignment),this.lastInterruptTimestamp<=e.audio_event.event_id&&(e.audio_event.audio_base_64&&((t=(i=this.options).onAudio)==null||t.call(i,e.audio_event.audio_base_64),this.connection instanceof jr||this.addAudioBase64Chunk(e.audio_event.audio_base_64)),this.currentEventId=e.audio_event.event_id,this.updateCanSendFeedback(),this.updateMode("speaking"))}setMicMuted(e){this.connection instanceof jr?this.connection.setMicMuted(e):this.input.setMuted(e)}getInputByteFrequencyData(){return this.inputFrequencyData!=null||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData}getOutputByteFrequencyData(){return this.connection instanceof jr?this.connection.getOutputByteFrequencyData()||new Uint8Array(1024):(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData)}getInputVolume(){return this.calculateVolume(this.getInputByteFrequencyData())}getOutputVolume(){return this.calculateVolume(this.getOutputByteFrequencyData())}async changeInputDevice({sampleRate:e,format:t,preferHeadphonesForIosDevices:i,inputDeviceId:s}){try{if(this.connection instanceof Fk)try{return await this.input.setInputDevice(s),this.input}catch(o){console.warn("Failed to change device on existing input, recreating:",o)}this.connection instanceof jr&&await this.connection.setAudioInputDevice(s||""),await this.input.close();const r=await Pu.create({sampleRate:e??this.connection.inputFormat.sampleRate,format:t??this.connection.inputFormat.format,preferHeadphonesForIosDevices:i,inputDeviceId:s,workletPaths:this.options.workletPaths,libsampleratePath:this.options.libsampleratePath});return this.input=r,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.input}catch(r){throw console.error("Error changing input device",r),r}}async changeOutputDevice({sampleRate:e,format:t,outputDeviceId:i}){try{if(this.connection instanceof Fk)try{return await this.output.setOutputDevice(i),this.output}catch(r){console.warn("Failed to change device on existing output, recreating:",r)}this.connection instanceof jr&&await this.connection.setAudioOutputDevice(i||""),await this.output.close();const s=await Ky.create({sampleRate:e??this.connection.outputFormat.sampleRate,format:t??this.connection.outputFormat.format,outputDeviceId:i,workletPaths:this.options.workletPaths});return this.output=s,this.output}catch(s){throw console.error("Error changing output device",s),s}}}var sB;(function(n){n.SESSION_STARTED="session_started",n.PARTIAL_TRANSCRIPT="partial_transcript",n.COMMITTED_TRANSCRIPT="committed_transcript",n.COMMITTED_TRANSCRIPT_WITH_TIMESTAMPS="committed_transcript_with_timestamps",n.AUTH_ERROR="auth_error",n.ERROR="error",n.OPEN="open",n.CLOSE="close",n.QUOTA_EXCEEDED="quota_exceeded",n.COMMIT_THROTTLED="commit_throttled",n.TRANSCRIBER_ERROR="transcriber_error",n.UNACCEPTED_TERMS="unaccepted_terms",n.RATE_LIMITED="rate_limited",n.INPUT_ERROR="input_error",n.QUEUE_OVERFLOW="queue_overflow",n.RESOURCE_EXHAUSTED="resource_exhausted",n.SESSION_TIME_LIMIT_EXCEEDED="session_time_limit_exceeded",n.CHUNK_SIZE_EXCEEDED="chunk_size_exceeded",n.INSUFFICIENT_AUDIO_ACTIVITY="insufficient_audio_activity"})(sB||(sB={}));var rB,oB;(function(n){n.PCM_8000="pcm_8000",n.PCM_16000="pcm_16000",n.PCM_22050="pcm_22050",n.PCM_24000="pcm_24000",n.PCM_44100="pcm_44100",n.PCM_48000="pcm_48000",n.ULAW_8000="ulaw_8000"})(rB||(rB={})),function(n){n.MANUAL="manual",n.VAD="vad"}(oB||(oB={}));class U2 extends Lf{static startSession(e){return e.textOnly?g1.startSession(e):tf.startSession(e)}}function nf(){return nf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},nf.apply(null,arguments)}const z2=["micMuted","volume","serverLocation"];function V2(n="us"){switch(n){case"eu-residency":case"in-residency":case"us":case"global":return n;default:return console.warn(`[ConversationalAI] Invalid server-location: ${n}. Defaulting to "us"`),"us"}}function H2(n){return{us:"wss://api.elevenlabs.io","eu-residency":"wss://api.eu.residency.elevenlabs.io","in-residency":"wss://api.in.residency.elevenlabs.io",global:"wss://api.elevenlabs.io"}[n]}function G2(n){return{us:"wss://livekit.rtc.elevenlabs.io","eu-residency":"wss://livekit.rtc.eu.residency.elevenlabs.io","in-residency":"wss://livekit.rtc.in.residency.elevenlabs.io",global:"wss://livekit.rtc.elevenlabs.io"}[n]}function W2(n={}){const{micMuted:e,volume:t,serverLocation:i}=n,s=function(k,C){if(k==null)return{};var A={};for(var T in k)if({}.hasOwnProperty.call(k,T)){if(C.indexOf(T)!==-1)continue;A[T]=k[T]}return A}(n,z2),r=P.useRef(null),o=P.useRef(null),a=P.useRef(!1),[c,d]=P.useState("disconnected"),[h,f]=P.useState(!1),[m,y]=P.useState("listening"),v=P.useRef(e),x=P.useRef(t);return v.current=e,x.current=t,P.useEffect(()=>{var k;e!==void 0&&(r==null||(k=r.current)==null||k.setMicMuted(e))},[e]),P.useEffect(()=>{var k;t!==void 0&&(r==null||(k=r.current)==null||k.setVolume({volume:t}))},[t]),P.useEffect(()=>()=>{var k;a.current=!0,o.current?o.current.then(C=>C.endSession()):(k=r.current)==null||k.endSession()},[]),{startSession:async k=>{var C;if((C=r.current)!=null&&C.isOpen())return r.current.getId();if(o.current)return(await o.current).getId();a.current=!1;try{var A,T,E,_,R,B,I,L,O,W;const ie=V2((k==null?void 0:k.serverLocation)||i),he=H2(ie),ae=G2(ie);if(o.current=U2.startSession(nf({},s??{},k??{},{origin:he,livekitUrl:(k==null?void 0:k.livekitUrl)||(s==null?void 0:s.livekitUrl)||ae,overrides:nf({},(A=s==null?void 0:s.overrides)!=null?A:{},(T=k==null?void 0:k.overrides)!=null?T:{},{client:nf({},(E=s==null||(_=s.overrides)==null?void 0:_.client)!=null?E:{},(R=k==null||(B=k.overrides)==null?void 0:B.client)!=null?R:{},{source:(k==null||(I=k.overrides)==null||(I=I.client)==null?void 0:I.source)||(s==null||(L=s.overrides)==null||(L=L.client)==null?void 0:L.source)||"react_sdk",version:(k==null||(O=k.overrides)==null||(O=O.client)==null?void 0:O.version)||(s==null||(W=s.overrides)==null||(W=W.client)==null?void 0:W.version)||"0.13.0"})}),onConnect:(k==null?void 0:k.onConnect)||(s==null?void 0:s.onConnect),onDisconnect:(k==null?void 0:k.onDisconnect)||(s==null?void 0:s.onDisconnect),onError:(k==null?void 0:k.onError)||(s==null?void 0:s.onError),onMessage:(k==null?void 0:k.onMessage)||(s==null?void 0:s.onMessage),onAudio:(k==null?void 0:k.onAudio)||(s==null?void 0:s.onAudio),onDebug:(k==null?void 0:k.onDebug)||(s==null?void 0:s.onDebug),onUnhandledClientToolCall:(k==null?void 0:k.onUnhandledClientToolCall)||(s==null?void 0:s.onUnhandledClientToolCall),onVadScore:(k==null?void 0:k.onVadScore)||(s==null?void 0:s.onVadScore),onInterruption:(k==null?void 0:k.onInterruption)||(s==null?void 0:s.onInterruption),onAgentToolRequest:(k==null?void 0:k.onAgentToolRequest)||(s==null?void 0:s.onAgentToolRequest),onAgentToolResponse:(k==null?void 0:k.onAgentToolResponse)||(s==null?void 0:s.onAgentToolResponse),onConversationMetadata:(k==null?void 0:k.onConversationMetadata)||(s==null?void 0:s.onConversationMetadata),onMCPToolCall:(k==null?void 0:k.onMCPToolCall)||(s==null?void 0:s.onMCPToolCall),onMCPConnectionStatus:(k==null?void 0:k.onMCPConnectionStatus)||(s==null?void 0:s.onMCPConnectionStatus),onAsrInitiationMetadata:(k==null?void 0:k.onAsrInitiationMetadata)||(s==null?void 0:s.onAsrInitiationMetadata),onAgentChatResponsePart:(k==null?void 0:k.onAgentChatResponsePart)||(s==null?void 0:s.onAgentChatResponsePart),onAudioAlignment:(k==null?void 0:k.onAudioAlignment)||(s==null?void 0:s.onAudioAlignment),onModeChange:({mode:le})=>{var K;y(le),(K=(k==null?void 0:k.onModeChange)||(s==null?void 0:s.onModeChange))==null||K({mode:le})},onStatusChange:({status:le})=>{var K;d(le),(K=(k==null?void 0:k.onStatusChange)||(s==null?void 0:s.onStatusChange))==null||K({status:le})},onCanSendFeedbackChange:({canSendFeedback:le})=>{var K;f(le),(K=(k==null?void 0:k.onCanSendFeedbackChange)||(s==null?void 0:s.onCanSendFeedbackChange))==null||K({canSendFeedback:le})}})),r.current=await o.current,a.current)throw await r.current.endSession(),r.current=null,o.current=null,new Error("Session cancelled during connection");return v.current!==void 0&&r.current.setMicMuted(v.current),x.current!==void 0&&r.current.setVolume({volume:x.current}),r.current.getId()}finally{o.current=null}},endSession:async()=>{a.current=!0;const k=o.current,C=r.current;r.current=null,k?await(await k).endSession():await(C==null?void 0:C.endSession())},setVolume:({volume:k})=>{var C;(C=r.current)==null||C.setVolume({volume:k})},getInputByteFrequencyData:()=>{var k;return(k=r.current)==null?void 0:k.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var k;return(k=r.current)==null?void 0:k.getOutputByteFrequencyData()},getInputVolume:()=>{var k,C;return(k=(C=r.current)==null?void 0:C.getInputVolume())!=null?k:0},getOutputVolume:()=>{var k,C;return(k=(C=r.current)==null?void 0:C.getOutputVolume())!=null?k:0},sendFeedback:k=>{var C;(C=r.current)==null||C.sendFeedback(k)},getId:()=>{var k;return(k=r.current)==null?void 0:k.getId()},sendContextualUpdate:k=>{var C;(C=r.current)==null||C.sendContextualUpdate(k)},sendUserMessage:k=>{var C;(C=r.current)==null||C.sendUserMessage(k)},sendUserActivity:()=>{var k;(k=r.current)==null||k.sendUserActivity()},sendMCPToolApprovalResult:(k,C)=>{var A;(A=r.current)==null||A.sendMCPToolApprovalResult(k,C)},changeInputDevice:async k=>{if(r.current&&"changeInputDevice"in r.current)return await r.current.changeInputDevice(k);throw new Error("Device switching is only available for voice conversations")},changeOutputDevice:async k=>{if(r.current&&"changeOutputDevice"in r.current)return await r.current.changeOutputDevice(k);throw new Error("Device switching is only available for voice conversations")},status:c,canSendFeedback:h,micMuted:e,isSpeaking:m==="speaking"}}const J2=({agentId:n,onSpeakingChange:e})=>{const[t,i]=P.useState(null),s=W2({onConnect:()=>console.log("Connected"),onDisconnect:()=>console.log("Disconnected"),onMessage:c=>console.log("Message:",c),onError:c=>{console.error("ElevenLabs Error:",c),i(c.message||"Unknown error")}}),{status:r,isSpeaking:o}=s;P.useEffect(()=>{e&&e(o)},[o,e]);const a=P.useCallback(async()=>{try{if(r==="connected"){await s.endSession();return}const c="sk_5e0e35096c4390b9e83d1f05fe9578144b20b56188baccfa",d=await fetch(`https://api.elevenlabs.io/v1/convai/conversation/get_signed_url?agent_id=${n}`,{method:"GET",headers:{"xi-api-key":c}});if(!d.ok)throw new Error(`Failed to auth: ${d.statusText}`);const h=await d.json();await s.startSession({signedUrl:h.signed_url})}catch(c){console.error("Connection failed:",c),i("Connection failed. Check console.")}},[s,r,n]);return S.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 border rounded-lg shadow-sm bg-white max-w-sm mx-auto",children:[S.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center transition-colors ${r==="connected"?"bg-green-100 border-4 border-green-500":"bg-gray-100 border-4 border-gray-300"}`,children:S.jsx("span",{className:"text-3xl",children:r==="connected"?o?"":"":""})}),S.jsxs("div",{className:"text-center",children:[S.jsx("h3",{className:"font-bold text-lg",children:"NeuroPal Agent"}),S.jsx("p",{className:"text-sm text-gray-500",children:r==="connected"?"Listening...":"Tap to start"})]}),S.jsx("button",{onClick:a,disabled:r==="connecting",className:`px-8 py-3 rounded-full font-bold text-white transition-all transform hover:scale-105 ${r==="connected"?"bg-red-500 hover:bg-red-600 shadow-red-200":"bg-blue-600 hover:bg-blue-700 shadow-blue-200"} shadow-lg disabled:opacity-70 disabled:cursor-not-allowed`,children:r==="connecting"?"Connecting...":r==="connected"?"End Chat":"Start Chat"}),t&&S.jsx("div",{className:"text-red-500 text-xs text-center px-2",children:t})]})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const y1="182",qy=0,K2=1,q2=2,aB=1,lB=100,cB=204,uB=205,dB=3,Q2=0,hB="attached",$2="detached",Oj=300,jf=1e3,Nh=1001,Lk=1002,jk=1003,X2=1004,Y2=1005,v1=1006,Z2=1007,b1=1008,Lj=1009,x1=1015,jj=1023,eee=1028,Uf=2300,zf=2301,Wx=2302,fB=2400,pB=2401,mB=2402,tee=2500,nee=0,Uj=1,Uk=2,iee=0,zj="",Cs="srgb",gB="srgb-linear",yB="linear",Jx="srgb",Nc=7680,vB=519,zk=35044,wl=2e3,Vk=2001;function see(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function ree(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Hk(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}const bB={};function xB(...n){const e="THREE."+n.shift();console.log(e,...n)}function rt(...n){const e="THREE."+n.shift();console.warn(e,...n)}function xt(...n){const e="THREE."+n.shift();console.error(e,...n)}function SB(...n){const e=n.join(" ");e in bB||(bB[e]=!0,rt(...n))}class Lv{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}const In=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let CB=1234567;const sf=Math.PI/180,Vf=180/Math.PI;function Bs(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(In[n&255]+In[n>>8&255]+In[n>>16&255]+In[n>>24&255]+"-"+In[e&255]+In[e>>8&255]+"-"+In[e>>16&15|64]+In[e>>24&255]+"-"+In[t&63|128]+In[t>>8&255]+"-"+In[t>>16&255]+In[t>>24&255]+In[i&255]+In[i>>8&255]+In[i>>16&255]+In[i>>24&255]).toLowerCase()}function Fe(n,e,t){return Math.max(e,Math.min(t,n))}function S1(n,e){return(n%e+e)%e}function oee(n,e,t,i,s){return i+(n-e)*(s-i)/(t-e)}function aee(n,e,t){return n!==e?(t-n)/(e-n):0}function rf(n,e,t){return(1-t)*n+t*e}function lee(n,e,t,i){return rf(n,e,1-Math.exp(-t*i))}function cee(n,e=1){return e-Math.abs(S1(n,e*2)-e)}function uee(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function dee(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function hee(n,e){return n+Math.floor(Math.random()*(e-n+1))}function fee(n,e){return n+Math.random()*(e-n)}function pee(n){return n*(.5-Math.random())}function mee(n){n!==void 0&&(CB=n);let e=CB+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function gee(n){return n*sf}function yee(n){return n*Vf}function vee(n){return(n&n-1)===0&&n!==0}function bee(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function xee(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function See(n,e,t,i,s){const r=Math.cos,o=Math.sin,a=r(t/2),c=o(t/2),d=r((e+i)/2),h=o((e+i)/2),f=r((e-i)/2),m=o((e-i)/2),y=r((i-e)/2),v=o((i-e)/2);switch(s){case"XYX":n.set(a*h,c*f,c*m,a*d);break;case"YZY":n.set(c*m,a*h,c*f,a*d);break;case"ZXZ":n.set(c*f,c*m,a*h,a*d);break;case"XZX":n.set(a*h,c*v,c*y,a*d);break;case"YXY":n.set(c*y,a*h,c*v,a*d);break;case"ZYZ":n.set(c*v,c*y,a*h,a*d);break;default:rt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Es(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function et(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Cee={DEG2RAD:sf,RAD2DEG:Vf,generateUUID:Bs,clamp:Fe,euclideanModulo:S1,mapLinear:oee,inverseLerp:aee,lerp:rf,damp:lee,pingpong:cee,smoothstep:uee,smootherstep:dee,randInt:hee,randFloat:fee,randFloatSpread:pee,seededRandom:mee,degToRad:gee,radToDeg:yee,isPowerOfTwo:vee,ceilPowerOfTwo:bee,floorPowerOfTwo:xee,setQuaternionFromProperEuler:See,normalize:et,denormalize:Es};class $t{constructor(e=0,t=0){$t.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Fe(this.x,e.x,t.x),this.y=Fe(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Fe(this.x,e,t),this.y=Fe(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Fe(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Fe(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*s+e.x,this.y=r*s+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class za{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,r,o,a){let c=i[s+0],d=i[s+1],h=i[s+2],f=i[s+3],m=r[o+0],y=r[o+1],v=r[o+2],x=r[o+3];if(a<=0){e[t+0]=c,e[t+1]=d,e[t+2]=h,e[t+3]=f;return}if(a>=1){e[t+0]=m,e[t+1]=y,e[t+2]=v,e[t+3]=x;return}if(f!==x||c!==m||d!==y||h!==v){let k=c*m+d*y+h*v+f*x;k<0&&(m=-m,y=-y,v=-v,x=-x,k=-k);let C=1-a;if(k<.9995){const A=Math.acos(k),T=Math.sin(A);C=Math.sin(C*A)/T,a=Math.sin(a*A)/T,c=c*C+m*a,d=d*C+y*a,h=h*C+v*a,f=f*C+x*a}else{c=c*C+m*a,d=d*C+y*a,h=h*C+v*a,f=f*C+x*a;const A=1/Math.sqrt(c*c+d*d+h*h+f*f);c*=A,d*=A,h*=A,f*=A}}e[t]=c,e[t+1]=d,e[t+2]=h,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,s,r,o){const a=i[s],c=i[s+1],d=i[s+2],h=i[s+3],f=r[o],m=r[o+1],y=r[o+2],v=r[o+3];return e[t]=a*v+h*f+c*y-d*m,e[t+1]=c*v+h*m+d*f-a*y,e[t+2]=d*v+h*y+a*m-c*f,e[t+3]=h*v-a*f-c*m-d*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,s=e._y,r=e._z,o=e._order,a=Math.cos,c=Math.sin,d=a(i/2),h=a(s/2),f=a(r/2),m=c(i/2),y=c(s/2),v=c(r/2);switch(o){case"XYZ":this._x=m*h*f+d*y*v,this._y=d*y*f-m*h*v,this._z=d*h*v+m*y*f,this._w=d*h*f-m*y*v;break;case"YXZ":this._x=m*h*f+d*y*v,this._y=d*y*f-m*h*v,this._z=d*h*v-m*y*f,this._w=d*h*f+m*y*v;break;case"ZXY":this._x=m*h*f-d*y*v,this._y=d*y*f+m*h*v,this._z=d*h*v+m*y*f,this._w=d*h*f-m*y*v;break;case"ZYX":this._x=m*h*f-d*y*v,this._y=d*y*f+m*h*v,this._z=d*h*v-m*y*f,this._w=d*h*f+m*y*v;break;case"YZX":this._x=m*h*f+d*y*v,this._y=d*y*f+m*h*v,this._z=d*h*v-m*y*f,this._w=d*h*f-m*y*v;break;case"XZY":this._x=m*h*f-d*y*v,this._y=d*y*f-m*h*v,this._z=d*h*v+m*y*f,this._w=d*h*f+m*y*v;break;default:rt("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],r=t[8],o=t[1],a=t[5],c=t[9],d=t[2],h=t[6],f=t[10],m=i+a+f;if(m>0){const y=.5/Math.sqrt(m+1);this._w=.25/y,this._x=(h-c)*y,this._y=(r-d)*y,this._z=(o-s)*y}else if(i>a&&i>f){const y=2*Math.sqrt(1+i-a-f);this._w=(h-c)/y,this._x=.25*y,this._y=(s+o)/y,this._z=(r+d)/y}else if(a>f){const y=2*Math.sqrt(1+a-i-f);this._w=(r-d)/y,this._x=(s+o)/y,this._y=.25*y,this._z=(c+h)/y}else{const y=2*Math.sqrt(1+f-i-a);this._w=(o-s)/y,this._x=(r+d)/y,this._y=(c+h)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Fe(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,r=e._z,o=e._w,a=t._x,c=t._y,d=t._z,h=t._w;return this._x=i*h+o*a+s*d-r*c,this._y=s*h+o*c+r*a-i*d,this._z=r*h+o*d+i*c-s*a,this._w=o*h-i*a-s*c-r*d,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let i=e._x,s=e._y,r=e._z,o=e._w,a=this.dot(e);a<0&&(i=-i,s=-s,r=-r,o=-o,a=-a);let c=1-t;if(a<.9995){const d=Math.acos(a),h=Math.sin(d);c=Math.sin(c*d)/h,t=Math.sin(t*d)/h,this._x=this._x*c+i*t,this._y=this._y*c+s*t,this._z=this._z*c+r*t,this._w=this._w*c+o*t,this._onChangeCallback()}else this._x=this._x*c+i*t,this._y=this._y*c+s*t,this._z=this._z*c+r*t,this._w=this._w*c+o*t,this.normalize();return this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),r=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class q{constructor(e=0,t=0,i=0){q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(kB.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(kB.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*s,this.y=r[1]*t+r[4]*i+r[7]*s,this.z=r[2]*t+r[5]*i+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,r=e.x,o=e.y,a=e.z,c=e.w,d=2*(o*s-a*i),h=2*(a*t-r*s),f=2*(r*i-o*t);return this.x=t+c*d+o*f-a*h,this.y=i+c*h+a*d-r*f,this.z=s+c*f+r*h-o*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*s,this.y=r[1]*t+r[5]*i+r[9]*s,this.z=r[2]*t+r[6]*i+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Fe(this.x,e.x,t.x),this.y=Fe(this.y,e.y,t.y),this.z=Fe(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Fe(this.x,e,t),this.y=Fe(this.y,e,t),this.z=Fe(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Fe(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,r=e.z,o=t.x,a=t.y,c=t.z;return this.x=s*c-r*a,this.y=r*o-i*c,this.z=i*a-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Kx.copy(this).projectOnVector(e),this.sub(Kx)}reflect(e){return this.sub(Kx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Fe(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Kx=new q,kB=new za;class po{constructor(e,t,i,s,r,o,a,c,d){po.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,r,o,a,c,d)}set(e,t,i,s,r,o,a,c,d){const h=this.elements;return h[0]=e,h[1]=s,h[2]=a,h[3]=t,h[4]=r,h[5]=c,h[6]=i,h[7]=o,h[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,r=this.elements,o=i[0],a=i[3],c=i[6],d=i[1],h=i[4],f=i[7],m=i[2],y=i[5],v=i[8],x=s[0],k=s[3],C=s[6],A=s[1],T=s[4],E=s[7],_=s[2],R=s[5],B=s[8];return r[0]=o*x+a*A+c*_,r[3]=o*k+a*T+c*R,r[6]=o*C+a*E+c*B,r[1]=d*x+h*A+f*_,r[4]=d*k+h*T+f*R,r[7]=d*C+h*E+f*B,r[2]=m*x+y*A+v*_,r[5]=m*k+y*T+v*R,r[8]=m*C+y*E+v*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],a=e[5],c=e[6],d=e[7],h=e[8];return t*o*h-t*a*d-i*r*h+i*a*c+s*r*d-s*o*c}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],a=e[5],c=e[6],d=e[7],h=e[8],f=h*o-a*d,m=a*c-h*r,y=d*r-o*c,v=t*f+i*m+s*y;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/v;return e[0]=f*x,e[1]=(s*d-h*i)*x,e[2]=(a*i-s*o)*x,e[3]=m*x,e[4]=(h*t-s*c)*x,e[5]=(s*r-a*t)*x,e[6]=y*x,e[7]=(i*c-d*t)*x,e[8]=(o*t-i*r)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,r,o,a){const c=Math.cos(r),d=Math.sin(r);return this.set(i*c,i*d,-i*(c*o+d*a)+o+e,-s*d,s*c,-s*(-d*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(qx.makeScale(e,t)),this}rotate(e){return this.premultiply(qx.makeRotation(-e)),this}translate(e,t){return this.premultiply(qx.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const qx=new po,wB=new po().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),TB=new po().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function kee(){const n={enabled:!0,workingColorSpace:gB,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Jx&&(s.r=to(s.r),s.g=to(s.g),s.b=to(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Jx&&(s.r=Iu(s.r),s.g=Iu(s.g),s.b=Iu(s.b))),s},workingToColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},colorSpaceToWorking:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===zj?yB:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,r){return SB("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(s,r)},toWorkingColorSpace:function(s,r){return SB("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(s,r)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[gB]:{primaries:e,whitePoint:i,transfer:yB,toXYZ:wB,fromXYZ:TB,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Cs},outputColorSpaceConfig:{drawingBufferColorSpace:Cs}},[Cs]:{primaries:e,whitePoint:i,transfer:Jx,toXYZ:wB,fromXYZ:TB,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Cs}}}),n}const hs=kee();function to(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Iu(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Fc;class wee{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Fc===void 0&&(Fc=Hk("canvas")),Fc.width=e.width,Fc.height=e.height;const s=Fc.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=Fc}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Hk("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=to(r[o]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(to(t[i]/255)*255):t[i]=to(t[i]);return{data:t,width:e.width,height:e.height}}else return rt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Tee=0;class Aee{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Tee++}),this.uuid=Bs(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,a=s.length;o<a;o++)s[o].isDataTexture?r.push(Qx(s[o].image)):r.push(Qx(s[o]))}else r=Qx(s);i.url=r}return t||(e.images[this.uuid]=i),i}}function Qx(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?wee.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(rt("Texture: Unable to serialize Texture."),{})}let Eee=0;const $x=new q;class Ds extends Lv{constructor(e=Ds.DEFAULT_IMAGE,t=Ds.DEFAULT_MAPPING,i=Nh,s=Nh,r=v1,o=b1,a=jj,c=Lj,d=Ds.DEFAULT_ANISOTROPY,h=zj){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Eee++}),this.uuid=Bs(),this.name="",this.source=new Aee(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=d,this.format=a,this.internalFormat=null,this.type=c,this.offset=new $t(0,0),this.repeat=new $t(1,1),this.center=new $t(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new po,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize($x).x}get height(){return this.source.getSize($x).y}get depth(){return this.source.getSize($x).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const i=e[t];if(i===void 0){rt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){rt(`Texture.setValues(): property '${t}' does not exist.`);continue}s&&i&&s.isVector2&&i.isVector2||s&&i&&s.isVector3&&i.isVector3||s&&i&&s.isMatrix3&&i.isMatrix3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Oj)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case jf:e.x=e.x-Math.floor(e.x);break;case Nh:e.x=e.x<0?0:1;break;case Lk:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case jf:e.y=e.y-Math.floor(e.y);break;case Nh:e.y=e.y<0?0:1;break;case Lk:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ds.DEFAULT_IMAGE=null;Ds.DEFAULT_MAPPING=Oj;Ds.DEFAULT_ANISOTROPY=1;class mo{constructor(e=0,t=0,i=0,s=1){mo.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,r;const c=e.elements,d=c[0],h=c[4],f=c[8],m=c[1],y=c[5],v=c[9],x=c[2],k=c[6],C=c[10];if(Math.abs(h-m)<.01&&Math.abs(f-x)<.01&&Math.abs(v-k)<.01){if(Math.abs(h+m)<.1&&Math.abs(f+x)<.1&&Math.abs(v+k)<.1&&Math.abs(d+y+C-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(d+1)/2,E=(y+1)/2,_=(C+1)/2,R=(h+m)/4,B=(f+x)/4,I=(v+k)/4;return T>E&&T>_?T<.01?(i=0,s=.707106781,r=.707106781):(i=Math.sqrt(T),s=R/i,r=B/i):E>_?E<.01?(i=.707106781,s=0,r=.707106781):(s=Math.sqrt(E),i=R/s,r=I/s):_<.01?(i=.707106781,s=.707106781,r=0):(r=Math.sqrt(_),i=B/r,s=I/r),this.set(i,s,r,t),this}let A=Math.sqrt((k-v)*(k-v)+(f-x)*(f-x)+(m-h)*(m-h));return Math.abs(A)<.001&&(A=1),this.x=(k-v)/A,this.y=(f-x)/A,this.z=(m-h)/A,this.w=Math.acos((d+y+C-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Fe(this.x,e.x,t.x),this.y=Fe(this.y,e.y,t.y),this.z=Fe(this.z,e.z,t.z),this.w=Fe(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Fe(this.x,e,t),this.y=Fe(this.y,e,t),this.z=Fe(this.z,e,t),this.w=Fe(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Fe(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class go{constructor(e=new q(1/0,1/0,1/0),t=new q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(fs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(fs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=fs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const r=i.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=r.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,fs):fs.fromBufferAttribute(r,o),fs.applyMatrix4(e.matrixWorld),this.expandByPoint(fs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Wm.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Wm.copy(i.boundingBox)),Wm.applyMatrix4(e.matrixWorld),this.union(Wm)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,fs),fs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(yh),Jm.subVectors(this.max,yh),Oc.subVectors(e.a,yh),Lc.subVectors(e.b,yh),jc.subVectors(e.c,yh),Uo.subVectors(Lc,Oc),zo.subVectors(jc,Lc),al.subVectors(Oc,jc);let t=[0,-Uo.z,Uo.y,0,-zo.z,zo.y,0,-al.z,al.y,Uo.z,0,-Uo.x,zo.z,0,-zo.x,al.z,0,-al.x,-Uo.y,Uo.x,0,-zo.y,zo.x,0,-al.y,al.x,0];return!Xx(t,Oc,Lc,jc,Jm)||(t=[1,0,0,0,1,0,0,0,1],!Xx(t,Oc,Lc,jc,Jm))?!1:(Km.crossVectors(Uo,zo),t=[Km.x,Km.y,Km.z],Xx(t,Oc,Lc,jc,Jm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(fs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ar[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ar[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ar[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ar[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ar[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ar[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ar[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ar[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ar),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Ar=[new q,new q,new q,new q,new q,new q,new q,new q],fs=new q,Wm=new go,Oc=new q,Lc=new q,jc=new q,Uo=new q,zo=new q,al=new q,yh=new q,Jm=new q,Km=new q,ll=new q;function Xx(n,e,t,i,s){for(let r=0,o=n.length-3;r<=o;r+=3){ll.fromArray(n,r);const a=s.x*Math.abs(ll.x)+s.y*Math.abs(ll.y)+s.z*Math.abs(ll.z),c=e.dot(ll),d=t.dot(ll),h=i.dot(ll);if(Math.max(-Math.max(c,d,h),Math.min(c,d,h))>a)return!1}return!0}const _ee=new go,vh=new q,Yx=new q;class ur{constructor(e=new q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):_ee.setFromPoints(e).getCenter(i);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;vh.subVectors(e,this.center);const t=vh.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(vh,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Yx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(vh.copy(e.center).add(Yx)),this.expandByPoint(vh.copy(e.center).sub(Yx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Er=new q,Zx=new q,qm=new q,Vo=new q,eS=new q,Qm=new q,tS=new q;class jv{constructor(e=new q,t=new q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Er)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Er.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Er.copy(this.origin).addScaledVector(this.direction,t),Er.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Zx.copy(e).add(t).multiplyScalar(.5),qm.copy(t).sub(e).normalize(),Vo.copy(this.origin).sub(Zx);const r=e.distanceTo(t)*.5,o=-this.direction.dot(qm),a=Vo.dot(this.direction),c=-Vo.dot(qm),d=Vo.lengthSq(),h=Math.abs(1-o*o);let f,m,y,v;if(h>0)if(f=o*c-a,m=o*a-c,v=r*h,f>=0)if(m>=-v)if(m<=v){const x=1/h;f*=x,m*=x,y=f*(f+o*m+2*a)+m*(o*f+m+2*c)+d}else m=r,f=Math.max(0,-(o*m+a)),y=-f*f+m*(m+2*c)+d;else m=-r,f=Math.max(0,-(o*m+a)),y=-f*f+m*(m+2*c)+d;else m<=-v?(f=Math.max(0,-(-o*r+a)),m=f>0?-r:Math.min(Math.max(-r,-c),r),y=-f*f+m*(m+2*c)+d):m<=v?(f=0,m=Math.min(Math.max(-r,-c),r),y=m*(m+2*c)+d):(f=Math.max(0,-(o*r+a)),m=f>0?r:Math.min(Math.max(-r,-c),r),y=-f*f+m*(m+2*c)+d);else m=o>0?-r:r,f=Math.max(0,-(o*m+a)),y=-f*f+m*(m+2*c)+d;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(Zx).addScaledVector(qm,m),y}intersectSphere(e,t){Er.subVectors(e.center,this.origin);const i=Er.dot(this.direction),s=Er.dot(Er)-i*i,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),a=i-o,c=i+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,r,o,a,c;const d=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,m=this.origin;return d>=0?(i=(e.min.x-m.x)*d,s=(e.max.x-m.x)*d):(i=(e.max.x-m.x)*d,s=(e.min.x-m.x)*d),h>=0?(r=(e.min.y-m.y)*h,o=(e.max.y-m.y)*h):(r=(e.max.y-m.y)*h,o=(e.min.y-m.y)*h),i>o||r>s||((r>i||isNaN(i))&&(i=r),(o<s||isNaN(s))&&(s=o),f>=0?(a=(e.min.z-m.z)*f,c=(e.max.z-m.z)*f):(a=(e.max.z-m.z)*f,c=(e.min.z-m.z)*f),i>c||a>s)||((a>i||i!==i)&&(i=a),(c<s||s!==s)&&(s=c),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,Er)!==null}intersectTriangle(e,t,i,s,r){eS.subVectors(t,e),Qm.subVectors(i,e),tS.crossVectors(eS,Qm);let o=this.direction.dot(tS),a;if(o>0){if(s)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Vo.subVectors(this.origin,e);const c=a*this.direction.dot(Qm.crossVectors(Vo,Qm));if(c<0)return null;const d=a*this.direction.dot(eS.cross(Vo));if(d<0||c+d>o)return null;const h=-a*Vo.dot(tS);return h<0?null:this.at(h/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class He{constructor(e,t,i,s,r,o,a,c,d,h,f,m,y,v,x,k){He.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,r,o,a,c,d,h,f,m,y,v,x,k)}set(e,t,i,s,r,o,a,c,d,h,f,m,y,v,x,k){const C=this.elements;return C[0]=e,C[4]=t,C[8]=i,C[12]=s,C[1]=r,C[5]=o,C[9]=a,C[13]=c,C[2]=d,C[6]=h,C[10]=f,C[14]=m,C[3]=y,C[7]=v,C[11]=x,C[15]=k,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new He().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,i=e.elements,s=1/Uc.setFromMatrixColumn(e,0).length(),r=1/Uc.setFromMatrixColumn(e,1).length(),o=1/Uc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,r=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(s),d=Math.sin(s),h=Math.cos(r),f=Math.sin(r);if(e.order==="XYZ"){const m=o*h,y=o*f,v=a*h,x=a*f;t[0]=c*h,t[4]=-c*f,t[8]=d,t[1]=y+v*d,t[5]=m-x*d,t[9]=-a*c,t[2]=x-m*d,t[6]=v+y*d,t[10]=o*c}else if(e.order==="YXZ"){const m=c*h,y=c*f,v=d*h,x=d*f;t[0]=m+x*a,t[4]=v*a-y,t[8]=o*d,t[1]=o*f,t[5]=o*h,t[9]=-a,t[2]=y*a-v,t[6]=x+m*a,t[10]=o*c}else if(e.order==="ZXY"){const m=c*h,y=c*f,v=d*h,x=d*f;t[0]=m-x*a,t[4]=-o*f,t[8]=v+y*a,t[1]=y+v*a,t[5]=o*h,t[9]=x-m*a,t[2]=-o*d,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const m=o*h,y=o*f,v=a*h,x=a*f;t[0]=c*h,t[4]=v*d-y,t[8]=m*d+x,t[1]=c*f,t[5]=x*d+m,t[9]=y*d-v,t[2]=-d,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const m=o*c,y=o*d,v=a*c,x=a*d;t[0]=c*h,t[4]=x-m*f,t[8]=v*f+y,t[1]=f,t[5]=o*h,t[9]=-a*h,t[2]=-d*h,t[6]=y*f+v,t[10]=m-x*f}else if(e.order==="XZY"){const m=o*c,y=o*d,v=a*c,x=a*d;t[0]=c*h,t[4]=-f,t[8]=d*h,t[1]=m*f+x,t[5]=o*h,t[9]=y*f-v,t[2]=v*f-y,t[6]=a*h,t[10]=x*f+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Mee,e,Ree)}lookAt(e,t,i){const s=this.elements;return Ei.subVectors(e,t),Ei.lengthSq()===0&&(Ei.z=1),Ei.normalize(),Ho.crossVectors(i,Ei),Ho.lengthSq()===0&&(Math.abs(i.z)===1?Ei.x+=1e-4:Ei.z+=1e-4,Ei.normalize(),Ho.crossVectors(i,Ei)),Ho.normalize(),$m.crossVectors(Ei,Ho),s[0]=Ho.x,s[4]=$m.x,s[8]=Ei.x,s[1]=Ho.y,s[5]=$m.y,s[9]=Ei.y,s[2]=Ho.z,s[6]=$m.z,s[10]=Ei.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,r=this.elements,o=i[0],a=i[4],c=i[8],d=i[12],h=i[1],f=i[5],m=i[9],y=i[13],v=i[2],x=i[6],k=i[10],C=i[14],A=i[3],T=i[7],E=i[11],_=i[15],R=s[0],B=s[4],I=s[8],L=s[12],O=s[1],W=s[5],ie=s[9],he=s[13],ae=s[2],le=s[6],K=s[10],ee=s[14],z=s[3],X=s[7],te=s[11],ye=s[15];return r[0]=o*R+a*O+c*ae+d*z,r[4]=o*B+a*W+c*le+d*X,r[8]=o*I+a*ie+c*K+d*te,r[12]=o*L+a*he+c*ee+d*ye,r[1]=h*R+f*O+m*ae+y*z,r[5]=h*B+f*W+m*le+y*X,r[9]=h*I+f*ie+m*K+y*te,r[13]=h*L+f*he+m*ee+y*ye,r[2]=v*R+x*O+k*ae+C*z,r[6]=v*B+x*W+k*le+C*X,r[10]=v*I+x*ie+k*K+C*te,r[14]=v*L+x*he+k*ee+C*ye,r[3]=A*R+T*O+E*ae+_*z,r[7]=A*B+T*W+E*le+_*X,r[11]=A*I+T*ie+E*K+_*te,r[15]=A*L+T*he+E*ee+_*ye,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],r=e[12],o=e[1],a=e[5],c=e[9],d=e[13],h=e[2],f=e[6],m=e[10],y=e[14],v=e[3],x=e[7],k=e[11],C=e[15],A=c*y-d*m,T=a*y-d*f,E=a*m-c*f,_=o*y-d*h,R=o*m-c*h,B=o*f-a*h;return t*(x*A-k*T+C*E)-i*(v*A-k*_+C*R)+s*(v*T-x*_+C*B)-r*(v*E-x*R+k*B)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],a=e[5],c=e[6],d=e[7],h=e[8],f=e[9],m=e[10],y=e[11],v=e[12],x=e[13],k=e[14],C=e[15],A=f*k*d-x*m*d+x*c*y-a*k*y-f*c*C+a*m*C,T=v*m*d-h*k*d-v*c*y+o*k*y+h*c*C-o*m*C,E=h*x*d-v*f*d+v*a*y-o*x*y-h*a*C+o*f*C,_=v*f*c-h*x*c-v*a*m+o*x*m+h*a*k-o*f*k,R=t*A+i*T+s*E+r*_;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const B=1/R;return e[0]=A*B,e[1]=(x*m*r-f*k*r-x*s*y+i*k*y+f*s*C-i*m*C)*B,e[2]=(a*k*r-x*c*r+x*s*d-i*k*d-a*s*C+i*c*C)*B,e[3]=(f*c*r-a*m*r-f*s*d+i*m*d+a*s*y-i*c*y)*B,e[4]=T*B,e[5]=(h*k*r-v*m*r+v*s*y-t*k*y-h*s*C+t*m*C)*B,e[6]=(v*c*r-o*k*r-v*s*d+t*k*d+o*s*C-t*c*C)*B,e[7]=(o*m*r-h*c*r+h*s*d-t*m*d-o*s*y+t*c*y)*B,e[8]=E*B,e[9]=(v*f*r-h*x*r-v*i*y+t*x*y+h*i*C-t*f*C)*B,e[10]=(o*x*r-v*a*r+v*i*d-t*x*d-o*i*C+t*a*C)*B,e[11]=(h*a*r-o*f*r-h*i*d+t*f*d+o*i*y-t*a*y)*B,e[12]=_*B,e[13]=(h*x*s-v*f*s+v*i*m-t*x*m-h*i*k+t*f*k)*B,e[14]=(v*a*s-o*x*s-v*i*c+t*x*c+o*i*k-t*a*k)*B,e[15]=(o*f*s-h*a*s+h*i*c-t*f*c-o*i*m+t*a*m)*B,this}scale(e){const t=this.elements,i=e.x,s=e.y,r=e.z;return t[0]*=i,t[4]*=s,t[8]*=r,t[1]*=i,t[5]*=s,t[9]*=r,t[2]*=i,t[6]*=s,t[10]*=r,t[3]*=i,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),r=1-i,o=e.x,a=e.y,c=e.z,d=r*o,h=r*a;return this.set(d*o+i,d*a-s*c,d*c+s*a,0,d*a+s*c,h*a+i,h*c-s*o,0,d*c-s*a,h*c+s*o,r*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,r,o){return this.set(1,i,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,r=t._x,o=t._y,a=t._z,c=t._w,d=r+r,h=o+o,f=a+a,m=r*d,y=r*h,v=r*f,x=o*h,k=o*f,C=a*f,A=c*d,T=c*h,E=c*f,_=i.x,R=i.y,B=i.z;return s[0]=(1-(x+C))*_,s[1]=(y+E)*_,s[2]=(v-T)*_,s[3]=0,s[4]=(y-E)*R,s[5]=(1-(m+C))*R,s[6]=(k+A)*R,s[7]=0,s[8]=(v+T)*B,s[9]=(k-A)*B,s[10]=(1-(m+x))*B,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;if(e.x=s[12],e.y=s[13],e.z=s[14],this.determinant()===0)return i.set(1,1,1),t.identity(),this;let r=Uc.set(s[0],s[1],s[2]).length();const o=Uc.set(s[4],s[5],s[6]).length(),a=Uc.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),ps.copy(this);const d=1/r,h=1/o,f=1/a;return ps.elements[0]*=d,ps.elements[1]*=d,ps.elements[2]*=d,ps.elements[4]*=h,ps.elements[5]*=h,ps.elements[6]*=h,ps.elements[8]*=f,ps.elements[9]*=f,ps.elements[10]*=f,t.setFromRotationMatrix(ps),i.x=r,i.y=o,i.z=a,this}makePerspective(e,t,i,s,r,o,a=wl,c=!1){const d=this.elements,h=2*r/(t-e),f=2*r/(i-s),m=(t+e)/(t-e),y=(i+s)/(i-s);let v,x;if(c)v=r/(o-r),x=o*r/(o-r);else if(a===wl)v=-(o+r)/(o-r),x=-2*o*r/(o-r);else if(a===Vk)v=-o/(o-r),x=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return d[0]=h,d[4]=0,d[8]=m,d[12]=0,d[1]=0,d[5]=f,d[9]=y,d[13]=0,d[2]=0,d[6]=0,d[10]=v,d[14]=x,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,i,s,r,o,a=wl,c=!1){const d=this.elements,h=2/(t-e),f=2/(i-s),m=-(t+e)/(t-e),y=-(i+s)/(i-s);let v,x;if(c)v=1/(o-r),x=o/(o-r);else if(a===wl)v=-2/(o-r),x=-(o+r)/(o-r);else if(a===Vk)v=-1/(o-r),x=-r/(o-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return d[0]=h,d[4]=0,d[8]=0,d[12]=m,d[1]=0,d[5]=f,d[9]=0,d[13]=y,d[2]=0,d[6]=0,d[10]=v,d[14]=x,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Uc=new q,ps=new He,Mee=new q(0,0,0),Ree=new q(1,1,1),Ho=new q,$m=new q,Ei=new q,AB=new He,EB=new za;class xd{constructor(e=0,t=0,i=0,s=xd.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,s=this._order){return this._x=e,this._y=t,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const s=e.elements,r=s[0],o=s[4],a=s[8],c=s[1],d=s[5],h=s[9],f=s[2],m=s[6],y=s[10];switch(t){case"XYZ":this._y=Math.asin(Fe(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,y),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Fe(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,y),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-f,r),this._z=0);break;case"ZXY":this._x=Math.asin(Fe(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-f,y),this._z=Math.atan2(-o,d)):(this._y=0,this._z=Math.atan2(c,r));break;case"ZYX":this._y=Math.asin(-Fe(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(m,y),this._z=Math.atan2(c,r)):(this._x=0,this._z=Math.atan2(-o,d));break;case"YZX":this._z=Math.asin(Fe(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,d),this._y=Math.atan2(-f,r)):(this._x=0,this._y=Math.atan2(a,y));break;case"XZY":this._z=Math.asin(-Fe(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-h,y),this._y=0);break;default:rt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return AB.makeRotationFromQuaternion(e),this.setFromRotationMatrix(AB,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return EB.setFromEuler(this),this.setFromQuaternion(EB,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}xd.DEFAULT_ORDER="XYZ";class Pee{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Iee=0;const _B=new q,zc=new za,_r=new He,Xm=new q,bh=new q,Bee=new q,Dee=new za,MB=new q(1,0,0),RB=new q(0,1,0),PB=new q(0,0,1),IB={type:"added"},Nee={type:"removed"},Vc={type:"childadded",child:null},nS={type:"childremoved",child:null};class Ut extends Lv{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Iee++}),this.uuid=Bs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ut.DEFAULT_UP.clone();const e=new q,t=new xd,i=new za,s=new q(1,1,1);function r(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(r),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new He},normalMatrix:{value:new po}}),this.matrix=new He,this.matrixWorld=new He,this.matrixAutoUpdate=Ut.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ut.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Pee,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return zc.setFromAxisAngle(e,t),this.quaternion.multiply(zc),this}rotateOnWorldAxis(e,t){return zc.setFromAxisAngle(e,t),this.quaternion.premultiply(zc),this}rotateX(e){return this.rotateOnAxis(MB,e)}rotateY(e){return this.rotateOnAxis(RB,e)}rotateZ(e){return this.rotateOnAxis(PB,e)}translateOnAxis(e,t){return _B.copy(e).applyQuaternion(this.quaternion),this.position.add(_B.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(MB,e)}translateY(e){return this.translateOnAxis(RB,e)}translateZ(e){return this.translateOnAxis(PB,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_r.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Xm.copy(e):Xm.set(e,t,i);const s=this.parent;this.updateWorldMatrix(!0,!1),bh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_r.lookAt(bh,Xm,this.up):_r.lookAt(Xm,bh,this.up),this.quaternion.setFromRotationMatrix(_r),s&&(_r.extractRotation(s.matrixWorld),zc.setFromRotationMatrix(_r),this.quaternion.premultiply(zc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(xt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(IB),Vc.child=e,this.dispatchEvent(Vc),Vc.child=null):xt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Nee),nS.child=e,this.dispatchEvent(nS),nS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_r.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_r.multiply(e.parent.matrixWorld)),e.applyMatrix4(_r),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(IB),Vc.child=e,this.dispatchEvent(Vc),Vc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,s=this.children.length;i<s;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bh,e,Bee),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bh,Dee,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(a=>({...a})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function r(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let d=0,h=c.length;d<h;d++){const f=c[d];r(e.shapes,f)}else r(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,d=this.material.length;c<d;c++)a.push(r(e.materials,this.material[c]));s.material=a}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let a=0;a<this.children.length;a++)s.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];s.animations.push(r(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),d=o(e.textures),h=o(e.images),f=o(e.shapes),m=o(e.skeletons),y=o(e.animations),v=o(e.nodes);a.length>0&&(i.geometries=a),c.length>0&&(i.materials=c),d.length>0&&(i.textures=d),h.length>0&&(i.images=h),f.length>0&&(i.shapes=f),m.length>0&&(i.skeletons=m),y.length>0&&(i.animations=y),v.length>0&&(i.nodes=v)}return i.object=s,i;function o(a){const c=[];for(const d in a){const h=a[d];delete h.metadata,c.push(h)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}Ut.DEFAULT_UP=new q(0,1,0);Ut.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ut.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ms=new q,Mr=new q,iS=new q,Rr=new q,Hc=new q,Gc=new q,BB=new q,sS=new q,rS=new q,oS=new q,aS=new mo,lS=new mo,cS=new mo;class _s{constructor(e=new q,t=new q,i=new q){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),ms.subVectors(e,t),s.cross(ms);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,i,s,r){ms.subVectors(s,t),Mr.subVectors(i,t),iS.subVectors(e,t);const o=ms.dot(ms),a=ms.dot(Mr),c=ms.dot(iS),d=Mr.dot(Mr),h=Mr.dot(iS),f=o*d-a*a;if(f===0)return r.set(0,0,0),null;const m=1/f,y=(d*c-a*h)*m,v=(o*h-a*c)*m;return r.set(1-y-v,v,y)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,Rr)===null?!1:Rr.x>=0&&Rr.y>=0&&Rr.x+Rr.y<=1}static getInterpolation(e,t,i,s,r,o,a,c){return this.getBarycoord(e,t,i,s,Rr)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(r,Rr.x),c.addScaledVector(o,Rr.y),c.addScaledVector(a,Rr.z),c)}static getInterpolatedAttribute(e,t,i,s,r,o){return aS.setScalar(0),lS.setScalar(0),cS.setScalar(0),aS.fromBufferAttribute(e,t),lS.fromBufferAttribute(e,i),cS.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(aS,r.x),o.addScaledVector(lS,r.y),o.addScaledVector(cS,r.z),o}static isFrontFacing(e,t,i,s){return ms.subVectors(i,t),Mr.subVectors(e,t),ms.cross(Mr).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ms.subVectors(this.c,this.b),Mr.subVectors(this.a,this.b),ms.cross(Mr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return _s.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return _s.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,s,r){return _s.getInterpolation(e,this.a,this.b,this.c,t,i,s,r)}containsPoint(e){return _s.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return _s.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,r=this.c;let o,a;Hc.subVectors(s,i),Gc.subVectors(r,i),sS.subVectors(e,i);const c=Hc.dot(sS),d=Gc.dot(sS);if(c<=0&&d<=0)return t.copy(i);rS.subVectors(e,s);const h=Hc.dot(rS),f=Gc.dot(rS);if(h>=0&&f<=h)return t.copy(s);const m=c*f-h*d;if(m<=0&&c>=0&&h<=0)return o=c/(c-h),t.copy(i).addScaledVector(Hc,o);oS.subVectors(e,r);const y=Hc.dot(oS),v=Gc.dot(oS);if(v>=0&&y<=v)return t.copy(r);const x=y*d-c*v;if(x<=0&&d>=0&&v<=0)return a=d/(d-v),t.copy(i).addScaledVector(Gc,a);const k=h*v-y*f;if(k<=0&&f-h>=0&&y-v>=0)return BB.subVectors(r,s),a=(f-h)/(f-h+(y-v)),t.copy(s).addScaledVector(BB,a);const C=1/(k+x+m);return o=x*C,a=m*C,t.copy(i).addScaledVector(Hc,o).addScaledVector(Gc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Vj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Go={h:0,s:0,l:0},Ym={h:0,s:0,l:0};function uS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class on{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Cs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,hs.colorSpaceToWorking(this,t),this}setRGB(e,t,i,s=hs.workingColorSpace){return this.r=e,this.g=t,this.b=i,hs.colorSpaceToWorking(this,s),this}setHSL(e,t,i,s=hs.workingColorSpace){if(e=S1(e,1),t=Fe(t,0,1),i=Fe(i,0,1),t===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+t):i+t-i*t,o=2*i-r;this.r=uS(o,r,e+1/3),this.g=uS(o,r,e),this.b=uS(o,r,e-1/3)}return hs.colorSpaceToWorking(this,s),this}setStyle(e,t=Cs){function i(r){r!==void 0&&parseFloat(r)<1&&rt("Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],a=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:rt("Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);rt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Cs){const i=Vj[e.toLowerCase()];return i!==void 0?this.setHex(i,t):rt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=to(e.r),this.g=to(e.g),this.b=to(e.b),this}copyLinearToSRGB(e){return this.r=Iu(e.r),this.g=Iu(e.g),this.b=Iu(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Cs){return hs.workingToColorSpace(Bn.copy(this),e),Math.round(Fe(Bn.r*255,0,255))*65536+Math.round(Fe(Bn.g*255,0,255))*256+Math.round(Fe(Bn.b*255,0,255))}getHexString(e=Cs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hs.workingColorSpace){hs.workingToColorSpace(Bn.copy(this),t);const i=Bn.r,s=Bn.g,r=Bn.b,o=Math.max(i,s,r),a=Math.min(i,s,r);let c,d;const h=(a+o)/2;if(a===o)c=0,d=0;else{const f=o-a;switch(d=h<=.5?f/(o+a):f/(2-o-a),o){case i:c=(s-r)/f+(s<r?6:0);break;case s:c=(r-i)/f+2;break;case r:c=(i-s)/f+4;break}c/=6}return e.h=c,e.s=d,e.l=h,e}getRGB(e,t=hs.workingColorSpace){return hs.workingToColorSpace(Bn.copy(this),t),e.r=Bn.r,e.g=Bn.g,e.b=Bn.b,e}getStyle(e=Cs){hs.workingToColorSpace(Bn.copy(this),e);const t=Bn.r,i=Bn.g,s=Bn.b;return e!==Cs?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(Go),this.setHSL(Go.h+e,Go.s+t,Go.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Go),e.getHSL(Ym);const i=rf(Go.h,Ym.h,t),s=rf(Go.s,Ym.s,t),r=rf(Go.l,Ym.l,t);return this.setHSL(i,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*i+r[6]*s,this.g=r[1]*t+r[4]*i+r[7]*s,this.b=r[2]*t+r[5]*i+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Bn=new on;on.NAMES=Vj;let Fee=0;class zl extends Lv{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Fee++}),this.uuid=Bs(),this.name="",this.type="Material",this.blending=aB,this.side=qy,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=cB,this.blendDst=uB,this.blendEquation=lB,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new on(0,0,0),this.blendAlpha=0,this.depthFunc=dB,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=vB,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nc,this.stencilZFail=Nc,this.stencilZPass=Nc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){rt(`Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){rt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==aB&&(i.blending=this.blending),this.side!==qy&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==cB&&(i.blendSrc=this.blendSrc),this.blendDst!==uB&&(i.blendDst=this.blendDst),this.blendEquation!==lB&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==dB&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==vB&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Nc&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Nc&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Nc&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(r){const o=[];for(const a in r){const c=r[a];delete c.metadata,o.push(c)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const s=t.length;i=new Array(s);for(let r=0;r!==s;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class mu extends zl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new on(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xd,this.combine=Q2,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Jt=new q,Zm=new $t;let Oee=0;class Bi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Oee++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=zk,this.updateRanges=[],this.gpuType=x1,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Zm.fromBufferAttribute(this,t),Zm.applyMatrix3(e),this.setXY(t,Zm.x,Zm.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Jt.fromBufferAttribute(this,t),Jt.applyMatrix3(e),this.setXYZ(t,Jt.x,Jt.y,Jt.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Jt.fromBufferAttribute(this,t),Jt.applyMatrix4(e),this.setXYZ(t,Jt.x,Jt.y,Jt.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Jt.fromBufferAttribute(this,t),Jt.applyNormalMatrix(e),this.setXYZ(t,Jt.x,Jt.y,Jt.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Jt.fromBufferAttribute(this,t),Jt.transformDirection(e),this.setXYZ(t,Jt.x,Jt.y,Jt.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Es(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=et(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Es(t,this.array)),t}setX(e,t){return this.normalized&&(t=et(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Es(t,this.array)),t}setY(e,t){return this.normalized&&(t=et(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Es(t,this.array)),t}setZ(e,t){return this.normalized&&(t=et(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Es(t,this.array)),t}setW(e,t){return this.normalized&&(t=et(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=et(t,this.array),i=et(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=et(t,this.array),i=et(i,this.array),s=et(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,r){return e*=this.itemSize,this.normalized&&(t=et(t,this.array),i=et(i,this.array),s=et(s,this.array),r=et(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==zk&&(e.usage=this.usage),e}}class Lee extends Bi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class jee extends Bi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class C1 extends Bi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Uee=0;const zi=new He,dS=new Ut,Wc=new q,_i=new go,xh=new go,dn=new q;class nc extends Lv{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Uee++}),this.uuid=Bs(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(see(e)?jee:Lee)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const r=new po().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return zi.makeRotationFromQuaternion(e),this.applyMatrix4(zi),this}rotateX(e){return zi.makeRotationX(e),this.applyMatrix4(zi),this}rotateY(e){return zi.makeRotationY(e),this.applyMatrix4(zi),this}rotateZ(e){return zi.makeRotationZ(e),this.applyMatrix4(zi),this}translate(e,t,i){return zi.makeTranslation(e,t,i),this.applyMatrix4(zi),this}scale(e,t,i){return zi.makeScale(e,t,i),this.applyMatrix4(zi),this}lookAt(e){return dS.lookAt(e),dS.updateMatrix(),this.applyMatrix4(dS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wc).negate(),this.translate(Wc.x,Wc.y,Wc.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new C1(i,3))}else{const i=Math.min(e.length,t.count);for(let s=0;s<i;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&rt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new go);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){xt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new q(-1/0,-1/0,-1/0),new q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){const r=t[i];_i.setFromBufferAttribute(r),this.morphTargetsRelative?(dn.addVectors(this.boundingBox.min,_i.min),this.boundingBox.expandByPoint(dn),dn.addVectors(this.boundingBox.max,_i.max),this.boundingBox.expandByPoint(dn)):(this.boundingBox.expandByPoint(_i.min),this.boundingBox.expandByPoint(_i.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&xt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ur);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){xt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new q,1/0);return}if(e){const i=this.boundingSphere.center;if(_i.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const a=t[r];xh.setFromBufferAttribute(a),this.morphTargetsRelative?(dn.addVectors(_i.min,xh.min),_i.expandByPoint(dn),dn.addVectors(_i.max,xh.max),_i.expandByPoint(dn)):(_i.expandByPoint(xh.min),_i.expandByPoint(xh.max))}_i.getCenter(i);let s=0;for(let r=0,o=e.count;r<o;r++)dn.fromBufferAttribute(e,r),s=Math.max(s,i.distanceToSquared(dn));if(t)for(let r=0,o=t.length;r<o;r++){const a=t[r],c=this.morphTargetsRelative;for(let d=0,h=a.count;d<h;d++)dn.fromBufferAttribute(a,d),c&&(Wc.fromBufferAttribute(e,d),dn.add(Wc)),s=Math.max(s,i.distanceToSquared(dn))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&xt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){xt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Bi(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],c=[];for(let I=0;I<i.count;I++)a[I]=new q,c[I]=new q;const d=new q,h=new q,f=new q,m=new $t,y=new $t,v=new $t,x=new q,k=new q;function C(I,L,O){d.fromBufferAttribute(i,I),h.fromBufferAttribute(i,L),f.fromBufferAttribute(i,O),m.fromBufferAttribute(r,I),y.fromBufferAttribute(r,L),v.fromBufferAttribute(r,O),h.sub(d),f.sub(d),y.sub(m),v.sub(m);const W=1/(y.x*v.y-v.x*y.y);isFinite(W)&&(x.copy(h).multiplyScalar(v.y).addScaledVector(f,-y.y).multiplyScalar(W),k.copy(f).multiplyScalar(y.x).addScaledVector(h,-v.x).multiplyScalar(W),a[I].add(x),a[L].add(x),a[O].add(x),c[I].add(k),c[L].add(k),c[O].add(k))}let A=this.groups;A.length===0&&(A=[{start:0,count:e.count}]);for(let I=0,L=A.length;I<L;++I){const O=A[I],W=O.start,ie=O.count;for(let he=W,ae=W+ie;he<ae;he+=3)C(e.getX(he+0),e.getX(he+1),e.getX(he+2))}const T=new q,E=new q,_=new q,R=new q;function B(I){_.fromBufferAttribute(s,I),R.copy(_);const L=a[I];T.copy(L),T.sub(_.multiplyScalar(_.dot(L))).normalize(),E.crossVectors(R,L);const W=E.dot(c[I])<0?-1:1;o.setXYZW(I,T.x,T.y,T.z,W)}for(let I=0,L=A.length;I<L;++I){const O=A[I],W=O.start,ie=O.count;for(let he=W,ae=W+ie;he<ae;he+=3)B(e.getX(he+0)),B(e.getX(he+1)),B(e.getX(he+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Bi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,y=i.count;m<y;m++)i.setXYZ(m,0,0,0);const s=new q,r=new q,o=new q,a=new q,c=new q,d=new q,h=new q,f=new q;if(e)for(let m=0,y=e.count;m<y;m+=3){const v=e.getX(m+0),x=e.getX(m+1),k=e.getX(m+2);s.fromBufferAttribute(t,v),r.fromBufferAttribute(t,x),o.fromBufferAttribute(t,k),h.subVectors(o,r),f.subVectors(s,r),h.cross(f),a.fromBufferAttribute(i,v),c.fromBufferAttribute(i,x),d.fromBufferAttribute(i,k),a.add(h),c.add(h),d.add(h),i.setXYZ(v,a.x,a.y,a.z),i.setXYZ(x,c.x,c.y,c.z),i.setXYZ(k,d.x,d.y,d.z)}else for(let m=0,y=t.count;m<y;m+=3)s.fromBufferAttribute(t,m+0),r.fromBufferAttribute(t,m+1),o.fromBufferAttribute(t,m+2),h.subVectors(o,r),f.subVectors(s,r),h.cross(f),i.setXYZ(m+0,h.x,h.y,h.z),i.setXYZ(m+1,h.x,h.y,h.z),i.setXYZ(m+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)dn.fromBufferAttribute(e,t),dn.normalize(),e.setXYZ(t,dn.x,dn.y,dn.z)}toNonIndexed(){function e(a,c){const d=a.array,h=a.itemSize,f=a.normalized,m=new d.constructor(c.length*h);let y=0,v=0;for(let x=0,k=c.length;x<k;x++){a.isInterleavedBufferAttribute?y=c[x]*a.data.stride+a.offset:y=c[x]*h;for(let C=0;C<h;C++)m[v++]=d[y++]}return new Bi(m,h,f)}if(this.index===null)return rt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new nc,i=this.index.array,s=this.attributes;for(const a in s){const c=s[a],d=e(c,i);t.setAttribute(a,d)}const r=this.morphAttributes;for(const a in r){const c=[],d=r[a];for(let h=0,f=d.length;h<f;h++){const m=d[h],y=e(m,i);c.push(y)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const d=o[a];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const d in c)c[d]!==void 0&&(e[d]=c[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i){const d=i[c];e.data.attributes[c]=d.toJSON(e.data)}const s={};let r=!1;for(const c in this.morphAttributes){const d=this.morphAttributes[c],h=[];for(let f=0,m=d.length;f<m;f++){const y=d[f];h.push(y.toJSON(e.data))}h.length>0&&(s[c]=h,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const d in s){const h=s[d];this.setAttribute(d,h.clone(t))}const r=e.morphAttributes;for(const d in r){const h=[],f=r[d];for(let m=0,y=f.length;m<y;m++)h.push(f[m].clone(t));this.morphAttributes[d]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let d=0,h=o.length;d<h;d++){const f=o[d];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const DB=new He,cl=new jv,eg=new ur,NB=new q,tg=new q,ng=new q,ig=new q,hS=new q,sg=new q,FB=new q,rg=new q;class Uv extends Ut{constructor(e=new nc,t=new mu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const a=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){const i=this.geometry,s=i.attributes.position,r=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(s,e);const a=this.morphTargetInfluences;if(r&&a){sg.set(0,0,0);for(let c=0,d=r.length;c<d;c++){const h=a[c],f=r[c];h!==0&&(hS.fromBufferAttribute(f,e),o?sg.addScaledVector(hS,h):sg.addScaledVector(hS.sub(t),h))}t.add(sg)}return t}raycast(e,t){const i=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),eg.copy(i.boundingSphere),eg.applyMatrix4(r),cl.copy(e.ray).recast(e.near),!(eg.containsPoint(cl.origin)===!1&&(cl.intersectSphere(eg,NB)===null||cl.origin.distanceToSquared(NB)>(e.far-e.near)**2))&&(DB.copy(r).invert(),cl.copy(e.ray).applyMatrix4(DB),!(i.boundingBox!==null&&cl.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,cl)))}_computeIntersections(e,t,i){let s;const r=this.geometry,o=this.material,a=r.index,c=r.attributes.position,d=r.attributes.uv,h=r.attributes.uv1,f=r.attributes.normal,m=r.groups,y=r.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,x=m.length;v<x;v++){const k=m[v],C=o[k.materialIndex],A=Math.max(k.start,y.start),T=Math.min(a.count,Math.min(k.start+k.count,y.start+y.count));for(let E=A,_=T;E<_;E+=3){const R=a.getX(E),B=a.getX(E+1),I=a.getX(E+2);s=og(this,C,e,i,d,h,f,R,B,I),s&&(s.faceIndex=Math.floor(E/3),s.face.materialIndex=k.materialIndex,t.push(s))}}else{const v=Math.max(0,y.start),x=Math.min(a.count,y.start+y.count);for(let k=v,C=x;k<C;k+=3){const A=a.getX(k),T=a.getX(k+1),E=a.getX(k+2);s=og(this,o,e,i,d,h,f,A,T,E),s&&(s.faceIndex=Math.floor(k/3),t.push(s))}}else if(c!==void 0)if(Array.isArray(o))for(let v=0,x=m.length;v<x;v++){const k=m[v],C=o[k.materialIndex],A=Math.max(k.start,y.start),T=Math.min(c.count,Math.min(k.start+k.count,y.start+y.count));for(let E=A,_=T;E<_;E+=3){const R=E,B=E+1,I=E+2;s=og(this,C,e,i,d,h,f,R,B,I),s&&(s.faceIndex=Math.floor(E/3),s.face.materialIndex=k.materialIndex,t.push(s))}}else{const v=Math.max(0,y.start),x=Math.min(c.count,y.start+y.count);for(let k=v,C=x;k<C;k+=3){const A=k,T=k+1,E=k+2;s=og(this,o,e,i,d,h,f,A,T,E),s&&(s.faceIndex=Math.floor(k/3),t.push(s))}}}}function zee(n,e,t,i,s,r,o,a){let c;if(e.side===K2?c=i.intersectTriangle(o,r,s,!0,a):c=i.intersectTriangle(s,r,o,e.side===qy,a),c===null)return null;rg.copy(a),rg.applyMatrix4(n.matrixWorld);const d=t.ray.origin.distanceTo(rg);return d<t.near||d>t.far?null:{distance:d,point:rg.clone(),object:n}}function og(n,e,t,i,s,r,o,a,c,d){n.getVertexPosition(a,tg),n.getVertexPosition(c,ng),n.getVertexPosition(d,ig);const h=zee(n,e,t,i,tg,ng,ig,FB);if(h){const f=new q;_s.getBarycoord(FB,tg,ng,ig,f),s&&(h.uv=_s.getInterpolatedAttribute(s,a,c,d,f,new $t)),r&&(h.uv1=_s.getInterpolatedAttribute(r,a,c,d,f,new $t)),o&&(h.normal=_s.getInterpolatedAttribute(o,a,c,d,f,new q),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const m={a,b:c,c:d,normal:new q,materialIndex:0};_s.getNormal(tg,ng,ig,m.normal),h.face=m,h.barycoord=f}return h}class Hj extends Ut{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new He,this.projectionMatrix=new He,this.projectionMatrixInverse=new He,this.coordinateSystem=wl,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Wo=new q,OB=new $t,LB=new $t;class k1 extends Hj{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Vf*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(sf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Vf*2*Math.atan(Math.tan(sf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Wo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Wo.x,Wo.y).multiplyScalar(-e/Wo.z),Wo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Wo.x,Wo.y).multiplyScalar(-e/Wo.z)}getViewSize(e,t){return this.getViewBounds(e,OB,LB),t.subVectors(LB,OB)}setViewOffset(e,t,i,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(sf*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,d=o.fullHeight;r+=o.offsetX*s/c,t-=o.offsetY*i/d,s*=o.width/c,i*=o.height/d}const a=this.filmOffset;a!==0&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class fS extends Ut{constructor(){super(),this.isGroup=!0,this.type="Group"}}class Vee{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=zk,this.updateRanges=[],this.version=0,this.uuid=Bs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Un=new q;class w1{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Un.fromBufferAttribute(this,t),Un.applyMatrix4(e),this.setXYZ(t,Un.x,Un.y,Un.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Un.fromBufferAttribute(this,t),Un.applyNormalMatrix(e),this.setXYZ(t,Un.x,Un.y,Un.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Un.fromBufferAttribute(this,t),Un.transformDirection(e),this.setXYZ(t,Un.x,Un.y,Un.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Es(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=et(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=et(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=et(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=et(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=et(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Es(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Es(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Es(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Es(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=et(t,this.array),i=et(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=et(t,this.array),i=et(i,this.array),s=et(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=et(t,this.array),i=et(i,this.array),s=et(s,this.array),r=et(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){xB("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new Bi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new w1(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){xB("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const jB=new q,UB=new mo,zB=new mo,Hee=new q,VB=new He,ag=new q,pS=new ur,HB=new He,mS=new jv;class Gee extends Uv{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=hB,this.bindMatrix=new He,this.bindMatrixInverse=new He,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new go),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ag),this.boundingBox.expandByPoint(ag)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ur),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ag),this.boundingSphere.expandByPoint(ag)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),pS.copy(this.boundingSphere),pS.applyMatrix4(s),e.ray.intersectsSphere(pS)!==!1&&(HB.copy(s).invert(),mS.copy(e.ray).applyMatrix4(HB),!(this.boundingBox!==null&&mS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,mS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new mo,t=this.geometry.attributes.skinWeight;for(let i=0,s=t.count;i<s;i++){e.fromBufferAttribute(t,i);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===hB?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===$2?this.bindMatrixInverse.copy(this.bindMatrix).invert():rt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,s=this.geometry;UB.fromBufferAttribute(s.attributes.skinIndex,e),zB.fromBufferAttribute(s.attributes.skinWeight,e),jB.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=zB.getComponent(r);if(o!==0){const a=UB.getComponent(r);VB.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Hee.copy(jB).applyMatrix4(VB),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Gj extends Ut{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Wj extends Ds{constructor(e=null,t=1,i=1,s,r,o,a,c,d=jk,h=jk,f,m){super(null,o,a,c,d,h,s,r,f,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const GB=new He,Wee=new He;class T1{constructor(e=[],t=[]){this.uuid=Bs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){rt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new He)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new He;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const a=e[r]?e[r].matrixWorld:Wee;GB.multiplyMatrices(a,t[r]),GB.toArray(i,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new T1(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Wj(t,e,e,jj,x1);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const r=e.bones[i];let o=t[r];o===void 0&&(rt("Skeleton: No bone found with UUID:",r),o=new Gj),this.bones.push(o),this.boneInverses.push(new He().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const a=i[s];e.boneInverses.push(a.toArray())}return e}}class Gk extends Bi{constructor(e,t,i,s=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Jc=new He,WB=new He,lg=[],JB=new go,Jee=new He,Sh=new Uv,Ch=new ur;class Kee extends Uv{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Gk(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,Jee)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new go),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Jc),JB.copy(e.boundingBox).applyMatrix4(Jc),this.boundingBox.union(JB)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ur),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Jc),Ch.copy(e.boundingSphere).applyMatrix4(Jc),this.boundingSphere.union(Ch)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=i.length+1,o=e*r+1;for(let a=0;a<i.length;a++)i[a]=s[o+a]}raycast(e,t){const i=this.matrixWorld,s=this.count;if(Sh.geometry=this.geometry,Sh.material=this.material,Sh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ch.copy(this.boundingSphere),Ch.applyMatrix4(i),e.ray.intersectsSphere(Ch)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,Jc),WB.multiplyMatrices(i,Jc),Sh.matrixWorld=WB,Sh.raycast(e,lg);for(let o=0,a=lg.length;o<a;o++){const c=lg[o];c.instanceId=r,c.object=this,t.push(c)}lg.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Gk(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,s=i.length+1;this.morphTexture===null&&(this.morphTexture=new Wj(new Float32Array(s*this.count),s,this.count,eee,x1));const r=this.morphTexture.source.data.data;let o=0;for(let d=0;d<i.length;d++)o+=i[d];const a=this.geometry.morphTargetsRelative?1:1-o,c=s*e;r[c]=a,r.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const gS=new q,qee=new q,Qee=new po;class Kc{constructor(e=new q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=gS.subVectors(i,t).cross(qee.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(gS),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(i,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Qee.getNormalMatrix(e),s=this.coplanarPoint(gS).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ul=new ur,$ee=new $t(.5,.5),cg=new q;class Xee{constructor(e=new Kc,t=new Kc,i=new Kc,s=new Kc,r=new Kc,o=new Kc){this.planes=[e,t,i,s,r,o]}set(e,t,i,s,r,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(s),a[4].copy(r),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=wl,i=!1){const s=this.planes,r=e.elements,o=r[0],a=r[1],c=r[2],d=r[3],h=r[4],f=r[5],m=r[6],y=r[7],v=r[8],x=r[9],k=r[10],C=r[11],A=r[12],T=r[13],E=r[14],_=r[15];if(s[0].setComponents(d-o,y-h,C-v,_-A).normalize(),s[1].setComponents(d+o,y+h,C+v,_+A).normalize(),s[2].setComponents(d+a,y+f,C+x,_+T).normalize(),s[3].setComponents(d-a,y-f,C-x,_-T).normalize(),i)s[4].setComponents(c,m,k,E).normalize(),s[5].setComponents(d-c,y-m,C-k,_-E).normalize();else if(s[4].setComponents(d-c,y-m,C-k,_-E).normalize(),t===wl)s[5].setComponents(d+c,y+m,C+k,_+E).normalize();else if(t===Vk)s[5].setComponents(c,m,k,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ul.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),ul.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ul)}intersectsSprite(e){ul.center.set(0,0,0);const t=$ee.distanceTo(e.center);return ul.radius=.7071067811865476+t,ul.applyMatrix4(e.matrixWorld),this.intersectsSphere(ul)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(cg.x=s.normal.x>0?e.max.x:e.min.x,cg.y=s.normal.y>0?e.max.y:e.min.y,cg.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(cg)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Jj extends zl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new on(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Qy=new q,$y=new q,KB=new He,kh=new jv,ug=new ur,yS=new q,qB=new q;class A1 extends Ut{constructor(e=new nc,t=new Jj){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let s=1,r=t.count;s<r;s++)Qy.fromBufferAttribute(t,s-1),$y.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=Qy.distanceTo($y);e.setAttribute("lineDistance",new C1(i,1))}else rt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ug.copy(i.boundingSphere),ug.applyMatrix4(s),ug.radius+=r,e.ray.intersectsSphere(ug)===!1)return;KB.copy(s).invert(),kh.copy(e.ray).applyMatrix4(KB);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,d=this.isLineSegments?2:1,h=i.index,m=i.attributes.position;if(h!==null){const y=Math.max(0,o.start),v=Math.min(h.count,o.start+o.count);for(let x=y,k=v-1;x<k;x+=d){const C=h.getX(x),A=h.getX(x+1),T=dg(this,e,kh,c,C,A,x);T&&t.push(T)}if(this.isLineLoop){const x=h.getX(v-1),k=h.getX(y),C=dg(this,e,kh,c,x,k,v-1);C&&t.push(C)}}else{const y=Math.max(0,o.start),v=Math.min(m.count,o.start+o.count);for(let x=y,k=v-1;x<k;x+=d){const C=dg(this,e,kh,c,x,x+1,x);C&&t.push(C)}if(this.isLineLoop){const x=dg(this,e,kh,c,v-1,y,v-1);x&&t.push(x)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const a=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function dg(n,e,t,i,s,r,o){const a=n.geometry.attributes.position;if(Qy.fromBufferAttribute(a,s),$y.fromBufferAttribute(a,r),t.distanceSqToSegment(Qy,$y,yS,qB)>i)return;yS.applyMatrix4(n.matrixWorld);const d=e.ray.origin.distanceTo(yS);if(!(d<e.near||d>e.far))return{distance:d,point:qB.clone().applyMatrix4(n.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:n}}const QB=new q,$B=new q;class Yee extends A1{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let s=0,r=t.count;s<r;s+=2)QB.fromBufferAttribute(t,s),$B.fromBufferAttribute(t,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+QB.distanceTo($B);e.setAttribute("lineDistance",new C1(i,1))}else rt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Zee extends A1{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Kj extends zl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new on(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const XB=new He,Wk=new jv,hg=new ur,fg=new q;class ete extends Ut{constructor(e=new nc,t=new Kj){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),hg.copy(i.boundingSphere),hg.applyMatrix4(s),hg.radius+=r,e.ray.intersectsSphere(hg)===!1)return;XB.copy(s).invert(),Wk.copy(e.ray).applyMatrix4(XB);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,d=i.index,f=i.attributes.position;if(d!==null){const m=Math.max(0,o.start),y=Math.min(d.count,o.start+o.count);for(let v=m,x=y;v<x;v++){const k=d.getX(v);fg.fromBufferAttribute(f,k),YB(fg,k,c,s,e,t,this)}}else{const m=Math.max(0,o.start),y=Math.min(f.count,o.start+o.count);for(let v=m,x=y;v<x;v++)fg.fromBufferAttribute(f,v),YB(fg,v,c,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const a=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function YB(n,e,t,i,s,r,o){const a=Wk.distanceSqToPoint(n);if(a<t){const c=new q;Wk.closestPointToPoint(n,c),c.applyMatrix4(i);const d=s.ray.origin.distanceTo(c);if(d<s.near||d>s.far)return;r.push({distance:d,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class E1 extends zl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new on(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new on(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=iee,this.normalScale=new $t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new xd,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dr extends E1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $t(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fe(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new on(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new on(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new on(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function pg(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function tte(n){function e(s,r){return n[s]-n[r]}const t=n.length,i=new Array(t);for(let s=0;s!==t;++s)i[s]=s;return i.sort(e),i}function ZB(n,e,t){const i=n.length,s=new n.constructor(i);for(let r=0,o=0;o!==i;++r){const a=t[r]*e;for(let c=0;c!==e;++c)s[o++]=n[a+c]}return s}function qj(n,e,t,i){let s=1,r=n[0];for(;r!==void 0&&r[i]===void 0;)r=n[s++];if(r===void 0)return;let o=r[i];if(o!==void 0)if(Array.isArray(o))do o=r[i],o!==void 0&&(e.push(r.time),t.push(...o)),r=n[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[i],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=n[s++];while(r!==void 0);else do o=r[i],o!==void 0&&(e.push(r.time),t.push(o)),r=n[s++];while(r!==void 0)}class dp{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,s=t[i],r=t[i-1];e:{t:{let o;n:{i:if(!(e<s)){for(let a=i+2;;){if(s===void 0){if(e<r)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(r=s,s=t[++i],e<s)break t}o=t.length;break n}if(!(e>=r)){const a=t[1];e<a&&(i=2,r=a);for(let c=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(s=r,r=t[--i-1],e>=r)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(s=t[i],r=t[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,s)}return this.interpolate_(i,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=i[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class nte extends dp{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fB,endingEnd:fB}}intervalChanged_(e,t,i){const s=this.parameterPositions;let r=e-2,o=e+1,a=s[r],c=s[o];if(a===void 0)switch(this.getSettings_().endingStart){case pB:r=e,a=2*t-i;break;case mB:r=s.length-2,a=t+s[r]-s[r+1];break;default:r=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case pB:o=e,c=2*i-t;break;case mB:o=1,c=i+s[1]-s[0];break;default:o=e-1,c=t}const d=(i-t)*.5,h=this.valueSize;this._weightPrev=d/(t-a),this._weightNext=d/(c-i),this._offsetPrev=r*h,this._offsetNext=o*h}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,d=c-a,h=this._offsetPrev,f=this._offsetNext,m=this._weightPrev,y=this._weightNext,v=(i-t)/(s-t),x=v*v,k=x*v,C=-m*k+2*m*x-m*v,A=(1+m)*k+(-1.5-2*m)*x+(-.5+m)*v+1,T=(-1-y)*k+(1.5+y)*x+.5*v,E=y*k-y*x;for(let _=0;_!==a;++_)r[_]=C*o[h+_]+A*o[d+_]+T*o[c+_]+E*o[f+_];return r}}class ite extends dp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,d=c-a,h=(i-t)/(s-t),f=1-h;for(let m=0;m!==a;++m)r[m]=o[d+m]*f+o[c+m]*h;return r}}class ste extends dp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class zs{constructor(e,t,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pg(t,this.TimeBufferType),this.values=pg(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:pg(e.times,Array),values:pg(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new ste(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ite(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nte(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Uf:t=this.InterpolantFactoryMethodDiscrete;break;case zf:t=this.InterpolantFactoryMethodLinear;break;case Wx:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return rt("KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Uf;case this.InterpolantFactoryMethodLinear:return zf;case this.InterpolantFactoryMethodSmooth:return Wx}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){const i=this.times,s=i.length;let r=0,o=s-1;for(;r!==s&&i[r]<e;)++r;for(;o!==-1&&i[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const a=this.getValueSize();this.times=i.slice(r,o),this.values=this.values.slice(r*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(xt("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,r=i.length;r===0&&(xt("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==r;a++){const c=i[a];if(typeof c=="number"&&isNaN(c)){xt("KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){xt("KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(s!==void 0&&ree(s))for(let a=0,c=s.length;a!==c;++a){const d=s[a];if(isNaN(d)){xt("KeyframeTrack: Value is not a valid number.",this,a,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===Wx,r=e.length-1;let o=1;for(let a=1;a<r;++a){let c=!1;const d=e[a],h=e[a+1];if(d!==h&&(a!==1||d!==e[0]))if(s)c=!0;else{const f=a*i,m=f-i,y=f+i;for(let v=0;v!==i;++v){const x=t[f+v];if(x!==t[m+v]||x!==t[y+v]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const f=a*i,m=o*i;for(let y=0;y!==i;++y)t[m+y]=t[f+y]}++o}}if(r>0){e[o]=e[r];for(let a=r*i,c=o*i,d=0;d!==i;++d)t[c+d]=t[a+d];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,s=new i(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}zs.prototype.ValueTypeName="";zs.prototype.TimeBufferType=Float32Array;zs.prototype.ValueBufferType=Float32Array;zs.prototype.DefaultInterpolation=zf;class Sd extends zs{constructor(e,t,i){super(e,t,i)}}Sd.prototype.ValueTypeName="bool";Sd.prototype.ValueBufferType=Array;Sd.prototype.DefaultInterpolation=Uf;Sd.prototype.InterpolantFactoryMethodLinear=void 0;Sd.prototype.InterpolantFactoryMethodSmooth=void 0;class Qj extends zs{constructor(e,t,i,s){super(e,t,i,s)}}Qj.prototype.ValueTypeName="color";class od extends zs{constructor(e,t,i,s){super(e,t,i,s)}}od.prototype.ValueTypeName="number";class rte extends dp{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(s-t);let d=e*a;for(let h=d+a;d!==h;d+=4)za.slerpFlat(r,0,o,d-a,o,d,c);return r}}class ad extends zs{constructor(e,t,i,s){super(e,t,i,s)}InterpolantFactoryMethodLinear(e){return new rte(this.times,this.values,this.getValueSize(),e)}}ad.prototype.ValueTypeName="quaternion";ad.prototype.InterpolantFactoryMethodSmooth=void 0;class Cd extends zs{constructor(e,t,i){super(e,t,i)}}Cd.prototype.ValueTypeName="string";Cd.prototype.ValueBufferType=Array;Cd.prototype.DefaultInterpolation=Uf;Cd.prototype.InterpolantFactoryMethodLinear=void 0;Cd.prototype.InterpolantFactoryMethodSmooth=void 0;class ld extends zs{constructor(e,t,i,s){super(e,t,i,s)}}ld.prototype.ValueTypeName="vector";class ote{constructor(e="",t=-1,i=[],s=tee){this.name=e,this.tracks=i,this.duration=t,this.blendMode=s,this.uuid=Bs(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,s=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(lte(i[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const t=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,o=i.length;r!==o;++r)t.push(zs.toJSON(i[r]));return s}static CreateFromMorphTargetSequence(e,t,i,s){const r=t.length,o=[];for(let a=0;a<r;a++){let c=[],d=[];c.push((a+r-1)%r,a,(a+1)%r),d.push(0,1,0);const h=tte(c);c=ZB(c,1,h),d=ZB(d,1,h),!s&&c[0]===0&&(c.push(r),d.push(d[0])),o.push(new od(".morphTargetInfluences["+t[a].name+"]",c,d).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===t)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const s={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const d=e[a],h=d.name.match(r);if(h&&h.length>1){const f=h[1];let m=s[f];m||(s[f]=m=[]),m.push(d)}}const o=[];for(const a in s)o.push(this.CreateFromMorphTargetSequence(a,s[a],t,i));return o}static parseAnimation(e,t){if(rt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return xt("AnimationClip: No animation in JSONLoader data."),null;const i=function(f,m,y,v,x){if(y.length!==0){const k=[],C=[];qj(y,k,C,v),k.length!==0&&x.push(new f(m,k,C))}},s=[],r=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const d=e.hierarchy||[];for(let f=0;f<d.length;f++){const m=d[f].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const y={};let v;for(v=0;v<m.length;v++)if(m[v].morphTargets)for(let x=0;x<m[v].morphTargets.length;x++)y[m[v].morphTargets[x]]=-1;for(const x in y){const k=[],C=[];for(let A=0;A!==m[v].morphTargets.length;++A){const T=m[v];k.push(T.time),C.push(T.morphTarget===x?1:0)}s.push(new od(".morphTargetInfluence["+x+"]",k,C))}c=y.length*o}else{const y=".bones["+t[f].name+"]";i(ld,y+".position",m,"pos",s),i(ad,y+".quaternion",m,"rot",s),i(ld,y+".scale",m,"scl",s)}}return s.length===0?null:new this(r,c,s,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,s=e.length;i!==s;++i){const r=this.tracks[i];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function ate(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return od;case"vector":case"vector2":case"vector3":case"vector4":return ld;case"color":return Qj;case"quaternion":return ad;case"bool":case"boolean":return Sd;case"string":return Cd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function lte(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=ate(n.type);if(n.times===void 0){const t=[],i=[];qj(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xr={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class cte{constructor(e,t,i){const s=this;let r=!1,o=0,a=0,c;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this._abortController=null,this.itemStart=function(h){a++,r===!1&&s.onStart!==void 0&&s.onStart(h,o,a),r=!0},this.itemEnd=function(h){o++,s.onProgress!==void 0&&s.onProgress(h,o,a),o===a&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(h){s.onError!==void 0&&s.onError(h)},this.resolveURL=function(h){return c?c(h):h},this.setURLModifier=function(h){return c=h,this},this.addHandler=function(h,f){return d.push(h,f),this},this.removeHandler=function(h){const f=d.indexOf(h);return f!==-1&&d.splice(f,2),this},this.getHandler=function(h){for(let f=0,m=d.length;f<m;f+=2){const y=d[f],v=d[f+1];if(y.global&&(y.lastIndex=0),y.test(h))return v}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const ute=new cte;class ic{constructor(e){this.manager=e!==void 0?e:ute,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(s,r){i.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ic.DEFAULT_MATERIAL_NAME="__DEFAULT";const Pr={};class dte extends Error{constructor(e,t){super(e),this.response=t}}class Xy extends ic{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Xr.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Pr[e]!==void 0){Pr[e].push({onLoad:t,onProgress:i,onError:s});return}Pr[e]=[],Pr[e].push({onLoad:t,onProgress:i,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,c=this.responseType;fetch(o).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&rt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const h=Pr[e],f=d.body.getReader(),m=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),y=m?parseInt(m):0,v=y!==0;let x=0;const k=new ReadableStream({start(C){A();function A(){f.read().then(({done:T,value:E})=>{if(T)C.close();else{x+=E.byteLength;const _=new ProgressEvent("progress",{lengthComputable:v,loaded:x,total:y});for(let R=0,B=h.length;R<B;R++){const I=h[R];I.onProgress&&I.onProgress(_)}C.enqueue(E),A()}},T=>{C.error(T)})}}});return new Response(k)}else throw new dte(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(c){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return d.json();default:if(a==="")return d.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),m=f&&f[1]?f[1].toLowerCase():void 0,y=new TextDecoder(m);return d.arrayBuffer().then(v=>y.decode(v))}}}).then(d=>{Xr.add(`file:${e}`,d);const h=Pr[e];delete Pr[e];for(let f=0,m=h.length;f<m;f++){const y=h[f];y.onLoad&&y.onLoad(d)}}).catch(d=>{const h=Pr[e];if(h===void 0)throw this.manager.itemError(e),d;delete Pr[e];for(let f=0,m=h.length;f<m;f++){const y=h[f];y.onError&&y.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const qc=new WeakMap;class hte extends ic{constructor(e){super(e)}load(e,t,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Xr.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0);else{let f=qc.get(o);f===void 0&&(f=[],qc.set(o,f)),f.push({onLoad:t,onError:s})}return o}const a=Hk("img");function c(){h(),t&&t(this);const f=qc.get(this)||[];for(let m=0;m<f.length;m++){const y=f[m];y.onLoad&&y.onLoad(this)}qc.delete(this),r.manager.itemEnd(e)}function d(f){h(),s&&s(f),Xr.remove(`image:${e}`);const m=qc.get(this)||[];for(let y=0;y<m.length;y++){const v=m[y];v.onError&&v.onError(f)}qc.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){a.removeEventListener("load",c,!1),a.removeEventListener("error",d,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),Xr.add(`image:${e}`,a),r.manager.itemStart(e),a.src=e,a}}class fte extends ic{constructor(e){super(e)}load(e,t,i,s){const r=new Ds,o=new hte(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){r.image=a,r.needsUpdate=!0,t!==void 0&&t(r)},i,s),r}}class _1 extends Ut{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new on(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}const vS=new He,eD=new q,tD=new q;class M1{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new $t(512,512),this.mapType=Lj,this.map=null,this.mapPass=null,this.matrix=new He,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xee,this._frameExtents=new $t(1,1),this._viewportCount=1,this._viewports=[new mo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;eD.setFromMatrixPosition(e.matrixWorld),t.position.copy(eD),tD.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(tD),t.updateMatrixWorld(),vS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vS,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(vS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class pte extends M1{constructor(){super(new k1(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,i=Vf*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;(i!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class mte extends _1{constructor(e,t,i=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ut.DEFAULT_UP),this.updateMatrix(),this.target=new Ut,this.distance=i,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new pte}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class gte extends M1{constructor(){super(new k1(90,1,.5,500)),this.isPointLightShadow=!0}}class yte extends _1{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new gte}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class $j extends Hj{constructor(e=-1,t=1,i=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=i-e,o=i+e,a=s+t,c=s-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=d*this.view.offsetX,o=r+d*this.view.width,a-=h*this.view.offsetY,c=a-h*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class vte extends M1{constructor(){super(new $j(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class bte extends _1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ut.DEFAULT_UP),this.updateMatrix(),this.target=new Ut,this.shadow=new vte}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class of{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}const bS=new WeakMap;class xte extends ic{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&rt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&rt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Xr.get(`image-bitmap:${e}`);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(d=>{if(bS.has(o)===!0)s&&s(bS.get(o)),r.manager.itemError(e),r.manager.itemEnd(e);else return t&&t(d),r.manager.itemEnd(e),d});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,a.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const c=fetch(e,a).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(d){return Xr.add(`image-bitmap:${e}`,d),t&&t(d),r.manager.itemEnd(e),d}).catch(function(d){s&&s(d),bS.set(c,d),Xr.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});Xr.add(`image-bitmap:${e}`,c),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const R1="\\[\\]\\.:\\/",Ste=new RegExp("["+R1+"]","g"),P1="[^"+R1+"]",Cte="[^"+R1.replace("\\.","")+"]",kte=/((?:WC+[\/:])*)/.source.replace("WC",P1),wte=/(WCOD+)?/.source.replace("WCOD",Cte),Tte=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",P1),Ate=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",P1),Ete=new RegExp("^"+kte+wte+Tte+Ate+"$"),_te=["material","materials","bones","map"];class Mte{constructor(e,t,i){const s=i||tt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=i.length;s!==r;++s)i[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class tt{constructor(e,t,i){this.path=t,this.parsedPath=i||tt.parseTrackName(t),this.node=tt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new tt.Composite(e,t,i):new tt(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ste,"")}static parseTrackName(e){const t=Ete.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=i.nodeName.substring(s+1);_te.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(r){for(let o=0;o<r.length;o++){const a=r[o];if(a.name===t||a.uuid===t)return a;const c=i(a.children);if(c)return c}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)e[t++]=i[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=tt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){rt("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let d=t.objectIndex;switch(i){case"materials":if(!e.material){xt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){xt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){xt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===d){d=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){xt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){xt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){xt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(d!==void 0){if(e[d]===void 0){xt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const o=e[s];if(o===void 0){const d=t.nodeName;xt("PropertyBinding: Trying to update property for track: "+d+"."+s+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?a=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){xt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){xt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}tt.Composite=Mte;tt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};tt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};tt.prototype.GetterByBindingType=[tt.prototype._getValue_direct,tt.prototype._getValue_array,tt.prototype._getValue_arrayElement,tt.prototype._getValue_toArray];tt.prototype.SetterByBindingTypeAndVersioning=[[tt.prototype._setValue_direct,tt.prototype._setValue_direct_setNeedsUpdate,tt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[tt.prototype._setValue_array,tt.prototype._setValue_array_setNeedsUpdate,tt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[tt.prototype._setValue_arrayElement,tt.prototype._setValue_arrayElement_setNeedsUpdate,tt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[tt.prototype._setValue_fromArray,tt.prototype._setValue_fromArray_setNeedsUpdate,tt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:y1}}));typeof window<"u"&&(window.__THREE__?rt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=y1);const Rte=n=>typeof n=="object"&&typeof n.then=="function",Tl=[];function Xj(n,e,t=(i,s)=>i===s){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let s=0;s<i;s++)if(!t(n[s],e[s]))return!1;return!0}function Yj(n,e=null,t=!1,i={}){e===null&&(e=[n]);for(const r of Tl)if(Xj(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return i.lifespan&&i.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,i.lifespan)),r.response;if(!t)throw r.promise}const s={keys:e,equal:i.equal,remove:()=>{const r=Tl.indexOf(s);r!==-1&&Tl.splice(r,1)},promise:(Rte(n)?n:n(...e)).then(r=>{s.response=r,i.lifespan&&i.lifespan>0&&(s.timeout=setTimeout(s.remove,i.lifespan))}).catch(r=>s.error=r)};if(Tl.push(s),!t)throw s.promise}const Pte=(n,e,t)=>Yj(n,e,!1,t),Ite=(n,e,t)=>void Yj(n,e,!0,t),Bte=n=>{if(n===void 0||n.length===0)Tl.splice(0,Tl.length);else{const e=Tl.find(t=>Xj(n,t.keys,t.equal));e&&e.remove()}};var Zj={exports:{}},eU={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(K,ee){var z=K.length;K.push(ee);e:for(;0<z;){var X=z-1>>>1,te=K[X];if(0<s(te,ee))K[X]=ee,K[z]=te,z=X;else break e}}function t(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var ee=K[0],z=K.pop();if(z!==ee){K[0]=z;e:for(var X=0,te=K.length,ye=te>>>1;X<ye;){var _e=2*(X+1)-1,Dt=K[_e],Ye=_e+1,Xt=K[Ye];if(0>s(Dt,z))Ye<te&&0>s(Xt,Dt)?(K[X]=Xt,K[Ye]=z,X=Ye):(K[X]=Dt,K[_e]=z,X=_e);else if(Ye<te&&0>s(Xt,z))K[X]=Xt,K[Ye]=z,X=Ye;else break e}}return ee}function s(K,ee){var z=K.sortIndex-ee.sortIndex;return z!==0?z:K.id-ee.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,f=null,m=3,y=!1,v=!1,x=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function E(K){for(var ee=t(d);ee!==null;){if(ee.callback===null)i(d);else if(ee.startTime<=K)i(d),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=t(d)}}function _(K){if(x=!1,E(K),!v)if(t(c)!==null)v=!0,R||(R=!0,ie());else{var ee=t(d);ee!==null&&le(_,ee.startTime-K)}}var R=!1,B=-1,I=5,L=-1;function O(){return k?!0:!(n.unstable_now()-L<I)}function W(){if(k=!1,R){var K=n.unstable_now();L=K;var ee=!0;try{e:{v=!1,x&&(x=!1,A(B),B=-1),y=!0;var z=m;try{t:{for(E(K),f=t(c);f!==null&&!(f.expirationTime>K&&O());){var X=f.callback;if(typeof X=="function"){f.callback=null,m=f.priorityLevel;var te=X(f.expirationTime<=K);if(K=n.unstable_now(),typeof te=="function"){f.callback=te,E(K),ee=!0;break t}f===t(c)&&i(c),E(K)}else i(c);f=t(c)}if(f!==null)ee=!0;else{var ye=t(d);ye!==null&&le(_,ye.startTime-K),ee=!1}}break e}finally{f=null,m=z,y=!1}ee=void 0}}finally{ee?ie():R=!1}}}var ie;if(typeof T=="function")ie=function(){T(W)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ae=he.port2;he.port1.onmessage=W,ie=function(){ae.postMessage(null)}}else ie=function(){C(W,0)};function le(K,ee){B=C(function(){K(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(K){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var z=m;m=ee;try{return K()}finally{m=z}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(K,ee){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var z=m;m=K;try{return ee()}finally{m=z}},n.unstable_scheduleCallback=function(K,ee,z){var X=n.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?X+z:X):z=X,K){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=z+te,K={id:h++,callback:ee,priorityLevel:K,startTime:z,expirationTime:te,sortIndex:-1},z>X?(K.sortIndex=z,e(d,K),t(c)===null&&K===t(d)&&(x?(A(B),B=-1):x=!0,le(_,z-X))):(K.sortIndex=te,e(c,K),v||y||(v=!0,R||(R=!0,ie()))),K},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(K){var ee=m;return function(){var z=m;m=ee;try{return K.apply(this,arguments)}finally{m=z}}}})(eU);Zj.exports=eU;var Dte=Zj.exports;const Nte=AD(Dte),Dr={obj:n=>n===Object(n)&&!Dr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Dr.str(n)||Dr.num(n)||Dr.boo(n))return n===e;const r=Dr.obj(n);if(r&&i==="reference")return n===e;const o=Dr.arr(n);if(o&&t==="reference")return n===e;if((o||r)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(r&&t==="shallow"&&i==="shallow"){for(a in s?e:n)if(!Dr.equ(n[a],e[a],{strict:s,objects:"reference"}))return!1}else for(a in s?e:n)if(n[a]!==e[a])return!1;if(Dr.und(a)){if(o&&n.length===0&&e.length===0||r&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function Fte(n){const e={nodes:{},materials:{},meshes:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}const Ote=n=>n==null?void 0:n.isObject3D,nD=new WeakMap,Lte=n=>{var e;return typeof n=="function"&&(n==null||(e=n.prototype)==null?void 0:e.constructor)===n};function tU(n,e){return function(t,...i){let s;return Lte(t)?(s=nD.get(t),s||(s=new t,nD.set(t,s))):s=t,n&&n(s),Promise.all(i.map(r=>new Promise((o,a)=>s.load(r,c=>{Ote(c==null?void 0:c.scene)&&Object.assign(c,Fte(c.scene)),o(c)},e,c=>a(new Error(`Could not load ${r}: ${c==null?void 0:c.message}`))))))}}function hp(n,e,t,i){const s=Array.isArray(e)?e:[e],r=Pte(tU(t,i),[n,...s],{equal:Dr.equ});return Array.isArray(e)?r:r[0]}hp.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return Ite(tU(t),[n,...i])};hp.clear=function(n,e){const t=Array.isArray(e)?e:[e];return Bte([n,...t])};function jte(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var iD={exports:{}},sD={exports:{}},rD;function Ute(){return rD||(rD=1,function(n){n.exports=function(e){function t(l,u,p,g){return new IU(l,u,p,g)}function i(){}function s(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(l){var u=l,p=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,u.flags&4098&&(p=u.return),l=u.return;while(l)}return u.tag===3?p:null}function o(l){if(r(l)!==l)throw Error(s(188))}function a(l){var u=l.alternate;if(!u){if(u=r(l),u===null)throw Error(s(188));return u!==l?null:l}for(var p=l,g=u;;){var b=p.return;if(b===null)break;var w=b.alternate;if(w===null){if(g=b.return,g!==null){p=g;continue}break}if(b.child===w.child){for(w=b.child;w;){if(w===p)return o(b),l;if(w===g)return o(b),u;w=w.sibling}throw Error(s(188))}if(p.return!==g.return)p=b,g=w;else{for(var M=!1,F=b.child;F;){if(F===p){M=!0,p=b,g=w;break}if(F===g){M=!0,g=b,p=w;break}F=F.sibling}if(!M){for(F=w.child;F;){if(F===p){M=!0,p=w,g=b;break}if(F===g){M=!0,g=w,p=b;break}F=F.sibling}if(!M)throw Error(s(189))}}if(p.alternate!==g)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?l:u}function c(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=c(l),u!==null)return u;l=l.sibling}return null}function d(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(l.tag!==4&&(u=d(l),u!==null))return u;l=l.sibling}return null}function h(l){return l===null||typeof l!="object"?null:(l=QE&&l[QE]||l["@@iterator"],typeof l=="function"?l:null)}function f(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===OU?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case hc:return"Fragment";case K0:return"Profiler";case KE:return"StrictMode";case Q0:return"Suspense";case $0:return"SuspenseList";case Y0:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case dc:return"Portal";case To:return l.displayName||"Context";case qE:return(l._context.displayName||"Context")+".Consumer";case q0:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case X0:return u=l.displayName||null,u!==null?u:f(l.type)||"Memo";case Ao:u=l._payload,l=l._init;try{return f(l(u))}catch{}}return null}function m(l){return{current:l}}function y(l){0>mc||(l.current=sb[mc],sb[mc]=null,mc--)}function v(l,u){mc++,sb[mc]=l.current,l.current=u}function x(l){return l>>>=0,l===0?32:31-(d6(l)/h6|0)|0}function k(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function C(l,u,p){var g=l.pendingLanes;if(g===0)return 0;var b=0,w=l.suspendedLanes,M=l.pingedLanes;l=l.warmLanes;var F=g&134217727;return F!==0?(g=F&~w,g!==0?b=k(g):(M&=F,M!==0?b=k(M):p||(p=F&~l,p!==0&&(b=k(p))))):(F=g&~w,F!==0?b=k(F):M!==0?b=k(M):p||(p=g&~l,p!==0&&(b=k(p)))),b===0?0:u!==0&&u!==b&&!(u&w)&&(w=b&-b,p=u&-u,w>=p||w===32&&(p&4194048)!==0)?u:b}function A(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function T(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E(){var l=qp;return qp<<=1,!(qp&62914560)&&(qp=4194304),l}function _(l){for(var u=[],p=0;31>p;p++)u.push(l);return u}function R(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function B(l,u,p,g,b,w){var M=l.pendingLanes;l.pendingLanes=p,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=p,l.entangledLanes&=p,l.errorRecoveryDisabledLanes&=p,l.shellSuspendCounter=0;var F=l.entanglements,J=l.expirationTimes,Y=l.hiddenUpdates;for(p=M&~p;0<p;){var ue=31-Si(p),se=1<<ue;F[ue]=0,J[ue]=-1;var pe=Y[ue];if(pe!==null)for(Y[ue]=null,ue=0;ue<pe.length;ue++){var we=pe[ue];we!==null&&(we.lane&=-536870913)}p&=~se}g!==0&&I(l,g,0),w!==0&&b===0&&l.tag!==0&&(l.suspendedLanes|=w&~(M&~u))}function I(l,u,p){l.pendingLanes|=u,l.suspendedLanes&=~u;var g=31-Si(u);l.entangledLanes|=u,l.entanglements[g]=l.entanglements[g]|1073741824|p&261930}function L(l,u){var p=l.entangledLanes|=u;for(l=l.entanglements;p;){var g=31-Si(p),b=1<<g;b&u|l[g]&u&&(l[g]|=u),p&=~b}}function O(l,u){var p=u&-u;return p=p&42?1:W(p),p&(l.suspendedLanes|u)?0:p}function W(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function ie(l){return l&=-l,2<l?8<l?l&134217727?32:268435456:8:2}function he(l){if(typeof y6=="function"&&v6(l),Ci&&typeof Ci.setStrictMode=="function")try{Ci.setStrictMode(zd,l)}catch{}}function ae(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}function le(l){if(ab===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);ab=u&&u[1]||"",S_=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ab+l+S_}function K(l,u){if(!l||lb)return"";lb=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(u){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(we){var pe=we}Reflect.construct(l,[],se)}else{try{se.call()}catch(we){pe=we}l.call(se.prototype)}}else{try{throw Error()}catch(we){pe=we}(se=l())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(we){if(we&&pe&&typeof we.stack=="string")return[we.stack,pe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=g.DetermineComponentFrameRoot(),M=w[0],F=w[1];if(M&&F){var J=M.split(`
`),Y=F.split(`
`);for(b=g=0;g<J.length&&!J[g].includes("DetermineComponentFrameRoot");)g++;for(;b<Y.length&&!Y[b].includes("DetermineComponentFrameRoot");)b++;if(g===J.length||b===Y.length)for(g=J.length-1,b=Y.length-1;1<=g&&0<=b&&J[g]!==Y[b];)b--;for(;1<=g&&0<=b;g--,b--)if(J[g]!==Y[b]){if(g!==1||b!==1)do if(g--,b--,0>b||J[g]!==Y[b]){var ue=`
`+J[g].replace(" at new "," at ");return l.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",l.displayName)),ue}while(1<=g&&0<=b);break}}}finally{lb=!1,Error.prepareStackTrace=p}return(p=l?l.displayName||l.name:"")?le(p):""}function ee(l,u){switch(l.tag){case 26:case 27:case 5:return le(l.type);case 16:return le("Lazy");case 13:return l.child!==u&&u!==null?le("Suspense Fallback"):le("Suspense");case 19:return le("SuspenseList");case 0:case 15:return K(l.type,!1);case 11:return K(l.type.render,!1);case 1:return K(l.type,!0);case 31:return le("Activity");default:return""}}function z(l){try{var u="",p=null;do u+=ee(l,p),p=l,l=l.return;while(l);return u}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}function X(l,u){if(typeof l=="object"&&l!==null){var p=C_.get(l);return p!==void 0?p:(u={value:l,source:u,stack:z(u)},C_.set(l,u),u)}return{value:l,source:u,stack:z(u)}}function te(l,u){yc[vc++]=Vd,yc[vc++]=$p,$p=l,Vd=u}function ye(l,u,p){Oi[Li++]=Ws,Oi[Li++]=Js,Oi[Li++]=Eo,Eo=l;var g=Ws;l=Js;var b=32-Si(g)-1;g&=~(1<<b),p+=1;var w=32-Si(u)+b;if(30<w){var M=b-b%5;w=(g&(1<<M)-1).toString(32),g>>=M,b-=M,Ws=1<<32-Si(u)+b|p<<b|g,Js=w+l}else Ws=1<<w|p<<b|g,Js=l}function _e(l){l.return!==null&&(te(l,1),ye(l,1,0))}function Dt(l){for(;l===$p;)$p=yc[--vc],yc[vc]=null,Vd=yc[--vc],yc[vc]=null;for(;l===Eo;)Eo=Oi[--Li],Oi[Li]=null,Js=Oi[--Li],Oi[Li]=null,Ws=Oi[--Li],Oi[Li]=null}function Ye(l,u){Oi[Li++]=Ws,Oi[Li++]=Js,Oi[Li++]=Eo,Ws=u.id,Js=u.overflow,Eo=l}function Xt(l,u){v(_o,u),v(Hd,l),v(xn,null),l=UU(u),y(xn),v(xn,l)}function an(){y(xn),y(Hd),y(_o)}function yo(l){l.memoizedState!==null&&v(Xp,l);var u=xn.current,p=zU(u,l.type);u!==p&&(v(Hd,l),v(xn,p))}function fp(l){Hd.current===l&&(y(xn),y(Hd)),Xp.current===l&&(y(Xp),br?Xa._currentValue=fc:Xa._currentValue2=fc)}function hr(l){var u=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kd(X(u,l)),cb}function B1(l,u){if(!Mn)throw Error(s(175));z9(l.stateNode,l.type,l.memoizedProps,u,l)||hr(l,!0)}function D1(l){for(Sn=l.return;Sn;)switch(Sn.tag){case 5:case 31:case 13:ji=!1;return;case 27:case 3:ji=!0;return;default:Sn=Sn.return}}function sc(l){if(!Mn||l!==Sn)return!1;if(!ze)return D1(l),ze=!0,!1;var u=l.tag;if(Yt?u!==3&&u!==27&&(u!==5||l_(l.type)&&!Wp(l.type,l.memoizedProps))&&yt&&hr(l):u!==3&&(u!==5||l_(l.type)&&!Wp(l.type,l.memoizedProps))&&yt&&hr(l),D1(l),u===13){if(!Mn)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));yt=J9(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));yt=W9(l)}else yt=Yt&&u===27?P9(l.type,yt):Sn?a_(l.stateNode):null;return!0}function Va(){Mn&&(yt=Sn=null,ze=!1)}function Hv(){var l=Mo;return l!==null&&(ii===null?ii=l:ii.push.apply(ii,l),Mo=null),l}function kd(l){Mo===null?Mo=[l]:Mo.push(l)}function vo(l,u,p){br?(v(Yp,u._currentValue),u._currentValue=p):(v(Yp,u._currentValue2),u._currentValue2=p)}function fr(l){var u=Yp.current;br?l._currentValue=u:l._currentValue2=u,y(Yp)}function Gv(l,u,p){for(;l!==null;){var g=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,g!==null&&(g.childLanes|=u)):g!==null&&(g.childLanes&u)!==u&&(g.childLanes|=u),l===p)break;l=l.return}}function Wv(l,u,p,g){var b=l.child;for(b!==null&&(b.return=l);b!==null;){var w=b.dependencies;if(w!==null){var M=b.child;w=w.firstContext;e:for(;w!==null;){var F=w;w=b;for(var J=0;J<u.length;J++)if(F.context===u[J]){w.lanes|=p,F=w.alternate,F!==null&&(F.lanes|=p),Gv(w.return,p,l),g||(M=null);break e}w=F.next}}else if(b.tag===18){if(M=b.return,M===null)throw Error(s(341));M.lanes|=p,w=M.alternate,w!==null&&(w.lanes|=p),Gv(M,p,l),M=null}else M=b.child;if(M!==null)M.return=b;else for(M=b;M!==null;){if(M===l){M=null;break}if(b=M.sibling,b!==null){b.return=M.return,M=b;break}M=M.return}b=M}}function rc(l,u,p,g){l=null;for(var b=u,w=!1;b!==null;){if(!w){if(b.flags&524288)w=!0;else if(b.flags&262144)break}if(b.tag===10){var M=b.alternate;if(M===null)throw Error(s(387));if(M=M.memoizedProps,M!==null){var F=b.type;ki(b.pendingProps.value,M.value)||(l!==null?l.push(F):l=[F])}}else if(b===Xp.current){if(M=b.alternate,M===null)throw Error(s(387));M.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(l!==null?l.push(Xa):l=[Xa])}b=b.return}l!==null&&Wv(u,l,p,g),u.flags|=262144}function pp(l){for(l=l.firstContext;l!==null;){var u=l.context;if(!ki(br?u._currentValue:u._currentValue2,l.memoizedValue))return!0;l=l.next}return!1}function Ha(l){Ya=l,Sr=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function vn(l){return N1(Ya,l)}function mp(l,u){return Ya===null&&Ha(l),N1(l,u)}function N1(l,u){var p=br?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},Sr===null){if(l===null)throw Error(s(308));Sr=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Sr=Sr.next=u;return p}function Jv(){return{controller:new x6,data:new Map,refCount:0}}function wd(l){l.refCount--,l.refCount===0&&S6(C6,function(){l.controller.abort()})}function gp(){}function Vs(l){l!==bc&&l.next===null&&(bc===null?Zp=bc=l:bc=bc.next=l),em=!0,ub||(ub=!0,lU())}function oc(l,u){if(!db&&em){db=!0;do for(var p=!1,g=Zp;g!==null;){if(l!==0){var b=g.pendingLanes;if(b===0)var w=0;else{var M=g.suspendedLanes,F=g.pingedLanes;w=(1<<31-Si(42|l)+1)-1,w&=b&~(M&~F),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(p=!0,U1(g,w))}else w=Ue,w=C(g,g===ot?w:0,g.cancelPendingCommit!==null||g.timeoutHandle!==$a),!(w&3)||A(g,w)||(p=!0,U1(g,w));g=g.next}while(p);db=!1}}function F1(){O1()}function O1(){em=ub=!1;var l=0;Za!==0&&$U()&&(l=Za);for(var u=ti(),p=null,g=Zp;g!==null;){var b=g.next,w=L1(g,u);w===0?(g.next=null,p===null?Zp=b:p.next=b,b===null&&(bc=p)):(p=g,(l!==0||w&3)&&(em=!0)),g=b}Zt!==0&&Zt!==5||oc(l),Za!==0&&(Za=0)}function L1(l,u){for(var p=l.suspendedLanes,g=l.pingedLanes,b=l.expirationTimes,w=l.pendingLanes&-62914561;0<w;){var M=31-Si(w),F=1<<M,J=b[M];J===-1?(!(F&p)||F&g)&&(b[M]=T(F,u)):J<=u&&(l.expiredLanes|=F),w&=~F}if(u=ot,p=Ue,p=C(l,l===u?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==$a),g=l.callbackNode,p===0||l===u&&(Ze===2||Ze===9)||l.cancelPendingCommit!==null)return g!==null&&g!==null&&rb(g),l.callbackNode=null,l.callbackPriority=0;if(!(p&3)||A(l,p)){if(u=p&-p,u===l.callbackPriority)return u;switch(g!==null&&rb(g),ie(p)){case 2:case 8:p=m6;break;case 32:p=ob;break;case 268435456:p=g6;break;default:p=ob}return g=j1.bind(null,l),p=Qp(p,g),l.callbackPriority=u,l.callbackNode=p,u}return g!==null&&g!==null&&rb(g),l.callbackPriority=2,l.callbackNode=null,2}function j1(l,u){if(Zt!==0&&Zt!==5)return l.callbackNode=null,l.callbackPriority=0,null;var p=l.callbackNode;if(Od()&&l.callbackNode!==p)return null;var g=Ue;return g=C(l,l===ot?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==$a),g===0?null:(CE(l,g,u),L1(l,ti()),l.callbackNode!=null&&l.callbackNode===p?j1.bind(null,l):null)}function U1(l,u){if(Od())return null;CE(l,u,!0)}function lU(){i9?s9(function(){Be&6?Qp(b_,F1):O1()}):Qp(b_,F1)}function Kv(){if(Za===0){var l=xc;l===0&&(l=Jp,Jp<<=1,!(Jp&261888)&&(Jp=256)),Za=l}return Za}function cU(l,u){if(Gd===null){var p=Gd=[];hb=0,xc=Kv(),Sc={status:"pending",value:void 0,then:function(g){p.push(g)}}}return hb++,u.then(z1,z1),u}function z1(){if(--hb===0&&Gd!==null){Sc!==null&&(Sc.status="fulfilled");var l=Gd;Gd=null,xc=0,Sc=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function uU(l,u){var p=[],g={status:"pending",value:null,reason:null,then:function(b){p.push(b)}};return l.then(function(){g.status="fulfilled",g.value=u;for(var b=0;b<p.length;b++)(0,p[b])(u)},function(b){for(g.status="rejected",g.reason=b,b=0;b<p.length;b++)(0,p[b])(void 0)}),g}function qv(){var l=el.current;return l!==null?l:ot.pooledCache}function yp(l,u){u===null?v(el,el.current):v(el,u.pool)}function V1(){var l=qv();return l===null?null:{parent:br?vt._currentValue:vt._currentValue2,pool:l}}function vp(l,u){if(ki(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var p=Object.keys(l),g=Object.keys(u);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var b=p[g];if(!b6.call(u,b)||!ki(l[b],u[b]))return!1}return!0}function H1(l){return l=l.status,l==="fulfilled"||l==="rejected"}function G1(l,u,p){switch(p=l[p],p===void 0?l.push(u):p!==u&&(u.then(gp,gp),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,J1(l),l;default:if(typeof u.status=="string")u.then(gp,gp);else{if(l=ot,l!==null&&100<l.shellSuspendCounter)throw Error(s(482));l=u,l.status="pending",l.then(function(g){if(u.status==="pending"){var b=u;b.status="fulfilled",b.value=g}},function(g){if(u.status==="pending"){var b=u;b.status="rejected",b.reason=g}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,J1(l),l}throw tl=u,Cc}}function Ga(l){try{var u=l._init;return u(l._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(tl=p,Cc):p}}function W1(){if(tl===null)throw Error(s(459));var l=tl;return tl=null,l}function J1(l){if(l===Cc||l===tm)throw Error(s(483))}function bp(l){var u=Wd;return Wd+=1,kc===null&&(kc=[]),G1(kc,l,u)}function Td(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function xp(l,u){throw u.$$typeof===NU?Error(s(525)):(l=Object.prototype.toString.call(u),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function K1(l){function u(V,j){if(l){var G=V.deletions;G===null?(V.deletions=[j],V.flags|=16):G.push(j)}}function p(V,j){if(!l)return null;for(;j!==null;)u(V,j),j=j.sibling;return null}function g(V){for(var j=new Map;V!==null;)V.key!==null?j.set(V.key,V):j.set(V.index,V),V=V.sibling;return j}function b(V,j){return V=vr(V,j),V.index=0,V.sibling=null,V}function w(V,j,G){return V.index=G,l?(G=V.alternate,G!==null?(G=G.index,G<j?(V.flags|=67108866,j):G):(V.flags|=67108866,j)):(V.flags|=1048576,j)}function M(V){return l&&V.alternate===null&&(V.flags|=67108866),V}function F(V,j,G,re){return j===null||j.tag!==6?(j=H0(G,V.mode,re),j.return=V,j):(j=b(j,G),j.return=V,j)}function J(V,j,G,re){var xe=G.type;return xe===hc?ue(V,j,G.props.children,re,G.key):j!==null&&(j.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===Ao&&Ga(xe)===j.type)?(j=b(j,G.props),Td(j,G),j.return=V,j):(j=Vp(G.type,G.key,G.props,null,V.mode,re),Td(j,G),j.return=V,j)}function Y(V,j,G,re){return j===null||j.tag!==4||j.stateNode.containerInfo!==G.containerInfo||j.stateNode.implementation!==G.implementation?(j=G0(G,V.mode,re),j.return=V,j):(j=b(j,G.children||[]),j.return=V,j)}function ue(V,j,G,re,xe){return j===null||j.tag!==7?(j=Qa(G,V.mode,re,xe),j.return=V,j):(j=b(j,G),j.return=V,j)}function se(V,j,G){if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return j=H0(""+j,V.mode,G),j.return=V,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Hp:return G=Vp(j.type,j.key,j.props,null,V.mode,G),Td(G,j),G.return=V,G;case dc:return j=G0(j,V.mode,G),j.return=V,j;case Ao:return j=Ga(j),se(V,j,G)}if(Gp(j)||h(j))return j=Qa(j,V.mode,G,null),j.return=V,j;if(typeof j.then=="function")return se(V,bp(j),G);if(j.$$typeof===To)return se(V,mp(V,j),G);xp(V,j)}return null}function pe(V,j,G,re){var xe=j!==null?j.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return xe!==null?null:F(V,j,""+G,re);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Hp:return G.key===xe?J(V,j,G,re):null;case dc:return G.key===xe?Y(V,j,G,re):null;case Ao:return G=Ga(G),pe(V,j,G,re)}if(Gp(G)||h(G))return xe!==null?null:ue(V,j,G,re,null);if(typeof G.then=="function")return pe(V,j,bp(G),re);if(G.$$typeof===To)return pe(V,j,mp(V,G),re);xp(V,G)}return null}function we(V,j,G,re,xe){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return V=V.get(G)||null,F(j,V,""+re,xe);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Hp:return V=V.get(re.key===null?G:re.key)||null,J(j,V,re,xe);case dc:return V=V.get(re.key===null?G:re.key)||null,Y(j,V,re,xe);case Ao:return re=Ga(re),we(V,j,G,re,xe)}if(Gp(re)||h(re))return V=V.get(G)||null,ue(j,V,re,xe,null);if(typeof re.then=="function")return we(V,j,G,bp(re),xe);if(re.$$typeof===To)return we(V,j,G,mp(j,re),xe);xp(j,re)}return null}function Wt(V,j,G,re){for(var xe=null,bt=null,Ce=j,Ke=j=0,un=null;Ce!==null&&Ke<G.length;Ke++){Ce.index>Ke?(un=Ce,Ce=null):un=Ce.sibling;var qe=pe(V,Ce,G[Ke],re);if(qe===null){Ce===null&&(Ce=un);break}l&&Ce&&qe.alternate===null&&u(V,Ce),j=w(qe,j,Ke),bt===null?xe=qe:bt.sibling=qe,bt=qe,Ce=un}if(Ke===G.length)return p(V,Ce),ze&&te(V,Ke),xe;if(Ce===null){for(;Ke<G.length;Ke++)Ce=se(V,G[Ke],re),Ce!==null&&(j=w(Ce,j,Ke),bt===null?xe=Ce:bt.sibling=Ce,bt=Ce);return ze&&te(V,Ke),xe}for(Ce=g(Ce);Ke<G.length;Ke++)un=we(Ce,V,Ke,G[Ke],re),un!==null&&(l&&un.alternate!==null&&Ce.delete(un.key===null?Ke:un.key),j=w(un,j,Ke),bt===null?xe=un:bt.sibling=un,bt=un);return l&&Ce.forEach(function(No){return u(V,No)}),ze&&te(V,Ke),xe}function Yd(V,j,G,re){if(G==null)throw Error(s(151));for(var xe=null,bt=null,Ce=j,Ke=j=0,un=null,qe=G.next();Ce!==null&&!qe.done;Ke++,qe=G.next()){Ce.index>Ke?(un=Ce,Ce=null):un=Ce.sibling;var No=pe(V,Ce,qe.value,re);if(No===null){Ce===null&&(Ce=un);break}l&&Ce&&No.alternate===null&&u(V,Ce),j=w(No,j,Ke),bt===null?xe=No:bt.sibling=No,bt=No,Ce=un}if(qe.done)return p(V,Ce),ze&&te(V,Ke),xe;if(Ce===null){for(;!qe.done;Ke++,qe=G.next())qe=se(V,qe.value,re),qe!==null&&(j=w(qe,j,Ke),bt===null?xe=qe:bt.sibling=qe,bt=qe);return ze&&te(V,Ke),xe}for(Ce=g(Ce);!qe.done;Ke++,qe=G.next())qe=we(Ce,V,Ke,qe.value,re),qe!==null&&(l&&qe.alternate!==null&&Ce.delete(qe.key===null?Ke:qe.key),j=w(qe,j,Ke),bt===null?xe=qe:bt.sibling=qe,bt=qe);return l&&Ce.forEach(function(A6){return u(V,A6)}),ze&&te(V,Ke),xe}function rl(V,j,G,re){if(typeof G=="object"&&G!==null&&G.type===hc&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case Hp:e:{for(var xe=G.key;j!==null;){if(j.key===xe){if(xe=G.type,xe===hc){if(j.tag===7){p(V,j.sibling),re=b(j,G.props.children),re.return=V,V=re;break e}}else if(j.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===Ao&&Ga(xe)===j.type){p(V,j.sibling),re=b(j,G.props),Td(re,G),re.return=V,V=re;break e}p(V,j);break}else u(V,j);j=j.sibling}G.type===hc?(re=Qa(G.props.children,V.mode,re,G.key),re.return=V,V=re):(re=Vp(G.type,G.key,G.props,null,V.mode,re),Td(re,G),re.return=V,V=re)}return M(V);case dc:e:{for(xe=G.key;j!==null;){if(j.key===xe)if(j.tag===4&&j.stateNode.containerInfo===G.containerInfo&&j.stateNode.implementation===G.implementation){p(V,j.sibling),re=b(j,G.children||[]),re.return=V,V=re;break e}else{p(V,j);break}else u(V,j);j=j.sibling}re=G0(G,V.mode,re),re.return=V,V=re}return M(V);case Ao:return G=Ga(G),rl(V,j,G,re)}if(Gp(G))return Wt(V,j,G,re);if(h(G)){if(xe=h(G),typeof xe!="function")throw Error(s(150));return G=xe.call(G),Yd(V,j,G,re)}if(typeof G.then=="function")return rl(V,j,bp(G),re);if(G.$$typeof===To)return rl(V,j,mp(V,G),re);xp(V,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,j!==null&&j.tag===6?(p(V,j.sibling),re=b(j,G),re.return=V,V=re):(p(V,j),re=H0(G,V.mode,re),re.return=V,V=re),M(V)):p(V,j)}return function(V,j,G,re){try{Wd=0;var xe=rl(V,j,G,re);return kc=null,xe}catch(Ce){if(Ce===Cc||Ce===tm)throw Ce;var bt=t(29,Ce,null,V.mode);return bt.lanes=re,bt.return=V,bt}finally{}}}function Sp(){for(var l=wc,u=pb=wc=0;u<l;){var p=Ui[u];Ui[u++]=null;var g=Ui[u];Ui[u++]=null;var b=Ui[u];Ui[u++]=null;var w=Ui[u];if(Ui[u++]=null,g!==null&&b!==null){var M=g.pending;M===null?b.next=b:(b.next=M.next,M.next=b),g.pending=b}w!==0&&q1(p,b,w)}}function Cp(l,u,p,g){Ui[wc++]=l,Ui[wc++]=u,Ui[wc++]=p,Ui[wc++]=g,pb|=g,l.lanes|=g,l=l.alternate,l!==null&&(l.lanes|=g)}function Qv(l,u,p,g){return Cp(l,u,p,g),kp(l)}function Wa(l,u){return Cp(l,null,null,u),kp(l)}function q1(l,u,p){l.lanes|=p;var g=l.alternate;g!==null&&(g.lanes|=p);for(var b=!1,w=l.return;w!==null;)w.childLanes|=p,g=w.alternate,g!==null&&(g.childLanes|=p),w.tag===22&&(l=w.stateNode,l===null||l._visibility&1||(b=!0)),l=w,w=w.return;return l.tag===3?(w=l.stateNode,b&&u!==null&&(b=31-Si(p),l=w.hiddenUpdates,g=l[b],g===null?l[b]=[u]:g.push(u),u.lane=p|536870912),w):null}function kp(l){if(50<Xd)throw Xd=0,Ab=null,Error(s(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}function $v(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xv(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function bo(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function xo(l,u,p){var g=l.updateQueue;if(g===null)return null;if(g=g.shared,(Be&2)!==0){var b=g.pending;return b===null?u.next=u:(u.next=b.next,b.next=u),g.pending=u,u=kp(l),q1(l,null,p),u}return Cp(l,g,u,p),kp(l)}function Ad(l,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var g=u.lanes;g&=l.pendingLanes,p|=g,u.lanes=p,L(l,p)}}function Yv(l,u){var p=l.updateQueue,g=l.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var b=null,w=null;if(p=p.firstBaseUpdate,p!==null){do{var M={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};w===null?b=w=M:w=w.next=M,p=p.next}while(p!==null);w===null?b=w=u:w=w.next=u}else b=w=u;p={baseState:g.baseState,firstBaseUpdate:b,lastBaseUpdate:w,shared:g.shared,callbacks:g.callbacks},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=u:l.next=u,p.lastBaseUpdate=u}function Ed(){if(mb){var l=Sc;if(l!==null)throw l}}function _d(l,u,p,g){mb=!1;var b=l.updateQueue;Ro=!1;var w=b.firstBaseUpdate,M=b.lastBaseUpdate,F=b.shared.pending;if(F!==null){b.shared.pending=null;var J=F,Y=J.next;J.next=null,M===null?w=Y:M.next=Y,M=J;var ue=l.alternate;ue!==null&&(ue=ue.updateQueue,F=ue.lastBaseUpdate,F!==M&&(F===null?ue.firstBaseUpdate=Y:F.next=Y,ue.lastBaseUpdate=J))}if(w!==null){var se=b.baseState;M=0,ue=Y=J=null,F=w;do{var pe=F.lane&-536870913,we=pe!==F.lane;if(we?(Ue&pe)===pe:(g&pe)===pe){pe!==0&&pe===xc&&(mb=!0),ue!==null&&(ue=ue.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var Wt=l,Yd=F;pe=u;var rl=p;switch(Yd.tag){case 1:if(Wt=Yd.payload,typeof Wt=="function"){se=Wt.call(rl,se,pe);break e}se=Wt;break e;case 3:Wt.flags=Wt.flags&-65537|128;case 0:if(Wt=Yd.payload,pe=typeof Wt=="function"?Wt.call(rl,se,pe):Wt,pe==null)break e;se=J0({},se,pe);break e;case 2:Ro=!0}}pe=F.callback,pe!==null&&(l.flags|=64,we&&(l.flags|=8192),we=b.callbacks,we===null?b.callbacks=[pe]:we.push(pe))}else we={lane:pe,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ue===null?(Y=ue=we,J=se):ue=ue.next=we,M|=pe;if(F=F.next,F===null){if(F=b.shared.pending,F===null)break;we=F,F=we.next,we.next=null,b.lastBaseUpdate=we,b.shared.pending=null}}while(!0);ue===null&&(J=se),b.baseState=J,b.firstBaseUpdate=Y,b.lastBaseUpdate=ue,w===null&&(b.shared.lanes=0),Io|=M,l.lanes=M,l.memoizedState=se}}function Q1(l,u){if(typeof l!="function")throw Error(s(191,l));l.call(u)}function $1(l,u){var p=l.callbacks;if(p!==null)for(l.callbacks=null,l=0;l<p.length;l++)Q1(p[l],u)}function X1(l,u){l=wr,v(im,l),v(Tc,u),wr=l|u.baseLanes}function Zv(){v(im,wr),v(Tc,Tc.current)}function e0(){wr=im.current,y(Tc),y(im)}function So(l){var u=l.alternate;v(Ft,Ft.current&1),v(wi,l),as===null&&(u===null||Tc.current!==null||u.memoizedState!==null)&&(as=l)}function t0(l){v(Ft,Ft.current),v(wi,l),as===null&&(as=l)}function Y1(l){l.tag===22?(v(Ft,Ft.current),v(wi,l),as===null&&(as=l)):Co()}function Co(){v(Ft,Ft.current),v(wi,wi.current)}function vi(l){y(wi),as===l&&(as=null),y(Ft)}function wp(l){for(var u=l;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||tb(p)||nb(p)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function At(){throw Error(s(321))}function n0(l,u){if(u===null)return!1;for(var p=0;p<u.length&&p<l.length;p++)if(!ki(l[p],u[p]))return!1;return!0}function i0(l,u,p,g,b,w){return Cr=w,Te=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,be.H=l===null||l.memoizedState===null?T_:gb,il=!1,w=p(g,b),il=!1,Ac&&(w=eA(u,p,g,b)),Z1(l),w}function Z1(l){be.H=Kd;var u=it!==null&&it.next!==null;if(Cr=0,zt=it=Te=null,sm=!1,Jd=0,Ec=null,u)throw Error(s(300));l===null||Vt||(l=l.dependencies,l!==null&&pp(l)&&(Vt=!0))}function eA(l,u,p,g){Te=l;var b=0;do{if(Ac&&(Ec=null),Jd=0,Ac=!1,25<=b)throw Error(s(301));if(b+=1,zt=it=null,l.updateQueue!=null){var w=l.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}be.H=A_,w=u(p,g)}while(Ac);return w}function dU(){var l=be.H,u=l.useState()[0];return u=typeof u.then=="function"?Md(u):u,l=l.useState()[0],(it!==null?it.memoizedState:null)!==l&&(Te.flags|=1024),u}function s0(){var l=rm!==0;return rm=0,l}function r0(l,u,p){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~p}function o0(l){if(sm){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}sm=!1}Cr=0,zt=it=Te=null,Ac=!1,Jd=rm=0,Ec=null}function Ln(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?Te.memoizedState=zt=l:zt=zt.next=l,zt}function Nt(){if(it===null){var l=Te.alternate;l=l!==null?l.memoizedState:null}else l=it.next;var u=zt===null?Te.memoizedState:zt.next;if(u!==null)zt=u,it=l;else{if(l===null)throw Te.alternate===null?Error(s(467)):Error(s(310));it=l,l={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},zt===null?Te.memoizedState=zt=l:zt=zt.next=l}return zt}function Tp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Md(l){var u=Jd;return Jd+=1,Ec===null&&(Ec=[]),l=G1(Ec,l,u),u=Te,(zt===null?u.memoizedState:zt.next)===null&&(u=u.alternate,be.H=u===null||u.memoizedState===null?T_:gb),l}function Ap(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Md(l);if(l.$$typeof===To)return vn(l)}throw Error(s(438,String(l)))}function a0(l){var u=null,p=Te.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var g=Te.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(u={data:g.data.map(function(b){return b.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Tp(),Te.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(l),g=0;g<l;g++)p[g]=FU;return u.index++,p}function pr(l,u){return typeof u=="function"?u(l):u}function Ep(l){var u=Nt();return l0(u,it,l)}function l0(l,u,p){var g=l.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=p;var b=l.baseQueue,w=g.pending;if(w!==null){if(b!==null){var M=b.next;b.next=w.next,w.next=M}u.baseQueue=b=w,g.pending=null}if(w=l.baseState,b===null)l.memoizedState=w;else{u=b.next;var F=M=null,J=null,Y=u,ue=!1;do{var se=Y.lane&-536870913;if(se!==Y.lane?(Ue&se)===se:(Cr&se)===se){var pe=Y.revertLane;if(pe===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),se===xc&&(ue=!0);else if((Cr&pe)===pe){Y=Y.next,pe===xc&&(ue=!0);continue}else se={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},J===null?(F=J=se,M=w):J=J.next=se,Te.lanes|=pe,Io|=pe;se=Y.action,il&&p(w,se),w=Y.hasEagerState?Y.eagerState:p(w,se)}else pe={lane:se,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},J===null?(F=J=pe,M=w):J=J.next=pe,Te.lanes|=se,Io|=se;Y=Y.next}while(Y!==null&&Y!==u);if(J===null?M=w:J.next=F,!ki(w,l.memoizedState)&&(Vt=!0,ue&&(p=Sc,p!==null)))throw p;l.memoizedState=w,l.baseState=M,l.baseQueue=J,g.lastRenderedState=w}return b===null&&(g.lanes=0),[l.memoizedState,g.dispatch]}function c0(l){var u=Nt(),p=u.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=l;var g=p.dispatch,b=p.pending,w=u.memoizedState;if(b!==null){p.pending=null;var M=b=b.next;do w=l(w,M.action),M=M.next;while(M!==b);ki(w,u.memoizedState)||(Vt=!0),u.memoizedState=w,u.baseQueue===null&&(u.baseState=w),p.lastRenderedState=w}return[w,g]}function tA(l,u,p){var g=Te,b=Nt(),w=ze;if(w){if(p===void 0)throw Error(s(407));p=p()}else p=u();var M=!ki((it||b).memoizedState,p);if(M&&(b.memoizedState=p,Vt=!0),b=b.queue,h0(sA.bind(null,g,b,l),[l]),b.getSnapshot!==u||M||zt!==null&&zt.memoizedState.tag&1){if(g.flags|=2048,ac(9,{destroy:void 0},iA.bind(null,g,b,p,u),null),ot===null)throw Error(s(349));w||Cr&127||nA(g,u,p)}return p}function nA(l,u,p){l.flags|=16384,l={getSnapshot:u,value:p},u=Te.updateQueue,u===null?(u=Tp(),Te.updateQueue=u,u.stores=[l]):(p=u.stores,p===null?u.stores=[l]:p.push(l))}function iA(l,u,p,g){u.value=p,u.getSnapshot=g,rA(u)&&oA(l)}function sA(l,u,p){return p(function(){rA(u)&&oA(l)})}function rA(l){var u=l.getSnapshot;l=l.value;try{var p=u();return!ki(l,p)}catch{return!0}}function oA(l){var u=Wa(l,2);u!==null&&ei(u,l,2)}function u0(l){var u=Ln();if(typeof l=="function"){var p=l;if(l=p(),il){he(!0);try{p()}finally{he(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pr,lastRenderedState:l},u}function aA(l,u,p,g){return l.baseState=p,l0(l,it,typeof g=="function"?g:pr)}function hU(l,u,p,g,b){if(Rp(l))throw Error(s(485));if(l=u.action,l!==null){var w={payload:b,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){w.listeners.push(M)}};be.T!==null?p(!0):w.isTransition=!1,g(w),p=u.pending,p===null?(w.next=u.pending=w,lA(u,w)):(w.next=p.next,u.pending=p.next=w)}}function lA(l,u){var p=u.action,g=u.payload,b=l.state;if(u.isTransition){var w=be.T,M={};be.T=M;try{var F=p(b,g),J=be.S;J!==null&&J(M,F),cA(l,u,F)}catch(Y){d0(l,u,Y)}finally{w!==null&&M.types!==null&&(w.types=M.types),be.T=w}}else try{w=p(b,g),cA(l,u,w)}catch(Y){d0(l,u,Y)}}function cA(l,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(g){uA(l,u,g)},function(g){return d0(l,u,g)}):uA(l,u,p)}function uA(l,u,p){u.status="fulfilled",u.value=p,dA(u),l.state=p,u=l.pending,u!==null&&(p=u.next,p===u?l.pending=null:(p=p.next,u.next=p,lA(l,p)))}function d0(l,u,p){var g=l.pending;if(l.pending=null,g!==null){g=g.next;do u.status="rejected",u.reason=p,dA(u),u=u.next;while(u!==g)}l.action=null}function dA(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function hA(l,u){return u}function fA(l,u){if(ze){var p=ot.formState;if(p!==null){e:{var g=Te;if(ze){if(yt){var b=M9(yt,ji);if(b){yt=a_(b),g=R9(b);break e}}hr(g)}g=!1}g&&(u=p[0])}}p=Ln(),p.memoizedState=p.baseState=u,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hA,lastRenderedState:u},p.queue=g,p=PA.bind(null,Te,g),g.dispatch=p,g=u0(!1);var w=g0.bind(null,Te,!1,g.queue);return g=Ln(),b={state:u,dispatch:null,action:l,pending:null},g.queue=b,p=hU.bind(null,Te,b,w,p),b.dispatch=p,g.memoizedState=l,[u,p,!1]}function pA(l){var u=Nt();return mA(u,it,l)}function mA(l,u,p){if(u=l0(l,u,hA)[0],l=Ep(pr)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var g=Md(u)}catch(M){throw M===Cc?tm:M}else g=u;u=Nt();var b=u.queue,w=b.dispatch;return p!==u.memoizedState&&(Te.flags|=2048,ac(9,{destroy:void 0},fU.bind(null,b,p),null)),[g,w,l]}function fU(l,u){l.action=u}function gA(l){var u=Nt(),p=it;if(p!==null)return mA(u,p,l);Nt(),u=u.memoizedState,p=Nt();var g=p.queue.dispatch;return p.memoizedState=l,[u,g,!1]}function ac(l,u,p,g){return l={tag:l,create:p,deps:g,inst:u,next:null},u=Te.updateQueue,u===null&&(u=Tp(),Te.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=l.next=l:(g=p.next,p.next=l,l.next=g,u.lastEffect=l),l}function yA(){return Nt().memoizedState}function _p(l,u,p,g){var b=Ln();Te.flags|=l,b.memoizedState=ac(1|u,{destroy:void 0},p,g===void 0?null:g)}function Mp(l,u,p,g){var b=Nt();g=g===void 0?null:g;var w=b.memoizedState.inst;it!==null&&g!==null&&n0(g,it.memoizedState.deps)?b.memoizedState=ac(u,w,p,g):(Te.flags|=l,b.memoizedState=ac(1|u,w,p,g))}function vA(l,u){_p(8390656,8,l,u)}function h0(l,u){Mp(2048,8,l,u)}function pU(l){Te.flags|=4;var u=Te.updateQueue;if(u===null)u=Tp(),Te.updateQueue=u,u.events=[l];else{var p=u.events;p===null?u.events=[l]:p.push(l)}}function bA(l){var u=Nt().memoizedState;return pU({ref:u,nextImpl:l}),function(){if(Be&2)throw Error(s(440));return u.impl.apply(void 0,arguments)}}function xA(l,u){return Mp(4,2,l,u)}function SA(l,u){return Mp(4,4,l,u)}function CA(l,u){if(typeof u=="function"){l=l();var p=u(l);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function kA(l,u,p){p=p!=null?p.concat([l]):null,Mp(4,4,CA.bind(null,u,l),p)}function f0(){}function wA(l,u){var p=Nt();u=u===void 0?null:u;var g=p.memoizedState;return u!==null&&n0(u,g[1])?g[0]:(p.memoizedState=[l,u],l)}function TA(l,u){var p=Nt();u=u===void 0?null:u;var g=p.memoizedState;if(u!==null&&n0(u,g[1]))return g[0];if(g=l(),il){he(!0);try{l()}finally{he(!1)}}return p.memoizedState=[g,u],g}function p0(l,u,p){return p===void 0||Cr&1073741824&&!(Ue&261930)?l.memoizedState=u:(l.memoizedState=p,l=SE(),Te.lanes|=l,Io|=l,p)}function AA(l,u,p,g){return ki(p,u)?p:Tc.current!==null?(l=p0(l,p,g),ki(l,u)||(Vt=!0),l):!(Cr&42)||Cr&1073741824&&!(Ue&261930)?(Vt=!0,l.memoizedState=p):(l=SE(),Te.lanes|=l,Io|=l,u)}function EA(l,u,p,g,b){var w=xr();ln(w!==0&&8>w?w:8);var M=be.T,F={};be.T=F,g0(l,!1,u,p);try{var J=b(),Y=be.S;if(Y!==null&&Y(F,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var ue=uU(J,g);Rd(l,u,ue,bi(l))}else Rd(l,u,g,bi(l))}catch(se){Rd(l,u,{then:function(){},status:"rejected",reason:se},bi())}finally{ln(w),M!==null&&F.types!==null&&(M.types=F.types),be.T=M}}function _A(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:fc,baseState:fc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pr,lastRenderedState:fc},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pr,lastRenderedState:p},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function m0(){return vn(Xa)}function MA(){return Nt().memoizedState}function RA(){return Nt().memoizedState}function mU(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var p=bi();l=bo(p);var g=xo(u,l,p);g!==null&&(ei(g,u,p),Ad(g,u,p)),u={cache:Jv()},l.payload=u;return}u=u.return}}function gU(l,u,p){var g=bi();p={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Rp(l)?IA(u,p):(p=Qv(l,u,p,g),p!==null&&(ei(p,l,g),BA(p,u,g)))}function PA(l,u,p){var g=bi();Rd(l,u,p,g)}function Rd(l,u,p,g){var b={lane:g,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Rp(l))IA(u,b);else{var w=l.alternate;if(l.lanes===0&&(w===null||w.lanes===0)&&(w=u.lastRenderedReducer,w!==null))try{var M=u.lastRenderedState,F=w(M,p);if(b.hasEagerState=!0,b.eagerState=F,ki(F,M))return Cp(l,u,b,0),ot===null&&Sp(),!1}catch{}finally{}if(p=Qv(l,u,b,g),p!==null)return ei(p,l,g),BA(p,u,g),!0}return!1}function g0(l,u,p,g){if(g={lane:2,revertLane:Kv(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Rp(l)){if(u)throw Error(s(479))}else u=Qv(l,p,g,2),u!==null&&ei(u,l,2)}function Rp(l){var u=l.alternate;return l===Te||u!==null&&u===Te}function IA(l,u){Ac=sm=!0;var p=l.pending;p===null?u.next=u:(u.next=p.next,p.next=u),l.pending=u}function BA(l,u,p){if(p&4194048){var g=u.lanes;g&=l.pendingLanes,p|=g,u.lanes=p,L(l,p)}}function y0(l,u,p,g){u=l.memoizedState,p=p(g,u),p=p==null?u:J0({},u,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}function DA(l,u,p,g,b,w,M){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(g,w,M):u.prototype&&u.prototype.isPureReactComponent?!vp(p,g)||!vp(b,w):!0}function NA(l,u,p,g){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,g),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,g),u.state!==l&&yb.enqueueReplaceState(u,u.state,null)}function Ja(l,u){var p=u;if("ref"in u){p={};for(var g in u)g!=="ref"&&(p[g]=u[g])}if(l=l.defaultProps){p===u&&(p=J0({},p));for(var b in l)p[b]===void 0&&(p[b]=l[b])}return p}function Pp(l,u){try{var p=l.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(g){setTimeout(function(){throw g})}}function FA(l,u,p){try{var g=l.onCaughtError;g(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function v0(l,u,p){return p=bo(p),p.tag=3,p.payload={element:null},p.callback=function(){Pp(l,u)},p}function OA(l){return l=bo(l),l.tag=3,l}function LA(l,u,p,g){var b=p.type.getDerivedStateFromError;if(typeof b=="function"){var w=g.value;l.payload=function(){return b(w)},l.callback=function(){FA(u,p,g)}}var M=p.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(l.callback=function(){FA(u,p,g),typeof b!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function yU(l,u,p,g,b){if(p.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(u=p.alternate,u!==null&&rc(u,p,b,!0),p=wi.current,p!==null){switch(p.tag){case 31:case 13:return as===null?Up():p.alternate===null&&Et===0&&(Et=3),p.flags&=-257,p.flags|=65536,p.lanes=b,g===nm?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([g]):u.add(g),z0(l,g,b)),!1;case 22:return p.flags|=65536,g===nm?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([g])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([g]):p.add(g)),z0(l,g,b)),!1}throw Error(s(435,p.tag))}return z0(l,g,b),Up(),!1}if(ze)return u=wi.current,u!==null?(!(u.flags&65536)&&(u.flags|=256),u.flags|=65536,u.lanes=b,g!==cb&&(l=Error(s(422),{cause:g}),kd(X(l,p)))):(g!==cb&&(u=Error(s(423),{cause:g}),kd(X(u,p))),l=l.current.alternate,l.flags|=65536,b&=-b,l.lanes|=b,g=X(g,p),b=v0(l.stateNode,g,b),Yv(l,b),Et!==4&&(Et=2)),!1;var w=Error(s(520),{cause:g});if(w=X(w,p),Qd===null?Qd=[w]:Qd.push(w),Et!==4&&(Et=2),u===null)return!0;g=X(g,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,l=b&-b,p.lanes|=l,l=v0(p.stateNode,g,l),Yv(p,l),!1;case 1:if(u=p.type,w=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Bo===null||!Bo.has(w))))return p.flags|=65536,b&=-b,p.lanes|=b,b=OA(b),LA(b,l,p,g),Yv(p,b),!1}p=p.return}while(p!==null);return!1}function bn(l,u,p,g){u.child=l===null?w_(u,null,p,g):nl(u,l.child,p,g)}function jA(l,u,p,g,b){p=p.render;var w=u.ref;if("ref"in g){var M={};for(var F in g)F!=="ref"&&(M[F]=g[F])}else M=g;return Ha(u),g=i0(l,u,p,M,w,b),F=s0(),l!==null&&!Vt?(r0(l,u,b),mr(l,u,b)):(ze&&F&&_e(u),u.flags|=1,bn(l,u,g,b),u.child)}function UA(l,u,p,g,b){if(l===null){var w=p.type;return typeof w=="function"&&!V0(w)&&w.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=w,zA(l,u,w,g,b)):(l=Vp(p.type,null,g,u,u.mode,b),l.ref=u.ref,l.return=u,u.child=l)}if(w=l.child,!T0(l,b)){var M=w.memoizedProps;if(p=p.compare,p=p!==null?p:vp,p(M,g)&&l.ref===u.ref)return mr(l,u,b)}return u.flags|=1,l=vr(w,g),l.ref=u.ref,l.return=u,u.child=l}function zA(l,u,p,g,b){if(l!==null){var w=l.memoizedProps;if(vp(w,g)&&l.ref===u.ref)if(Vt=!1,u.pendingProps=g=w,T0(l,b))l.flags&131072&&(Vt=!0);else return u.lanes=l.lanes,mr(l,u,b)}return b0(l,u,p,g,b)}function VA(l,u,p,g){var b=g.children,w=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if(u.flags&128){if(w=w!==null?w.baseLanes|p:p,l!==null){for(g=u.child=l.child,b=0;g!==null;)b=b|g.lanes|g.childLanes,g=g.sibling;g=b&~w}else g=0,u.child=null;return HA(l,u,w,p,g)}if(p&536870912)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&yp(u,w!==null?w.cachePool:null),w!==null?X1(u,w):Zv(),Y1(u);else return g=u.lanes=536870912,HA(l,u,w!==null?w.baseLanes|p:p,p,g)}else w!==null?(yp(u,w.cachePool),X1(u,w),Co(),u.memoizedState=null):(l!==null&&yp(u,null),Zv(),Co());return bn(l,u,b,p),u.child}function Pd(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function HA(l,u,p,g,b){var w=qv();return w=w===null?null:{parent:br?vt._currentValue:vt._currentValue2,pool:w},u.memoizedState={baseLanes:p,cachePool:w},l!==null&&yp(u,null),Zv(),Y1(u),l!==null&&rc(l,u,g,!0),u.childLanes=b,null}function Ip(l,u){return u=Dp({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function GA(l,u,p){return nl(u,l.child,null,p),l=Ip(u,u.pendingProps),l.flags|=2,vi(u),u.memoizedState=null,l}function vU(l,u,p){var g=u.pendingProps,b=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(ze){if(g.mode==="hidden")return l=Ip(u,g),u.lanes=536870912,Pd(null,l);if(t0(u),(l=yt)?(l=j9(l,ji),l!==null&&(u.memoizedState={dehydrated:l,treeContext:Eo!==null?{id:Ws,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},p=zE(l),p.return=u,u.child=p,Sn=u,yt=null)):l=null,l===null)throw hr(u);return u.lanes=536870912,null}return Ip(u,g)}var w=l.memoizedState;if(w!==null){var M=w.dehydrated;if(t0(u),b)if(u.flags&256)u.flags&=-257,u=GA(l,u,p);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(s(558));else if(Vt||rc(l,u,p,!1),b=(p&l.childLanes)!==0,Vt||b){if(g=ot,g!==null&&(M=O(g,p),M!==0&&M!==w.retryLane))throw w.retryLane=M,Wa(l,M),ei(g,l,M),vb;Up(),u=GA(l,u,p)}else l=w.treeContext,Mn&&(yt=D9(M),Sn=u,ze=!0,Mo=null,ji=!1,l!==null&&Ye(u,l)),u=Ip(u,g),u.flags|=4096;return u}return l=vr(l.child,{mode:g.mode,children:g.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Bp(l,u){var p=u.ref;if(p===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(s(284));(l===null||l.ref!==p)&&(u.flags|=4194816)}}function b0(l,u,p,g,b){return Ha(u),p=i0(l,u,p,g,void 0,b),g=s0(),l!==null&&!Vt?(r0(l,u,b),mr(l,u,b)):(ze&&g&&_e(u),u.flags|=1,bn(l,u,p,b),u.child)}function WA(l,u,p,g,b,w){return Ha(u),u.updateQueue=null,p=eA(u,g,p,b),Z1(l),g=s0(),l!==null&&!Vt?(r0(l,u,w),mr(l,u,w)):(ze&&g&&_e(u),u.flags|=1,bn(l,u,p,w),u.child)}function JA(l,u,p,g,b){if(Ha(u),u.stateNode===null){var w=gc,M=p.contextType;typeof M=="object"&&M!==null&&(w=vn(M)),w=new p(g,w),u.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=yb,u.stateNode=w,w._reactInternals=u,w=u.stateNode,w.props=g,w.state=u.memoizedState,w.refs={},$v(u),M=p.contextType,w.context=typeof M=="object"&&M!==null?vn(M):gc,w.state=u.memoizedState,M=p.getDerivedStateFromProps,typeof M=="function"&&(y0(u,p,M,g),w.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(M=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),M!==w.state&&yb.enqueueReplaceState(w,w.state,null),_d(u,g,w,b),Ed(),w.state=u.memoizedState),typeof w.componentDidMount=="function"&&(u.flags|=4194308),g=!0}else if(l===null){w=u.stateNode;var F=u.memoizedProps,J=Ja(p,F);w.props=J;var Y=w.context,ue=p.contextType;M=gc,typeof ue=="object"&&ue!==null&&(M=vn(ue));var se=p.getDerivedStateFromProps;ue=typeof se=="function"||typeof w.getSnapshotBeforeUpdate=="function",F=u.pendingProps!==F,ue||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(F||Y!==M)&&NA(u,w,g,M),Ro=!1;var pe=u.memoizedState;w.state=pe,_d(u,g,w,b),Ed(),Y=u.memoizedState,F||pe!==Y||Ro?(typeof se=="function"&&(y0(u,p,se,g),Y=u.memoizedState),(J=Ro||DA(u,p,J,g,pe,Y,M))?(ue||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(u.flags|=4194308)):(typeof w.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=g,u.memoizedState=Y),w.props=g,w.state=Y,w.context=M,g=J):(typeof w.componentDidMount=="function"&&(u.flags|=4194308),g=!1)}else{w=u.stateNode,Xv(l,u),M=u.memoizedProps,ue=Ja(p,M),w.props=ue,se=u.pendingProps,pe=w.context,Y=p.contextType,J=gc,typeof Y=="object"&&Y!==null&&(J=vn(Y)),F=p.getDerivedStateFromProps,(Y=typeof F=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(M!==se||pe!==J)&&NA(u,w,g,J),Ro=!1,pe=u.memoizedState,w.state=pe,_d(u,g,w,b),Ed();var we=u.memoizedState;M!==se||pe!==we||Ro||l!==null&&l.dependencies!==null&&pp(l.dependencies)?(typeof F=="function"&&(y0(u,p,F,g),we=u.memoizedState),(ue=Ro||DA(u,p,ue,g,pe,we,J)||l!==null&&l.dependencies!==null&&pp(l.dependencies))?(Y||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(g,we,J),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(g,we,J)),typeof w.componentDidUpdate=="function"&&(u.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof w.componentDidUpdate!="function"||M===l.memoizedProps&&pe===l.memoizedState||(u.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&pe===l.memoizedState||(u.flags|=1024),u.memoizedProps=g,u.memoizedState=we),w.props=g,w.state=we,w.context=J,g=ue):(typeof w.componentDidUpdate!="function"||M===l.memoizedProps&&pe===l.memoizedState||(u.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&pe===l.memoizedState||(u.flags|=1024),g=!1)}return w=g,Bp(l,u),g=(u.flags&128)!==0,w||g?(w=u.stateNode,p=g&&typeof p.getDerivedStateFromError!="function"?null:w.render(),u.flags|=1,l!==null&&g?(u.child=nl(u,l.child,null,b),u.child=nl(u,null,p,b)):bn(l,u,p,b),u.memoizedState=w.state,l=u.child):l=mr(l,u,b),l}function KA(l,u,p,g){return Va(),u.flags|=256,bn(l,u,p,g),u.child}function x0(l){return{baseLanes:l,cachePool:V1()}}function S0(l,u,p){return l=l!==null?l.childLanes&~p:0,u&&(l|=Ai),l}function qA(l,u,p){var g=u.pendingProps,b=!1,w=(u.flags&128)!==0,M;if((M=w)||(M=l!==null&&l.memoizedState===null?!1:(Ft.current&2)!==0),M&&(b=!0,u.flags&=-129),M=(u.flags&32)!==0,u.flags&=-33,l===null){if(ze){if(b?So(u):Co(),(l=yt)?(l=U9(l,ji),l!==null&&(u.memoizedState={dehydrated:l,treeContext:Eo!==null?{id:Ws,overflow:Js}:null,retryLane:536870912,hydrationErrors:null},p=zE(l),p.return=u,u.child=p,Sn=u,yt=null)):l=null,l===null)throw hr(u);return nb(l)?u.lanes=32:u.lanes=536870912,null}var F=g.children;return g=g.fallback,b?(Co(),b=u.mode,F=Dp({mode:"hidden",children:F},b),g=Qa(g,b,p,null),F.return=u,g.return=u,F.sibling=g,u.child=F,g=u.child,g.memoizedState=x0(p),g.childLanes=S0(l,M,p),u.memoizedState=bb,Pd(null,g)):(So(u),C0(u,F))}var J=l.memoizedState;if(J!==null&&(F=J.dehydrated,F!==null)){if(w)u.flags&256?(So(u),u.flags&=-257,u=k0(l,u,p)):u.memoizedState!==null?(Co(),u.child=l.child,u.flags|=128,u=null):(Co(),F=g.fallback,b=u.mode,g=Dp({mode:"visible",children:g.children},b),F=Qa(F,b,p,null),F.flags|=2,g.return=u,F.return=u,g.sibling=F,u.child=g,nl(u,l.child,null,p),g=u.child,g.memoizedState=x0(p),g.childLanes=S0(l,M,p),u.memoizedState=bb,u=Pd(null,g));else if(So(u),nb(F))M=E9(F).digest,g=Error(s(419)),g.stack="",g.digest=M,kd({value:g,source:null,stack:null}),u=k0(l,u,p);else if(Vt||rc(l,u,p,!1),M=(p&l.childLanes)!==0,Vt||M){if(M=ot,M!==null&&(g=O(M,p),g!==0&&g!==J.retryLane))throw J.retryLane=g,Wa(l,g),ei(M,l,g),vb;tb(F)||Up(),u=k0(l,u,p)}else tb(F)?(u.flags|=192,u.child=l.child,u=null):(l=J.treeContext,Mn&&(yt=N9(F),Sn=u,ze=!0,Mo=null,ji=!1,l!==null&&Ye(u,l)),u=C0(u,g.children),u.flags|=4096);return u}return b?(Co(),F=g.fallback,b=u.mode,J=l.child,w=J.sibling,g=vr(J,{mode:"hidden",children:g.children}),g.subtreeFlags=J.subtreeFlags&65011712,w!==null?F=vr(w,F):(F=Qa(F,b,p,null),F.flags|=2),F.return=u,g.return=u,g.sibling=F,u.child=g,Pd(null,g),g=u.child,F=l.child.memoizedState,F===null?F=x0(p):(b=F.cachePool,b!==null?(J=br?vt._currentValue:vt._currentValue2,b=b.parent!==J?{parent:J,pool:J}:b):b=V1(),F={baseLanes:F.baseLanes|p,cachePool:b}),g.memoizedState=F,g.childLanes=S0(l,M,p),u.memoizedState=bb,Pd(l.child,g)):(So(u),p=l.child,l=p.sibling,p=vr(p,{mode:"visible",children:g.children}),p.return=u,p.sibling=null,l!==null&&(M=u.deletions,M===null?(u.deletions=[l],u.flags|=16):M.push(l)),u.child=p,u.memoizedState=null,p)}function C0(l,u){return u=Dp({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Dp(l,u){return l=t(22,l,null,u),l.lanes=0,l}function k0(l,u,p){return nl(u,l.child,null,p),l=C0(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function QA(l,u,p){l.lanes|=u;var g=l.alternate;g!==null&&(g.lanes|=u),Gv(l.return,u,p)}function w0(l,u,p,g,b,w){var M=l.memoizedState;M===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:b,treeForkCount:w}:(M.isBackwards=u,M.rendering=null,M.renderingStartTime=0,M.last=g,M.tail=p,M.tailMode=b,M.treeForkCount=w)}function $A(l,u,p){var g=u.pendingProps,b=g.revealOrder,w=g.tail;g=g.children;var M=Ft.current,F=(M&2)!==0;if(F?(M=M&1|2,u.flags|=128):M&=1,v(Ft,M),bn(l,u,g,p),g=ze?Vd:0,!F&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&QA(l,p,u);else if(l.tag===19)QA(l,p,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(b){case"forwards":for(p=u.child,b=null;p!==null;)l=p.alternate,l!==null&&wp(l)===null&&(b=p),p=p.sibling;p=b,p===null?(b=u.child,u.child=null):(b=p.sibling,p.sibling=null),w0(u,!1,b,p,w,g);break;case"backwards":case"unstable_legacy-backwards":for(p=null,b=u.child,u.child=null;b!==null;){if(l=b.alternate,l!==null&&wp(l)===null){u.child=b;break}l=b.sibling,b.sibling=p,p=b,b=l}w0(u,!0,p,null,w,g);break;case"together":w0(u,!1,null,null,void 0,g);break;default:u.memoizedState=null}return u.child}function mr(l,u,p){if(l!==null&&(u.dependencies=l.dependencies),Io|=u.lanes,(p&u.childLanes)===0)if(l!==null){if(rc(l,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(s(153));if(u.child!==null){for(l=u.child,p=vr(l,l.pendingProps),u.child=p,p.return=u;l.sibling!==null;)l=l.sibling,p=p.sibling=vr(l,l.pendingProps),p.return=u;p.sibling=null}return u.child}function T0(l,u){return l.lanes&u?!0:(l=l.dependencies,!!(l!==null&&pp(l)))}function bU(l,u,p){switch(u.tag){case 3:Xt(u,u.stateNode.containerInfo),vo(u,vt,l.memoizedState.cache),Va();break;case 27:case 5:yo(u);break;case 4:Xt(u,u.stateNode.containerInfo);break;case 10:vo(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,t0(u),null;break;case 13:var g=u.memoizedState;if(g!==null)return g.dehydrated!==null?(So(u),u.flags|=128,null):p&u.child.childLanes?qA(l,u,p):(So(u),l=mr(l,u,p),l!==null?l.sibling:null);So(u);break;case 19:var b=(l.flags&128)!==0;if(g=(p&u.childLanes)!==0,g||(rc(l,u,p,!1),g=(p&u.childLanes)!==0),b){if(g)return $A(l,u,p);u.flags|=128}if(b=u.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),v(Ft,Ft.current),g)break;return null;case 22:return u.lanes=0,VA(l,u,p,u.pendingProps);case 24:vo(u,vt,l.memoizedState.cache)}return mr(l,u,p)}function XA(l,u,p){if(l!==null)if(l.memoizedProps!==u.pendingProps)Vt=!0;else{if(!T0(l,p)&&!(u.flags&128))return Vt=!1,bU(l,u,p);Vt=(l.flags&131072)!==0}else Vt=!1,ze&&u.flags&1048576&&ye(u,Vd,u.index);switch(u.lanes=0,u.tag){case 16:e:{var g=u.pendingProps;if(l=Ga(u.elementType),u.type=l,typeof l=="function")V0(l)?(g=Ja(l,g),u.tag=1,u=JA(null,u,l,g,p)):(u.tag=0,u=b0(null,u,l,g,p));else{if(l!=null){var b=l.$$typeof;if(b===q0){u.tag=11,u=jA(null,u,l,g,p);break e}else if(b===X0){u.tag=14,u=UA(null,u,l,g,p);break e}}throw u=f(l)||l,Error(s(306,u,""))}}return u;case 0:return b0(l,u,u.type,u.pendingProps,p);case 1:return g=u.type,b=Ja(g,u.pendingProps),JA(l,u,g,b,p);case 3:e:{if(Xt(u,u.stateNode.containerInfo),l===null)throw Error(s(387));var w=u.pendingProps;b=u.memoizedState,g=b.element,Xv(l,u),_d(u,w,null,p);var M=u.memoizedState;if(w=M.cache,vo(u,vt,w),w!==b.cache&&Wv(u,[vt],p,!0),Ed(),w=M.element,Mn&&b.isDehydrated)if(b={element:w,isDehydrated:!1,cache:M.cache},u.updateQueue.baseState=b,u.memoizedState=b,u.flags&256){u=KA(l,u,w,p);break e}else if(w!==g){g=X(Error(s(424)),u),kd(g),u=KA(l,u,w,p);break e}else for(Mn&&(yt=B9(u.stateNode.containerInfo),Sn=u,ze=!0,Mo=null,ji=!0),p=w_(u,null,w,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Va(),w===g){u=mr(l,u,p);break e}bn(l,u,w,p)}u=u.child}return u;case 26:if(os)return Bp(l,u),l===null?(p=u_(u.type,null,u.pendingProps,null))?u.memoizedState=p:ze||(u.stateNode=o6(u.type,u.pendingProps,_o.current,u)):u.memoizedState=u_(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:if(Yt)return yo(u),l===null&&Yt&&ze&&(g=u.stateNode=g_(u.type,u.pendingProps,_o.current,xn.current,!1),Sn=u,ji=!0,yt=F9(u.type,g,yt)),bn(l,u,u.pendingProps.children,p),Bp(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&ze&&(i6(u.type,u.pendingProps,xn.current),(b=g=yt)&&(g=O9(g,u.type,u.pendingProps,ji),g!==null?(u.stateNode=g,Sn=u,yt=I9(g),ji=!1,b=!0):b=!1),b||hr(u)),yo(u),b=u.type,w=u.pendingProps,M=l!==null?l.memoizedProps:null,g=w.children,Wp(b,w)?g=null:M!==null&&Wp(b,M)&&(u.flags|=32),u.memoizedState!==null&&(b=i0(l,u,dU,null,null,p),br?Xa._currentValue=b:Xa._currentValue2=b),Bp(l,u),bn(l,u,g,p),u.child;case 6:return l===null&&ze&&(s6(u.pendingProps,xn.current),(l=p=yt)&&(p=L9(p,u.pendingProps,ji),p!==null?(u.stateNode=p,Sn=u,yt=null,l=!0):l=!1),l||hr(u)),null;case 13:return qA(l,u,p);case 4:return Xt(u,u.stateNode.containerInfo),g=u.pendingProps,l===null?u.child=nl(u,null,g,p):bn(l,u,g,p),u.child;case 11:return jA(l,u,u.type,u.pendingProps,p);case 7:return bn(l,u,u.pendingProps,p),u.child;case 8:return bn(l,u,u.pendingProps.children,p),u.child;case 12:return bn(l,u,u.pendingProps.children,p),u.child;case 10:return g=u.pendingProps,vo(u,u.type,g.value),bn(l,u,g.children,p),u.child;case 9:return b=u.type._context,g=u.pendingProps.children,Ha(u),b=vn(b),g=g(b),u.flags|=1,bn(l,u,g,p),u.child;case 14:return UA(l,u,u.type,u.pendingProps,p);case 15:return zA(l,u,u.type,u.pendingProps,p);case 19:return $A(l,u,p);case 31:return vU(l,u,p);case 22:return VA(l,u,p,u.pendingProps);case 24:return Ha(u),g=vn(vt),l===null?(b=qv(),b===null&&(b=ot,w=Jv(),b.pooledCache=w,w.refCount++,w!==null&&(b.pooledCacheLanes|=p),b=w),u.memoizedState={parent:g,cache:b},$v(u),vo(u,vt,b)):(l.lanes&p&&(Xv(l,u),_d(u,null,null,p),Ed()),b=l.memoizedState,w=u.memoizedState,b.parent!==g?(b={parent:g,cache:g},u.memoizedState=b,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=b),vo(u,vt,g)):(g=w.cache,vo(u,vt,g),g!==b.cache&&Wv(u,[vt],p,!0))),bn(l,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(s(156,u.tag))}function is(l){l.flags|=4}function Np(l){Gs&&(l.flags|=8)}function YA(l,u){if(l!==null&&l.child===u.child)return!1;if(u.flags&16)return!0;for(l=u.child;l!==null;){if(l.flags&8218||l.subtreeFlags&8218)return!0;l=l.sibling}return!1}function A0(l,u,p,g){if(_n)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)Z0(l,p.stateNode);else if(!(p.tag===4||Yt&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(Gs)for(var b=u.child;b!==null;){if(b.tag===5){var w=b.stateNode;p&&g&&(w=r_(w,b.type,b.memoizedProps)),Z0(l,w)}else if(b.tag===6)w=b.stateNode,p&&g&&(w=o_(w,b.memoizedProps)),Z0(l,w);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)w=b.child,w!==null&&(w.return=b),A0(l,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===u)break;for(;b.sibling===null;){if(b.return===null||b.return===u)return;b=b.return}b.sibling.return=b.return,b=b.sibling}}function ZA(l,u,p,g){var b=!1;if(Gs)for(var w=u.child;w!==null;){if(w.tag===5){var M=w.stateNode;p&&g&&(M=r_(M,w.type,w.memoizedProps)),i_(l,M)}else if(w.tag===6)M=w.stateNode,p&&g&&(M=o_(M,w.memoizedProps)),i_(l,M);else if(w.tag!==4){if(w.tag===22&&w.memoizedState!==null)b=w.child,b!==null&&(b.return=w),ZA(l,w,!0,!0),b=!0;else if(w.child!==null){w.child.return=w,w=w.child;continue}}if(w===u)break;for(;w.sibling===null;){if(w.return===null||w.return===u)return b;w=w.return}w.sibling.return=w.return,w=w.sibling}return b}function eE(l,u){if(Gs&&YA(l,u)){l=u.stateNode;var p=l.containerInfo,g=n_();ZA(g,u,!1,!1),l.pendingChildren=g,is(u),A9(p,g)}}function E0(l,u,p,g){if(_n)l.memoizedProps!==g&&is(u);else if(Gs){var b=l.stateNode,w=l.memoizedProps;if((l=YA(l,u))||w!==g){var M=xn.current;w=T9(b,p,w,g,!l,null),w===b?u.stateNode=b:(Np(u),XE(w,p,g,M)&&is(u),u.stateNode=w,l&&A0(w,u,!1,!1))}else u.stateNode=b}}function _0(l,u,p,g,b){if(l.mode&32&&(p===null?YU(u,g):ZU(u,p,g))){if(l.flags|=16777216,(b&335544128)===b||eb(u,g))if(ZE(l.stateNode,u,g))l.flags|=8192;else if(AE())l.flags|=8192;else throw tl=nm,fb}else l.flags&=-16777217}function tE(l,u){if(l6(u)){if(l.flags|=16777216,!m_(u))if(AE())l.flags|=8192;else throw tl=nm,fb}else l.flags&=-16777217}function Fp(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?E():536870912,l.lanes|=u,Rc|=u)}function Id(l,u){if(!ze)switch(l.tailMode){case"hidden":u=l.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:g.sibling=null}}function dt(l){var u=l.alternate!==null&&l.alternate.child===l.child,p=0,g=0;if(u)for(var b=l.child;b!==null;)p|=b.lanes|b.childLanes,g|=b.subtreeFlags&65011712,g|=b.flags&65011712,b.return=l,b=b.sibling;else for(b=l.child;b!==null;)p|=b.lanes|b.childLanes,g|=b.subtreeFlags,g|=b.flags,b.return=l,b=b.sibling;return l.subtreeFlags|=g,l.childLanes=p,u}function xU(l,u,p){var g=u.pendingProps;switch(Dt(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(u),null;case 1:return dt(u),null;case 3:return p=u.stateNode,g=null,l!==null&&(g=l.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),fr(vt),an(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(l===null||l.child===null)&&(sc(u)?is(u):l===null||l.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,Hv())),eE(l,u),dt(u),null;case 26:if(os){var b=u.type,w=u.memoizedState;return l===null?(is(u),w!==null?(dt(u),tE(u,w)):(dt(u),_0(u,b,null,g,p))):w?w!==l.memoizedState?(is(u),dt(u),tE(u,w)):(dt(u),u.flags&=-16777217):(w=l.memoizedProps,_n?w!==g&&is(u):E0(l,u,b,g),dt(u),_0(u,b,w,g,p)),null}case 27:if(Yt){if(fp(u),p=_o.current,b=u.type,l!==null&&u.stateNode!=null)_n?l.memoizedProps!==g&&is(u):E0(l,u,b,g);else{if(!g){if(u.stateNode===null)throw Error(s(166));return dt(u),null}l=xn.current,sc(u)?B1(u,l):(l=g_(b,g,p,l,!0),u.stateNode=l,is(u))}return dt(u),null}case 5:if(fp(u),b=u.type,l!==null&&u.stateNode!=null)E0(l,u,b,g);else{if(!g){if(u.stateNode===null)throw Error(s(166));return dt(u),null}if(w=xn.current,sc(u))B1(u,w),X9(u.stateNode,b,g,w)&&(u.flags|=64);else{var M=GU(b,g,_o.current,w,u);Np(u),A0(M,u,!1,!1),u.stateNode=M,XE(M,b,g,w)&&is(u)}}return dt(u),_0(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,p),null;case 6:if(l&&u.stateNode!=null)p=l.memoizedProps,_n?p!==g&&is(u):Gs&&(p!==g?(l=_o.current,p=xn.current,Np(u),u.stateNode=YE(g,l,p,u)):u.stateNode=l.stateNode);else{if(typeof g!="string"&&u.stateNode===null)throw Error(s(166));if(l=_o.current,p=xn.current,sc(u)){if(!Mn)throw Error(s(176));if(l=u.stateNode,p=u.memoizedProps,g=null,b=Sn,b!==null)switch(b.tag){case 27:case 5:g=b.memoizedProps}V9(l,p,u,g)||hr(u,!0)}else Np(u),u.stateNode=YE(g,l,p,u)}return dt(u),null;case 31:if(p=u.memoizedState,l===null||l.memoizedState!==null){if(g=sc(u),p!==null){if(l===null){if(!g)throw Error(s(318));if(!Mn)throw Error(s(556));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(557));H9(l,u)}else Va(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;dt(u),l=!1}else p=Hv(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=p),l=!0;if(!l)return u.flags&256?(vi(u),u):(vi(u),null);if(u.flags&128)throw Error(s(558))}return dt(u),null;case 13:if(g=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(b=sc(u),g!==null&&g.dehydrated!==null){if(l===null){if(!b)throw Error(s(318));if(!Mn)throw Error(s(344));if(b=u.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(s(317));G9(b,u)}else Va(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;dt(u),b=!1}else b=Hv(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=b),b=!0;if(!b)return u.flags&256?(vi(u),u):(vi(u),null)}return vi(u),u.flags&128?(u.lanes=p,u):(p=g!==null,l=l!==null&&l.memoizedState!==null,p&&(g=u.child,b=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(b=g.alternate.memoizedState.cachePool.pool),w=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(w=g.memoizedState.cachePool.pool),w!==b&&(g.flags|=2048)),p!==l&&p&&(u.child.flags|=8192),Fp(u,u.updateQueue),dt(u),null);case 4:return an(),eE(l,u),l===null&&qU(u.stateNode.containerInfo),dt(u),null;case 10:return fr(u.type),dt(u),null;case 19:if(y(Ft),g=u.memoizedState,g===null)return dt(u),null;if(b=(u.flags&128)!==0,w=g.rendering,w===null)if(b)Id(g,!1);else{if(Et!==0||l!==null&&l.flags&128)for(l=u.child;l!==null;){if(w=wp(l),w!==null){for(u.flags|=128,Id(g,!1),l=w.updateQueue,u.updateQueue=l,Fp(u,l),u.subtreeFlags=0,l=p,p=u.child;p!==null;)UE(p,l),p=p.sibling;return v(Ft,Ft.current&1|2),ze&&te(u,g.treeForkCount),u.child}l=l.sibling}g.tail!==null&&ti()>$d&&(u.flags|=128,b=!0,Id(g,!1),u.lanes=4194304)}else{if(!b)if(l=wp(w),l!==null){if(u.flags|=128,b=!0,l=l.updateQueue,u.updateQueue=l,Fp(u,l),Id(g,!0),g.tail===null&&g.tailMode==="hidden"&&!w.alternate&&!ze)return dt(u),null}else 2*ti()-g.renderingStartTime>$d&&p!==536870912&&(u.flags|=128,b=!0,Id(g,!1),u.lanes=4194304);g.isBackwards?(w.sibling=u.child,u.child=w):(l=g.last,l!==null?l.sibling=w:u.child=w,g.last=w)}return g.tail!==null?(l=g.tail,g.rendering=l,g.tail=l.sibling,g.renderingStartTime=ti(),l.sibling=null,p=Ft.current,v(Ft,b?p&1|2:p&1),ze&&te(u,g.treeForkCount),l):(dt(u),null);case 22:case 23:return vi(u),e0(),g=u.memoizedState!==null,l!==null?l.memoizedState!==null!==g&&(u.flags|=8192):g&&(u.flags|=8192),g?p&536870912&&!(u.flags&128)&&(dt(u),u.subtreeFlags&6&&(u.flags|=8192)):dt(u),p=u.updateQueue,p!==null&&Fp(u,p.retryQueue),p=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==p&&(u.flags|=2048),l!==null&&y(el),null;case 24:return p=null,l!==null&&(p=l.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),fr(vt),dt(u),null;case 25:return null;case 30:return null}throw Error(s(156,u.tag))}function SU(l,u){switch(Dt(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return fr(vt),an(),l=u.flags,l&65536&&!(l&128)?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return fp(u),null;case 31:if(u.memoizedState!==null){if(vi(u),u.alternate===null)throw Error(s(340));Va()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(vi(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(s(340));Va()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return y(Ft),null;case 4:return an(),null;case 10:return fr(u.type),null;case 22:case 23:return vi(u),e0(),l!==null&&y(el),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return fr(vt),null;case 25:return null;default:return null}}function nE(l,u){switch(Dt(u),u.tag){case 3:fr(vt),an();break;case 26:case 27:case 5:fp(u);break;case 4:an();break;case 31:u.memoizedState!==null&&vi(u);break;case 13:vi(u);break;case 19:y(Ft);break;case 10:fr(u.type);break;case 22:case 23:vi(u),e0(),l!==null&&y(el);break;case 24:fr(vt)}}function Bd(l,u){try{var p=u.updateQueue,g=p!==null?p.lastEffect:null;if(g!==null){var b=g.next;p=b;do{if((p.tag&l)===l){g=void 0;var w=p.create,M=p.inst;g=w(),M.destroy=g}p=p.next}while(p!==b)}}catch(F){Je(u,u.return,F)}}function ko(l,u,p){try{var g=u.updateQueue,b=g!==null?g.lastEffect:null;if(b!==null){var w=b.next;g=w;do{if((g.tag&l)===l){var M=g.inst,F=M.destroy;if(F!==void 0){M.destroy=void 0,b=u;var J=p,Y=F;try{Y()}catch(ue){Je(b,J,ue)}}}g=g.next}while(g!==w)}}catch(ue){Je(u,u.return,ue)}}function iE(l){var u=l.updateQueue;if(u!==null){var p=l.stateNode;try{$1(u,p)}catch(g){Je(l,l.return,g)}}}function sE(l,u,p){p.props=Ja(l.type,l.memoizedProps),p.state=l.memoizedState;try{p.componentWillUnmount()}catch(g){Je(l,u,g)}}function Dd(l,u){try{var p=l.ref;if(p!==null){switch(l.tag){case 26:case 27:case 5:var g=Ld(l.stateNode);break;case 30:g=l.stateNode;break;default:g=l.stateNode}typeof p=="function"?l.refCleanup=p(g):p.current=g}}catch(b){Je(l,u,b)}}function Hs(l,u){var p=l.ref,g=l.refCleanup;if(p!==null)if(typeof g=="function")try{g()}catch(b){Je(l,u,b)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(b){Je(l,u,b)}else p.current=null}function rE(l){var u=l.type,p=l.memoizedProps,g=l.stateNode;try{p9(g,u,p,l)}catch(b){Je(l,l.return,b)}}function M0(l,u,p){try{m9(l.stateNode,l.type,p,u,l)}catch(g){Je(l,l.return,g)}}function oE(l){return l.tag===5||l.tag===3||(os?l.tag===26:!1)||(Yt?l.tag===27&&pc(l.type):!1)||l.tag===4}function R0(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||oE(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(Yt&&l.tag===27&&pc(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function P0(l,u,p){var g=l.tag;if(g===5||g===6)l=l.stateNode,u?y9(p,l,u):h9(p,l);else if(g!==4&&(Yt&&g===27&&pc(l.type)&&(p=l.stateNode,u=null),l=l.child,l!==null))for(P0(l,u,p),l=l.sibling;l!==null;)P0(l,u,p),l=l.sibling}function Op(l,u,p){var g=l.tag;if(g===5||g===6)l=l.stateNode,u?g9(p,l,u):d9(p,l);else if(g!==4&&(Yt&&g===27&&pc(l.type)&&(p=l.stateNode),l=l.child,l!==null))for(Op(l,u,p),l=l.sibling;l!==null;)Op(l,u,p),l=l.sibling}function aE(l,u,p){l=l.containerInfo;try{s_(l,p)}catch(g){Je(u,u.return,g)}}function lE(l){var u=l.stateNode,p=l.memoizedProps;try{u6(l.type,p,u,l)}catch(g){Je(l,l.return,g)}}function CU(l,u){for(VU(l.containerInfo),cn=u;cn!==null;)if(l=cn,u=l.child,(l.subtreeFlags&1028)!==0&&u!==null)u.return=l,cn=u;else for(;cn!==null;){l=cn;var p=l.alternate;switch(u=l.flags,l.tag){case 0:if(u&4&&(u=l.updateQueue,u=u!==null?u.events:null,u!==null))for(var g=0;g<u.length;g++){var b=u[g];b.ref.impl=b.nextImpl}break;case 11:case 15:break;case 1:if(u&1024&&p!==null){u=void 0,g=l,b=p.memoizedProps,p=p.memoizedState;var w=g.stateNode;try{var M=Ja(g.type,b);u=w.getSnapshotBeforeUpdate(M,p),w.__reactInternalSnapshotBeforeUpdate=u}catch(F){Je(g,g.return,F)}}break;case 3:u&1024&&_n&&w9(l.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(u&1024)throw Error(s(163))}if(u=l.sibling,u!==null){u.return=l.return,cn=u;break}cn=l.return}}function cE(l,u,p){var g=p.flags;switch(p.tag){case 0:case 11:case 15:gr(l,p),g&4&&Bd(5,p);break;case 1:if(gr(l,p),g&4)if(l=p.stateNode,u===null)try{l.componentDidMount()}catch(M){Je(p,p.return,M)}else{var b=Ja(p.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(b,u,l.__reactInternalSnapshotBeforeUpdate)}catch(M){Je(p,p.return,M)}}g&64&&iE(p),g&512&&Dd(p,p.return);break;case 3:if(gr(l,p),g&64&&(g=p.updateQueue,g!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=Ld(p.child.stateNode);break;case 1:l=p.child.stateNode}try{$1(g,l)}catch(M){Je(p,p.return,M)}}break;case 27:Yt&&u===null&&g&4&&lE(p);case 26:case 5:if(gr(l,p),u===null){if(g&4)rE(p);else if(g&64){l=p.type,u=p.memoizedProps,b=p.stateNode;try{K9(b,l,u,p)}catch(M){Je(p,p.return,M)}}}g&512&&Dd(p,p.return);break;case 12:gr(l,p);break;case 31:gr(l,p),g&4&&dE(l,p);break;case 13:gr(l,p),g&4&&hE(l,p),g&64&&(g=p.memoizedState,g!==null&&(g=g.dehydrated,g!==null&&(p=MU.bind(null,p),_9(g,p))));break;case 22:if(g=p.memoizedState!==null||kr,!g){u=u!==null&&u.memoizedState!==null||Ht,b=kr;var w=Ht;kr=g,(Ht=u)&&!w?yr(l,p,(p.subtreeFlags&8772)!==0):gr(l,p),kr=b,Ht=w}break;case 30:break;default:gr(l,p)}}function uE(l){var u=l.alternate;u!==null&&(l.alternate=null,uE(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&XU(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function ss(l,u,p){for(p=p.child;p!==null;)I0(l,u,p),p=p.sibling}function I0(l,u,p){if(Ci&&typeof Ci.onCommitFiberUnmount=="function")try{Ci.onCommitFiberUnmount(zd,p)}catch{}switch(p.tag){case 26:if(os){Ht||Hs(p,u),ss(l,u,p),p.memoizedState?h_(p.memoizedState):p.stateNode&&p_(p.stateNode);break}case 27:if(Yt){Ht||Hs(p,u);var g=Gt,b=ni;pc(p.type)&&(Gt=p.stateNode,ni=!1),ss(l,u,p),y_(p.stateNode),Gt=g,ni=b;break}case 5:Ht||Hs(p,u);case 6:if(_n){if(g=Gt,b=ni,Gt=null,ss(l,u,p),Gt=g,ni=b,Gt!==null)if(ni)try{b9(Gt,p.stateNode)}catch(w){Je(p,u,w)}else try{v9(Gt,p.stateNode)}catch(w){Je(p,u,w)}}else ss(l,u,p);break;case 18:_n&&Gt!==null&&(ni?e6(Gt,p.stateNode):Z9(Gt,p.stateNode));break;case 4:_n?(g=Gt,b=ni,Gt=p.stateNode.containerInfo,ni=!0,ss(l,u,p),Gt=g,ni=b):(Gs&&aE(p.stateNode,p,n_()),ss(l,u,p));break;case 0:case 11:case 14:case 15:ko(2,p,u),Ht||ko(4,p,u),ss(l,u,p);break;case 1:Ht||(Hs(p,u),g=p.stateNode,typeof g.componentWillUnmount=="function"&&sE(p,u,g)),ss(l,u,p);break;case 21:ss(l,u,p);break;case 22:Ht=(g=Ht)||p.memoizedState!==null,ss(l,u,p),Ht=g;break;default:ss(l,u,p)}}function dE(l,u){if(Mn&&u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{Q9(l)}catch(p){Je(u,u.return,p)}}}function hE(l,u){if(Mn&&u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{$9(l)}catch(p){Je(u,u.return,p)}}function kU(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new E_),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new E_),u;default:throw Error(s(435,l.tag))}}function Lp(l,u){var p=kU(l);u.forEach(function(g){if(!p.has(g)){p.add(g);var b=RU.bind(null,l,g);g.then(b,b)}})}function En(l,u){var p=u.deletions;if(p!==null)for(var g=0;g<p.length;g++){var b=p[g],w=l,M=u;if(_n){var F=M;e:for(;F!==null;){switch(F.tag){case 27:if(Yt){if(pc(F.type)){Gt=F.stateNode,ni=!1;break e}break}case 5:Gt=F.stateNode,ni=!1;break e;case 3:case 4:Gt=F.stateNode.containerInfo,ni=!0;break e}F=F.return}if(Gt===null)throw Error(s(160));I0(w,M,b),Gt=null,ni=!1}else I0(w,M,b);w=b.alternate,w!==null&&(w.return=null),b.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)fE(u,l),u=u.sibling}function fE(l,u){var p=l.alternate,g=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:En(u,l),jn(l),g&4&&(ko(3,l,l.return),Bd(3,l),ko(5,l,l.return));break;case 1:En(u,l),jn(l),g&512&&(Ht||p===null||Hs(p,p.return)),g&64&&kr&&(l=l.updateQueue,l!==null&&(g=l.callbacks,g!==null&&(p=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=p===null?g:p.concat(g))));break;case 26:if(os){var b=ls;if(En(u,l),jn(l),g&512&&(Ht||p===null||Hs(p,p.return)),g&4){g=p!==null?p.memoizedState:null;var w=l.memoizedState;p===null?w===null?l.stateNode===null?l.stateNode=r6(b,l.type,l.memoizedProps,l):f_(b,l.type,l.stateNode):l.stateNode=d_(b,w,l.memoizedProps):g!==w?(g===null?p.stateNode!==null&&p_(p.stateNode):h_(g),w===null?f_(b,l.type,l.stateNode):d_(b,w,l.memoizedProps)):w===null&&l.stateNode!==null&&M0(l,l.memoizedProps,p.memoizedProps)}break}case 27:if(Yt){En(u,l),jn(l),g&512&&(Ht||p===null||Hs(p,p.return)),p!==null&&g&4&&M0(l,l.memoizedProps,p.memoizedProps);break}case 5:if(En(u,l),jn(l),g&512&&(Ht||p===null||Hs(p,p.return)),_n){if(l.flags&32){b=l.stateNode;try{t_(b)}catch(se){Je(l,l.return,se)}}g&4&&l.stateNode!=null&&(b=l.memoizedProps,M0(l,b,p!==null?p.memoizedProps:b)),g&1024&&(xb=!0)}else Gs&&l.alternate!==null&&(l.alternate.stateNode=l.stateNode);break;case 6:if(En(u,l),jn(l),g&4&&_n){if(l.stateNode===null)throw Error(s(162));g=l.memoizedProps,p=p!==null?p.memoizedProps:g,b=l.stateNode;try{f9(b,p,g)}catch(se){Je(l,l.return,se)}}break;case 3:if(os?(a6(),b=ls,ls=ib(u.containerInfo),En(u,l),ls=b):En(u,l),jn(l),g&4){if(_n&&Mn&&p!==null&&p.memoizedState.isDehydrated)try{q9(u.containerInfo)}catch(se){Je(l,l.return,se)}if(Gs){g=u.containerInfo,p=u.pendingChildren;try{s_(g,p)}catch(se){Je(l,l.return,se)}}}xb&&(xb=!1,pE(l));break;case 4:os?(p=ls,ls=ib(l.stateNode.containerInfo),En(u,l),jn(l),ls=p):(En(u,l),jn(l)),g&4&&Gs&&aE(l.stateNode,l,l.stateNode.pendingChildren);break;case 12:En(u,l),jn(l);break;case 31:En(u,l),jn(l),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Lp(l,g)));break;case 13:En(u,l),jn(l),l.child.flags&8192&&l.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(dm=ti()),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Lp(l,g)));break;case 22:b=l.memoizedState!==null;var M=p!==null&&p.memoizedState!==null,F=kr,J=Ht;if(kr=F||b,Ht=J||M,En(u,l),Ht=J,kr=F,jn(l),g&8192&&(u=l.stateNode,u._visibility=b?u._visibility&-2:u._visibility|1,b&&(p===null||M||kr||Ht||Ka(l)),_n)){e:if(p=null,_n)for(u=l;;){if(u.tag===5||os&&u.tag===26){if(p===null){M=p=u;try{w=M.stateNode,b?x9(w):C9(M.stateNode,M.memoizedProps)}catch(se){Je(M,M.return,se)}}}else if(u.tag===6){if(p===null){M=u;try{var Y=M.stateNode;b?S9(Y):k9(Y,M.memoizedProps)}catch(se){Je(M,M.return,se)}}}else if(u.tag===18){if(p===null){M=u;try{var ue=M.stateNode;b?t6(ue):n6(M.stateNode)}catch(se){Je(M,M.return,se)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}g&4&&(g=l.updateQueue,g!==null&&(p=g.retryQueue,p!==null&&(g.retryQueue=null,Lp(l,p))));break;case 19:En(u,l),jn(l),g&4&&(g=l.updateQueue,g!==null&&(l.updateQueue=null,Lp(l,g)));break;case 30:break;case 21:break;default:En(u,l),jn(l)}}function jn(l){var u=l.flags;if(u&2){try{for(var p,g=l.return;g!==null;){if(oE(g)){p=g;break}g=g.return}if(_n){if(p==null)throw Error(s(160));switch(p.tag){case 27:if(Yt){var b=p.stateNode,w=R0(l);Op(l,w,b);break}case 5:var M=p.stateNode;p.flags&32&&(t_(M),p.flags&=-33);var F=R0(l);Op(l,F,M);break;case 3:case 4:var J=p.stateNode.containerInfo,Y=R0(l);P0(l,Y,J);break;default:throw Error(s(161))}}}catch(ue){Je(l,l.return,ue)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function pE(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;pE(u),u.tag===5&&u.flags&1024&&n9(u.stateNode),l=l.sibling}}function gr(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)cE(l,u.alternate,u),u=u.sibling}function Ka(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:ko(4,u,u.return),Ka(u);break;case 1:Hs(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&sE(u,u.return,p),Ka(u);break;case 27:Yt&&y_(u.stateNode);case 26:case 5:Hs(u,u.return),Ka(u);break;case 22:u.memoizedState===null&&Ka(u);break;case 30:Ka(u);break;default:Ka(u)}l=l.sibling}}function yr(l,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var g=u.alternate,b=l,w=u,M=w.flags;switch(w.tag){case 0:case 11:case 15:yr(b,w,p),Bd(4,w);break;case 1:if(yr(b,w,p),g=w,b=g.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Y){Je(g,g.return,Y)}if(g=w,b=g.updateQueue,b!==null){var F=g.stateNode;try{var J=b.shared.hiddenCallbacks;if(J!==null)for(b.shared.hiddenCallbacks=null,b=0;b<J.length;b++)Q1(J[b],F)}catch(Y){Je(g,g.return,Y)}}p&&M&64&&iE(w),Dd(w,w.return);break;case 27:Yt&&lE(w);case 26:case 5:yr(b,w,p),p&&g===null&&M&4&&rE(w),Dd(w,w.return);break;case 12:yr(b,w,p);break;case 31:yr(b,w,p),p&&M&4&&dE(b,w);break;case 13:yr(b,w,p),p&&M&4&&hE(b,w);break;case 22:w.memoizedState===null&&yr(b,w,p),Dd(w,w.return);break;case 30:break;default:yr(b,w,p)}u=u.sibling}}function B0(l,u){var p=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==p&&(l!=null&&l.refCount++,p!=null&&wd(p))}function D0(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&wd(l))}function rs(l,u,p,g){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)mE(l,u,p,g),u=u.sibling}function mE(l,u,p,g){var b=u.flags;switch(u.tag){case 0:case 11:case 15:rs(l,u,p,g),b&2048&&Bd(9,u);break;case 1:rs(l,u,p,g);break;case 3:rs(l,u,p,g),b&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&wd(l)));break;case 12:if(b&2048){rs(l,u,p,g),l=u.stateNode;try{var w=u.memoizedProps,M=w.id,F=w.onPostCommit;typeof F=="function"&&F(M,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(J){Je(u,u.return,J)}}else rs(l,u,p,g);break;case 31:rs(l,u,p,g);break;case 13:rs(l,u,p,g);break;case 23:break;case 22:w=u.stateNode,M=u.alternate,u.memoizedState!==null?w._visibility&2?rs(l,u,p,g):Nd(l,u):w._visibility&2?rs(l,u,p,g):(w._visibility|=2,lc(l,u,p,g,(u.subtreeFlags&10256)!==0||!1)),b&2048&&B0(M,u);break;case 24:rs(l,u,p,g),b&2048&&D0(u.alternate,u);break;default:rs(l,u,p,g)}}function lc(l,u,p,g,b){for(b=b&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var w=l,M=u,F=p,J=g,Y=M.flags;switch(M.tag){case 0:case 11:case 15:lc(w,M,F,J,b),Bd(8,M);break;case 23:break;case 22:var ue=M.stateNode;M.memoizedState!==null?ue._visibility&2?lc(w,M,F,J,b):Nd(w,M):(ue._visibility|=2,lc(w,M,F,J,b)),b&&Y&2048&&B0(M.alternate,M);break;case 24:lc(w,M,F,J,b),b&&Y&2048&&D0(M.alternate,M);break;default:lc(w,M,F,J,b)}u=u.sibling}}function Nd(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=l,g=u,b=g.flags;switch(g.tag){case 22:Nd(p,g),b&2048&&B0(g.alternate,g);break;case 24:Nd(p,g),b&2048&&D0(g.alternate,g);break;default:Nd(p,g)}u=u.sibling}}function qa(l,u,p){if(l.subtreeFlags&_c)for(l=l.child;l!==null;)gE(l,u,p),l=l.sibling}function gE(l,u,p){switch(l.tag){case 26:if(qa(l,u,p),l.flags&_c)if(l.memoizedState!==null)c6(p,ls,l.memoizedState,l.memoizedProps);else{var g=l.stateNode,b=l.type;l=l.memoizedProps,((u&335544128)===u||eb(b,l))&&e_(p,g,b,l)}break;case 5:qa(l,u,p),l.flags&_c&&(g=l.stateNode,b=l.type,l=l.memoizedProps,((u&335544128)===u||eb(b,l))&&e_(p,g,b,l));break;case 3:case 4:os?(g=ls,ls=ib(l.stateNode.containerInfo),qa(l,u,p),ls=g):qa(l,u,p);break;case 22:l.memoizedState===null&&(g=l.alternate,g!==null&&g.memoizedState!==null?(g=_c,_c=16777216,qa(l,u,p),_c=g):qa(l,u,p));break;default:qa(l,u,p)}}function yE(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function Fd(l){var u=l.deletions;if(l.flags&16){if(u!==null)for(var p=0;p<u.length;p++){var g=u[p];cn=g,bE(g,l)}yE(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)vE(l),l=l.sibling}function vE(l){switch(l.tag){case 0:case 11:case 15:Fd(l),l.flags&2048&&ko(9,l,l.return);break;case 3:Fd(l);break;case 12:Fd(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,jp(l)):Fd(l);break;default:Fd(l)}}function jp(l){var u=l.deletions;if(l.flags&16){if(u!==null)for(var p=0;p<u.length;p++){var g=u[p];cn=g,bE(g,l)}yE(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:ko(8,u,u.return),jp(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,jp(u));break;default:jp(u)}l=l.sibling}}function bE(l,u){for(;cn!==null;){var p=cn;switch(p.tag){case 0:case 11:case 15:ko(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var g=p.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:wd(p.memoizedState.cache)}if(g=p.child,g!==null)g.return=p,cn=g;else e:for(p=l;cn!==null;){g=cn;var b=g.sibling,w=g.return;if(uE(g),g===p){cn=null;break e}if(b!==null){b.return=w,cn=b;break e}cn=w}}}function N0(l){var u=KU(l);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(s(364));return u}if(l=r9(l),l===null)throw Error(s(362));return l.stateNode.current}function F0(l,u){var p=l.tag;switch(u.$$typeof){case om:if(l.type===u.value)return!0;break;case am:e:{for(u=u.value,l=[l,0],p=0;p<l.length;){var g=l[p++],b=g.tag,w=l[p++],M=u[w];if(b!==5&&b!==26&&b!==27||!Ud(g)){for(;M!=null&&F0(g,M);)w++,M=u[w];if(w===u.length){u=!0;break e}else for(g=g.child;g!==null;)l.push(g,w),g=g.sibling}}u=!1}return u;case lm:if((p===5||p===26||p===27)&&l9(l.stateNode,u.value))return!0;break;case um:if((p===5||p===6||p===26||p===27)&&(l=a9(l),l!==null&&0<=l.indexOf(u.value)))return!0;break;case cm:if((p===5||p===26||p===27)&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function O0(l){switch(l.$$typeof){case om:return"<"+(f(l.value)||"Unknown")+">";case am:return":has("+(O0(l)||"")+")";case lm:return'[role="'+l.value+'"]';case um:return'"'+l.value+'"';case cm:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function xE(l,u){var p=[];l=[l,0];for(var g=0;g<l.length;){var b=l[g++],w=b.tag,M=l[g++],F=u[M];if(w!==5&&w!==26&&w!==27||!Ud(b)){for(;F!=null&&F0(b,F);)M++,F=u[M];if(M===u.length)p.push(b);else for(b=b.child;b!==null;)l.push(b,M),b=b.sibling}}return p}function L0(l,u){if(!jd)throw Error(s(363));l=N0(l),l=xE(l,u),u=[],l=Array.from(l);for(var p=0;p<l.length;){var g=l[p++],b=g.tag;if(b===5||b===26||b===27)Ud(g)||u.push(g.stateNode);else for(g=g.child;g!==null;)l.push(g),g=g.sibling}return u}function bi(){return Be&2&&Ue!==0?Ue&-Ue:be.T!==null?Kv():QU()}function SE(){if(Ai===0)if(!(Ue&536870912)||ze){var l=Kp;Kp<<=1,!(Kp&3932160)&&(Kp=262144),Ai=l}else Ai=536870912;return l=wi.current,l!==null&&(l.flags|=32),Ai}function ei(l,u,p){(l===ot&&(Ze===2||Ze===9)||l.cancelPendingCommit!==null)&&(cc(l,0),wo(l,Ue,Ai,!1)),R(l,p),(!(Be&2)||l!==ot)&&(l===ot&&(!(Be&2)&&(sl|=p),Et===4&&wo(l,Ue,Ai,!1)),Vs(l))}function CE(l,u,p){if(Be&6)throw Error(s(327));var g=!p&&(u&127)===0&&(u&l.expiredLanes)===0||A(l,u),b=g?AU(l,u):U0(l,u,!0),w=g;do{if(b===0){Mc&&!g&&wo(l,u,0,!1);break}else{if(p=l.current.alternate,w&&!wU(p)){b=U0(l,u,!1),w=!1;continue}if(b===2){if(w=u,l.errorRecoveryDisabledLanes&w)var M=0;else M=l.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){u=M;e:{var F=l;b=Qd;var J=Mn&&F.current.memoizedState.isDehydrated;if(J&&(cc(F,M).flags|=256),M=U0(F,M,!1),M!==2){if(Sb&&!J){F.errorRecoveryDisabledLanes|=w,sl|=w,b=4;break e}w=ii,ii=b,w!==null&&(ii===null?ii=w:ii.push.apply(ii,w))}b=M}if(w=!1,b!==2)continue}}if(b===1){cc(l,0),wo(l,u,0,!0);break}e:{switch(g=l,w=b,w){case 0:case 1:throw Error(s(345));case 4:if((u&4194048)!==u)break;case 6:wo(g,u,Ai,!Po);break e;case 2:ii=null;break;case 3:case 5:break;default:throw Error(s(329))}if((u&62914560)===u&&(b=dm+300-ti(),10<b)){if(wo(g,u,Ai,!Po),C(g,0,!0)!==0)break e;Tr=u,g.timeoutHandle=WU(kE.bind(null,g,p,ii,hm,kb,u,Ai,sl,Rc,Po,w,"Throttled",-0,0),b);break e}kE(g,p,ii,hm,kb,u,Ai,sl,Rc,Po,w,null,-0,0)}}break}while(!0);Vs(l)}function kE(l,u,p,g,b,w,M,F,J,Y,ue,se,pe,we){if(l.timeoutHandle=$a,se=u.subtreeFlags,se&8192||(se&16785408)===16785408){se=e9(),gE(u,w,se);var Wt=(w&62914560)===w?dm-ti():(w&4194048)===w?__-ti():0;if(Wt=t9(se,Wt),Wt!==null){Tr=w,l.cancelPendingCommit=Wt(IE.bind(null,l,u,w,p,g,b,M,F,J,ue,se,null,pe,we)),wo(l,w,M,!Y);return}}IE(l,u,w,p,g,b,M,F,J)}function wU(l){for(var u=l;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var g=0;g<p.length;g++){var b=p[g],w=b.getSnapshot;b=b.value;try{if(!ki(w(),b))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function wo(l,u,p,g){u&=~Cb,u&=~sl,l.suspendedLanes|=u,l.pingedLanes&=~u,g&&(l.warmLanes|=u),g=l.expirationTimes;for(var b=u;0<b;){var w=31-Si(b),M=1<<w;g[w]=-1,b&=~M}p!==0&&I(l,p,u)}function wE(){return Be&6?!0:(oc(0),!1)}function j0(){if(De!==null){if(Ze===0)var l=De.return;else l=De,Sr=Ya=null,o0(l),kc=null,Wd=0,l=De;for(;l!==null;)nE(l.alternate,l),l=l.return;De=null}}function cc(l,u){var p=l.timeoutHandle;p!==$a&&(l.timeoutHandle=$a,JU(p)),p=l.cancelPendingCommit,p!==null&&(l.cancelPendingCommit=null,p()),Tr=0,j0(),ot=l,De=p=vr(l.current,null),Ue=u,Ze=0,Ti=null,Po=!1,Mc=A(l,u),Sb=!1,Rc=Ai=Cb=sl=Io=Et=0,ii=Qd=null,kb=!1,u&8&&(u|=u&32);var g=l.entangledLanes;if(g!==0)for(l=l.entanglements,g&=u;0<g;){var b=31-Si(g),w=1<<b;u|=l[b],g&=~w}return wr=u,Sp(),p}function TE(l,u){Te=null,be.H=Kd,u===Cc||u===tm?(u=W1(),Ze=3):u===fb?(u=W1(),Ze=4):Ze=u===vb?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ti=u,De===null&&(Et=1,Pp(l,X(u,l.current)))}function AE(){var l=wi.current;return l===null?!0:(Ue&4194048)===Ue?as===null:(Ue&62914560)===Ue||Ue&536870912?l===as:!1}function EE(){var l=be.H;return be.H=Kd,l===null?Kd:l}function _E(){var l=be.A;return be.A=w6,l}function Up(){Et=4,Po||(Ue&4194048)!==Ue&&wi.current!==null||(Mc=!0),!(Io&134217727)&&!(sl&134217727)||ot===null||wo(ot,Ue,Ai,!1)}function U0(l,u,p){var g=Be;Be|=2;var b=EE(),w=_E();(ot!==l||Ue!==u)&&(hm=null,cc(l,u)),u=!1;var M=Et;e:do try{if(Ze!==0&&De!==null){var F=De,J=Ti;switch(Ze){case 8:j0(),M=6;break e;case 3:case 2:case 9:case 6:wi.current===null&&(u=!0);var Y=Ze;if(Ze=0,Ti=null,uc(l,F,J,Y),p&&Mc){M=0;break e}break;default:Y=Ze,Ze=0,Ti=null,uc(l,F,J,Y)}}TU(),M=Et;break}catch(ue){TE(l,ue)}while(!0);return u&&l.shellSuspendCounter++,Sr=Ya=null,Be=g,be.H=b,be.A=w,De===null&&(ot=null,Ue=0,Sp()),M}function TU(){for(;De!==null;)ME(De)}function AU(l,u){var p=Be;Be|=2;var g=EE(),b=_E();ot!==l||Ue!==u?(hm=null,$d=ti()+500,cc(l,u)):Mc=A(l,u);e:do try{if(Ze!==0&&De!==null){u=De;var w=Ti;t:switch(Ze){case 1:Ze=0,Ti=null,uc(l,u,w,1);break;case 2:case 9:if(H1(w)){Ze=0,Ti=null,RE(u);break}u=function(){Ze!==2&&Ze!==9||ot!==l||(Ze=7),Vs(l)},w.then(u,u);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:H1(w)?(Ze=0,Ti=null,RE(u)):(Ze=0,Ti=null,uc(l,u,w,7));break;case 5:var M=null;switch(De.tag){case 26:M=De.memoizedState;case 5:case 27:var F=De,J=F.type,Y=F.pendingProps;if(M?m_(M):ZE(F.stateNode,J,Y)){Ze=0,Ti=null;var ue=F.sibling;if(ue!==null)De=ue;else{var se=F.return;se!==null?(De=se,zp(se)):De=null}break t}}Ze=0,Ti=null,uc(l,u,w,5);break;case 6:Ze=0,Ti=null,uc(l,u,w,6);break;case 8:j0(),Et=6;break e;default:throw Error(s(462))}}EU();break}catch(pe){TE(l,pe)}while(!0);return Sr=Ya=null,be.H=g,be.A=b,Be=p,De!==null?0:(ot=null,Ue=0,Sp(),Et)}function EU(){for(;De!==null&&!f6();)ME(De)}function ME(l){var u=XA(l.alternate,l,wr);l.memoizedProps=l.pendingProps,u===null?zp(l):De=u}function RE(l){var u=l,p=u.alternate;switch(u.tag){case 15:case 0:u=WA(p,u,u.pendingProps,u.type,void 0,Ue);break;case 11:u=WA(p,u,u.pendingProps,u.type.render,u.ref,Ue);break;case 5:o0(u);default:nE(p,u),u=De=UE(u,wr),u=XA(p,u,wr)}l.memoizedProps=l.pendingProps,u===null?zp(l):De=u}function uc(l,u,p,g){Sr=Ya=null,o0(u),kc=null,Wd=0;var b=u.return;try{if(yU(l,b,u,p,Ue)){Et=1,Pp(l,X(p,l.current)),De=null;return}}catch(w){if(b!==null)throw De=b,w;Et=1,Pp(l,X(p,l.current)),De=null;return}u.flags&32768?(ze||g===1?l=!0:Mc||Ue&536870912?l=!1:(Po=l=!0,(g===2||g===9||g===3||g===6)&&(g=wi.current,g!==null&&g.tag===13&&(g.flags|=16384))),PE(u,l)):zp(u)}function zp(l){var u=l;do{if(u.flags&32768){PE(u,Po);return}l=u.return;var p=xU(u.alternate,u,wr);if(p!==null){De=p;return}if(u=u.sibling,u!==null){De=u;return}De=u=l}while(u!==null);Et===0&&(Et=5)}function PE(l,u){do{var p=SU(l.alternate,l);if(p!==null){p.flags&=32767,De=p;return}if(p=l.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(l=l.sibling,l!==null)){De=l;return}De=l=p}while(l!==null);Et=6,De=null}function IE(l,u,p,g,b,w,M,F,J){l.cancelPendingCommit=null;do Od();while(Zt!==0);if(Be&6)throw Error(s(327));if(u!==null){if(u===l.current)throw Error(s(177));if(w=u.lanes|u.childLanes,w|=pb,B(l,p,w,M,F,J),l===ot&&(De=ot=null,Ue=0),Pc=u,Do=l,Tr=p,wb=w,Tb=b,M_=g,u.subtreeFlags&10256||u.flags&10256?(l.callbackNode=null,l.callbackPriority=0,PU(ob,function(){return OE(),null})):(l.callbackNode=null,l.callbackPriority=0),g=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||g){g=be.T,be.T=null,b=xr(),ln(2),M=Be,Be|=4;try{CU(l,u,p)}finally{Be=M,ln(b),be.T=g}}Zt=1,BE(),DE(),NE()}}function BE(){if(Zt===1){Zt=0;var l=Do,u=Pc,p=(u.flags&13878)!==0;if(u.subtreeFlags&13878||p){p=be.T,be.T=null;var g=xr();ln(2);var b=Be;Be|=4;try{fE(u,l),HU(l.containerInfo)}finally{Be=b,ln(g),be.T=p}}l.current=u,Zt=2}}function DE(){if(Zt===2){Zt=0;var l=Do,u=Pc,p=(u.flags&8772)!==0;if(u.subtreeFlags&8772||p){p=be.T,be.T=null;var g=xr();ln(2);var b=Be;Be|=4;try{cE(l,u.alternate,u)}finally{Be=b,ln(g),be.T=p}}Zt=3}}function NE(){if(Zt===4||Zt===3){Zt=0,p6();var l=Do,u=Pc,p=Tr,g=M_;u.subtreeFlags&10256||u.flags&10256?Zt=5:(Zt=0,Pc=Do=null,FE(l,l.pendingLanes));var b=l.pendingLanes;if(b===0&&(Bo=null),ie(p),u=u.stateNode,Ci&&typeof Ci.onCommitFiberRoot=="function")try{Ci.onCommitFiberRoot(zd,u,void 0,(u.current.flags&128)===128)}catch{}if(g!==null){u=be.T,b=xr(),ln(2),be.T=null;try{for(var w=l.onRecoverableError,M=0;M<g.length;M++){var F=g[M];w(F.value,{componentStack:F.stack})}}finally{be.T=u,ln(b)}}Tr&3&&Od(),Vs(l),b=l.pendingLanes,p&261930&&b&42?l===Ab?Xd++:(Xd=0,Ab=l):Xd=0,Mn&&Y9(),oc(0)}}function FE(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,wd(u)))}function Od(){return BE(),DE(),NE(),OE()}function OE(){if(Zt!==5)return!1;var l=Do,u=wb;wb=0;var p=ie(Tr),g=32>p?32:p;p=be.T;var b=xr();try{ln(g),be.T=null,g=Tb,Tb=null;var w=Do,M=Tr;if(Zt=0,Pc=Do=null,Tr=0,(Be&6)!==0)throw Error(s(331));var F=Be;if(Be|=4,vE(w.current),mE(w,w.current,M,g),Be=F,oc(0,!1),Ci&&typeof Ci.onPostCommitFiberRoot=="function")try{Ci.onPostCommitFiberRoot(zd,w)}catch{}return!0}finally{ln(b),be.T=p,FE(l,u)}}function LE(l,u,p){u=X(p,u),u=v0(l.stateNode,u,2),l=xo(l,u,2),l!==null&&(R(l,2),Vs(l))}function Je(l,u,p){if(l.tag===3)LE(l,l,p);else for(;u!==null;){if(u.tag===3){LE(u,l,p);break}else if(u.tag===1){var g=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Bo===null||!Bo.has(g))){l=X(p,l),p=OA(2),g=xo(u,p,2),g!==null&&(LA(p,g,u,l),R(g,2),Vs(g));break}}u=u.return}}function z0(l,u,p){var g=l.pingCache;if(g===null){g=l.pingCache=new T6;var b=new Set;g.set(u,b)}else b=g.get(u),b===void 0&&(b=new Set,g.set(u,b));b.has(p)||(Sb=!0,b.add(p),l=_U.bind(null,l,u,p),u.then(l,l))}function _U(l,u,p){var g=l.pingCache;g!==null&&g.delete(u),l.pingedLanes|=l.suspendedLanes&p,l.warmLanes&=~p,ot===l&&(Ue&p)===p&&(Et===4||Et===3&&(Ue&62914560)===Ue&&300>ti()-dm?!(Be&2)&&cc(l,0):Cb|=p,Rc===Ue&&(Rc=0)),Vs(l)}function jE(l,u){u===0&&(u=E()),l=Wa(l,u),l!==null&&(R(l,u),Vs(l))}function MU(l){var u=l.memoizedState,p=0;u!==null&&(p=u.retryLane),jE(l,p)}function RU(l,u){var p=0;switch(l.tag){case 31:case 13:var g=l.stateNode,b=l.memoizedState;b!==null&&(p=b.retryLane);break;case 19:g=l.stateNode;break;case 22:g=l.stateNode._retryCache;break;default:throw Error(s(314))}g!==null&&g.delete(u),jE(l,p)}function PU(l,u){return Qp(l,u)}function IU(l,u,p,g){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function V0(l){return l=l.prototype,!(!l||!l.isReactComponent)}function vr(l,u){var p=l.alternate;return p===null?(p=t(l.tag,u,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=u,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&65011712,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,u=l.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p.refCleanup=l.refCleanup,p}function UE(l,u){l.flags&=65011714;var p=l.alternate;return p===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=p.childLanes,l.lanes=p.lanes,l.child=p.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=p.memoizedProps,l.memoizedState=p.memoizedState,l.updateQueue=p.updateQueue,l.type=p.type,u=p.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function Vp(l,u,p,g,b,w){var M=0;if(g=l,typeof l=="function")V0(l)&&(M=1);else if(typeof l=="string")M=os&&Yt?c_(l,p,xn.current)?26:v_(l)?27:5:os?c_(l,p,xn.current)?26:5:Yt&&v_(l)?27:5;else e:switch(l){case Y0:return l=t(31,p,u,b),l.elementType=Y0,l.lanes=w,l;case hc:return Qa(p.children,b,w,u);case KE:M=8,b|=24;break;case K0:return l=t(12,p,u,b|2),l.elementType=K0,l.lanes=w,l;case Q0:return l=t(13,p,u,b),l.elementType=Q0,l.lanes=w,l;case $0:return l=t(19,p,u,b),l.elementType=$0,l.lanes=w,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case To:M=10;break e;case qE:M=9;break e;case q0:M=11;break e;case X0:M=14;break e;case Ao:M=16,g=null;break e}M=29,p=Error(s(130,l===null?"null":typeof l,"")),g=null}return u=t(M,p,u,b),u.elementType=l,u.type=g,u.lanes=w,u}function Qa(l,u,p,g){return l=t(7,l,g,u),l.lanes=p,l}function H0(l,u,p){return l=t(6,l,null,u),l.lanes=p,l}function zE(l){var u=t(18,null,null,0);return u.stateNode=l,u}function G0(l,u,p){return u=t(4,l.children!==null?l.children:[],l.key,u),u.lanes=p,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function BU(l,u,p,g,b,w,M,F,J){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=$a,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_(0),this.hiddenUpdates=_(null),this.identifierPrefix=g,this.onUncaughtError=b,this.onCaughtError=w,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function VE(l,u,p,g,b,w,M,F,J,Y,ue,se){return l=new BU(l,u,p,M,J,Y,ue,se,F),u=1,w===!0&&(u|=24),w=t(3,null,null,u),l.current=w,w.stateNode=l,u=Jv(),u.refCount++,l.pooledCache=u,u.refCount++,w.memoizedState={element:g,isDehydrated:p,cache:u},$v(w),l}function HE(l){return l?(l=gc,l):gc}function GE(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=a(u),l=l!==null?c(l):null,l===null?null:Ld(l.stateNode)}function WE(l,u,p,g,b,w){b=HE(b),g.context===null?g.context=b:g.pendingContext=b,g=bo(u),g.payload={element:p},w=w===void 0?null:w,w!==null&&(g.callback=w),p=xo(l,g,u),p!==null&&(ei(p,l,u),Ad(p,l,u))}function JE(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<u?p:u}}function W0(l,u){JE(l,u),(l=l.alternate)&&JE(l,u)}var Ie={},DU=OD,xi=Nte,J0=Object.assign,NU=Symbol.for("react.element"),Hp=Symbol.for("react.transitional.element"),dc=Symbol.for("react.portal"),hc=Symbol.for("react.fragment"),KE=Symbol.for("react.strict_mode"),K0=Symbol.for("react.profiler"),qE=Symbol.for("react.consumer"),To=Symbol.for("react.context"),q0=Symbol.for("react.forward_ref"),Q0=Symbol.for("react.suspense"),$0=Symbol.for("react.suspense_list"),X0=Symbol.for("react.memo"),Ao=Symbol.for("react.lazy"),Y0=Symbol.for("react.activity"),FU=Symbol.for("react.memo_cache_sentinel"),QE=Symbol.iterator,OU=Symbol.for("react.client.reference"),Gp=Array.isArray,be=DU.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,LU=e.rendererVersion,jU=e.rendererPackageName,$E=e.extraDevToolsConfig,Ld=e.getPublicInstance,UU=e.getRootHostContext,zU=e.getChildHostContext,VU=e.prepareForCommit,HU=e.resetAfterCommit,GU=e.createInstance;e.cloneMutableInstance;var Z0=e.appendInitialChild,XE=e.finalizeInitialChildren,Wp=e.shouldSetTextContent,YE=e.createTextInstance;e.cloneMutableTextInstance;var WU=e.scheduleTimeout,JU=e.cancelTimeout,$a=e.noTimeout,br=e.isPrimaryRenderer;e.warnsIfNotActing;var _n=e.supportsMutation,Gs=e.supportsPersistence,Mn=e.supportsHydration,KU=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var qU=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var ln=e.setCurrentUpdatePriority,xr=e.getCurrentUpdatePriority,QU=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var $U=e.shouldAttemptEagerTransition,XU=e.detachDeletedInstance;e.requestPostPaintCallback;var YU=e.maySuspendCommit,ZU=e.maySuspendCommitOnUpdate,eb=e.maySuspendCommitInSyncRender,ZE=e.preloadInstance,e9=e.startSuspendingCommit,e_=e.suspendInstance;e.suspendOnActiveViewTransition;var t9=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var fc=e.NotPendingTransition,Xa=e.HostTransitionContext,n9=e.resetFormInstance;e.bindToConsole;var i9=e.supportsMicrotasks,s9=e.scheduleMicrotask,jd=e.supportsTestSelectors,r9=e.findFiberRoot,o9=e.getBoundingRect,a9=e.getTextContent,Ud=e.isHiddenSubtree,l9=e.matchAccessibilityRole,c9=e.setFocusIfFocusable,u9=e.setupIntersectionObserver,d9=e.appendChild,h9=e.appendChildToContainer,f9=e.commitTextUpdate,p9=e.commitMount,m9=e.commitUpdate,g9=e.insertBefore,y9=e.insertInContainerBefore,v9=e.removeChild,b9=e.removeChildFromContainer,t_=e.resetTextContent,x9=e.hideInstance,S9=e.hideTextInstance,C9=e.unhideInstance,k9=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var w9=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var T9=e.cloneInstance,n_=e.createContainerChildSet,i_=e.appendChildToContainerChildSet,A9=e.finalizeContainerChildren,s_=e.replaceContainerChildren,r_=e.cloneHiddenInstance,o_=e.cloneHiddenTextInstance,tb=e.isSuspenseInstancePending,nb=e.isSuspenseInstanceFallback,E9=e.getSuspenseInstanceFallbackErrorDetails,_9=e.registerSuspenseInstanceRetry,M9=e.canHydrateFormStateMarker,R9=e.isFormStateMarkerMatching,a_=e.getNextHydratableSibling,P9=e.getNextHydratableSiblingAfterSingleton,I9=e.getFirstHydratableChild,B9=e.getFirstHydratableChildWithinContainer,D9=e.getFirstHydratableChildWithinActivityInstance,N9=e.getFirstHydratableChildWithinSuspenseInstance,F9=e.getFirstHydratableChildWithinSingleton,O9=e.canHydrateInstance,L9=e.canHydrateTextInstance,j9=e.canHydrateActivityInstance,U9=e.canHydrateSuspenseInstance,z9=e.hydrateInstance,V9=e.hydrateTextInstance,H9=e.hydrateActivityInstance,G9=e.hydrateSuspenseInstance,W9=e.getNextHydratableInstanceAfterActivityInstance,J9=e.getNextHydratableInstanceAfterSuspenseInstance,K9=e.commitHydratedInstance,q9=e.commitHydratedContainer,Q9=e.commitHydratedActivityInstance,$9=e.commitHydratedSuspenseInstance,X9=e.finalizeHydratedChildren,Y9=e.flushHydrationEvents;e.clearActivityBoundary;var Z9=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var e6=e.clearSuspenseBoundaryFromContainer,t6=e.hideDehydratedBoundary,n6=e.unhideDehydratedBoundary,l_=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var i6=e.validateHydratableInstance,s6=e.validateHydratableTextInstance,os=e.supportsResources,c_=e.isHostHoistableType,ib=e.getHoistableRoot,u_=e.getResource,d_=e.acquireResource,h_=e.releaseResource,r6=e.hydrateHoistable,f_=e.mountHoistable,p_=e.unmountHoistable,o6=e.createHoistableInstance,a6=e.prepareToCommitHoistables,l6=e.mayResourceSuspendCommit,m_=e.preloadResource,c6=e.suspendResource,Yt=e.supportsSingletons,g_=e.resolveSingletonInstance,u6=e.acquireSingletonInstance,y_=e.releaseSingletonInstance,v_=e.isHostSingletonType,pc=e.isSingletonScope,sb=[],mc=-1,gc={},Si=Math.clz32?Math.clz32:x,d6=Math.log,h6=Math.LN2,Jp=256,Kp=262144,qp=4194304,Qp=xi.unstable_scheduleCallback,rb=xi.unstable_cancelCallback,f6=xi.unstable_shouldYield,p6=xi.unstable_requestPaint,ti=xi.unstable_now,b_=xi.unstable_ImmediatePriority,m6=xi.unstable_UserBlockingPriority,ob=xi.unstable_NormalPriority,g6=xi.unstable_IdlePriority,y6=xi.log,v6=xi.unstable_setDisableYieldValue,zd=null,Ci=null,ki=typeof Object.is=="function"?Object.is:ae,x_=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},b6=Object.prototype.hasOwnProperty,ab,S_,lb=!1,C_=new WeakMap,yc=[],vc=0,$p=null,Vd=0,Oi=[],Li=0,Eo=null,Ws=1,Js="",xn=m(null),Hd=m(null),_o=m(null),Xp=m(null),Sn=null,yt=null,ze=!1,Mo=null,ji=!1,cb=Error(s(519)),Yp=m(null),Ya=null,Sr=null,x6=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(p,g){l.push(g)}};this.abort=function(){u.aborted=!0,l.forEach(function(p){return p()})}},S6=xi.unstable_scheduleCallback,C6=xi.unstable_NormalPriority,vt={$$typeof:To,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Zp=null,bc=null,ub=!1,em=!1,db=!1,Za=0,Gd=null,hb=0,xc=0,Sc=null,k_=be.S;be.S=function(l,u){__=ti(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&cU(l,u),k_!==null&&k_(l,u)};var el=m(null),Cc=Error(s(460)),fb=Error(s(474)),tm=Error(s(542)),nm={then:function(){}},tl=null,kc=null,Wd=0,nl=K1(!0),w_=K1(!1),Ui=[],wc=0,pb=0,Ro=!1,mb=!1,Tc=m(null),im=m(0),wi=m(null),as=null,Ft=m(0),Cr=0,Te=null,it=null,zt=null,sm=!1,Ac=!1,il=!1,rm=0,Jd=0,Ec=null,k6=0,Kd={readContext:vn,use:Ap,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useLayoutEffect:At,useInsertionEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useSyncExternalStore:At,useId:At,useHostTransitionStatus:At,useFormState:At,useActionState:At,useOptimistic:At,useMemoCache:At,useCacheRefresh:At};Kd.useEffectEvent=At;var T_={readContext:vn,use:Ap,useCallback:function(l,u){return Ln().memoizedState=[l,u===void 0?null:u],l},useContext:vn,useEffect:vA,useImperativeHandle:function(l,u,p){p=p!=null?p.concat([l]):null,_p(4194308,4,CA.bind(null,u,l),p)},useLayoutEffect:function(l,u){return _p(4194308,4,l,u)},useInsertionEffect:function(l,u){_p(4,2,l,u)},useMemo:function(l,u){var p=Ln();u=u===void 0?null:u;var g=l();if(il){he(!0);try{l()}finally{he(!1)}}return p.memoizedState=[g,u],g},useReducer:function(l,u,p){var g=Ln();if(p!==void 0){var b=p(u);if(il){he(!0);try{p(u)}finally{he(!1)}}}else b=u;return g.memoizedState=g.baseState=b,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:b},g.queue=l,l=l.dispatch=gU.bind(null,Te,l),[g.memoizedState,l]},useRef:function(l){var u=Ln();return l={current:l},u.memoizedState=l},useState:function(l){l=u0(l);var u=l.queue,p=PA.bind(null,Te,u);return u.dispatch=p,[l.memoizedState,p]},useDebugValue:f0,useDeferredValue:function(l,u){var p=Ln();return p0(p,l,u)},useTransition:function(){var l=u0(!1);return l=EA.bind(null,Te,l.queue,!0,!1),Ln().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,p){var g=Te,b=Ln();if(ze){if(p===void 0)throw Error(s(407));p=p()}else{if(p=u(),ot===null)throw Error(s(349));Ue&127||nA(g,u,p)}b.memoizedState=p;var w={value:p,getSnapshot:u};return b.queue=w,vA(sA.bind(null,g,w,l),[l]),g.flags|=2048,ac(9,{destroy:void 0},iA.bind(null,g,w,p,u),null),p},useId:function(){var l=Ln(),u=ot.identifierPrefix;if(ze){var p=Js,g=Ws;p=(g&~(1<<32-Si(g)-1)).toString(32)+p,u="_"+u+"R_"+p,p=rm++,0<p&&(u+="H"+p.toString(32)),u+="_"}else p=k6++,u="_"+u+"r_"+p.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:m0,useFormState:fA,useActionState:fA,useOptimistic:function(l){var u=Ln();u.memoizedState=u.baseState=l;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=g0.bind(null,Te,!0,p),p.dispatch=u,[l,u]},useMemoCache:a0,useCacheRefresh:function(){return Ln().memoizedState=mU.bind(null,Te)},useEffectEvent:function(l){var u=Ln(),p={impl:l};return u.memoizedState=p,function(){if(Be&2)throw Error(s(440));return p.impl.apply(void 0,arguments)}}},gb={readContext:vn,use:Ap,useCallback:wA,useContext:vn,useEffect:h0,useImperativeHandle:kA,useInsertionEffect:xA,useLayoutEffect:SA,useMemo:TA,useReducer:Ep,useRef:yA,useState:function(){return Ep(pr)},useDebugValue:f0,useDeferredValue:function(l,u){var p=Nt();return AA(p,it.memoizedState,l,u)},useTransition:function(){var l=Ep(pr)[0],u=Nt().memoizedState;return[typeof l=="boolean"?l:Md(l),u]},useSyncExternalStore:tA,useId:MA,useHostTransitionStatus:m0,useFormState:pA,useActionState:pA,useOptimistic:function(l,u){var p=Nt();return aA(p,it,l,u)},useMemoCache:a0,useCacheRefresh:RA};gb.useEffectEvent=bA;var A_={readContext:vn,use:Ap,useCallback:wA,useContext:vn,useEffect:h0,useImperativeHandle:kA,useInsertionEffect:xA,useLayoutEffect:SA,useMemo:TA,useReducer:c0,useRef:yA,useState:function(){return c0(pr)},useDebugValue:f0,useDeferredValue:function(l,u){var p=Nt();return it===null?p0(p,l,u):AA(p,it.memoizedState,l,u)},useTransition:function(){var l=c0(pr)[0],u=Nt().memoizedState;return[typeof l=="boolean"?l:Md(l),u]},useSyncExternalStore:tA,useId:MA,useHostTransitionStatus:m0,useFormState:gA,useActionState:gA,useOptimistic:function(l,u){var p=Nt();return it!==null?aA(p,it,l,u):(p.baseState=l,[l,p.queue.dispatch])},useMemoCache:a0,useCacheRefresh:RA};A_.useEffectEvent=bA;var yb={enqueueSetState:function(l,u,p){l=l._reactInternals;var g=bi(),b=bo(g);b.payload=u,p!=null&&(b.callback=p),u=xo(l,b,g),u!==null&&(ei(u,l,g),Ad(u,l,g))},enqueueReplaceState:function(l,u,p){l=l._reactInternals;var g=bi(),b=bo(g);b.tag=1,b.payload=u,p!=null&&(b.callback=p),u=xo(l,b,g),u!==null&&(ei(u,l,g),Ad(u,l,g))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var p=bi(),g=bo(p);g.tag=2,u!=null&&(g.callback=u),u=xo(l,g,p),u!==null&&(ei(u,l,p),Ad(u,l,p))}},vb=Error(s(461)),Vt=!1,bb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},kr=!1,Ht=!1,xb=!1,E_=typeof WeakSet=="function"?WeakSet:Set,cn=null,Gt=null,ni=!1,ls=null,_c=8192,w6={getCacheForType:function(l){var u=vn(vt),p=u.data.get(l);return p===void 0&&(p=l(),u.data.set(l,p)),p},cacheSignal:function(){return vn(vt).controller.signal}},om=0,am=1,lm=2,cm=3,um=4;if(typeof Symbol=="function"&&Symbol.for){var qd=Symbol.for;om=qd("selector.component"),am=qd("selector.has_pseudo_class"),lm=qd("selector.role"),cm=qd("selector.test_id"),um=qd("selector.text")}var T6=typeof WeakMap=="function"?WeakMap:Map,Be=0,ot=null,De=null,Ue=0,Ze=0,Ti=null,Po=!1,Mc=!1,Sb=!1,wr=0,Et=0,Io=0,sl=0,Cb=0,Ai=0,Rc=0,Qd=null,ii=null,kb=!1,dm=0,__=0,$d=1/0,hm=null,Bo=null,Zt=0,Do=null,Pc=null,Tr=0,wb=0,Tb=null,M_=null,Xd=0,Ab=null;return Ie.attemptContinuousHydration=function(l){if(l.tag===13||l.tag===31){var u=Wa(l,67108864);u!==null&&ei(u,l,67108864),W0(l,67108864)}},Ie.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13||l.tag===31){var u=bi();u=W(u);var p=Wa(l,u);p!==null&&ei(p,l,u),W0(l,u)}},Ie.attemptSynchronousHydration=function(l){switch(l.tag){case 3:if(l=l.stateNode,l.current.memoizedState.isDehydrated){var u=k(l.pendingLanes);if(u!==0){for(l.pendingLanes|=2,l.entangledLanes|=2;u;){var p=1<<31-Si(u);l.entanglements[1]|=p,u&=~p}Vs(l),!(Be&6)&&($d=ti()+500,oc(0))}}break;case 31:case 13:u=Wa(l,2),u!==null&&ei(u,l,2),wE(),W0(l,2)}},Ie.batchedUpdates=function(l,u){return l(u)},Ie.createComponentSelector=function(l){return{$$typeof:om,value:l}},Ie.createContainer=function(l,u,p,g,b,w,M,F,J,Y){return VE(l,u,!1,null,p,g,w,null,M,F,J,Y)},Ie.createHasPseudoClassSelector=function(l){return{$$typeof:am,value:l}},Ie.createHydrationContainer=function(l,u,p,g,b,w,M,F,J,Y,ue,se,pe,we){var Wt;return l=VE(p,g,!0,l,b,w,F,we,J,Y,ue,se),l.context=HE(null),p=l.current,g=bi(),g=W(g),b=bo(g),b.callback=(Wt=u)!=null?Wt:null,xo(p,b,g),u=g,l.current.lanes=u,R(l,u),Vs(l),l},Ie.createPortal=function(l,u,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dc,key:g==null?null:""+g,children:l,containerInfo:u,implementation:p}},Ie.createRoleSelector=function(l){return{$$typeof:lm,value:l}},Ie.createTestNameSelector=function(l){return{$$typeof:cm,value:l}},Ie.createTextSelector=function(l){return{$$typeof:um,value:l}},Ie.defaultOnCaughtError=function(l){console.error(l)},Ie.defaultOnRecoverableError=function(l){x_(l)},Ie.defaultOnUncaughtError=function(l){x_(l)},Ie.deferredUpdates=function(l){var u=be.T,p=xr();try{return ln(32),be.T=null,l()}finally{ln(p),be.T=u}},Ie.discreteUpdates=function(l,u,p,g,b){var w=be.T,M=xr();try{return ln(2),be.T=null,l(u,p,g,b)}finally{ln(M),be.T=w,Be===0&&($d=ti()+500)}},Ie.findAllNodes=L0,Ie.findBoundingRects=function(l,u){if(!jd)throw Error(s(363));u=L0(l,u),l=[];for(var p=0;p<u.length;p++)l.push(o9(u[p]));for(u=l.length-1;0<u;u--){p=l[u];for(var g=p.x,b=g+p.width,w=p.y,M=w+p.height,F=u-1;0<=F;F--)if(u!==F){var J=l[F],Y=J.x,ue=Y+J.width,se=J.y,pe=se+J.height;if(g>=Y&&w>=se&&b<=ue&&M<=pe){l.splice(u,1);break}else if(g!==Y||p.width!==J.width||pe<w||se>M){if(!(w!==se||p.height!==J.height||ue<g||Y>b)){Y>g&&(J.width+=Y-g,J.x=g),ue<b&&(J.width=b-Y),l.splice(u,1);break}}else{se>w&&(J.height+=se-w,J.y=w),pe<M&&(J.height=M-se),l.splice(u,1);break}}}return l},Ie.findHostInstance=GE,Ie.findHostInstanceWithNoPortals=function(l){return l=a(l),l=l!==null?d(l):null,l===null?null:Ld(l.stateNode)},Ie.findHostInstanceWithWarning=function(l){return GE(l)},Ie.flushPassiveEffects=Od,Ie.flushSyncFromReconciler=function(l){var u=Be;Be|=1;var p=be.T,g=xr();try{if(ln(2),be.T=null,l)return l()}finally{ln(g),be.T=p,Be=u,!(Be&6)&&oc(0)}},Ie.flushSyncWork=wE,Ie.focusWithin=function(l,u){if(!jd)throw Error(s(363));for(l=N0(l),u=xE(l,u),u=Array.from(u),l=0;l<u.length;){var p=u[l++],g=p.tag;if(!Ud(p)){if((g===5||g===26||g===27)&&c9(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},Ie.getFindAllNodesFailureDescription=function(l,u){if(!jd)throw Error(s(363));var p=0,g=[];l=[N0(l),0];for(var b=0;b<l.length;){var w=l[b++],M=w.tag,F=l[b++],J=u[F];if((M!==5&&M!==26&&M!==27||!Ud(w))&&(F0(w,J)&&(g.push(O0(J)),F++,F>p&&(p=F)),F<u.length))for(w=w.child;w!==null;)l.push(w,F),w=w.sibling}if(p<u.length){for(l=[];p<u.length;p++)l.push(O0(u[p]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},Ie.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 27:case 5:return Ld(l.child.stateNode);default:return l.child.stateNode}},Ie.injectIntoDevTools=function(){var l={bundleType:0,version:LU,rendererPackageName:jU,currentDispatcherRef:be,reconcilerVersion:"19.2.0"};if($E!==null&&(l.rendererConfig=$E),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)l=!0;else{try{zd=u.inject(l),Ci=u}catch{}l=!!u.checkDCE}}return l},Ie.isAlreadyRendering=function(){return(Be&6)!==0},Ie.observeVisibleRects=function(l,u,p,g){if(!jd)throw Error(s(363));l=L0(l,u);var b=u9(l,p,g).disconnect;return{disconnect:function(){b()}}},Ie.shouldError=function(){return null},Ie.shouldSuspend=function(){return!1},Ie.startHostTransition=function(l,u,p,g){if(l.tag!==5)throw Error(s(476));var b=_A(l).queue;EA(l,b,u,fc,p===null?i:function(){var w=_A(l);return w.next===null&&(w=l.alternate.memoizedState),Rd(l,w.next.queue,{},bi()),p(g)})},Ie.updateContainer=function(l,u,p,g){var b=u.current,w=bi();return WE(b,w,l,u,p,g),w},Ie.updateContainerSync=function(l,u,p,g){return WE(u.current,2,l,u,p,g),2},Ie},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})}(sD)),sD.exports}var oD;function zte(){return oD||(oD=1,iD.exports=Ute()),iD.exports}var Vte=zte();jte(Vte);const Hte=parseInt(y1.replace(/\D+/g,""));function aD(n,e){if(e===nee)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Uk||e===Uj){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,s=[];if(t)if(e===Uk)for(let o=1;o<=i;o++)s.push(t.getX(0)),s.push(t.getX(o)),s.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(s.push(t.getX(o)),s.push(t.getX(o+1)),s.push(t.getX(o+2))):(s.push(t.getX(o+2)),s.push(t.getX(o+1)),s.push(t.getX(o)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=n.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}function Yy(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,i=n.length;t<i;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Al="srgb",no="srgb-linear",lD=3001,Gte=3e3;class I1 extends ic{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Qte(t)}),this.register(function(t){return new $te(t)}),this.register(function(t){return new rne(t)}),this.register(function(t){return new one(t)}),this.register(function(t){return new ane(t)}),this.register(function(t){return new Yte(t)}),this.register(function(t){return new Zte(t)}),this.register(function(t){return new ene(t)}),this.register(function(t){return new tne(t)}),this.register(function(t){return new qte(t)}),this.register(function(t){return new nne(t)}),this.register(function(t){return new Xte(t)}),this.register(function(t){return new sne(t)}),this.register(function(t){return new ine(t)}),this.register(function(t){return new Jte(t)}),this.register(function(t){return new lne(t)}),this.register(function(t){return new cne(t)})}load(e,t,i,s){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const d=of.extractUrlBase(e);o=of.resolveURL(d,this.path)}else o=of.extractUrlBase(e);this.manager.itemStart(e);const a=function(d){s?s(d):console.error(d),r.manager.itemError(e),r.manager.itemEnd(e)},c=new Xy(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(d){try{r.parse(d,o,function(h){t(h),r.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,s){let r;const o={},a={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Yy(new Uint8Array(e.slice(0,4)))===nU){try{o[Oe.KHR_BINARY_GLTF]=new une(e)}catch(h){s&&s(h);return}r=JSON.parse(o[Oe.KHR_BINARY_GLTF].content)}else r=JSON.parse(Yy(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new kne(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const h=this.pluginCallbacks[d](c);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(r.extensionsUsed)for(let d=0;d<r.extensionsUsed.length;++d){const h=r.extensionsUsed[d],f=r.extensionsRequired||[];switch(h){case Oe.KHR_MATERIALS_UNLIT:o[h]=new Kte;break;case Oe.KHR_DRACO_MESH_COMPRESSION:o[h]=new dne(r,this.dracoLoader);break;case Oe.KHR_TEXTURE_TRANSFORM:o[h]=new hne;break;case Oe.KHR_MESH_QUANTIZATION:o[h]=new fne;break;default:f.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,s)}parseAsync(e,t){const i=this;return new Promise(function(s,r){i.parse(e,t,s,r)})}}function Wte(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Oe={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Jte{constructor(e){this.parser=e,this.name=Oe.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){const r=t[i];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let s=t.cache.get(i);if(s)return s;const r=t.json,c=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let d;const h=new on(16777215);c.color!==void 0&&h.setRGB(c.color[0],c.color[1],c.color[2],no);const f=c.range!==void 0?c.range:0;switch(c.type){case"directional":d=new bte(h),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new yte(h),d.distance=f;break;case"spot":d=new mte(h),d.distance=f,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,d.angle=c.spot.outerConeAngle,d.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return d.position.set(0,0,0),d.decay=2,Fr(d,c),c.intensity!==void 0&&(d.intensity=c.intensity),d.name=t.createUniqueName(c.name||"light_"+e),s=Promise.resolve(d),t.cache.add(i,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class Kte{constructor(){this.name=Oe.KHR_MATERIALS_UNLIT}getMaterialType(){return mu}extendParams(e,t,i){const s=[];e.color=new on(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],no),e.opacity=o[3]}r.baseColorTexture!==void 0&&s.push(i.assignTexture(e,"map",r.baseColorTexture,Al))}return Promise.all(s)}}class qte{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class Qte{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new $t(a,a)}return Promise.all(r)}}class $te{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Xte{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class Yte{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new on(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],no)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Al)),o.sheenRoughnessTexture!==void 0&&r.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class Zte{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class ene{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new on().setRGB(a[0],a[1],a[2],no),Promise.all(r)}}class tne{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class nne{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new on().setRGB(a[0],a[1],a[2],no),o.specularColorTexture!==void 0&&r.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Al)),Promise.all(r)}}class ine{constructor(e){this.parser=e,this.name=Oe.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(r)}}class sne{constructor(e){this.parser=e,this.name=Oe.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:dr}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class rne{constructor(e){this.parser=e,this.name=Oe.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,o)}}class one{constructor(e){this.parser=e,this.name=Oe.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],a=s.images[o.source];let c=i.textureLoader;if(a.uri){const d=i.options.manager.getHandler(a.uri);d!==null&&(c=d)}return this.detectSupport().then(function(d){if(d)return i.loadTextureImage(e,o.source,c);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class ane{constructor(e){this.parser=e,this.name=Oe.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,r=s.textures[e];if(!r.extensions||!r.extensions[t])return null;const o=r.extensions[t],a=s.images[o.source];let c=i.textureLoader;if(a.uri){const d=i.options.manager.getHandler(a.uri);d!==null&&(c=d)}return this.detectSupport().then(function(d){if(d)return i.loadTextureImage(e,o.source,c);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class lne{constructor(e){this.name=Oe.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(a){const c=s.byteOffset||0,d=s.byteLength||0,h=s.count,f=s.byteStride,m=new Uint8Array(a,c,d);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,f,m,s.mode,s.filter).then(function(y){return y.buffer}):o.ready.then(function(){const y=new ArrayBuffer(h*f);return o.decodeGltfBuffer(new Uint8Array(y),h,f,m,s.mode,s.filter),y})})}else return null}}class cne{constructor(e){this.name=Oe.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const s=t.meshes[i.mesh];for(const d of s.primitives)if(d.mode!==Wi.TRIANGLES&&d.mode!==Wi.TRIANGLE_STRIP&&d.mode!==Wi.TRIANGLE_FAN&&d.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],c={};for(const d in o)a.push(this.parser.getDependency("accessor",o[d]).then(h=>(c[d]=h,c[d])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(d=>{const h=d.pop(),f=h.isGroup?h.children:[h],m=d[0].count,y=[];for(const v of f){const x=new He,k=new q,C=new za,A=new q(1,1,1),T=new Kee(v.geometry,v.material,m);for(let E=0;E<m;E++)c.TRANSLATION&&k.fromBufferAttribute(c.TRANSLATION,E),c.ROTATION&&C.fromBufferAttribute(c.ROTATION,E),c.SCALE&&A.fromBufferAttribute(c.SCALE,E),T.setMatrixAt(E,x.compose(k,C,A));for(const E in c)if(E==="_COLOR_0"){const _=c[E];T.instanceColor=new Gk(_.array,_.itemSize,_.normalized)}else E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&v.geometry.setAttribute(E,c[E]);Ut.prototype.copy.call(T,v),this.parser.assignFinalMaterial(T),y.push(T)}return h.isGroup?(h.clear(),h.add(...y),h):y[0]}))}}const nU="glTF",wh=12,cD={JSON:1313821514,BIN:5130562};class une{constructor(e){this.name=Oe.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,wh);if(this.header={magic:Yy(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==nU)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-wh,s=new DataView(e,wh);let r=0;for(;r<i;){const o=s.getUint32(r,!0);r+=4;const a=s.getUint32(r,!0);if(r+=4,a===cD.JSON){const c=new Uint8Array(e,wh+r,o);this.content=Yy(c)}else if(a===cD.BIN){const c=wh+r;this.body=e.slice(c,c+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class dne{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Oe.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},d={};for(const h in o){const f=Jk[h]||h.toLowerCase();a[f]=o[h]}for(const h in e.attributes){const f=Jk[h]||h.toLowerCase();if(o[h]!==void 0){const m=i.accessors[e.attributes[h]],y=Bu[m.componentType];d[f]=y.name,c[f]=m.normalized===!0}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(f,m){s.decodeDracoFile(h,function(y){for(const v in y.attributes){const x=y.attributes[v],k=c[v];k!==void 0&&(x.normalized=k)}f(y)},a,d,no,m)})})}}class hne{constructor(){this.name=Oe.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class fne{constructor(){this.name=Oe.KHR_MESH_QUANTIZATION}}class iU extends dp{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let o=0;o!==s;o++)t[o]=i[r+o];return t}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=a*2,d=a*3,h=s-t,f=(i-t)/h,m=f*f,y=m*f,v=e*d,x=v-d,k=-2*y+3*m,C=y-m,A=1-k,T=C-m+f;for(let E=0;E!==a;E++){const _=o[x+E+a],R=o[x+E+c]*h,B=o[v+E+a],I=o[v+E]*h;r[E]=A*_+T*R+k*B+C*I}return r}}const pne=new za;class mne extends iU{interpolate_(e,t,i,s){const r=super.interpolate_(e,t,i,s);return pne.fromArray(r).normalize().toArray(r),r}}const Wi={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Bu={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},uD={9728:jk,9729:v1,9984:X2,9985:Z2,9986:Y2,9987:b1},dD={33071:Nh,33648:Lk,10497:jf},xS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Jk={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Hte>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Jo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gne={CUBICSPLINE:void 0,LINEAR:zf,STEP:Uf},SS={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function yne(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new E1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:qy})),n.DefaultMaterial}function dl(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Fr(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function vne(n,e,t){let i=!1,s=!1,r=!1;for(let d=0,h=e.length;d<h;d++){const f=e[d];if(f.POSITION!==void 0&&(i=!0),f.NORMAL!==void 0&&(s=!0),f.COLOR_0!==void 0&&(r=!0),i&&s&&r)break}if(!i&&!s&&!r)return Promise.resolve(n);const o=[],a=[],c=[];for(let d=0,h=e.length;d<h;d++){const f=e[d];if(i){const m=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(m)}if(s){const m=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(m)}if(r){const m=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;c.push(m)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(d){const h=d[0],f=d[1],m=d[2];return i&&(n.morphAttributes.position=h),s&&(n.morphAttributes.normal=f),r&&(n.morphAttributes.color=m),n.morphTargetsRelative=!0,n})}function bne(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,s=t.length;i<s;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function xne(n){let e;const t=n.extensions&&n.extensions[Oe.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+CS(t.attributes):e=n.indices+":"+CS(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,s=n.targets.length;i<s;i++)e+=":"+CS(n.targets[i]);return e}function CS(n){let e="";const t=Object.keys(n).sort();for(let i=0,s=t.length;i<s;i++)e+=t[i]+":"+n[t[i]]+";";return e}function Kk(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Sne(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Cne=new He;class kne{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Wte,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||s&&r<98?this.textureLoader=new fte(this.options.manager):this.textureLoader=new xte(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xy(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][s.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:s.asset,parser:i,userData:{}};return dl(r,a,s),Fr(a,s),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(const c of a.scenes)c.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let s=0,r=t.length;s<r;s++){const o=t[s].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const o=e[s];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const s=i.clone(),r=(o,a)=>{const c=this.associations.get(o);c!=null&&this.associations.set(a,c);for(const[d,h]of o.children.entries())r(h,a.children[d])};return r(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const s=e(t[i]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let s=0;s<t.length;s++){const r=e(t[s]);r&&i.push(r)}return i}getDependency(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(r,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Oe.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,o){i.load(of.resolveURL(t.uri,s.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteLength||0,r=t.byteOffset||0;return i.slice(r,r+s)})}loadAccessor(e){const t=this,i=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const o=xS[s.type],a=Bu[s.componentType],c=s.normalized===!0,d=new a(s.count*o);return Promise.resolve(new Bi(d,o,c))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(o){const a=o[0],c=xS[s.type],d=Bu[s.componentType],h=d.BYTES_PER_ELEMENT,f=h*c,m=s.byteOffset||0,y=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,v=s.normalized===!0;let x,k;if(y&&y!==f){const C=Math.floor(m/y),A="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+C+":"+s.count;let T=t.cache.get(A);T||(x=new d(a,C*y,s.count*y/h),T=new Vee(x,y/h),t.cache.add(A,T)),k=new w1(T,c,m%y/h,v)}else a===null?x=new d(s.count*c):x=new d(a,m,s.count*c),k=new Bi(x,c,v);if(s.sparse!==void 0){const C=xS.SCALAR,A=Bu[s.sparse.indices.componentType],T=s.sparse.indices.byteOffset||0,E=s.sparse.values.byteOffset||0,_=new A(o[1],T,s.sparse.count*C),R=new d(o[2],E,s.sparse.count*c);a!==null&&(k=new Bi(k.array.slice(),k.itemSize,k.normalized));for(let B=0,I=_.length;B<I;B++){const L=_[B];if(k.setX(L,R[B*c]),c>=2&&k.setY(L,R[B*c+1]),c>=3&&k.setZ(L,R[B*c+2]),c>=4&&k.setW(L,R[B*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return k})}loadTexture(e){const t=this.json,i=this.options,r=t.textures[e].source,o=t.images[r];let a=this.textureLoader;if(o.uri){const c=i.manager.getHandler(o.uri);c!==null&&(a=c)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,i){const s=this,r=this.json,o=r.textures[e],a=r.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const d=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const m=(r.samplers||{})[o.sampler]||{};return h.magFilter=uD[m.magFilter]||v1,h.minFilter=uD[m.minFilter]||b1,h.wrapS=dD[m.wrapS]||jf,h.wrapT=dD[m.wrapT]||jf,s.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[c]=d,d}loadImageSource(e,t){const i=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=s.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",d=!1;if(o.bufferView!==void 0)c=i.getDependency("bufferView",o.bufferView).then(function(f){d=!0;const m=new Blob([f],{type:o.mimeType});return c=a.createObjectURL(m),c});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(c).then(function(f){return new Promise(function(m,y){let v=m;t.isImageBitmapLoader===!0&&(v=function(x){const k=new Ds(x);k.needsUpdate=!0,m(k)}),t.load(of.resolveURL(f,r.path),v,void 0,y)})}).then(function(f){return d===!0&&a.revokeObjectURL(c),Fr(f,o),f.userData.mimeType=o.mimeType||Sne(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),f});return this.sourceCache[e]=h,h}assignTexture(e,t,i,s){const r=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),r.extensions[Oe.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[Oe.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=r.associations.get(o);o=r.extensions[Oe.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),r.associations.set(o,c)}}return s!==void 0&&(typeof s=="number"&&(s=s===lD?Al:no),"colorSpace"in o?o.colorSpace=s:o.encoding=s===Al?lD:Gte),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const s=t.attributes.tangent===void 0,r=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Kj,zl.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Jj,zl.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(s||r||o){let a="ClonedMaterial:"+i.uuid+":";s&&(a+="derivative-tangents:"),r&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),r&&(c.vertexColors=!0),o&&(c.flatShading=!0),s&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return E1}loadMaterial(e){const t=this,i=this.json,s=this.extensions,r=i.materials[e];let o;const a={},c=r.extensions||{},d=[];if(c[Oe.KHR_MATERIALS_UNLIT]){const f=s[Oe.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),d.push(f.extendParams(a,r,t))}else{const f=r.pbrMetallicRoughness||{};if(a.color=new on(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const m=f.baseColorFactor;a.color.setRGB(m[0],m[1],m[2],no),a.opacity=m[3]}f.baseColorTexture!==void 0&&d.push(t.assignTexture(a,"map",f.baseColorTexture,Al)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(d.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),d.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,a)})))}r.doubleSided===!0&&(a.side=q2);const h=r.alphaMode||SS.OPAQUE;if(h===SS.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===SS.MASK&&(a.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==mu&&(d.push(t.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new $t(1,1),r.normalTexture.scale!==void 0)){const f=r.normalTexture.scale;a.normalScale.set(f,f)}if(r.occlusionTexture!==void 0&&o!==mu&&(d.push(t.assignTexture(a,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==mu){const f=r.emissiveFactor;a.emissive=new on().setRGB(f[0],f[1],f[2],no)}return r.emissiveTexture!==void 0&&o!==mu&&d.push(t.assignTexture(a,"emissiveMap",r.emissiveTexture,Al)),Promise.all(d).then(function(){const f=new o(a);return r.name&&(f.name=r.name),Fr(f,r),t.associations.set(f,{materials:e}),r.extensions&&dl(s,f,r),f})}createUniqueName(e){const t=tt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,s=this.primitiveCache;function r(a){return i[Oe.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return hD(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const d=e[a],h=xne(d),f=s[h];if(f)o.push(f.promise);else{let m;d.extensions&&d.extensions[Oe.KHR_DRACO_MESH_COMPRESSION]?m=r(d):m=hD(new nc,d,t),s[h]={primitive:d,promise:m},o.push(m)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,s=this.extensions,r=i.meshes[e],o=r.primitives,a=[];for(let c=0,d=o.length;c<d;c++){const h=o[c].material===void 0?yne(this.cache):this.getDependency("material",o[c].material);a.push(h)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const d=c.slice(0,c.length-1),h=c[c.length-1],f=[];for(let y=0,v=h.length;y<v;y++){const x=h[y],k=o[y];let C;const A=d[y];if(k.mode===Wi.TRIANGLES||k.mode===Wi.TRIANGLE_STRIP||k.mode===Wi.TRIANGLE_FAN||k.mode===void 0)C=r.isSkinnedMesh===!0?new Gee(x,A):new Uv(x,A),C.isSkinnedMesh===!0&&C.normalizeSkinWeights(),k.mode===Wi.TRIANGLE_STRIP?C.geometry=aD(C.geometry,Uj):k.mode===Wi.TRIANGLE_FAN&&(C.geometry=aD(C.geometry,Uk));else if(k.mode===Wi.LINES)C=new Yee(x,A);else if(k.mode===Wi.LINE_STRIP)C=new A1(x,A);else if(k.mode===Wi.LINE_LOOP)C=new Zee(x,A);else if(k.mode===Wi.POINTS)C=new ete(x,A);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+k.mode);Object.keys(C.geometry.morphAttributes).length>0&&bne(C,r),C.name=t.createUniqueName(r.name||"mesh_"+e),Fr(C,r),k.extensions&&dl(s,C,k),t.assignFinalMaterial(C),f.push(C)}for(let y=0,v=f.length;y<v;y++)t.associations.set(f[y],{meshes:e,primitives:y});if(f.length===1)return r.extensions&&dl(s,f[0],r),f[0];const m=new fS;r.extensions&&dl(s,m,r),t.associations.set(m,{meshes:e});for(let y=0,v=f.length;y<v;y++)m.add(f[y]);return m})}loadCamera(e){let t;const i=this.json.cameras[e],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new k1(Cee.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(t=new $j(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Fr(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let s=0,r=t.joints.length;s<r;s++)i.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){const r=s.pop(),o=s,a=[],c=[];for(let d=0,h=o.length;d<h;d++){const f=o[d];if(f){a.push(f);const m=new He;r!==null&&m.fromArray(r.array,d*16),c.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[d])}return new T1(a,c)})}loadAnimation(e){const t=this.json,i=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,o=[],a=[],c=[],d=[],h=[];for(let f=0,m=s.channels.length;f<m;f++){const y=s.channels[f],v=s.samplers[y.sampler],x=y.target,k=x.node,C=s.parameters!==void 0?s.parameters[v.input]:v.input,A=s.parameters!==void 0?s.parameters[v.output]:v.output;x.node!==void 0&&(o.push(this.getDependency("node",k)),a.push(this.getDependency("accessor",C)),c.push(this.getDependency("accessor",A)),d.push(v),h.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c),Promise.all(d),Promise.all(h)]).then(function(f){const m=f[0],y=f[1],v=f[2],x=f[3],k=f[4],C=[];for(let A=0,T=m.length;A<T;A++){const E=m[A],_=y[A],R=v[A],B=x[A],I=k[A];if(E===void 0)continue;E.updateMatrix&&E.updateMatrix();const L=i._createAnimationTracks(E,_,R,B,I);if(L)for(let O=0;O<L.length;O++)C.push(L[O])}return new ote(r,void 0,C)})}createNodeMesh(e){const t=this.json,i=this,s=t.nodes[e];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(r){const o=i._getNodeRef(i.meshCache,s.mesh,r);return s.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let c=0,d=s.weights.length;c<d;c++)a.morphTargetInfluences[c]=s.weights[c]}),o})}loadNode(e){const t=this.json,i=this,s=t.nodes[e],r=i._loadNodeShallow(e),o=[],a=s.children||[];for(let d=0,h=a.length;d<h;d++)o.push(i.getDependency("node",a[d]));const c=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([r,Promise.all(o),c]).then(function(d){const h=d[0],f=d[1],m=d[2];m!==null&&h.traverse(function(y){y.isSkinnedMesh&&y.bind(m,Cne)});for(let y=0,v=f.length;y<v;y++)h.add(f[y]);return h})}_loadNodeShallow(e){const t=this.json,i=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=t.nodes[e],o=r.name?s.createUniqueName(r.name):"",a=[],c=s._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return c&&a.push(c),r.camera!==void 0&&a.push(s.getDependency("camera",r.camera).then(function(d){return s._getNodeRef(s.cameraCache,r.camera,d)})),s._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){a.push(d)}),this.nodeCache[e]=Promise.all(a).then(function(d){let h;if(r.isBone===!0?h=new Gj:d.length>1?h=new fS:d.length===1?h=d[0]:h=new Ut,h!==d[0])for(let f=0,m=d.length;f<m;f++)h.add(d[f]);if(r.name&&(h.userData.name=r.name,h.name=o),Fr(h,r),r.extensions&&dl(i,h,r),r.matrix!==void 0){const f=new He;f.fromArray(r.matrix),h.applyMatrix4(f)}else r.translation!==void 0&&h.position.fromArray(r.translation),r.rotation!==void 0&&h.quaternion.fromArray(r.rotation),r.scale!==void 0&&h.scale.fromArray(r.scale);return s.associations.has(h)||s.associations.set(h,{}),s.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],s=this,r=new fS;i.name&&(r.name=s.createUniqueName(i.name)),Fr(r,i),i.extensions&&dl(t,r,i);const o=i.nodes||[],a=[];for(let c=0,d=o.length;c<d;c++)a.push(s.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let h=0,f=c.length;h<f;h++)r.add(c[h]);const d=h=>{const f=new Map;for(const[m,y]of s.associations)(m instanceof zl||m instanceof Ds)&&f.set(m,y);return h.traverse(m=>{const y=s.associations.get(m);y!=null&&f.set(m,y)}),f};return s.associations=d(r),r})}_createAnimationTracks(e,t,i,s,r){const o=[],a=e.name?e.name:e.uuid,c=[];Jo[r.path]===Jo.weights?e.traverse(function(m){m.morphTargetInfluences&&c.push(m.name?m.name:m.uuid)}):c.push(a);let d;switch(Jo[r.path]){case Jo.weights:d=od;break;case Jo.rotation:d=ad;break;case Jo.position:case Jo.scale:d=ld;break;default:switch(i.itemSize){case 1:d=od;break;case 2:case 3:default:d=ld;break}break}const h=s.interpolation!==void 0?gne[s.interpolation]:zf,f=this._getArrayFromAccessor(i);for(let m=0,y=c.length;m<y;m++){const v=new d(c[m]+"."+Jo[r.path],t.array,f,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(v),o.push(v)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=Kk(t.constructor),s=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)s[r]=t[r]*i;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const s=this instanceof ad?mne:iU;return new s(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function wne(n,e,t){const i=e.attributes,s=new go;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],c=a.min,d=a.max;if(c!==void 0&&d!==void 0){if(s.set(new q(c[0],c[1],c[2]),new q(d[0],d[1],d[2])),a.normalized){const h=Kk(Bu[a.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const a=new q,c=new q;for(let d=0,h=r.length;d<h;d++){const f=r[d];if(f.POSITION!==void 0){const m=t.json.accessors[f.POSITION],y=m.min,v=m.max;if(y!==void 0&&v!==void 0){if(c.setX(Math.max(Math.abs(y[0]),Math.abs(v[0]))),c.setY(Math.max(Math.abs(y[1]),Math.abs(v[1]))),c.setZ(Math.max(Math.abs(y[2]),Math.abs(v[2]))),m.normalized){const x=Kk(Bu[m.componentType]);c.multiplyScalar(x)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(a)}n.boundingBox=s;const o=new ur;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,n.boundingSphere=o}function hD(n,e,t){const i=e.attributes,s=[];function r(o,a){return t.getDependency("accessor",o).then(function(c){n.setAttribute(a,c)})}for(const o in i){const a=Jk[o]||o.toLowerCase();a in n.attributes||s.push(r(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});s.push(o)}return Fr(n,e),wne(n,e,t),Promise.all(s).then(function(){return e.targets!==void 0?vne(n,e.targets,t):n})}const kS=new WeakMap;class Tne extends ic{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,s){const r=new Xy(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(s)},i,s)}decodeDracoFile(e,t,i,s){const r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const c in t.attributeTypes){const d=t.attributeTypes[c];d.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=d.name)}const i=JSON.stringify(t);if(kS.has(e)){const c=kS.get(e);if(c.key===i)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(r,o).then(c=>(s=c,new Promise((d,h)=>{s._callbacks[r]={resolve:d,reject:h},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),kS.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new nc;e.index&&t.setIndex(new Bi(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i],r=s.name,o=s.array,a=s.itemSize;t.setAttribute(r,new Bi(o,a))}return t}_loadLibrary(e,t){const i=new Xy(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((s,r)=>{i.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const s=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const r=Ane.toString(),o=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const o=r.data;switch(o.type){case"decode":s._callbacks[o.id].resolve(o);break;case"error":s._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Ane(){let n,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(h){n.onModuleLoaded=function(f){h({draco:f})},DracoDecoderModule(n)});break;case"decode":const c=a.buffer,d=a.taskConfig;e.then(h=>{const f=h.draco,m=new f.Decoder,y=new f.DecoderBuffer;y.Init(new Int8Array(c),c.byteLength);try{const v=t(f,m,y,d),x=v.attributes.map(k=>k.array.buffer);v.index&&x.push(v.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:v},x)}catch(v){console.error(v),self.postMessage({type:"error",id:a.id,error:v.message})}finally{f.destroy(y),f.destroy(m)}});break}};function t(o,a,c,d){const h=d.attributeIDs,f=d.attributeTypes;let m,y;const v=a.GetEncodedGeometryType(c);if(v===o.TRIANGULAR_MESH)m=new o.Mesh,y=a.DecodeBufferToMesh(c,m);else if(v===o.POINT_CLOUD)m=new o.PointCloud,y=a.DecodeBufferToPointCloud(c,m);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||m.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const x={index:null,attributes:[]};for(const k in h){const C=self[f[k]];let A,T;if(d.useUniqueIDs)T=h[k],A=a.GetAttributeByUniqueId(m,T);else{if(T=a.GetAttributeId(m,o[h[k]]),T===-1)continue;A=a.GetAttribute(m,T)}x.attributes.push(s(o,a,m,k,C,A))}return v===o.TRIANGULAR_MESH&&(x.index=i(o,a,m)),o.destroy(m),x}function i(o,a,c){const h=c.num_faces()*3,f=h*4,m=o._malloc(f);a.GetTrianglesUInt32Array(c,f,m);const y=new Uint32Array(o.HEAPF32.buffer,m,h).slice();return o._free(m),{array:y,itemSize:1}}function s(o,a,c,d,h,f){const m=f.num_components(),v=c.num_points()*m,x=v*h.BYTES_PER_ELEMENT,k=r(o,h),C=o._malloc(x);a.GetAttributeDataArrayForAllPoints(c,f,k,x,C);const A=new h(o.HEAPF32.buffer,C,v).slice();return o._free(C),{name:d,array:A,itemSize:m}}function r(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let mg;const wS=()=>{if(mg)return mg;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=n;WebAssembly.validate(t)&&(s=e);let r;const o=WebAssembly.instantiate(a(s),{}).then(f=>{r=f.instance,r.exports.__wasm_call_ctors()});function a(f){const m=new Uint8Array(f.length);for(let v=0;v<f.length;++v){const x=f.charCodeAt(v);m[v]=x>96?x-71:x>64?x-65:x>47?x+4:x>46?63:62}let y=0;for(let v=0;v<f.length;++v)m[y++]=m[v]<60?i[m[v]]:(m[v]-60)*64+m[++v];return m.buffer.slice(0,y)}function c(f,m,y,v,x,k){const C=r.exports.sbrk,A=y+3&-4,T=C(A*v),E=C(x.length),_=new Uint8Array(r.exports.memory.buffer);_.set(x,E);const R=f(T,y,v,E,x.length);if(R===0&&k&&k(T,A,v),m.set(_.subarray(T,T+y*v)),C(T-C(0)),R!==0)throw new Error(`Malformed buffer data: ${R}`)}const d={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return mg={ready:o,supported:!0,decodeVertexBuffer(f,m,y,v,x){c(r.exports.meshopt_decodeVertexBuffer,f,m,y,v,r.exports[d[x]])},decodeIndexBuffer(f,m,y,v){c(r.exports.meshopt_decodeIndexBuffer,f,m,y,v)},decodeIndexSequence(f,m,y,v){c(r.exports.meshopt_decodeIndexSequence,f,m,y,v)},decodeGltfBuffer(f,m,y,v,x,k){c(r.exports[h[x]],f,m,y,v,r.exports[d[k]])}},mg};let gg=null,sU="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function rU(n=!0,e=!0,t){return i=>{t&&t(i),n&&(gg||(gg=new Tne),gg.setDecoderPath(typeof n=="string"?n:sU),i.setDRACOLoader(gg)),e&&i.setMeshoptDecoder(typeof wS=="function"?wS():wS)}}const zv=(n,e,t,i)=>hp(I1,n,rU(e,t,i));zv.preload=(n,e,t,i)=>hp.preload(I1,n,rU(e,t,i));zv.clear=n=>hp.clear(I1,n);zv.setDecoderPath=n=>{sU=n};const Ene="https://models.readyplayer.me/64e3055495439dfcf3f0b665.glb";zv.preload(Ene);var oU={},Vv={};Object.defineProperty(Vv,"__esModule",{value:!0});Vv.SimliClient=void 0;const _ne=`
        class AudioProcessor extends AudioWorkletProcessor {
          constructor() {
            super();
            this.buffer = new Int16Array(3000);
            this.bufferIndex = 0;
        }

          process(inputs, outputs, parameters) {
            const input = inputs[0];
            const inputChannel = input[0];
            if (inputChannel) {
              for (let i = 0; i < inputChannel.length; i++) {
                this.buffer[this.bufferIndex] = Math.max(-32768, Math.min(32767, Math.round(inputChannel[i] * 32767)));
                this.bufferIndex++;

                if (this.bufferIndex === this.buffer.length){
                  this.port.postMessage({type: 'audioData', data: this.buffer.slice(0, this.bufferIndex)});
                  this.bufferIndex = 0;
                }
              }
            }
            return true;
          }
        }

        registerProcessor('audio-processor', AudioProcessor);
      `;class Mne{constructor(){this.pc=null,this.dc=null,this.dcInterval=null,this.candidateCount=0,this.prevCandidateCount=-1,this.apiKey="",this.session_token="",this.faceID="",this.handleSilence=!0,this.videoRef=null,this.audioRef=null,this.errorReason=null,this.sessionInitialized=!1,this.inputStreamTrack=null,this.sourceNode=null,this.audioWorklet=null,this.audioBuffer=null,this.answer=null,this.localDescription=null,this.maxSessionLength=3600,this.maxIdleTime=600,this.model="artalk",this.pingSendTimes=new Map,this.webSocket=null,this.lastSendTime=0,this.MAX_RETRY_ATTEMPTS=100,this.RETRY_DELAY=2e3,this.VIDEO_TIMEOUT=1e4,this.connectionTimeout=null,this.CONNECTION_TIMEOUT_MS=15e3,this.SimliURL="",this.enableSFU=!0,this.isAvatarSpeaking=!1,this.enableConsoleLogs=!1,this.events=new Map,this.retryAttempt=1,this.inputIceServers=[],this.videoReceived=!1,this.config=null,this.ClearBuffer=()=>{var e;if(((e=this.webSocket)===null||e===void 0?void 0:e.readyState)===WebSocket.OPEN)try{this.webSocket.send("SKIP")}catch(t){this.enableConsoleLogs&&console.error("SIMLI: Failed to clear buffer:",t)}else this.enableConsoleLogs&&console.warn("SIMLI: Cannot clear buffer: WebSocket not open")}}on(e,t){var i;this.events.has(e)||this.events.set(e,new Set),(i=this.events.get(e))===null||i===void 0||i.add(t)}off(e,t){var i;(i=this.events.get(e))===null||i===void 0||i.delete(t)}emit(e,...t){var i;(i=this.events.get(e))===null||i===void 0||i.forEach(s=>{s(...t)})}Initialize(e){var t,i,s,r;if((!e.apiKey||e.apiKey==="")&&(!e.session_token||e.session_token===""))throw console.error("SIMLI: apiKey or session_token is required in config"),new Error("apiKey or session_token is required in config");this.config=e,this.apiKey=e.apiKey,this.faceID=e.faceID,this.handleSilence=e.handleSilence,this.maxSessionLength=e.maxSessionLength,this.maxIdleTime=e.maxIdleTime,this.enableConsoleLogs=(t=e.enableConsoleLogs)!==null&&t!==void 0?t:!1,this.session_token=e.session_token,this.MAX_RETRY_ATTEMPTS=(i=e.maxRetryAttempts)!==null&&i!==void 0?i:this.MAX_RETRY_ATTEMPTS,this.RETRY_DELAY=(s=e.retryDelay_ms)!==null&&s!==void 0?s:this.RETRY_DELAY,this.VIDEO_TIMEOUT=(r=e.videoReceivedTimeout)!==null&&r!==void 0?r:this.VIDEO_TIMEOUT,e.enableSFU!==void 0&&(this.enableSFU=e.enableSFU),e.model!==""&&(this.model=e.model),!e.SimliURL||e.SimliURL===""?this.SimliURL="s://api.simli.ai":this.SimliURL=e.SimliURL,typeof window<"u"?(this.videoRef=e.videoRef,this.audioRef=e.audioRef,this.videoRef instanceof HTMLVideoElement||console.error("SIMLI: videoRef is required in config as HTMLVideoElement"),this.audioRef instanceof HTMLAudioElement||console.error("SIMLI: audioRef is required in config as HTMLAudioElement"),console.log("SIMLI: simli-client@1.2.20 initialized")):console.warn("SIMLI: Running in Node.js environment. Some features may not be available.")}async getIceServers(e,t,i=1){try{const s=`http${t}/getIceServers`,r=await Promise.race([fetch(s,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({apiKey:e})}),new Promise((a,c)=>setTimeout(()=>c(new Error("SIMLI: ICE server request timeout")),5e3))]);if(!r.ok)throw new Error(`SIMLI: HTTP error! status: ${r.status}`);const o=await r.json();if(!o||o.length===0)throw new Error("SIMLI: No ICE servers returned");return o}catch(s){return this.enableConsoleLogs&&console.warn(`SIMLI: ICE servers fetch attempt ${i} failed:`,s),i<this.MAX_RETRY_ATTEMPTS?(await new Promise(r=>setTimeout(r,this.RETRY_DELAY)),this.getIceServers(e,t,i+1)):(this.enableConsoleLogs&&console.log("SIMLI: Using fallback STUN server"),[{urls:["stun:stun.l.google.com:19302"]}])}}async createPeerConnection(e=[],t){this.pc&&this.pc.close();const i={sdpSemantics:"unified-plan",iceServers:e};this.enableConsoleLogs&&console.log("SIMLI: Server running: ",i.iceServers),this.pc=new window.RTCPeerConnection(i),this.pc&&this.setupPeerConnectionListeners(t)}setupPeerConnectionListeners(e){this.pc&&(this.pc.addEventListener("icegatheringstatechange",()=>{var t;this.enableConsoleLogs&&console.log("SIMLI: ICE gathering state changed: ",(t=this.pc)===null||t===void 0?void 0:t.iceGatheringState)}),this.pc.addEventListener("iceconnectionstatechange",()=>{var t,i;this.enableConsoleLogs&&console.log("SIMLI: ICE connection state changed: ",(t=this.pc)===null||t===void 0?void 0:t.iceConnectionState),((i=this.pc)===null||i===void 0?void 0:i.iceConnectionState)==="failed"&&(this.retryAttempt<this.MAX_RETRY_ATTEMPTS?(this.retryAttempt+=1,this.start(this.inputIceServers,this.retryAttempt)):this.handleConnectionFailure("ICE connection failed"))}),this.pc.addEventListener("signalingstatechange",()=>{var t;this.enableConsoleLogs&&console.log("SIMLI: Signaling state changed: ",(t=this.pc)===null||t===void 0?void 0:t.signalingState)}),this.pc.addEventListener("track",t=>{this.enableConsoleLogs&&console.log("SIMLI: Track event: ",t.track.kind),t.track.kind==="video"&&this.videoRef?(this.videoRef.srcObject=t.streams[0],this.videoRef.requestVideoFrameCallback(()=>{e()})):t.track.kind==="audio"&&this.audioRef&&(this.audioRef.srcObject=t.streams[0])}),this.pc.onicecandidate=t=>{t.candidate===null||(this.candidateCount+=1)})}setupConnectionStateHandler(){this.pc&&this.pc.addEventListener("connectionstatechange",()=>{var e,t;switch(this.enableConsoleLogs&&console.log("SIMLI: Connection state changed to:",(e=this.pc)===null||e===void 0?void 0:e.connectionState),(t=this.pc)===null||t===void 0?void 0:t.connectionState){case"connected":this.clearTimeouts();break;case"failed":this.emit("failed","Connection failed");case"closed":this.videoReceived&&this.emit("disconnected"),this.cleanup();break;case"disconnected":this.videoReceived&&(this.emit("disconnected"),this.handleDisconnection());break}})}async start(e=[],t=1){try{if(await this.cleanup(),this.clearTimeouts(),this.connectionTimeout=setTimeout(()=>{this.handleConnectionTimeout()},this.CONNECTION_TIMEOUT_MS),this.inputIceServers=e,e.length===0){const a={faceId:this.faceID,isJPG:!1,apiKey:this.apiKey,syncAudio:!0,handleSilence:this.handleSilence,maxSessionLength:this.maxSessionLength,maxIdleTime:this.maxIdleTime,model:this.model},c=await Promise.all([this.getIceServers(this.apiKey,this.SimliURL),this.createSessionToken(this.SimliURL,a)]);e=c[0],this.session_token=c[1].session_token}const i=`ws${this.SimliURL}/StartWebRTCSession?enableSFU=${this.enableSFU}`,s=new WebSocket(i);this.webSocket=s;const r=new Promise(a=>{this.webSocket&&this.setupWebSocketListeners(this.webSocket,a)});await Promise.race([r,new Promise((a,c)=>setTimeout(()=>c(new Error("SIMLI: WebSocket connection timeout")),5e3))]);const o=new Promise(async(a,c)=>{var d,h;try{await this.createPeerConnection(e,a);const f={ordered:!0};this.dc=this.pc.createDataChannel("chat",f),this.setupDataChannelListeners(),this.setupConnectionStateHandler(),(d=this.pc)===null||d===void 0||d.addTransceiver("audio",{direction:"recvonly"}),(h=this.pc)===null||h===void 0||h.addTransceiver("video",{direction:"recvonly"}),await this.negotiate()}catch{c()}});await Promise.race([o,new Promise((a,c)=>setTimeout(()=>c(new Error("SIMLI: Video connection timeout")),this.VIDEO_TIMEOUT))]),this.videoReceived=!0,console.log("CONNECTED"),this.clearTimeouts()}catch(i){if(this.enableConsoleLogs&&console.error(`SIMLI: Connection attempt ${t} failed:`,i),this.clearTimeouts(),this.retryAttempt<this.MAX_RETRY_ATTEMPTS)return this.enableConsoleLogs&&console.log(`SIMLI: Retrying connection... Attempt ${t+1}`),await this.cleanup(),await new Promise(s=>setTimeout(s,this.RETRY_DELAY)),this.retryAttempt+=1,this.start(e,this.retryAttempt);throw this.emit("failed",`Failed to connect after ${this.MAX_RETRY_ATTEMPTS} attempts`),i}}setupDataChannelListeners(){this.dc&&(this.dc.addEventListener("close",()=>{this.enableConsoleLogs&&console.log("SIMLI: Data channel closed"),this.videoReceived&&(this.emit("disconnected"),this.stopDataChannelInterval())}),this.dc.addEventListener("error",e=>{this.videoReceived&&(this.enableConsoleLogs&&console.error("SIMLI: Data channel error:",e),this.emit("disconnected")),this.handleConnectionFailure("Data channel error")}))}startDataChannelInterval(){this.stopDataChannelInterval(),this.dcInterval=setInterval(()=>{},1e3)}stopDataChannelInterval(){this.dcInterval&&(clearInterval(this.dcInterval),this.dcInterval=null)}sendPingMessage(){var e,t;if(this.webSocket&&this.webSocket.readyState===this.webSocket.OPEN){const i="ping "+Date.now();this.pingSendTimes.set(i,Date.now());try{(e=this.webSocket)===null||e===void 0||e.send(i)}catch(s){this.enableConsoleLogs&&console.error("SIMLI: Failed to send message:",s),this.stopDataChannelInterval(),this.handleConnectionFailure("Failed to send ping message")}}else this.enableConsoleLogs&&console.warn("SIMLI: WebSocket is not open. Current state:",(t=this.webSocket)===null||t===void 0?void 0:t.readyState),this.errorReason!==null&&this.enableConsoleLogs&&console.error("SIMLI: Error Reason: ",this.errorReason),this.stopDataChannelInterval()}async createSessionToken(e,t){if(this.session_token&&this.session_token!=="")return{session_token:this.session_token};try{const i=`http${e}/startAudioToVideoSession`,s=await fetch(i,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});if(!s.ok){const o=await s.text();throw new Error(`${o}`)}return await s.json()}catch(i){throw this.handleConnectionFailure(`Session initialization failed: ${i}`),i}}async sendSessionToken(e){var t;try{if(this.webSocket&&this.webSocket.readyState===this.webSocket.OPEN)(t=this.webSocket)===null||t===void 0||t.send(e);else throw new Error("WebSocket not open when trying to send session token")}catch(i){throw this.handleConnectionFailure(`Session initialization failed: ${i}`),i}}async negotiate(){if(!this.pc)throw new Error("SIMLI: PeerConnection not initialized");try{const e=await this.pc.createOffer();if(await this.pc.setLocalDescription(e),await this.waitForIceGathering(),this.localDescription=this.pc.localDescription,!this.localDescription)throw new Error("SIMLI: Local description is null");let t;this.answer=null,await Promise.race([new Promise((i,s)=>{t=setTimeout(()=>s(new Error("Answer timeout A")),1e4);const r=async()=>{if(!this.pc){s();return}this.answer?(clearTimeout(t),i(),await this.pc.setRemoteDescription(new RTCSessionDescription(this.answer))):setTimeout(r,100)};r()}),new Promise((i,s)=>setTimeout(()=>s(new Error("SIMLI: Answer timeout B")),1e4))])}catch(e){throw this.handleConnectionFailure(`SIMLI: Negotiation failed: ${e}`),e}}async waitForIceGathering(){if(this.pc&&(this.candidateCount=0,this.prevCandidateCount=0,this.pc.iceGatheringState!=="complete"))return new Promise((e,t)=>{const i=setTimeout(()=>{t(new Error("ICE gathering timeout"))},1e4),s=()=>{var r;((r=this.pc)===null||r===void 0?void 0:r.iceGatheringState)==="complete"||this.candidateCount===this.prevCandidateCount?(clearTimeout(i),e()):(this.prevCandidateCount=this.candidateCount,setTimeout(s,150))};s()})}handleConnectionFailure(e){this.errorReason=e,this.enableConsoleLogs&&console.error("SIMLI: connection failure:",e),this.retryAttempt>=this.MAX_RETRY_ATTEMPTS&&this.emit("failed",e),this.cleanup()}handleConnectionTimeout(){this.handleConnectionFailure("Connection timed out")}handleDisconnection(){this.sessionInitialized&&(this.enableConsoleLogs&&console.log("SIMLI: Connection lost, attempting to reconnect..."),this.cleanup().then(()=>this.start(this.inputIceServers,this.retryAttempt)).catch(e=>{this.enableConsoleLogs&&console.error("SIMLI: Reconnection failed:",e),this.retryAttempt>=this.MAX_RETRY_ATTEMPTS&&this.emit("failed","Reconnection failed")}))}async cleanup(){this.videoRef&&(this.videoRef.srcObject=null),this.audioRef&&(this.audioRef.srcObject=null),this.webSocket&&(this.webSocket.close(),this.webSocket=null),this.dc&&(this.dc.close(),this.dc=null),this.pc&&(this.pc.close(),this.pc=null),this.audioWorklet&&(this.audioWorklet.disconnect(),this.audioWorklet=null),this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null),this.sessionInitialized=!1,this.candidateCount=0,this.prevCandidateCount=-1,this.videoRef=null,this.audioRef=null,this.answer=null,this.localDescription=null,this.pingSendTimes=new Map,this.inputIceServers=[],this.clearTimeouts(),this.stopDataChannelInterval(),this.answer=null,this.config&&this.Initialize(this.config)}clearTimeouts(){this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null)}listenToMediastreamTrack(e){try{this.inputStreamTrack=e;const t=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});this.initializeAudioWorklet(t,e)}catch(t){this.enableConsoleLogs&&console.error("SIMLI: Failed to initialize audio stream:",t),this.retryAttempt>=this.MAX_RETRY_ATTEMPTS&&this.emit("failed","Audio initialization failed")}}initializeAudioWorklet(e,t){e.audioWorklet.addModule(URL.createObjectURL(new Blob([_ne],{type:"application/javascript"}))).then(()=>{if(this.audioWorklet=new AudioWorkletNode(e,"audio-processor"),this.sourceNode=e.createMediaStreamSource(new MediaStream([t])),this.audioWorklet===null)throw new Error("SIMLI: AudioWorklet not initialized");this.sourceNode.connect(this.audioWorklet),this.audioWorklet.port.onmessage=i=>{i.data.type==="audioData"&&this.sendAudioData(new Uint8Array(i.data.data.buffer))}}).catch(i=>{this.enableConsoleLogs&&console.error("SIMLI: Failed to initialize AudioWorklet:",i),this.retryAttempt>=this.MAX_RETRY_ATTEMPTS&&this.emit("failed","AudioWorklet initialization failed")})}sendAudioData(e){var t,i;if(!this.sessionInitialized){this.enableConsoleLogs&&console.log("SIMLI: Session not initialized. Ignoring audio data.");return}if(((t=this.webSocket)===null||t===void 0?void 0:t.readyState)!==WebSocket.OPEN){this.enableConsoleLogs&&console.error("SIMLI: WebSocket is not open. Current state:",(i=this.webSocket)===null||i===void 0?void 0:i.readyState,"Error Reason:",this.errorReason);return}try{this.webSocket.send(e);const s=Date.now();if(this.lastSendTime!==0){const r=s-this.lastSendTime;r>100&&this.enableConsoleLogs&&console.log("SIMLI: Time between sends:",r)}this.lastSendTime=s}catch(s){this.enableConsoleLogs&&console.error("SIMLI: Failed to send audio data:",s),this.handleConnectionFailure("Failed to send audio data")}}sendAudioDataImmediate(e){var t,i;if(!this.sessionInitialized){this.enableConsoleLogs&&console.log("SIMLI: Session not initialized. Ignoring audio data.");return}if(((t=this.webSocket)===null||t===void 0?void 0:t.readyState)!==WebSocket.OPEN){this.enableConsoleLogs&&console.error("SIMLI: WebSocket is not open. Current state:",(i=this.webSocket)===null||i===void 0?void 0:i.readyState,"Error Reason:",this.errorReason);return}try{const o=new TextEncoder().encode("PLAY_IMMEDIATE"),a=new Uint8Array(o.length+e.length);a.set(o,0),a.set(e,o.length),this.webSocket.send(a);const c=Date.now();if(this.lastSendTime!==0){const d=c-this.lastSendTime;d>100&&this.enableConsoleLogs&&console.log("SIMLI: Time between sends:",d)}this.lastSendTime=c}catch(s){this.enableConsoleLogs&&console.error("SIMLI: Failed to send audio data:",s),this.handleConnectionFailure("Failed to send audio data")}}close(){this.enableConsoleLogs&&console.log("SIMLI: Closing SimliClient connection"),this.webSocket&&this.webSocket.send("DONE"),this.emit("disconnected");try{this.cleanup()}catch(e){this.enableConsoleLogs&&console.error("SIMLI: Error during cleanup:",e)}}isConnected(){var e,t;return this.sessionInitialized&&((e=this.webSocket)===null||e===void 0?void 0:e.readyState)===WebSocket.OPEN&&((t=this.pc)===null||t===void 0?void 0:t.connectionState)==="connected"}getConnectionStatus(){var e,t,i,s;return{sessionInitialized:this.sessionInitialized,webSocketState:(t=(e=this.webSocket)===null||e===void 0?void 0:e.readyState)!==null&&t!==void 0?t:null,peerConnectionState:(s=(i=this.pc)===null||i===void 0?void 0:i.connectionState)!==null&&s!==void 0?s:null,errorReason:this.errorReason}}setupWebSocketListeners(e,t){e.addEventListener("open",async()=>{for(t();!this.localDescription;)await new Promise(i=>setTimeout(i,50));if(await e.send(JSON.stringify(this.localDescription)),!this.session_token||this.session_token===""){const i={faceId:this.faceID,isJPG:!1,apiKey:this.apiKey,syncAudio:!0,handleSilence:this.handleSilence,maxSessionLength:this.maxSessionLength,maxIdleTime:this.maxIdleTime,model:this.model};await this.sendSessionToken((await this.createSessionToken(this.SimliURL,i)).session_token)}else await this.sendSessionToken(this.session_token);this.startDataChannelInterval()}),e.addEventListener("message",async i=>{this.enableConsoleLogs&&console.log("SIMLI: Received message: ",i.data);try{if(i.data==="START")this.sessionInitialized=!0,this.sendAudioData(new Uint8Array(6e3)),this.emit("connected"),console.log("START"),console.log(new Date().getTime());else if(i.data==="STOP")this.close();else if(i.data.startsWith("pong")){const s=this.pingSendTimes.get(i.data.replace("pong","ping"));s&&this.enableConsoleLogs&&console.log("SIMLI: Simli Latency: ",Date.now()-s)}else if(i.data!=="ACK")if(i.data==="SPEAK")this.emit("speaking"),this.isAvatarSpeaking=!0;else if(i.data==="SILENT")this.emit("silent"),this.isAvatarSpeaking=!1;else if(i.data==="MISSING_SESSION_TOKEN")if(!this.session_token||this.session_token===""){const s={faceId:this.faceID,isJPG:!1,apiKey:this.apiKey,syncAudio:!0,handleSilence:this.handleSilence,maxSessionLength:this.maxSessionLength,maxIdleTime:this.maxIdleTime,model:this.model};await this.sendSessionToken((await this.createSessionToken(this.SimliURL,s)).session_token)}else await this.sendSessionToken(this.session_token);else{const s=JSON.parse(i.data);s.type==="answer"&&(this.answer=s)}}catch(s){this.enableConsoleLogs&&console.warn("SIMLI: Error processing WebSocket message:",s)}}),e.addEventListener("error",i=>{this.videoReceived?this.cleanup().then(()=>this.start(this.inputIceServers,this.retryAttempt)).catch(s=>{this.enableConsoleLogs&&console.error("SIMLI: Reconnection failed:",s),this.retryAttempt>=this.MAX_RETRY_ATTEMPTS&&this.emit("failed","Reconnection failed")}):(this.enableConsoleLogs&&console.error("SIMLI: WebSocket error:",i),this.emit("disconnected"),this.handleConnectionFailure("WebSocket error"))}),e.addEventListener("close",()=>{this.enableConsoleLogs&&console.warn("SIMLI: WebSocket closed"),this.emit("disconnected")})}}Vv.SimliClient=Mne;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SimliClient=void 0;var e=Vv;Object.defineProperty(n,"SimliClient",{enumerable:!0,get:function(){return e.SimliClient}})})(oU);const Rne=({video:n,audio:e})=>S.jsxs("div",{className:"w-full h-full relative",children:[S.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),S.jsx("audio",{ref:e,autoPlay:!0})]}),Pne=({className:n=""})=>S.jsxs("svg",{className:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[S.jsx("path",{d:"M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z",fill:"currentColor"}),S.jsx("path",{d:"M19 3L19.5 5.5L22 6L19.5 6.5L19 9L18.5 6.5L16 6L18.5 5.5L19 3Z",fill:"currentColor"}),S.jsx("path",{d:"M19 15L19.5 17.5L22 18L19.5 18.5L19 21L18.5 18.5L16 18L18.5 17.5L19 15Z",fill:"currentColor"})]}),ht=new oU.SimliClient,Ine=({simli_faceid:n="0c2b8b04-5274-41f1-a21c-d5c98322efa9",agentId:e,onStart:t,onClose:i,onSpeakingChange:s,isActive:r=!1})=>{const[o,a]=P.useState(!1),[c,d]=P.useState(!1),[h,f]=P.useState(""),m=P.useRef(null),y=P.useRef(null),v=P.useRef(null),x=P.useRef(null),k=P.useRef(null),C=P.useRef(null),A=P.useRef(null),T=async ae=>{try{const le=await fetch("/api/elevenlabs-signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:ae})});if(!le.ok)throw new Error(`Failed to get signed URL: ${le.status}`);return(await le.json()).signedUrl}catch(le){return console.error("Error getting signed URL:",le),`wss://api.elevenlabs.io/v1/convai/conversation?agent_id=${ae}&api_key=sk_5e0e35096c4390b9e83d1f05fe9578144b20b56188baccfa`}},E=P.useCallback(()=>{if(m.current&&y.current){const ae={apiKey:"your_simli_api_key_here",faceID:n,handleSilence:!0,videoRef:m.current,audioRef:y.current};ht.Initialize(ae),console.log("Simli Client initialized")}},[n]),_=ae=>{const le=atob(ae),K=le.length,ee=new Uint8Array(K);for(let z=0;z<K;z++)ee[z]=le.charCodeAt(z);return ee},R=ae=>{const le=new Int16Array(ae.length);for(let te=0;te<ae.length;te++){const ye=Math.max(-1,Math.min(1,ae[te]));le[te]=Math.floor(ye*32767)}const K=le.buffer,ee=new Uint8Array(K);let z="";const X=8192;for(let te=0;te<ee.length;te+=X){const ye=ee.subarray(te,te+X);z+=String.fromCharCode.apply(null,Array.from(ye))}return btoa(z)},B=ae=>{var le;((le=v.current)==null?void 0:le.readyState)===WebSocket.OPEN&&v.current.send(JSON.stringify({user_audio_chunk:ae}))},I=(ae,le)=>{ae.readyState===WebSocket.OPEN&&ae.send(JSON.stringify(le))},L=async()=>{try{const ae=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});x.current=ae;const le=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});k.current=le;const K=le.createMediaStreamSource(ae);A.current=K;const z=le.createScriptProcessor(4096,1,1);C.current=z;let X=!1;z.onaudioprocess=te=>{if(!(X||!v.current||v.current.readyState!==WebSocket.OPEN)){X=!0;try{const _e=te.inputBuffer.getChannelData(0);if(_e.some(Ye=>Math.abs(Ye)>.01)){const Ye=R(_e);B(Ye)}}catch(ye){console.error("Error processing audio:",ye)}finally{X=!1}}},K.connect(z),z.connect(le.destination),console.log("Voice streaming started with Web Audio API")}catch(ae){throw console.error("Failed to setup voice stream:",ae),ae}},O=()=>{C.current&&(C.current.disconnect(),C.current.onaudioprocess=null,C.current=null),A.current&&(A.current.disconnect(),A.current=null),k.current&&(k.current.close(),k.current=null),x.current&&(x.current.getTracks().forEach(ae=>ae.stop()),x.current=null),console.log("Voice streaming stopped")},W=async()=>{try{const ae=await T(e);console.log("Got ElevenLabs signed URL");const le=new WebSocket(ae);v.current=le,le.onopen=async()=>{console.log("ElevenLabs WebSocket connected"),I(le,{type:"conversation_initiation_client_data",conversation_initiation_client_data:{custom_llm_extra_body:{}}}),await L(),d(!0),a(!1),t==null||t()},le.onmessage=async K=>{const ee=JSON.parse(K.data);if(ee.type==="ping"&&setTimeout(()=>{I(le,{type:"pong",event_id:ee.ping_event.event_id})},ee.ping_event.ping_ms||0),ee.type==="user_transcript"&&console.log("User transcript:",ee.user_transcription_event.user_transcript),ee.type==="agent_response"&&(console.log("Agent response:",ee.agent_response_event.agent_response),s==null||s(!0)),ee.type==="audio"){const{audio_base_64:z}=ee.audio_event,X=_(z);ht&&(ht.sendAudioData(X),console.log("Sent audio data to Simli:",X.length,"bytes"))}ee.type==="interruption"&&(console.log("Conversation interrupted:",ee.interruption_event.reason),s==null||s(!1))},le.onclose=K=>{console.log("ElevenLabs WebSocket disconnected",K.code,K.reason),d(!1),O(),he(),v.current=null,s==null||s(!1)},le.onerror=K=>{console.error("ElevenLabs WebSocket error:",K),f("WebSocket connection failed"),a(!1),s==null||s(!1)}}catch(ae){console.error("Failed to connect to ElevenLabs:",ae),f(`Failed to connect: ${ae}`),a(!1)}},ie=P.useCallback(async()=>{if(!e){f("No agent ID provided");return}E(),ht&&(ht==null||ht.on("connected",()=>{console.log("SimliClient connected");const ae=new Uint8Array(6e3).fill(0);ht==null||ht.sendAudioData(ae),console.log("Sent initial audio data to Simli"),W()}),ht==null||ht.on("disconnected",()=>{console.log("SimliClient disconnected")})),a(!0),f("");try{await(ht==null?void 0:ht.start())}catch(ae){console.error("Error starting interaction:",ae),f(`Error starting interaction: ${ae.message}`),a(!1)}},[e,E]),he=P.useCallback(()=>{console.log("Stopping interaction..."),a(!1),f(""),d(!1),v.current&&(v.current.close(),v.current=null),O(),ht==null||ht.ClearBuffer(),ht==null||ht.close(),i==null||i(),s==null||s(!1),console.log("Interaction stopped")},[i,s]);return P.useEffect(()=>{r&&!c&&!o?ie():!r&&c&&he()},[r,c,o,ie,he]),P.useEffect(()=>()=>{v.current&&v.current.close(),O(),ht==null||ht.close()},[]),S.jsxs("div",{className:"w-full h-full relative",children:[h&&S.jsx("div",{className:"absolute top-4 left-4 right-4 z-10 p-2 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),o&&S.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-black/50",children:S.jsxs("div",{className:"flex flex-col items-center gap-2 text-white",children:[S.jsx(Pne,{className:"h-8 w-8 animate-spin"}),S.jsx("span",{className:"font-bold",children:"Connecting to avatar..."})]})}),S.jsx(Rne,{video:m,audio:y})]})},TS=({onClick:n,disabled:e,children:t,colorClass:i="bg-black text-white",icon:s,className:r=""})=>S.jsxs(ke.button,{whileHover:{x:-2,y:-2},whileTap:{x:2,y:2},onClick:n,disabled:e,className:`
      relative py-4 px-6 rounded-xl font-black text-xl border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]
      flex items-center justify-center gap-3 transition-all
      ${e?"opacity-50 grayscale cursor-not-allowed":`${i} hover:shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]`}
      ${r}
    `,children:[s&&S.jsx(s,{size:24,strokeWidth:3}),t]}),fD=({onClick:n,isActive:e,onIcon:t,offIcon:i})=>S.jsx(ke.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:n,className:`
      w-16 h-16 rounded-full border-[3px] border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]
      flex items-center justify-center transition-colors
      ${e?"bg-white text-black":"bg-[#FF6B6B] text-white"}
    `,children:e?S.jsx(t,{size:24,strokeWidth:3}):S.jsx(i,{size:24,strokeWidth:3})}),Bne=()=>{var B;const n=tp(),t=(B=Oa().state)==null?void 0:B.avatar,[i,s]=P.useState(!1),[r,o]=P.useState(!1),[a,c]=P.useState(!1),[d,h]=P.useState(!1),[f,m]=P.useState(!1),y=P.useRef(null),v=P.useRef(null),x=P.useRef(null),k=P.useRef([]);P.useEffect(()=>{t||n("/dashboard")},[t,n]);const C=async I=>{try{const L="snipz",O="avatar_sessions",W=new FormData;W.append("file",I,`session_${Date.now()}.webm`),W.append("upload_preset",O);const ie=await fetch(`https://api.cloudinary.com/v1_1/${L}/video/upload`,{method:"POST",body:W});if(!ie.ok)throw new Error(`Cloudinary upload failed: ${ie.status}`);const he=await ie.json(),ae=he.secure_url||he.url;console.log("Cloudinary URL:",ae);try{const le=await fetch("https://besotted-mallory-prenebular.ngrok-free.dev/process-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar_id:(t==null?void 0:t.id)??(t==null?void 0:t.agent_id)??"unknown-avatar",video_url:ae})});le.ok||console.error("Backend processing failed:",le.status)}catch(le){console.error("Error calling backend /process-session:",le)}}catch(L){console.error("Error uploading recorded session:",L)}},A=async()=>{try{const I=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});y.current&&(y.current.srcObject=I),v.current=I;try{const L=new MediaRecorder(I,{mimeType:"video/webm;codecs=vp9"});k.current=[],L.ondataavailable=O=>{O.data&&O.data.size>0&&k.current.push(O.data)},L.onstop=async()=>{if(k.current.length>0){const O=new Blob(k.current,{type:"video/webm"});k.current=[],await C(O)}m(!1)},L.start(),x.current=L,m(!0)}catch(L){console.error("Error starting MediaRecorder:",L)}o(!0),c(!0)}catch(I){console.error("Error accessing webcam:",I),alert("Unable to access camera. Please check permissions!")}},T=()=>{x.current&&x.current.state!=="inactive"&&x.current.stop(),v.current&&(v.current.getTracks().forEach(I=>I.stop()),v.current=null),y.current&&(y.current.srcObject=null),o(!1),c(!1)},E=()=>{if(!v.current)return;const I=v.current.getVideoTracks()[0];I&&(I.enabled=!I.enabled,o(I.enabled))},_=()=>{if(!v.current)return;const I=v.current.getAudioTracks()[0];I&&(I.enabled=!I.enabled,c(I.enabled))},R=async()=>{i?(T(),s(!1)):(await A(),s(!0))};return P.useEffect(()=>{i&&v.current&&y.current&&(y.current.srcObject=v.current)},[i]),P.useEffect(()=>()=>T(),[]),t?S.jsx(nd,{children:S.jsx("div",{className:"min-h-screen bg-[#4D96FF] font-sans selection:bg-black selection:text-white pb-24",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px",backgroundColor:"#4D96FF"},children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[S.jsxs(ke.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,type:"spring",bounce:.4},className:"mb-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[S.jsx("div",{className:"flex items-center gap-4",children:S.jsx(TS,{onClick:()=>n("/dashboard"),colorClass:"bg-white text-black",icon:Pf,className:"w-auto",children:"Back"})}),S.jsxs("div",{className:"text-right",children:[S.jsxs("h1",{className:"text-5xl font-black text-white drop-shadow-[4px_4px_0px_rgba(0,0,0,1)] uppercase tracking-tight",style:{WebkitTextStroke:"2px black"},children:["Chat with ",t.name]}),S.jsx("p",{className:"text-xl font-black text-black uppercase mt-1",children:"Let's have some fun! "})]})]}),S.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-start",children:[S.jsxs("div",{className:"space-y-8",children:[S.jsxs(ke.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"relative bg-[#FFD93D] p-4 rounded-[40px] border-[4px] border-black shadow-[12px_12px_0px_0px_rgba(0,0,0,1)]",children:[S.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 w-32 h-12 border-l-[4px] border-r-[4px] border-black border-t-0 opacity-0 md:opacity-100 rotate-12"}),S.jsxs("div",{className:"bg-white border-[3px] border-black rounded-[30px] overflow-hidden aspect-square relative shadow-[inset_0px_0px_20px_rgba(0,0,0,0.1)]",children:[i?S.jsx(Ine,{agentId:t.agent_id,simli_faceid:t.simli_face_id||"0c2b8b04-5274-41f1-a21c-d5c98322efa9",isActive:i,onSpeakingChange:h,onStart:()=>console.log("Simli avatar started"),onClose:()=>console.log("Simli avatar closed")}):S.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}),i&&S.jsxs("div",{className:"absolute top-4 right-4 bg-red-500 text-white px-3 py-1 rounded-full border-2 border-white shadow-md flex items-center gap-2 animate-pulse",children:[S.jsx("div",{className:"w-3 h-3 bg-white rounded-full"}),S.jsx("span",{className:"font-black text-xs uppercase",children:"Live"})]})]}),S.jsxs("div",{className:"mt-4 flex justify-between items-center px-4",children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsx("div",{className:"w-4 h-4 rounded-full bg-black"}),S.jsx("div",{className:"w-4 h-4 rounded-full bg-black/50"}),S.jsx("div",{className:"w-4 h-4 rounded-full bg-black/50"})]}),S.jsx("div",{className:"h-2 w-32 bg-black/10 rounded-full"})]})]}),S.jsxs(ke.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-[#A29BFE] border-[3px] border-black rounded-3xl p-6 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] rotate-[-1deg]",children:[S.jsxs("h3",{className:"text-2xl font-black text-black mb-2 uppercase flex items-center gap-2",children:[S.jsx(hq,{size:24})," About ",t.name]}),S.jsx("p",{className:"font-bold text-black/80 text-lg leading-snug",children:t.system_prompt})]})]}),S.jsxs("div",{className:"space-y-6",children:[!i&&S.jsxs(ke.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.4,type:"spring",bounce:.6},className:"flex flex-col items-center justify-center min-h-[400px] bg-white/50 rounded-[40px] border-[4px] border-black border-dashed p-8",children:[S.jsx(ke.div,{animate:{scale:[1,1.05,1],rotate:[0,2,-2,0]},transition:{duration:2,repeat:1/0},className:"w-full",children:S.jsxs(TS,{onClick:R,colorClass:"bg-[#6BCB77] text-white",className:"text-3xl py-8 w-full shadow-[8px_8px_0px_0px_black] hover:shadow-[12px_12px_0px_0px_black]",children:[S.jsx(sk,{size:40,strokeWidth:3,className:"mr-4"}),"START TALKING"]})}),S.jsx("p",{className:"font-black text-black/60 text-xl mt-6 uppercase text-center",children:"Click the Green Button to start your conversation!"})]}),i&&S.jsxs(ke.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[S.jsxs("div",{className:"relative rounded-[30px] overflow-hidden bg-black border-[4px] border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]",children:[S.jsxs("div",{className:"aspect-video relative bg-slate-800",children:[S.jsx("video",{ref:y,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover scale-x-[-1]"}),!r&&S.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#2d3436] text-white/50 gap-2",children:[S.jsx(MP,{className:"w-16 h-16",strokeWidth:1.5}),S.jsx("span",{className:"font-black uppercase",children:"Camera Off"})]})]}),S.jsxs("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center gap-6",children:[S.jsx(fD,{onClick:E,isActive:r,onIcon:Rq,offIcon:MP}),S.jsx(fD,{onClick:_,isActive:a,onIcon:sk,offIcon:l3})]})]}),S.jsxs("div",{className:"bg-white border-[3px] border-black rounded-3xl p-6 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]",children:[S.jsxs("div",{className:"flex items-center gap-2 mb-4 border-b-2 border-black/10 pb-2",children:[S.jsx(a3,{size:20}),S.jsx("span",{className:"font-black uppercase text-sm",children:"Conversation Log"})]}),S.jsx("div",{className:"min-h-[100px]",children:S.jsx(J2,{agentId:t.agent_id,onSpeakingChange:h})})]}),S.jsx(TS,{onClick:R,colorClass:"bg-[#FF6B6B] text-white",icon:LT,children:"END CONVERSATION"})]})]})]})]})})}):null},pD=["bg-[#FFD93D]","bg-[#FF6B6B]","bg-[#A29BFE]","bg-[#6BCB77]","bg-[#FF9F43]"],Dne=n=>pD[n%pD.length],aU=n=>{const e=(n==null?void 0:n.toLowerCase())||"";return e.includes("happy")||e.includes("excited")?S.jsx(OT,{className:"w-6 h-6"}):e.includes("sad")||e.includes("anxious")||e.includes("frustrated")?S.jsx(VK,{className:"w-6 h-6"}):S.jsx(YK,{className:"w-6 h-6"})},qk=n=>{const e=(n==null?void 0:n.toLowerCase())||"";return e.includes("happy")||e.includes("excited")||e.includes("calm")?"bg-[#6BCB77]":e.includes("sad")||e.includes("anxious")?"bg-[#FF6B6B]":e.includes("frustrated")||e.includes("confused")?"bg-[#FF9F43]":"bg-[#A29BFE]"},Nne=async()=>(await ut.get("/api/sessions")).data.sessions,Fne=({onClick:n,children:e,className:t="",color:i="bg-white"})=>S.jsx(ke.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:n,className:`
      ${i} ${t}
      relative border-[3px] border-black rounded-[20px] p-4
      shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]
      cursor-pointer transition-all duration-200 hover:shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]
    `,children:e}),One=({session:n,onClose:e})=>{var c,d,h;const t=(n==null?void 0:n.emotion_report)||{},i=n==null?void 0:n.avatars,s=t.emotion_timeline||[],r=t.mental_status_report||{},o=t.recommendations||{},a=t.emotion_distribution||{};return S.jsx(ke.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e,children:S.jsxs(ke.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:f=>f.stopPropagation(),className:`bg-white border-[3px] border-black rounded-[30px] shadow-[10px_10px_0px_0px_black] \r
                   w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col`,children:[S.jsxs("div",{className:"bg-[#4D96FF] border-b-[3px] border-black p-6 flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[(i==null?void 0:i.image_url)&&S.jsx("img",{src:i.image_url,alt:i.name,className:"w-14 h-14 rounded-xl border-[3px] border-black object-cover"}),S.jsxs("div",{children:[S.jsxs("h2",{className:"text-2xl font-black text-white",children:[(i==null?void 0:i.name)||"Session"," Report"]}),S.jsx("p",{className:"text-white/80 font-bold text-sm",children:new Date(n==null?void 0:n.created_at).toLocaleString()})]})]}),S.jsx("button",{onClick:e,className:"bg-white p-2 rounded-xl border-[3px] border-black shadow-[3px_3px_0px_0px_black] hover:bg-[#FF6B6B] hover:text-white transition-colors",children:S.jsx(LT,{size:24,strokeWidth:3})})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[S.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[S.jsxs("div",{className:`${qk(t.dominant_emotion)} p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]`,children:[S.jsx("p",{className:"text-xs font-bold uppercase opacity-70",children:"Dominant Emotion"}),S.jsxs("p",{className:"text-xl font-black flex items-center gap-2",children:[aU(t.dominant_emotion),t.dominant_emotion||"N/A"]})]}),S.jsxs("div",{className:"bg-[#FFD93D] p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsx("p",{className:"text-xs font-bold uppercase opacity-70",children:"Confidence"}),S.jsxs("p",{className:"text-xl font-black",children:[t.confidence_score||0,"%"]})]}),S.jsxs("div",{className:"bg-[#A29BFE] p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsx("p",{className:"text-xs font-bold uppercase opacity-70",children:"Engagement"}),S.jsx("p",{className:"text-xl font-black",children:t.overall_engagement||"N/A"})]}),S.jsxs("div",{className:"bg-white p-4 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsx("p",{className:"text-xs font-bold uppercase opacity-70",children:"Mood Stability"}),S.jsx("p",{className:"text-xl font-black",children:r.mood_stability||"N/A"})]})]}),(n==null?void 0:n.video_url)&&S.jsx("div",{className:"bg-black rounded-xl border-[3px] border-black overflow-hidden",children:S.jsx("video",{src:n.video_url,controls:!0,className:"w-full max-h-[300px]"})}),t.session_summary&&S.jsxs("div",{className:"bg-[#E8F4FD] p-5 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsxs("h3",{className:"font-black text-lg mb-2 flex items-center gap-2",children:[S.jsx(NK,{size:20})," Session Summary"]}),S.jsx("p",{className:"font-medium text-gray-800",children:t.session_summary})]}),s.length>0&&S.jsxs("div",{className:"bg-white p-5 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsxs("h3",{className:"font-black text-lg mb-4 flex items-center gap-2",children:[S.jsx(kv,{size:20})," Emotion Timeline"]}),S.jsx("div",{className:"space-y-3 max-h-[250px] overflow-y-auto pr-2",children:s.map((f,m)=>S.jsxs("div",{className:"flex gap-3 items-start p-3 bg-gray-50 rounded-lg border-2 border-gray-200",children:[S.jsx("span",{className:"bg-[#4D96FF] text-white px-2 py-1 rounded-lg font-bold text-sm min-w-[60px] text-center",children:f.timestamp}),S.jsxs("div",{className:"flex-1",children:[S.jsxs("p",{className:"font-bold text-sm",children:[f.detected_emotion,S.jsxs("span",{className:"text-xs font-medium text-gray-500 ml-2",children:["(",f.intensity,")"]})]}),S.jsx("p",{className:"text-xs text-gray-600",children:f.facial_expression}),S.jsxs("p",{className:"text-xs text-gray-500 italic mt-1",children:[" ",f.possible_trigger]})]})]},m))})]}),Object.keys(a).length>0&&S.jsxs("div",{className:"bg-white p-5 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsxs("h3",{className:"font-black text-lg mb-4 flex items-center gap-2",children:[S.jsx(kq,{size:20})," Emotion Distribution"]}),S.jsx("div",{className:"space-y-2",children:Object.entries(a).map(([f,m])=>S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("span",{className:"w-24 font-bold capitalize text-sm",children:f}),S.jsx("div",{className:"flex-1 h-6 bg-gray-200 rounded-full border-2 border-black overflow-hidden",children:S.jsx("div",{className:`h-full ${qk(f)} transition-all duration-500`,style:{width:`${m}%`}})}),S.jsxs("span",{className:"font-bold text-sm w-12 text-right",children:[m,"%"]})]},f))})]}),r.overall_assessment&&S.jsxs("div",{className:"bg-[#FFF4E6] p-5 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsxs("h3",{className:"font-black text-lg mb-3 flex items-center gap-2",children:[S.jsx(ed,{size:20})," Mental Status Assessment"]}),S.jsx("p",{className:"font-medium text-gray-800 mb-4",children:r.overall_assessment}),S.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[((c=r.positive_indicators)==null?void 0:c.length)>0&&S.jsxs("div",{children:[S.jsxs("p",{className:"font-bold text-sm text-green-700 mb-2 flex items-center gap-1",children:[S.jsx(jK,{size:16})," Positive Indicators"]}),S.jsx("ul",{className:"text-sm space-y-1",children:r.positive_indicators.map((f,m)=>S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-green-500",children:""})," ",f]},m))})]}),((d=r.areas_of_concern)==null?void 0:d.length)>0&&S.jsxs("div",{children:[S.jsxs("p",{className:"font-bold text-sm text-orange-700 mb-2 flex items-center gap-1",children:[S.jsx(rk,{size:16})," Areas of Concern"]}),S.jsx("ul",{className:"text-sm space-y-1",children:r.areas_of_concern.map((f,m)=>S.jsxs("li",{className:"flex items-start gap-2",children:[S.jsx("span",{className:"text-orange-500",children:""})," ",f]},m))})]})]})]}),o.for_caregiver&&S.jsxs("div",{className:"bg-[#E8FFE8] p-5 rounded-xl border-[3px] border-black shadow-[4px_4px_0px_0px_black]",children:[S.jsxs("h3",{className:"font-black text-lg mb-3 flex items-center gap-2",children:[S.jsx(d3,{size:20})," Recommendations for Caregiver"]}),S.jsx("p",{className:"font-medium text-gray-800 mb-3",children:o.for_caregiver}),((h=o.suggested_activities)==null?void 0:h.length)>0&&S.jsxs("div",{className:"mt-3",children:[S.jsx("p",{className:"font-bold text-sm mb-2",children:"Suggested Activities:"}),S.jsx("div",{className:"flex flex-wrap gap-2",children:o.suggested_activities.map((f,m)=>S.jsx("span",{className:"bg-white px-3 py-1 rounded-full border-2 border-black text-sm font-medium",children:f},m))})]}),o.follow_up_notes&&S.jsxs("p",{className:"mt-3 text-sm text-gray-600 italic",children:[" ",o.follow_up_notes]})]})]})]})})},Lne=()=>{const n=tp(),[e,t]=P.useState(null),{data:i=[],isLoading:s}=XF({queryKey:["sessions"],queryFn:Nne});return s?S.jsx(nd,{children:S.jsx("div",{className:"min-h-screen bg-[#4D96FF] flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px"},children:S.jsx("div",{className:"bg-white p-8 rounded-3xl border-[3px] border-black shadow-[8px_8px_0px_0px_black]",children:S.jsx(O3,{text:"LOADING SESSIONS..."})})})}):S.jsxs(nd,{children:[S.jsx("div",{className:"min-h-screen bg-[#4D96FF] font-sans pb-24",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px"},children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[S.jsx("div",{className:"flex justify-between items-center mb-8",children:S.jsxs(ke.button,{whileHover:{x:-2,y:-2,boxShadow:"4px 4px 0px 0px black"},whileTap:{x:0,y:0,boxShadow:"0px 0px 0px 0px black"},onClick:()=>n("/dashboard"),className:"bg-white px-5 py-3 rounded-xl border-[3px] border-black shadow-[2px_2px_0px_0px_black] flex items-center gap-2 group transition-all",children:[S.jsx("div",{className:"bg-black text-white p-1 rounded-md group-hover:bg-[#FF6B6B] transition-colors",children:S.jsx(Pf,{size:20,strokeWidth:3})}),S.jsx("span",{className:"font-black text-black text-sm uppercase tracking-wide hidden sm:block",children:"Back to Dashboard"})]})}),S.jsxs(ke.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},className:"text-center mb-12",children:[S.jsx("h1",{className:"text-5xl md:text-6xl font-black text-white drop-shadow-[4px_4px_0px_rgba(0,0,0,1)]",children:"SESSION HISTORY"}),S.jsx("p",{className:"mt-4 text-xl font-bold text-white/90",children:"Review past interactions and emotion reports"})]}),i.length===0?S.jsxs("div",{className:"bg-white p-12 rounded-3xl border-[3px] border-black shadow-[8px_8px_0px_0px_black] text-center",children:[S.jsx(kv,{size:64,className:"mx-auto mb-4 text-gray-400"}),S.jsx("h3",{className:"text-2xl font-black mb-2",children:"No Sessions Yet"}),S.jsx("p",{className:"text-gray-600",children:"Start chatting with an avatar to create session recordings!"})]}):S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((r,o)=>{const a=r.emotion_report||{},c=r.avatars;return S.jsxs(Fne,{color:Dne(o),onClick:()=>t(r),children:[S.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c!=null&&c.image_url?S.jsx("img",{src:c.image_url,alt:c.name,className:"w-12 h-12 rounded-xl border-[3px] border-black object-cover"}):S.jsx("div",{className:"w-12 h-12 rounded-xl border-[3px] border-black bg-white flex items-center justify-center",children:S.jsx(d3,{size:24})}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-black text-lg",children:(c==null?void 0:c.name)||"Unknown Avatar"}),S.jsxs("p",{className:"text-xs font-bold opacity-70 flex items-center gap-1",children:[S.jsx(o3,{size:12}),new Date(r.created_at).toLocaleDateString()]})]})]}),S.jsxs("div",{className:"bg-white/80 rounded-xl p-3 border-2 border-black mb-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("span",{className:"text-sm font-bold",children:"Dominant Emotion"}),S.jsxs("span",{className:`${qk(a.dominant_emotion)} px-2 py-1 rounded-lg text-xs font-black border-2 border-black flex items-center gap-1`,children:[aU(a.dominant_emotion),a.dominant_emotion||"N/A"]})]}),a.confidence_score&&S.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[S.jsx("span",{className:"text-xs font-medium",children:"Confidence:"}),S.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:S.jsx("div",{className:"h-full bg-[#4D96FF]",style:{width:`${a.confidence_score}%`}})}),S.jsxs("span",{className:"text-xs font-bold",children:[a.confidence_score,"%"]})]})]}),S.jsxs("button",{className:"w-full bg-black text-white py-3 rounded-xl font-black flex items-center justify-center gap-2 hover:bg-[#333] transition-colors",children:[S.jsx(FT,{size:18})," View Full Report"]})]},r.id)})})]})}),S.jsx(BT,{children:e&&S.jsx(One,{session:e,onClose:()=>t(null)})})]})},jne=()=>{const[n,e]=P.useState(!1),[t,i]=P.useState("Tap the green button to talk with your family..."),[s,r]=P.useState(!1);P.useEffect(()=>{if(n){const c=["Hello! How are you feeling today?","I hope you had a good breakfast...","The weather looks lovely outside.","Would you like to hear about your grandchildren?"];let d=0;const h=setInterval(()=>{i(c[d%c.length]),d++},3e3);return()=>clearInterval(h)}},[n]);const o=()=>{e(!n),i(n?"Tap the green button to talk with your family...":"Listening...")},a=()=>{r(!0),i(" Emergency alert sent! Help is on the way..."),setTimeout(()=>r(!1),5e3)};return S.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-amber-50 to-orange-50 flex flex-col relative overflow-hidden",children:[S.jsxs("div",{className:"absolute inset-0 opacity-5",children:[S.jsx("div",{className:"absolute top-10 left-10 w-32 h-32 rounded-full bg-sage-500"}),S.jsx("div",{className:"absolute bottom-20 right-10 w-48 h-48 rounded-full bg-amber-400"}),S.jsx("div",{className:"absolute top-1/3 right-1/4 w-24 h-24 rounded-full bg-orange-300"})]}),S.jsxs("div",{className:"absolute top-6 right-6 z-20",children:[S.jsx("button",{onClick:a,className:`
            w-16 h-16 md:w-20 md:h-20 rounded-2xl 
            bg-gradient-to-br from-red-500 to-red-600 
            shadow-lg shadow-red-200
            flex items-center justify-center
            transition-all duration-300
            hover:scale-105 hover:shadow-xl hover:shadow-red-300
            active:scale-95
            ${s?"animate-pulse ring-4 ring-red-300":""}
          `,"aria-label":"Emergency Call",children:S.jsx(aq,{className:"w-8 h-8 md:w-10 md:h-10 text-white",strokeWidth:2.5})}),S.jsx("p",{className:"text-center text-red-600 font-bold text-sm mt-2",children:"EMERGENCY"})]}),S.jsxs("header",{className:"pt-8 pb-4 px-6 text-center relative z-10",children:[S.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[S.jsx(ed,{className:"w-8 h-8 text-rose-400",fill:"currentColor"}),S.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800",children:"CareChain"})]}),S.jsx("p",{className:"text-xl md:text-2xl text-gray-600 font-medium",children:"Your Family is Here"})]}),S.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center px-6 pb-8 relative z-10",children:[S.jsxs("div",{className:"relative mb-8",children:[S.jsx("div",{className:`
              absolute inset-0 rounded-full 
              bg-gradient-to-r from-emerald-200 to-teal-200
              ${n?"animate-breathe-outer":"opacity-30"}
            `,style:{transform:"scale(1.3)"}}),S.jsx("div",{className:`
              absolute inset-0 rounded-full 
              bg-gradient-to-r from-emerald-300 to-teal-300
              ${n?"animate-breathe-middle":"opacity-40"}
            `,style:{transform:"scale(1.15)"}}),S.jsxs("div",{className:`
              relative w-56 h-56 md:w-72 md:h-72 lg:w-80 lg:h-80
              rounded-full 
              bg-gradient-to-br from-emerald-100 to-teal-100
              border-4 border-white
              shadow-2xl
              flex items-center justify-center
              overflow-hidden
              transition-all duration-500
              ${n?"ring-4 ring-emerald-300 ring-opacity-60":""}
            `,children:[S.jsx("div",{className:"w-full h-full bg-gradient-to-br from-emerald-50 to-teal-50 flex items-center justify-center",children:S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"w-32 h-32 md:w-40 md:h-40 mx-auto rounded-full bg-gradient-to-br from-amber-200 to-orange-200 flex items-center justify-center mb-4 shadow-inner",children:S.jsx("span",{className:"text-6xl md:text-7xl",children:""})}),S.jsx("p",{className:"text-lg md:text-xl font-semibold text-gray-700",children:n?"Listening...":"Family Avatar"})]})}),n&&S.jsx("div",{className:"absolute bottom-4 right-4 w-6 h-6 bg-emerald-500 rounded-full animate-pulse shadow-lg shadow-emerald-300"})]})]}),S.jsx("div",{className:`
            w-full max-w-lg mx-auto
            bg-white/80 backdrop-blur-sm
            rounded-3xl
            p-6 md:p-8
            shadow-lg
            border-2 border-emerald-100
            transition-all duration-300
            ${s?"border-red-300 bg-red-50/80":""}
          `,children:S.jsx("p",{className:`
              text-center
              text-xl md:text-2xl lg:text-3xl
              font-medium
              leading-relaxed
              ${s?"text-red-700":"text-gray-800"}
            `,children:t})})]}),S.jsxs("footer",{className:"pb-10 pt-4 px-6 relative z-10",children:[S.jsx("div",{className:"flex justify-center",children:S.jsx("button",{onClick:o,className:`
              w-20 h-20 md:w-24 md:h-24
              rounded-full
              flex items-center justify-center
              transition-all duration-300
              shadow-xl
              ${n?"bg-gradient-to-br from-emerald-500 to-teal-600 shadow-emerald-300 scale-110 animate-pulse-slow":"bg-gradient-to-br from-emerald-400 to-teal-500 shadow-emerald-200 hover:scale-105"}
              active:scale-95
            `,"aria-label":n?"Stop listening":"Start talking",children:n?S.jsx(l3,{className:"w-10 h-10 md:w-12 md:h-12 text-white",strokeWidth:2.5}):S.jsx(sk,{className:"w-10 h-10 md:w-12 md:h-12 text-white",strokeWidth:2.5})})}),S.jsx("p",{className:"text-center text-gray-600 font-semibold text-lg md:text-xl mt-4",children:n?"Tap to Stop":"Tap to Talk"})]}),S.jsx("style",{children:`
        @keyframes breathe-outer {
          0%, 100% {
            transform: scale(1.3);
            opacity: 0.2;
          }
          50% {
            transform: scale(1.4);
            opacity: 0.4;
          }
        }

        @keyframes breathe-middle {
          0%, 100% {
            transform: scale(1.15);
            opacity: 0.3;
          }
          50% {
            transform: scale(1.25);
            opacity: 0.5;
          }
        }

        @keyframes pulse-slow {
          0%, 100% {
            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
          }
          50% {
            box-shadow: 0 0 0 20px rgba(16, 185, 129, 0);
          }
        }

        .animate-breathe-outer {
          animation: breathe-outer 3s ease-in-out infinite;
        }

        .animate-breathe-middle {
          animation: breathe-middle 3s ease-in-out infinite 0.5s;
        }

        .animate-pulse-slow {
          animation: pulse-slow 2s ease-in-out infinite;
        }
      `})]})},Th=({children:n,className:e="",color:t="bg-white",noShadow:i=!1})=>S.jsx("div",{className:`
    ${t} ${e}
    border-[3px] border-black rounded-[20px]
    ${i?"":"shadow-[6px_6px_0px_0px_black]"}
  `,children:n}),Une=()=>{const[n,e]=P.useState(new Date),[t,i]=P.useState(!1),[s,r]=P.useState("map");P.useEffect(()=>{const m=setInterval(()=>e(new Date),1e3);return()=>clearInterval(m)},[]);const o=m=>m.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),a=m=>m.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),c=[{id:"map",icon:$K,label:"Live Map"},{id:"alerts",icon:rk,label:"Alerts"},{id:"community",icon:ed,label:"Community"},{id:"settings",icon:gq,label:"Config"}],d=[{id:1,ward:"Ward 7",type:"Voice Activity Drop",detail:"40% drop (Mrs. Sharma)",status:"NGO Notified",severity:"critical",time:"2 min ago"},{id:2,ward:"Ward 12",type:"Missed Check-in",detail:"No response (Mr. Patel)",status:"Family Contacted",severity:"critical",time:"15 min ago"},{id:3,ward:"Ward 3",type:"Isolation Score",detail:"Score up 25% (Mrs. Gupta)",status:"Volunteer Assigned",severity:"warning",time:"32 min ago"},{id:4,ward:"Ward 9",type:"Sentiment Shift",detail:"Negative sentiment (Mr. Singh)",status:"Monitoring",severity:"warning",time:"1 hour ago"},{id:5,ward:"Ward 5",type:"Routine Check",detail:"Wellness call (Mrs. Das)",status:"Resolved",severity:"normal",time:"2 hours ago"},{id:6,ward:"Ward 2",type:"New Registration",detail:"Onboarded (Mr. Kumar)",status:"Active",severity:"normal",time:"3 hours ago"}],h=[{x:15,y:25,status:"critical",label:"Ward 7"},{x:35,y:40,status:"warning",label:"Ward 12"},{x:55,y:20,status:"normal",label:"Ward 3"},{x:75,y:55,status:"normal",label:"Ward 5"},{x:25,y:65,status:"warning",label:"Ward 9"},{x:60,y:70,status:"normal",label:"Ward 2"},{x:85,y:30,status:"normal",label:"Ward 8"},{x:45,y:85,status:"critical",label:"Ward 11"},{x:20,y:45,status:"normal",label:"Ward 4"},{x:70,y:40,status:"warning",label:"Ward 6"}],f=m=>{switch(m){case"critical":return"bg-[#FF6B6B]";case"warning":return"bg-[#FF9F43]";case"normal":return"bg-[#6BCB77]";default:return"bg-gray-400"}};return S.jsxs("div",{className:"min-h-screen font-sans text-black flex overflow-hidden bg-[#4D96FF]",style:{backgroundImage:"radial-gradient(circle, #ffffff 10%, transparent 10%)",backgroundSize:"30px 30px"},children:[S.jsx(BT,{children:t&&S.jsx(ke.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40 lg:hidden backdrop-blur-sm",onClick:()=>i(!1)})}),S.jsxs("aside",{className:`
                    fixed lg:static inset-y-0 left-0 z-50
                    w-72 bg-[#FFD93D] border-r-[3px] border-black
                    transform transition-transform duration-300 shadow-[6px_0px_0px_0px_rgba(0,0,0,0.2)]
                    ${t?"translate-x-0":"-translate-x-full lg:translate-x-0"}
                    flex flex-col
                `,children:[S.jsx("div",{className:"p-6 border-b-[3px] border-black bg-[#FFD93D]",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-12 h-12 rounded-xl bg-white border-[3px] border-black flex items-center justify-center shadow-sm",children:S.jsx(c3,{className:"w-7 h-7 text-black",strokeWidth:2.5})}),S.jsxs("div",{children:[S.jsx("h1",{className:"font-black text-xl tracking-tight",children:"CareChain"}),S.jsx("p",{className:"text-xs font-bold uppercase tracking-wider opacity-70",children:"Admin HQ"})]})]}),S.jsx("button",{className:"lg:hidden text-black hover:scale-110 transition-transform",onClick:()=>i(!1),children:S.jsx(LT,{className:"w-8 h-8",strokeWidth:3})})]})}),S.jsx("nav",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:c.map(m=>S.jsxs(ke.button,{whileHover:{x:5},whileTap:{scale:.95},onClick:()=>r(m.id),className:`
                                w-full flex items-center gap-3 px-4 py-4 rounded-xl border-[3px] border-black
                                transition-all duration-200 font-bold text-lg
                                ${s===m.id?"bg-white shadow-[4px_4px_0px_0px_black]":"bg-[#FFD93D] border-transparent hover:bg-white hover:border-black"}
                            `,children:[S.jsx(m.icon,{className:"w-6 h-6",strokeWidth:2.5}),S.jsx("span",{children:m.label}),m.id==="alerts"&&S.jsx("span",{className:"ml-auto bg-[#FF6B6B] text-white border-2 border-black text-xs font-black px-2 py-1 rounded-full",children:"3"})]},m.id))}),S.jsx("div",{className:"p-6 border-t-[3px] border-black bg-[#fff4c2]",children:S.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-white border-[3px] border-black shadow-[3px_3px_0px_0px_black]",children:[S.jsx("div",{className:"w-10 h-10 rounded-full bg-[#A29BFE] border-2 border-black flex items-center justify-center",children:S.jsx("span",{className:"text-sm font-black",children:"AD"})}),S.jsxs("div",{className:"flex-1",children:[S.jsx("p",{className:"font-bold text-sm leading-tight",children:"Admin User"}),S.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Super Admin"})]})]})})]}),S.jsxs("div",{className:"flex-1 flex flex-col min-h-screen overflow-hidden",children:[S.jsx("header",{className:"bg-white border-b-[3px] border-black px-4 lg:px-8 py-4 sticky top-0 z-30 shadow-md",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("button",{className:"lg:hidden p-2 border-2 border-black rounded-lg bg-[#FFD93D] shadow-[3px_3px_0px_0px_black]",onClick:()=>i(!0),children:S.jsx(eq,{className:"w-6 h-6",strokeWidth:2.5})}),S.jsxs("div",{children:[S.jsx("h1",{className:"text-xl lg:text-3xl font-black uppercase italic tracking-tighter",style:{WebkitTextStroke:"1px black",color:"#4D96FF"},children:"Social Immune System"}),S.jsx("p",{className:"text-sm font-bold text-black hidden sm:block bg-black text-white inline-block px-2 transform -rotate-1",children:"Real-time Elder Wellness Monitoring"})]})]}),S.jsxs("div",{className:"flex items-center gap-4 lg:gap-6",children:[S.jsxs("div",{className:"hidden md:flex items-center gap-2 px-4 py-2 rounded-full bg-black text-[#6BCB77] border-[3px] border-[#6BCB77]",children:[S.jsx("span",{className:"w-3 h-3 rounded-full bg-[#6BCB77] animate-pulse"}),S.jsx("span",{className:"font-black text-sm uppercase",children:"System Online"})]}),S.jsxs("div",{className:"text-right hidden sm:block bg-[#E0E0E0] p-2 rounded-lg border-2 border-black font-mono",children:[S.jsxs("div",{className:"flex items-center gap-2 text-black leading-none",children:[S.jsx(o3,{className:"w-4 h-4"}),S.jsx("span",{className:"text-lg font-bold",children:o(n)})]}),S.jsx("p",{className:"text-xs font-bold text-gray-600 mt-1",children:a(n)})]}),S.jsxs(ke.button,{whileTap:{scale:.9},className:"relative p-3 rounded-xl bg-white border-[3px] border-black hover:bg-gray-50 transition-colors shadow-[4px_4px_0px_0px_black]",children:[S.jsx(BK,{className:"w-6 h-6 text-black",strokeWidth:2.5}),S.jsx("span",{className:"absolute -top-2 -right-2 w-6 h-6 bg-[#FF6B6B] border-2 border-black rounded-full flex items-center justify-center text-xs font-black text-white",children:"3"})]})]})]})}),S.jsx("main",{className:"flex-1 p-4 lg:p-8 overflow-y-auto",children:S.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-8",children:[S.jsxs("div",{className:"xl:col-span-3 space-y-8",children:[S.jsxs(Th,{className:"overflow-hidden",children:[S.jsxs("div",{className:"px-6 py-4 border-b-[3px] border-black bg-[#A29BFE] flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"w-10 h-10 rounded-lg bg-black text-white flex items-center justify-center",children:S.jsx(qK,{className:"w-6 h-6"})}),S.jsxs("div",{children:[S.jsx("h2",{className:"font-black text-xl text-black uppercase",children:"Community Heatmap"}),S.jsx("p",{className:"text-sm font-bold text-black/70",children:"Real-time Ward Status"})]})]}),S.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs font-bold uppercase bg-white/50 p-2 rounded-lg border-2 border-black",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-3 h-3 rounded-full bg-[#FF6B6B] border border-black"}),S.jsx("span",{children:"Critical"})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-3 h-3 rounded-full bg-[#FF9F43] border border-black"}),S.jsx("span",{children:"Warning"})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-3 h-3 rounded-full bg-[#6BCB77] border border-black"}),S.jsx("span",{children:"Normal"})]})]})]}),S.jsxs("div",{className:"relative h-64 sm:h-80 lg:h-96 bg-white",children:[S.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"linear-gradient(#e5e7eb 2px, transparent 2px), linear-gradient(90deg, #e5e7eb 2px, transparent 2px)",backgroundSize:"40px 40px"}}),h.map((m,y)=>S.jsxs(ke.div,{initial:{scale:0},animate:{scale:1},transition:{delay:y*.1,type:"spring"},className:"absolute transform -translate-x-1/2 -translate-y-1/2 group cursor-pointer z-10",style:{left:`${m.x}%`,top:`${m.y}%`},children:[m.status==="critical"&&S.jsx("div",{className:`absolute inset-0 rounded-full animate-ping opacity-75 ${f(m.status)}`}),S.jsx("div",{className:`
                                                relative w-8 h-8 rounded-full ${f(m.status)}
                                                flex items-center justify-center
                                                border-[3px] border-black shadow-md
                                                transition-transform duration-200 group-hover:scale-125
                                            `,children:S.jsx("div",{className:"w-2 h-2 rounded-full bg-black"})}),S.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-3 py-1 bg-black text-white border-2 border-white rounded-lg text-sm font-bold whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-20",children:m.label})]},y)),S.jsx("div",{className:"absolute bottom-4 left-4 px-4 py-2 bg-white border-[3px] border-black rounded-lg shadow-[4px_4px_0px_0px_black]",children:S.jsx("span",{className:"font-black text-sm uppercase",children:" National View"})})]})]}),S.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[S.jsxs(Th,{color:"bg-[#FFD93D]",className:"p-6 relative",children:[S.jsx("div",{className:"absolute top-4 right-4 opacity-20",children:S.jsx(Eq,{size:64,color:"black"})}),S.jsx("p",{className:"text-sm font-black uppercase mb-2",children:"Total Monitored"}),S.jsx("p",{className:"text-5xl font-black text-black",children:"12.8k"}),S.jsxs("p",{className:"text-sm font-bold mt-2 flex items-center gap-1",children:[S.jsx(_P,{className:"w-4 h-4 rotate-180"}),"+142 this week"]})]}),S.jsxs(Th,{color:"bg-[#FF6B6B]",className:"p-6 text-white relative",children:[S.jsx("div",{className:"absolute top-4 right-4 opacity-20",children:S.jsx(rk,{size:64,color:"black"})}),S.jsx("p",{className:"text-sm font-black uppercase mb-2 text-black",children:"Critical Alerts"}),S.jsx("p",{className:"text-5xl font-black text-white drop-shadow-[2px_2px_0px_black]",style:{WebkitTextStroke:"2px black"},children:"23"}),S.jsxs("p",{className:"text-sm font-bold mt-2 flex items-center gap-1 text-black bg-white/50 inline-block px-2 rounded",children:[S.jsx(kv,{className:"w-4 h-4"}),"8 pending"]})]}),S.jsxs(Th,{color:"bg-[#6BCB77]",className:"p-6 relative",children:[S.jsx("div",{className:"absolute top-4 right-4 opacity-20",children:S.jsx(ed,{size:64,color:"black"})}),S.jsx("p",{className:"text-sm font-black uppercase mb-2",children:"Avg. Isolation"}),S.jsx("p",{className:"text-5xl font-black text-black",children:"3.2"}),S.jsxs("p",{className:"text-sm font-bold mt-2 flex items-center gap-1",children:[S.jsx(_P,{className:"w-4 h-4"}),"-0.4 (Improving)"]})]})]})]}),S.jsx("div",{className:"xl:col-span-2 h-full",children:S.jsxs(Th,{className:"h-full flex flex-col bg-white",children:[S.jsxs("div",{className:"px-6 py-4 border-b-[3px] border-black bg-white flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx(jT,{className:"w-6 h-6 text-black fill-[#FFD93D]"}),S.jsx("h2",{className:"font-black text-xl uppercase",children:"Live Feed"})]}),S.jsxs("span",{className:"flex items-center gap-2 text-xs font-bold uppercase bg-black text-[#6BCB77] px-3 py-1 rounded-full",children:[S.jsx("span",{className:"w-2 h-2 rounded-full bg-[#6BCB77] animate-pulse"}),"Streaming"]})]}),S.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 max-h-[600px] bg-[#f0f0f0]",children:d.map(m=>S.jsxs(ke.div,{whileHover:{x:4,y:-4,boxShadow:"-4px 4px 0px 0px black"},className:`
                                                p-4 rounded-xl border-2 border-black bg-white shadow-[2px_2px_0px_0px_black]
                                                cursor-pointer transition-all relative overflow-hidden
                                            `,children:[S.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-2 ${f(m.severity)} border-r-2 border-black`}),S.jsxs("div",{className:"pl-4 flex items-start justify-between gap-2",children:[S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-center justify-between mb-1",children:[S.jsx("span",{className:"font-black text-lg text-black",children:m.ward}),S.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase",children:m.time})]}),S.jsx("p",{className:"text-sm font-bold text-[#4D96FF] uppercase mb-1",children:m.type}),S.jsx("p",{className:"text-sm text-gray-700 font-medium leading-snug",children:m.detail}),S.jsxs("div",{className:"mt-3 inline-block bg-black text-white text-xs font-bold px-2 py-1 rounded",children:["STATUS: ",m.status.toUpperCase()]})]}),S.jsx(EP,{className:"w-5 h-5 text-gray-400"})]})]},m.id))}),S.jsx("div",{className:"p-4 border-t-[3px] border-black bg-white",children:S.jsxs("button",{className:"w-full py-3 rounded-xl border-2 border-black bg-gray-100 hover:bg-[#FFD93D] hover:shadow-[4px_4px_0px_0px_black] transition-all font-black uppercase text-sm flex items-center justify-center gap-2",children:["View All Activity",S.jsx(EP,{className:"w-4 h-4"})]})})]})})]})})]})]})};function zne(){return S.jsx(tH,{children:S.jsxs(PV,{children:[S.jsx(qo,{path:"/",element:S.jsx(Oq,{})}),S.jsx(qo,{path:"/dashboard",element:S.jsx(m$,{})}),S.jsx(qo,{path:"/create",element:S.jsx(y$,{})}),S.jsx(qo,{path:"/chat",element:S.jsx(Bne,{})}),S.jsx(qo,{path:"/sessions",element:S.jsx(Lne,{})}),S.jsx(qo,{path:"/elder-chat",element:S.jsx(jne,{})}),S.jsx(qo,{path:"/admin",element:S.jsx(Une,{})})]})})}const Vne=new C8({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});AS.createRoot(document.getElementById("root")).render(S.jsx(OD.StrictMode,{children:S.jsx(k8,{client:Vne,children:S.jsx(zne,{})})}));
